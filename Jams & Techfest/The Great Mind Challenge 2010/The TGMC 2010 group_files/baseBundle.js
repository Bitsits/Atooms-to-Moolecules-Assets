/*
	Copyright (c) 2004-2008, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is a compiled version of Dojo, built for deployment and not for
	development. To get an editable version, please visit:

		http://dojotoolkit.org

	for documentation and information on getting the source.
*/

(function(){
var _1=null;
if((_1||(typeof djConfig!="undefined"&&djConfig.scopeMap))&&(typeof window!="undefined")){
var _2="",_3="",_4="",_5={},_6={};
_1=_1||djConfig.scopeMap;
for(var i=0;i<_1.length;i++){
var _8=_1[i];
_2+="var "+_8[0]+" = {}; "+_8[1]+" = "+_8[0]+";"+_8[1]+"._scopeName = '"+_8[1]+"';";
_3+=(i==0?"":",")+_8[0];
_4+=(i==0?"":",")+_8[1];
_5[_8[0]]=_8[1];
_6[_8[1]]=_8[0];
}
eval(_2+"dojo._scopeArgs = ["+_4+"];");
dojo._scopePrefixArgs=_3;
dojo._scopePrefix="(function("+_3+"){";
dojo._scopeSuffix="})("+_4+")";
dojo._scopeMap=_5;
dojo._scopeMapRev=_6;
}
(function(){
if(this["navigator"]){
if(/3[\.0-9]+.*Safari/i.test(navigator.appVersion)&&this["console"]){
this.console={_c:this.console,log:function(s){
this._c.log(s);
},info:function(s){
this._c.info(s);
},error:function(s){
this._c.error(s);
},warn:function(s){
this._c.warn(s);
}};
}
}
if(!this["console"]){
this.console={};
}
var cn=["assert","count","debug","dir","dirxml","error","group","groupEnd","info","profile","profileEnd","time","timeEnd","trace","warn","log"];
var i=0,tn;
while((tn=cn[i++])){
if(!console[tn]){
(function(){
var tcn=tn+"";
console[tcn]=("log" in console)?function(){
var a=Array.apply({},arguments);
a.unshift(tcn+":");
console["log"](a.join(" "));
}:function(){
};
})();
}
}
if(typeof dojo=="undefined"){
this.dojo={_scopeName:"dojo",_scopePrefix:"",_scopePrefixArgs:"",_scopeSuffix:"",_scopeMap:{},_scopeMapRev:{}};
}
var d=dojo;
if(typeof dijit=="undefined"){
this.dijit={_scopeName:"dijit"};
}
if(typeof dojox=="undefined"){
this.dojox={_scopeName:"dojox"};
}
if(!d._scopeArgs){
d._scopeArgs=[dojo,dijit,dojox];
}
d.global=this;
d.config={isDebug:false,debugAtAllCosts:false};
if(typeof djConfig!="undefined"){
for(var opt in djConfig){
d.config[opt]=djConfig[opt];
}
}
var _14=["Browser","Rhino","Spidermonkey","Mobile"];
var t;
while((t=_14.shift())){
d["is"+t]=false;
}
dojo.locale=d.config.locale;
var rev="$Rev: 15997 $".match(/\d+/);
dojo.version={major:1,minor:2,patch:3,flag:"connections.communities",revision:rev?+rev[0]:999999,toString:function(){
with(d.version){
return major+"."+minor+"."+patch+flag+" ("+revision+")";
}
}};
if(typeof OpenAjax!="undefined"){
OpenAjax.hub.registerLibrary(dojo._scopeName,"http://dojotoolkit.org",d.version.toString());
}
dojo._mixin=function(obj,_18){
var _19={};
for(var x in _18){
if(_19[x]===undefined||_19[x]!=_18[x]){
obj[x]=_18[x];
}
}
if(d["isIE"]&&_18){
var p=_18.toString;
if(typeof p=="function"&&p!=obj.toString&&p!=_19.toString&&p!="\nfunction toString() {\n    [native code]\n}\n"){
obj.toString=_18.toString;
}
}
return obj;
};
dojo.mixin=function(obj,_1d){
for(var i=1,l=arguments.length;i<l;i++){
d._mixin(obj,arguments[i]);
}
return obj;
};
dojo._getProp=function(_20,_21,_22){
var obj=_22||d.global;
for(var i=0,p;obj&&(p=_20[i]);i++){
if(i==0&&this._scopeMap[p]){
p=this._scopeMap[p];
}
obj=(p in obj?obj[p]:(_21?obj[p]={}:undefined));
}
return obj;
};
dojo.setObject=function(_26,_27,_28){
var _29=_26.split("."),p=_29.pop(),obj=d._getProp(_29,true,_28);
return obj&&p?(obj[p]=_27):undefined;
};
dojo.getObject=function(_2c,_2d,_2e){
return d._getProp(_2c.split("."),_2d,_2e);
};
dojo.exists=function(_2f,obj){
return !!d.getObject(_2f,false,obj);
};
dojo["eval"]=function(_31){
return d.global.eval?d.global.eval(_31):eval(_31);
};
d.deprecated=d.experimental=function(){
};
})();
(function(){
var d=dojo;
d.mixin(d,{_loadedModules:{},_inFlightCount:0,_hasResource:{},_modulePrefixes:{dojo:{name:"dojo",value:"."},doh:{name:"doh",value:"../util/doh"},tests:{name:"tests",value:"tests"}},_moduleHasPrefix:function(_33){
var mp=this._modulePrefixes;
return !!(mp[_33]&&mp[_33].value);
},_getModulePrefix:function(_35){
var mp=this._modulePrefixes;
if(this._moduleHasPrefix(_35)){
return mp[_35].value;
}
return _35;
},_loadedUrls:[],_postLoad:false,_loaders:[],_unloaders:[],_loadNotifying:false});
dojo._loadPath=function(_37,_38,cb){
var uri=((_37.charAt(0)=="/"||_37.match(/^\w+:/))?"":this.baseUrl)+_37;
try{
return !_38?this._loadUri(uri,cb):this._loadUriAndCheck(uri,_38,cb);
}
catch(e){
console.error(e);
return false;
}
};
dojo._loadUri=function(uri,cb){
if(this._loadedUrls[uri]){
return true;
}
var _3d=this._getText(uri,true);
if(!_3d){
return false;
}
this._loadedUrls[uri]=true;
this._loadedUrls.push(uri);
if(cb){
_3d="("+_3d+")";
}else{
_3d=this._scopePrefix+_3d+this._scopeSuffix;
}
if(d.isMoz){
_3d+="\r\n//@ sourceURL="+uri;
}
var _3e=d["eval"](_3d);
if(cb){
cb(_3e);
}
return true;
};
dojo._loadUriAndCheck=function(uri,_40,cb){
var ok=false;
try{
ok=this._loadUri(uri,cb);
}
catch(e){
console.error("failed loading "+uri+" with error: "+e);
}
return !!(ok&&this._loadedModules[_40]);
};
dojo.loaded=function(){
this._loadNotifying=true;
this._postLoad=true;
var mll=d._loaders;
this._loaders=[];
for(var x=0;x<mll.length;x++){
mll[x]();
}
this._loadNotifying=false;
if(d._postLoad&&d._inFlightCount==0&&mll.length){
d._callLoaded();
}
};
dojo.unloaded=function(){
var mll=this._unloaders;
while(mll.length){
(mll.pop())();
}
};
d._onto=function(arr,obj,fn){
if(!fn){
arr.push(obj);
}else{
if(fn){
var _49=(typeof fn=="string")?obj[fn]:fn;
arr.push(function(){
_49.call(obj);
});
}
}
};
dojo.addOnLoad=function(obj,_4b){
d._onto(d._loaders,obj,_4b);
if(d._postLoad&&d._inFlightCount==0&&!d._loadNotifying){
d._callLoaded();
}
};
var dca=d.config.addOnLoad;
if(dca){
d.addOnLoad[(dca instanceof Array?"apply":"call")](d,dca);
}
dojo.addOnUnload=function(obj,_4e){
d._onto(d._unloaders,obj,_4e);
};
dojo._modulesLoaded=function(){
if(d._postLoad){
return;
}
if(d._inFlightCount>0){
console.warn("files still in flight!");
return;
}
d._callLoaded();
};
dojo._callLoaded=function(){
if(typeof setTimeout=="object"||(dojo.config.useXDomain&&d.isOpera)){
if(dojo.isAIR){
setTimeout(function(){
dojo.loaded();
},0);
}else{
setTimeout(dojo._scopeName+".loaded();",0);
}
}else{
d.loaded();
}
};
dojo._getModuleSymbols=function(_4f){
var _50=_4f.split(".");
for(var i=_50.length;i>0;i--){
var _52=_50.slice(0,i).join(".");
if((i==1)&&!this._moduleHasPrefix(_52)){
_50[0]="../"+_50[0];
}else{
var _53=this._getModulePrefix(_52);
if(_53!=_52){
_50.splice(0,i,_53);
break;
}
}
}
return _50;
};
dojo._global_omit_module_check=false;
dojo.loadInit=function(_54){
_54();
};
dojo._loadModule=dojo.require=function(_55,_56){
_56=this._global_omit_module_check||_56;
var _57=this._loadedModules[_55];
if(_57){
return _57;
}
var _58=this._getModuleSymbols(_55).join("/")+".js";
var _59=(!_56)?_55:null;
var ok=this._loadPath(_58,_59);
if(!ok&&!_56){
throw new Error("Could not load '"+_55+"'; last tried '"+_58+"'");
}
if(!_56&&!this._isXDomain){
_57=this._loadedModules[_55];
if(!_57){
throw new Error("symbol '"+_55+"' is not defined after loading '"+_58+"'");
}
}
return _57;
};
dojo.provide=function(_5b){
_5b=_5b+"";
return (d._loadedModules[_5b]=d.getObject(_5b,true));
};
dojo.platformRequire=function(_5c){
var _5d=_5c.common||[];
var _5e=_5d.concat(_5c[d._name]||_5c["default"]||[]);
for(var x=0;x<_5e.length;x++){
var _60=_5e[x];
if(_60.constructor==Array){
d._loadModule.apply(d,_60);
}else{
d._loadModule(_60);
}
}
};
dojo.requireIf=function(_61,_62){
if(_61===true){
var _63=[];
for(var i=1;i<arguments.length;i++){
_63.push(arguments[i]);
}
d.require.apply(d,_63);
}
};
dojo.requireAfterIf=d.requireIf;
dojo.registerModulePath=function(_65,_66){
d._modulePrefixes[_65]={name:_65,value:_66};
};
dojo.requireLocalization=function(_67,_68,_69,_6a){
d.require("dojo.i18n");
d.i18n._requireLocalization.apply(d.hostenv,arguments);
};
var ore=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$");
var ire=new RegExp("^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$");
dojo._Url=function(){
var n=null;
var _a=arguments;
var uri=[_a[0]];
for(var i=1;i<_a.length;i++){
if(!_a[i]){
continue;
}
var _71=new d._Url(_a[i]+"");
var _72=new d._Url(uri[0]+"");
if(_71.path==""&&!_71.scheme&&!_71.authority&&!_71.query){
if(_71.fragment!=n){
_72.fragment=_71.fragment;
}
_71=_72;
}else{
if(!_71.scheme){
_71.scheme=_72.scheme;
if(!_71.authority){
_71.authority=_72.authority;
if(_71.path.charAt(0)!="/"){
var _73=_72.path.substring(0,_72.path.lastIndexOf("/")+1)+_71.path;
var _74=_73.split("/");
for(var j=0;j<_74.length;j++){
if(_74[j]=="."){
if(j==_74.length-1){
_74[j]="";
}else{
_74.splice(j,1);
j--;
}
}else{
if(j>0&&!(j==1&&_74[0]=="")&&_74[j]==".."&&_74[j-1]!=".."){
if(j==(_74.length-1)){
_74.splice(j,1);
_74[j-1]="";
}else{
_74.splice(j-1,2);
j-=2;
}
}
}
}
_71.path=_74.join("/");
}
}
}
}
uri=[];
if(_71.scheme){
uri.push(_71.scheme,":");
}
if(_71.authority){
uri.push("//",_71.authority);
}
uri.push(_71.path);
if(_71.query){
uri.push("?",_71.query);
}
if(_71.fragment){
uri.push("#",_71.fragment);
}
}
this.uri=uri.join("");
var r=this.uri.match(ore);
this.scheme=r[2]||(r[1]?"":n);
this.authority=r[4]||(r[3]?"":n);
this.path=r[5];
this.query=r[7]||(r[6]?"":n);
this.fragment=r[9]||(r[8]?"":n);
if(this.authority!=n){
r=this.authority.match(ire);
this.user=r[3]||n;
this.password=r[4]||n;
this.host=r[6]||r[7];
this.port=r[9]||n;
}
};
dojo._Url.prototype.toString=function(){
return this.uri;
};
dojo.moduleUrl=function(_77,url){
var loc=d._getModuleSymbols(_77).join("/");
if(!loc){
return null;
}
if(loc.lastIndexOf("/")!=loc.length-1){
loc+="/";
}
var _7a=loc.indexOf(":");
if(loc.charAt(0)!="/"&&(_7a==-1||_7a>loc.indexOf("/"))){
loc=d.baseUrl+loc;
}
return new d._Url(loc,url);
};
})();
if(typeof window!="undefined"){
dojo.isBrowser=true;
dojo._name="browser";
(function(){
var d=dojo;
if(document&&document.getElementsByTagName){
var _7c=document.getElementsByTagName("script");
var _7d=/dojo(\.xd)?\.js(\W|$)/i;
for(var i=0;i<_7c.length;i++){
var src=_7c[i].getAttribute("src");
if(!src){
continue;
}
var m=src.match(_7d);
if(m){
if(!d.config.baseUrl){
d.config.baseUrl=src.substring(0,m.index);
}
var cfg=_7c[i].getAttribute("djConfig");
if(cfg){
var _82=eval("({ "+cfg+" })");
for(var x in _82){
dojo.config[x]=_82[x];
}
}
break;
}
}
}
d.baseUrl=d.config.baseUrl;
var n=navigator;
var dua=n.userAgent;
var dav=n.appVersion;
var tv=parseFloat(dav);
if(dua.indexOf("Opera")>=0){
d.isOpera=tv;
}
var _88=Math.max(dav.indexOf("WebKit"),dav.indexOf("Safari"),0);
if(_88){
d.isSafari=parseFloat(dav.split("Version/")[1])||(parseFloat(dav.substr(_88+7))>419.3)?3:2;
}
if(dua.indexOf("AdobeAIR")>=0){
d.isAIR=1;
}
if(dav.indexOf("Konqueror")>=0||d.isSafari){
d.isKhtml=tv;
}
if(dua.indexOf("Gecko")>=0&&!d.isKhtml){
d.isMozilla=d.isMoz=tv;
}
if(d.isMoz){
d.isFF=parseFloat(dua.split("Firefox/")[1])||undefined;
}
if(document.all&&!d.isOpera){
d.isIE=parseFloat(dav.split("MSIE ")[1])||undefined;
}
if(dojo.isIE&&window.location.protocol==="file:"){
dojo.config.ieForceActiveXXhr=true;
}
var cm=document.compatMode;
d.isQuirks=cm=="BackCompat"||cm=="QuirksMode"||d.isIE<6;
d.locale=dojo.config.locale||(d.isIE?n.userLanguage:n.language).toLowerCase();
d._XMLHTTP_PROGIDS=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"];
d._xhrObj=function(){
var _8a=null;
var _8b=null;
if(!dojo.isIE||!dojo.config.ieForceActiveXXhr){
try{
_8a=new XMLHttpRequest();
}
catch(e){
}
}
if(!_8a){
for(var i=0;i<3;++i){
var _8d=d._XMLHTTP_PROGIDS[i];
try{
_8a=new ActiveXObject(_8d);
}
catch(e){
_8b=e;
}
if(_8a){
d._XMLHTTP_PROGIDS=[_8d];
break;
}
}
}
if(!_8a){
throw new Error("XMLHTTP not available: "+_8b);
}
return _8a;
};
d._isDocumentOk=function(_8e){
var _8f=_8e.status||0;
return (_8f>=200&&_8f<300)||_8f==304||_8f==1223||(!_8f&&(location.protocol=="file:"||location.protocol=="chrome:"));
};
var _90=window.location+"";
var _91=document.getElementsByTagName("base");
var _92=(_91&&_91.length>0);
d._getText=function(uri,_94){
var _95=this._xhrObj();
if(!_92&&dojo._Url){
uri=(new dojo._Url(_90,uri)).toString();
}
if(d.config.cacheBust){
uri+="";
uri+=(uri.indexOf("?")==-1?"?":"&")+String(d.config.cacheBust).replace(/\W+/g,"");
}
_95.open("GET",uri,false);
try{
_95.send(null);
if(!d._isDocumentOk(_95)){
var err=Error("Unable to load "+uri+" status:"+_95.status);
err.status=_95.status;
err.responseText=_95.responseText;
throw err;
}
}
catch(e){
if(_94){
return null;
}
throw e;
}
return _95.responseText;
};
d._windowUnloaders=[];
d.windowUnloaded=function(){
var mll=this._windowUnloaders;
while(mll.length){
(mll.pop())();
}
};
d.addOnWindowUnload=function(obj,_99){
d._onto(d._windowUnloaders,obj,_99);
};
})();
dojo._initFired=false;
dojo._loadInit=function(e){
dojo._initFired=true;
var _9b=(e&&e.type)?e.type.toLowerCase():"load";
if(arguments.callee.initialized||(_9b!="domcontentloaded"&&_9b!="load")){
return;
}
arguments.callee.initialized=true;
if("_khtmlTimer" in dojo){
clearInterval(dojo._khtmlTimer);
delete dojo._khtmlTimer;
}
if(dojo._inFlightCount==0){
dojo._modulesLoaded();
}
};
dojo._fakeLoadInit=function(){
dojo._loadInit({type:"load"});
};
if(!dojo.config.afterOnLoad){
if(document.addEventListener){
if(dojo.isOpera||dojo.isFF>=3||(dojo.isMoz&&dojo.config.enableMozDomContentLoaded===true)){
document.addEventListener("DOMContentLoaded",dojo._loadInit,null);
}
window.addEventListener("load",dojo._loadInit,null);
}
if(dojo.isAIR){
window.addEventListener("load",dojo._loadInit,null);
}else{
if(/(WebKit|khtml)/i.test(navigator.userAgent)){
dojo._khtmlTimer=setInterval(function(){
if(/loaded|complete/.test(document.readyState)){
dojo._loadInit();
}
},10);
}
}
}
(function(){
var _w=window;
var _9d=function(_9e,fp){
var _a0=_w[_9e]||function(){
};
_w[_9e]=function(){
fp.apply(_w,arguments);
_a0.apply(_w,arguments);
};
};
if(dojo.isIE){
if(!dojo.config.afterOnLoad){
document.write("<scr"+"ipt defer src=\"//:\" "+"onreadystatechange=\"if(this.readyState=='complete'){"+dojo._scopeName+"._loadInit();}\">"+"</scr"+"ipt>");
}
try{
document.namespaces.add("v","urn:schemas-microsoft-com:vml");
document.createStyleSheet().addRule("v\\:*","behavior:url(#default#VML)");
}
catch(e){
}
}
_9d("onbeforeunload",function(){
dojo.unloaded();
});
_9d("onunload",function(){
dojo.windowUnloaded();
});
})();
}
(function(){
var mp=dojo.config["modulePaths"];
if(mp){
for(var _a2 in mp){
dojo.registerModulePath(_a2,mp[_a2]);
}
}
})();
if(dojo.config.isDebug){
dojo.require("dojo._firebug.firebug");
}
if(dojo.config.debugAtAllCosts){
dojo.config.useXDomain=true;
dojo.require("dojo._base._loader.loader_xd");
dojo.require("dojo._base._loader.loader_debug");
}
if(!dojo._hasResource["dojo._base.lang"]){
dojo._hasResource["dojo._base.lang"]=true;
dojo.provide("dojo._base.lang");
dojo.isString=function(it){
return !!arguments.length&&it!=null&&(typeof it=="string"||it instanceof String);
};
dojo.isArray=function(it){
return it&&(it instanceof Array||typeof it=="array");
};
dojo.isFunction=(function(){
var _a5=function(it){
return it&&(typeof it=="function"||it instanceof Function);
};
return dojo.isSafari?function(it){
if(typeof it=="function"&&it=="[object NodeList]"){
return false;
}
return _a5(it);
}:_a5;
})();
dojo.isObject=function(it){
return it!==undefined&&(it===null||typeof it=="object"||dojo.isArray(it)||dojo.isFunction(it));
};
dojo.isArrayLike=function(it){
var d=dojo;
return it&&it!==undefined&&!d.isString(it)&&!d.isFunction(it)&&!(it.tagName&&it.tagName.toLowerCase()=="form")&&(d.isArray(it)||isFinite(it.length));
};
dojo.isAlien=function(it){
return it&&!dojo.isFunction(it)&&/\{\s*\[native code\]\s*\}/.test(String(it));
};
dojo.extend=function(_ac,_ad){
for(var i=1,l=arguments.length;i<l;i++){
dojo._mixin(_ac.prototype,arguments[i]);
}
return _ac;
};
dojo._hitchArgs=function(_b0,_b1){
var pre=dojo._toArray(arguments,2);
var _b3=dojo.isString(_b1);
return function(){
var _b4=dojo._toArray(arguments);
var f=_b3?(_b0||dojo.global)[_b1]:_b1;
return f&&f.apply(_b0||this,pre.concat(_b4));
};
};
dojo.hitch=function(_b6,_b7){
if(arguments.length>2){
return dojo._hitchArgs.apply(dojo,arguments);
}
if(!_b7){
_b7=_b6;
_b6=null;
}
if(dojo.isString(_b7)){
_b6=_b6||dojo.global;
if(!_b6[_b7]){
throw (["dojo.hitch: scope[\"",_b7,"\"] is null (scope=\"",_b6,"\")"].join(""));
}
return function(){
return _b6[_b7].apply(_b6,arguments||[]);
};
}
return !_b6?_b7:function(){
return _b7.apply(_b6,arguments||[]);
};
};
dojo.delegate=dojo._delegate=(function(){
function TMP(){
};
return function(obj,_b9){
TMP.prototype=obj;
var tmp=new TMP();
if(_b9){
dojo._mixin(tmp,_b9);
}
return tmp;
};
})();
(function(){
var _bb=function(obj,_bd,_be){
return (_be||[]).concat(Array.prototype.slice.call(obj,_bd||0));
};
var _bf=function(obj,_c1,_c2){
var arr=_c2||[];
for(var x=_c1||0;x<obj.length;x++){
arr.push(obj[x]);
}
return arr;
};
dojo._toArray=(!dojo.isIE)?_bb:function(obj){
return ((obj.item)?_bf:_bb).apply(this,arguments);
};
})();
dojo.partial=function(_c6){
var arr=[null];
return dojo.hitch.apply(dojo,arr.concat(dojo._toArray(arguments)));
};
dojo.clone=function(o){
if(!o){
return o;
}
if(dojo.isArray(o)){
var r=[];
for(var i=0;i<o.length;++i){
r.push(dojo.clone(o[i]));
}
return r;
}
if(!dojo.isObject(o)){
return o;
}
if(o.nodeType&&o.cloneNode){
return o.cloneNode(true);
}
if(o instanceof Date){
return new Date(o.getTime());
}
var r=new o.constructor();
for(var i in o){
if(!(i in r)||r[i]!=o[i]){
r[i]=dojo.clone(o[i]);
}
}
return r;
};
dojo.trim=function(str){
return str.replace(/^\s\s*/,"").replace(/\s\s*$/,"");
};
}
if(!dojo._hasResource["dojo._base.declare"]){
dojo._hasResource["dojo._base.declare"]=true;
dojo.provide("dojo._base.declare");
dojo.declare=function(_cc,_cd,_ce){
var dd=arguments.callee,_d0;
if(dojo.isArray(_cd)){
_d0=_cd;
_cd=_d0.shift();
}
if(_d0){
dojo.forEach(_d0,function(m){
if(!m){
throw (_cc+": mixin #"+i+" is null");
}
_cd=dd._delegate(_cd,m);
});
}
var _d2=dd._delegate(_cd);
_ce=_ce||{};
_d2.extend(_ce);
dojo.extend(_d2,{declaredClass:_cc,_constructor:_ce.constructor});
_d2.prototype.constructor=_d2;
return dojo.setObject(_cc,_d2);
};
dojo.mixin(dojo.declare,{_delegate:function(_d3,_d4){
var bp=(_d3||0).prototype,mp=(_d4||0).prototype,dd=dojo.declare;
var _d8=dd._makeCtor();
dojo.mixin(_d8,{superclass:bp,mixin:mp,extend:dd._extend});
if(_d3){
_d8.prototype=dojo._delegate(bp);
}
dojo.extend(_d8,dd._core,mp||0,{_constructor:null,preamble:null});
_d8.prototype.constructor=_d8;
_d8.prototype.declaredClass=(bp||0).declaredClass+"_"+(mp||0).declaredClass;
return _d8;
},_extend:function(_d9){
var i,fn;
for(i in _d9){
if(dojo.isFunction(fn=_d9[i])&&!0[i]){
fn.nom=i;
fn.ctor=this;
}
}
dojo.extend(this,_d9);
},_makeCtor:function(){
return function(){
this._construct(arguments);
};
},_core:{_construct:function(_dc){
var c=_dc.callee,s=c.superclass,ct=s&&s.constructor,m=c.mixin,mct=m&&m.constructor,a=_dc,ii,fn;
if(a[0]){
if(((fn=a[0].preamble))){
a=fn.apply(this,a)||a;
}
}
if((fn=c.prototype.preamble)){
a=fn.apply(this,a)||a;
}
if(ct&&ct.apply){
ct.apply(this,a);
}
if(mct&&mct.apply){
mct.apply(this,a);
}
if((ii=c.prototype._constructor)){
ii.apply(this,_dc);
}
if(this.constructor.prototype==c.prototype&&(ct=this.postscript)){
ct.apply(this,_dc);
}
},_findMixin:function(_e5){
var c=this.constructor,p,m;
while(c){
p=c.superclass;
m=c.mixin;
if(m==_e5||(m instanceof _e5.constructor)){
return p;
}
if(m&&m._findMixin&&(m=m._findMixin(_e5))){
return m;
}
c=p&&p.constructor;
}
},_findMethod:function(_e9,_ea,_eb,has){
var p=_eb,c,m,f;
do{
c=p.constructor;
m=c.mixin;
if(m&&(m=this._findMethod(_e9,_ea,m,has))){
return m;
}
if((f=p[_e9])&&(has==(f==_ea))){
return p;
}
p=c.superclass;
}while(p);
return !has&&(p=this._findMixin(_eb))&&this._findMethod(_e9,_ea,p,has);
},inherited:function(_f1,_f2,_f3){
var a=arguments;
if(!dojo.isString(a[0])){
_f3=_f2;
_f2=_f1;
_f1=_f2.callee.nom;
}
a=_f3||_f2;
var c=_f2.callee,p=this.constructor.prototype,fn,mp;
if(this[_f1]!=c||p[_f1]==c){
mp=(c.ctor||0).superclass||this._findMethod(_f1,c,p,true);
if(!mp){
throw (this.declaredClass+": inherited method \""+_f1+"\" mismatch");
}
p=this._findMethod(_f1,c,mp,false);
}
fn=p&&p[_f1];
if(!fn){
throw (mp.declaredClass+": inherited method \""+_f1+"\" not found");
}
return fn.apply(this,a);
}}});
}
if(!dojo._hasResource["dojo._base.connect"]){
dojo._hasResource["dojo._base.connect"]=true;
dojo.provide("dojo._base.connect");
dojo._listener={getDispatcher:function(){
return function(){
var ap=Array.prototype,c=arguments.callee,ls=c._listeners,t=c.target;
var r=t&&t.apply(this,arguments);
var lls;
lls=[].concat(ls);
for(var i in lls){
if(!(i in ap)){
lls[i].apply(this,arguments);
}
}
return r;
};
},add:function(_100,_101,_102){
_100=_100||dojo.global;
var f=_100[_101];
if(!f||!f._listeners){
var d=dojo._listener.getDispatcher();
d.target=f;
d._listeners=[];
f=_100[_101]=d;
}
return f._listeners.push(_102);
},remove:function(_105,_106,_107){
var f=(_105||dojo.global)[_106];
if(f&&f._listeners&&_107--){
delete f._listeners[_107];
}
}};
dojo.connect=function(obj,_10a,_10b,_10c,_10d){
var a=arguments,args=[],i=0;
args.push(dojo.isString(a[0])?null:a[i++],a[i++]);
var a1=a[i+1];
args.push(dojo.isString(a1)||dojo.isFunction(a1)?a[i++]:null,a[i++]);
for(var l=a.length;i<l;i++){
args.push(a[i]);
}
return dojo._connect.apply(this,args);
};
dojo._connect=function(obj,_113,_114,_115){
var l=dojo._listener,h=l.add(obj,_113,dojo.hitch(_114,_115));
return [obj,_113,h,l];
};
dojo.disconnect=function(_118){
if(_118&&_118[0]!==undefined){
dojo._disconnect.apply(this,_118);
delete _118[0];
}
};
dojo._disconnect=function(obj,_11a,_11b,_11c){
_11c.remove(obj,_11a,_11b);
};
dojo._topics={};
dojo.subscribe=function(_11d,_11e,_11f){
return [_11d,dojo._listener.add(dojo._topics,_11d,dojo.hitch(_11e,_11f))];
};
dojo.unsubscribe=function(_120){
if(_120){
dojo._listener.remove(dojo._topics,_120[0],_120[1]);
}
};
dojo.publish=function(_121,args){
var f=dojo._topics[_121];
if(f){
f.apply(this,args||[]);
}
};
dojo.connectPublisher=function(_124,obj,_126){
var pf=function(){
dojo.publish(_124,arguments);
};
return (_126)?dojo.connect(obj,_126,pf):dojo.connect(obj,pf);
};
}
if(!dojo._hasResource["dojo._base.Deferred"]){
dojo._hasResource["dojo._base.Deferred"]=true;
dojo.provide("dojo._base.Deferred");
dojo.Deferred=function(_128){
this.chain=[];
this.id=this._nextId();
this.fired=-1;
this.paused=0;
this.results=[null,null];
this.canceller=_128;
this.silentlyCancelled=false;
};
dojo.extend(dojo.Deferred,{_nextId:(function(){
var n=1;
return function(){
return n++;
};
})(),cancel:function(){
var err;
if(this.fired==-1){
if(this.canceller){
err=this.canceller(this);
}else{
this.silentlyCancelled=true;
}
if(this.fired==-1){
if(!(err instanceof Error)){
var res=err;
err=new Error("Deferred Cancelled");
err.dojoType="cancel";
err.cancelResult=res;
}
this.errback(err);
}
}else{
if((this.fired==0)&&(this.results[0] instanceof dojo.Deferred)){
this.results[0].cancel();
}
}
},_resback:function(res){
this.fired=((res instanceof Error)?1:0);
this.results[this.fired]=res;
this._fire();
},_check:function(){
if(this.fired!=-1){
if(!this.silentlyCancelled){
throw new Error("already called!");
}
this.silentlyCancelled=false;
return;
}
},callback:function(res){
this._check();
this._resback(res);
},errback:function(res){
this._check();
if(!(res instanceof Error)){
res=new Error(res);
}
this._resback(res);
},addBoth:function(cb,cbfn){
var _131=dojo.hitch.apply(dojo,arguments);
return this.addCallbacks(_131,_131);
},addCallback:function(cb,cbfn){
return this.addCallbacks(dojo.hitch.apply(dojo,arguments));
},addErrback:function(cb,cbfn){
return this.addCallbacks(null,dojo.hitch.apply(dojo,arguments));
},addCallbacks:function(cb,eb){
this.chain.push([cb,eb]);
if(this.fired>=0){
this._fire();
}
return this;
},_fire:function(){
var _138=this.chain;
var _139=this.fired;
var res=this.results[_139];
var self=this;
var cb=null;
while((_138.length>0)&&(this.paused==0)){
var f=_138.shift()[_139];
if(!f){
continue;
}
var func=function(){
var ret=f(res);
if(typeof ret!="undefined"){
res=ret;
}
_139=((res instanceof Error)?1:0);
if(res instanceof dojo.Deferred){
cb=function(res){
self._resback(res);
self.paused--;
if((self.paused==0)&&(self.fired>=0)){
self._fire();
}
};
this.paused++;
}
};
if(dojo.config.isDebug){
func.call(this);
}else{
try{
func.call(this);
}
catch(err){
_139=1;
res=err;
}
}
}
this.fired=_139;
this.results[_139]=res;
if((cb)&&(this.paused)){
res.addBoth(cb);
}
}});
}
if(!dojo._hasResource["dojo._base.json"]){
dojo._hasResource["dojo._base.json"]=true;
dojo.provide("dojo._base.json");
dojo.fromJson=function(json){
return eval("("+json+")");
};
dojo._escapeString=function(str){
return ("\""+str.replace(/(["\\])/g,"\\$1")+"\"").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r");
};
dojo.toJsonIndentStr="\t";
dojo.toJson=function(it,_144,_145){
if(it===undefined){
return "undefined";
}
var _146=typeof it;
if(_146=="number"||_146=="boolean"){
return it+"";
}
if(it===null){
return "null";
}
if(dojo.isString(it)){
return dojo._escapeString(it);
}
var _147=arguments.callee;
var _148;
_145=_145||"";
var _149=_144?_145+dojo.toJsonIndentStr:"";
var tf=it.__json__||it.json;
if(dojo.isFunction(tf)){
_148=tf.call(it);
if(it!==_148){
return _147(_148,_144,_149);
}
}
if(it.nodeType&&it.cloneNode){
throw new Error("Can't serialize DOM nodes");
}
var sep=_144?" ":"";
var _14c=_144?"\n":"";
if(dojo.isArray(it)){
var res=dojo.map(it,function(obj){
var val=_147(obj,_144,_149);
if(typeof val!="string"){
val="undefined";
}
return _14c+_149+val;
});
return "["+res.join(","+sep)+_14c+_145+"]";
}
if(_146=="function"){
return null;
}
var _150=[],key;
for(key in it){
var _152,val;
if(typeof key=="number"){
_152="\""+key+"\"";
}else{
if(typeof key=="string"){
_152=dojo._escapeString(key);
}else{
continue;
}
}
val=_147(it[key],_144,_149);
if(typeof val!="string"){
continue;
}
_150.push(_14c+_149+_152+":"+sep+val);
}
return "{"+_150.join(","+sep)+_14c+_145+"}";
};
}
if(!dojo._hasResource["dojo._base.array"]){
dojo._hasResource["dojo._base.array"]=true;
dojo.provide("dojo._base.array");
(function(){
var _154=function(arr,obj,cb){
return [dojo.isString(arr)?arr.split(""):arr,obj||dojo.global,dojo.isString(cb)?new Function("item","index","array",cb):cb];
};
dojo.mixin(dojo,{indexOf:function(_158,_159,_15a,_15b){
var step=1,end=_158.length||0,i=0;
if(_15b){
i=end-1;
step=end=-1;
}
if(_15a!=undefined){
i=_15a;
}
if((_15b&&i>end)||i<end){
for(;i!=end;i+=step){
if(_158[i]==_159){
return i;
}
}
}
return -1;
},lastIndexOf:function(_15e,_15f,_160){
return dojo.indexOf(_15e,_15f,_160,true);
},forEach:function(arr,_162,_163){
if(!arr||!arr.length){
return;
}
var _p=_154(arr,_163,_162);
arr=_p[0];
for(var i=0,l=arr.length;i<l;++i){
_p[2].call(_p[1],arr[i],i,arr);
}
},_everyOrSome:function(_167,arr,_169,_16a){
var _p=_154(arr,_16a,_169);
arr=_p[0];
for(var i=0,l=arr.length;i<l;++i){
var _16e=!!_p[2].call(_p[1],arr[i],i,arr);
if(_167^_16e){
return _16e;
}
}
return _167;
},every:function(arr,_170,_171){
return this._everyOrSome(true,arr,_170,_171);
},some:function(arr,_173,_174){
return this._everyOrSome(false,arr,_173,_174);
},map:function(arr,_176,_177){
var _p=_154(arr,_177,_176);
arr=_p[0];
var _179=(arguments[3]?(new arguments[3]()):[]);
for(var i=0,l=arr.length;i<l;++i){
_179.push(_p[2].call(_p[1],arr[i],i,arr));
}
return _179;
},filter:function(arr,_17d,_17e){
var _p=_154(arr,_17e,_17d);
arr=_p[0];
var _180=[];
for(var i=0,l=arr.length;i<l;++i){
if(_p[2].call(_p[1],arr[i],i,arr)){
_180.push(arr[i]);
}
}
return _180;
}});
})();
}
if(!dojo._hasResource["dojo._base.Color"]){
dojo._hasResource["dojo._base.Color"]=true;
dojo.provide("dojo._base.Color");
dojo.Color=function(_183){
if(_183){
this.setColor(_183);
}
};
dojo.Color.named={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255]};
dojo.extend(dojo.Color,{r:255,g:255,b:255,a:1,_set:function(r,g,b,a){
var t=this;
t.r=r;
t.g=g;
t.b=b;
t.a=a;
},setColor:function(_189){
var d=dojo;
if(d.isString(_189)){
d.colorFromString(_189,this);
}else{
if(d.isArray(_189)){
d.colorFromArray(_189,this);
}else{
this._set(_189.r,_189.g,_189.b,_189.a);
if(!(_189 instanceof d.Color)){
this.sanitize();
}
}
}
return this;
},sanitize:function(){
return this;
},toRgb:function(){
var t=this;
return [t.r,t.g,t.b];
},toRgba:function(){
var t=this;
return [t.r,t.g,t.b,t.a];
},toHex:function(){
var arr=dojo.map(["r","g","b"],function(x){
var s=this[x].toString(16);
return s.length<2?"0"+s:s;
},this);
return "#"+arr.join("");
},toCss:function(_190){
var t=this,rgb=t.r+", "+t.g+", "+t.b;
return (_190?"rgba("+rgb+", "+t.a:"rgb("+rgb)+")";
},toString:function(){
return this.toCss(true);
}});
dojo.blendColors=function(_193,end,_195,obj){
var d=dojo,t=obj||new dojo.Color();
d.forEach(["r","g","b","a"],function(x){
t[x]=_193[x]+(end[x]-_193[x])*_195;
if(x!="a"){
t[x]=Math.round(t[x]);
}
});
return t.sanitize();
};
dojo.colorFromRgb=function(_19a,obj){
var m=_19a.toLowerCase().match(/^rgba?\(([\s\.,0-9]+)\)/);
return m&&dojo.colorFromArray(m[1].split(/\s*,\s*/),obj);
};
dojo.colorFromHex=function(_19d,obj){
var d=dojo,t=obj||new d.Color(),bits=(_19d.length==4)?4:8,mask=(1<<bits)-1;
_19d=Number("0x"+_19d.substr(1));
if(isNaN(_19d)){
return null;
}
d.forEach(["b","g","r"],function(x){
var c=_19d&mask;
_19d>>=bits;
t[x]=bits==4?17*c:c;
});
t.a=1;
return t;
};
dojo.colorFromArray=function(a,obj){
var t=obj||new dojo.Color();
t._set(Number(a[0]),Number(a[1]),Number(a[2]),Number(a[3]));
if(isNaN(t.a)){
t.a=1;
}
return t.sanitize();
};
dojo.colorFromString=function(str,obj){
var a=dojo.Color.named[str];
return a&&dojo.colorFromArray(a,obj)||dojo.colorFromRgb(str,obj)||dojo.colorFromHex(str,obj);
};
}
if(!dojo._hasResource["dojo._base"]){
dojo._hasResource["dojo._base"]=true;
dojo.provide("dojo._base");
}
if(!dojo._hasResource["dojo._base.window"]){
dojo._hasResource["dojo._base.window"]=true;
dojo.provide("dojo._base.window");
dojo.doc=window["document"]||null;
dojo.body=function(){
return dojo.doc.body||dojo.doc.getElementsByTagName("body")[0];
};
dojo.setContext=function(_1ab,_1ac){
dojo.global=_1ab;
dojo.doc=_1ac;
};
dojo._fireCallback=function(_1ad,_1ae,_1af){
if(_1ae&&dojo.isString(_1ad)){
_1ad=_1ae[_1ad];
}
return _1ad.apply(_1ae,_1af||[]);
};
dojo.withGlobal=function(_1b0,_1b1,_1b2,_1b3){
var rval;
var _1b5=dojo.global;
var _1b6=dojo.doc;
try{
dojo.setContext(_1b0,_1b0.document);
rval=dojo._fireCallback(_1b1,_1b2,_1b3);
}
finally{
dojo.setContext(_1b5,_1b6);
}
return rval;
};
dojo.withDoc=function(_1b7,_1b8,_1b9,_1ba){
var rval;
var _1bc=dojo.doc;
try{
dojo.doc=_1b7;
rval=dojo._fireCallback(_1b8,_1b9,_1ba);
}
finally{
dojo.doc=_1bc;
}
return rval;
};
}
if(!dojo._hasResource["dojo._base.event"]){
dojo._hasResource["dojo._base.event"]=true;
dojo.provide("dojo._base.event");
(function(){
var del=(dojo._event_listener={add:function(node,name,fp){
if(!node){
return;
}
name=del._normalizeEventName(name);
fp=del._fixCallback(name,fp);
var _1c1=name;
if(!dojo.isIE&&(name=="mouseenter"||name=="mouseleave")){
var ofp=fp;
name=(name=="mouseenter")?"mouseover":"mouseout";
fp=function(e){
try{
e.relatedTarget.tagName;
}
catch(e2){
return;
}
if(!dojo.isDescendant(e.relatedTarget,node)){
return ofp.call(this,e);
}
};
}
node.addEventListener(name,fp,false);
return fp;
},remove:function(node,_1c5,_1c6){
if(node){
_1c5=del._normalizeEventName(_1c5);
if(!dojo.isIE&&(_1c5=="mouseenter"||_1c5=="mouseleave")){
_1c5=(_1c5=="mouseenter")?"mouseover":"mouseout";
}
node.removeEventListener(_1c5,_1c6,false);
}
},_normalizeEventName:function(name){
return name.slice(0,2)=="on"?name.slice(2):name;
},_fixCallback:function(name,fp){
return name!="keypress"?fp:function(e){
return fp.call(this,del._fixEvent(e,this));
};
},_fixEvent:function(evt,_1cc){
switch(evt.type){
case "keypress":
del._setKeyChar(evt);
break;
}
return evt;
},_setKeyChar:function(evt){
evt.keyChar=evt.charCode?String.fromCharCode(evt.charCode):"";
evt.charOrCode=evt.keyChar||evt.keyCode;
},_punctMap:{106:42,111:47,186:59,187:43,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39}});
dojo.fixEvent=function(evt,_1cf){
return del._fixEvent(evt,_1cf);
};
dojo.stopEvent=function(evt){
evt.preventDefault();
evt.stopPropagation();
};
var _1d1=dojo._listener;
dojo._connect=function(obj,_1d3,_1d4,_1d5,_1d6){
var _1d7=obj&&(obj.nodeType||obj.attachEvent||obj.addEventListener);
var lid=!_1d7?0:(!_1d6?1:2),l=[dojo._listener,del,_1d1][lid];
var h=l.add(obj,_1d3,dojo.hitch(_1d4,_1d5));
return [obj,_1d3,h,lid];
};
dojo._disconnect=function(obj,_1dc,_1dd,_1de){
([dojo._listener,del,_1d1][_1de]).remove(obj,_1dc,_1dd);
};
dojo.keys={BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,HELP:47,LEFT_WINDOW:91,RIGHT_WINDOW:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_PLUS:107,NUMPAD_ENTER:108,NUMPAD_MINUS:109,NUMPAD_PERIOD:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,NUM_LOCK:144,SCROLL_LOCK:145};
if(dojo.isIE){
var _1df=function(e,code){
try{
return (e.keyCode=code);
}
catch(e){
return 0;
}
};
var iel=dojo._listener;
var _1e3=dojo._ieListenersName="_"+dojo._scopeName+"_listeners";
if(!dojo.config._allow_leaks){
_1d1=iel=dojo._ie_listener={handlers:[],add:function(_1e4,_1e5,_1e6){
_1e4=_1e4||dojo.global;
var f=_1e4[_1e5];
if(!f||!f[_1e3]){
var d=dojo._getIeDispatcher();
d.target=f&&(ieh.push(f)-1);
d[_1e3]=[];
f=_1e4[_1e5]=d;
}
return f[_1e3].push(ieh.push(_1e6)-1);
},remove:function(_1ea,_1eb,_1ec){
var f=(_1ea||dojo.global)[_1eb],l=f&&f[_1e3];
if(f&&l&&_1ec--){
delete ieh[l[_1ec]];
delete l[_1ec];
}
}};
var ieh=iel.handlers;
}
dojo.mixin(del,{add:function(node,_1f0,fp){
if(!node){
return;
}
_1f0=del._normalizeEventName(_1f0);
if(_1f0=="onkeypress"){
var kd=node.onkeydown;
if(!kd||!kd[_1e3]||!kd._stealthKeydownHandle){
var h=del.add(node,"onkeydown",del._stealthKeyDown);
kd=node.onkeydown;
kd._stealthKeydownHandle=h;
kd._stealthKeydownRefs=1;
}else{
kd._stealthKeydownRefs++;
}
}
return iel.add(node,_1f0,del._fixCallback(fp));
},remove:function(node,_1f5,_1f6){
_1f5=del._normalizeEventName(_1f5);
iel.remove(node,_1f5,_1f6);
if(_1f5=="onkeypress"){
var kd=node.onkeydown;
if(--kd._stealthKeydownRefs<=0){
iel.remove(node,"onkeydown",kd._stealthKeydownHandle);
delete kd._stealthKeydownHandle;
}
}
},_normalizeEventName:function(_1f8){
return _1f8.slice(0,2)!="on"?"on"+_1f8:_1f8;
},_nop:function(){
},_fixEvent:function(evt,_1fa){
if(!evt){
var w=_1fa&&(_1fa.ownerDocument||_1fa.document||_1fa).parentWindow||window;
evt=w.event;
}
if(!evt){
return (evt);
}
evt.target=evt.srcElement;
evt.currentTarget=(_1fa||evt.srcElement);
evt.layerX=evt.offsetX;
evt.layerY=evt.offsetY;
var se=evt.srcElement,doc=(se&&se.ownerDocument)||document;
var _1fe=((dojo.isIE<6)||(doc["compatMode"]=="BackCompat"))?doc.body:doc.documentElement;
var _1ff=dojo._getIeDocumentElementOffset();
evt.pageX=evt.clientX+dojo._fixIeBiDiScrollLeft(_1fe.scrollLeft||0)-_1ff.x;
evt.pageY=evt.clientY+(_1fe.scrollTop||0)-_1ff.y;
if(evt.type=="mouseover"){
evt.relatedTarget=evt.fromElement;
}
if(evt.type=="mouseout"){
evt.relatedTarget=evt.toElement;
}
evt.stopPropagation=del._stopPropagation;
evt.preventDefault=del._preventDefault;
return del._fixKeys(evt);
},_fixKeys:function(evt){
switch(evt.type){
case "keypress":
var c=("charCode" in evt?evt.charCode:evt.keyCode);
if(c==10){
c=0;
evt.keyCode=13;
}else{
if(c==13||c==27){
c=0;
}else{
if(c==3){
c=99;
}
}
}
evt.charCode=c;
del._setKeyChar(evt);
break;
}
return evt;
},_stealthKeyDown:function(evt){
var kp=evt.currentTarget.onkeypress;
if(!kp||!kp[_1e3]){
return;
}
var k=evt.keyCode;
var _205=(k!=13)&&(k!=32)&&(k!=27)&&(k<48||k>90)&&(k<96||k>111)&&(k<186||k>192)&&(k<219||k>222);
if(_205||evt.ctrlKey){
var c=_205?0:k;
if(evt.ctrlKey){
if(k==3||k==13){
return;
}else{
if(c>95&&c<106){
c-=48;
}else{
if((!evt.shiftKey)&&(c>=65&&c<=90)){
c+=32;
}else{
c=del._punctMap[c]||c;
}
}
}
}
var faux=del._synthesizeEvent(evt,{type:"keypress",faux:true,charCode:c});
kp.call(evt.currentTarget,faux);
evt.cancelBubble=faux.cancelBubble;
evt.returnValue=faux.returnValue;
_1df(evt,faux.keyCode);
}
},_stopPropagation:function(){
this.cancelBubble=true;
},_preventDefault:function(){
this.bubbledKeyCode=this.keyCode;
if(this.ctrlKey){
_1df(this,0);
}
this.returnValue=false;
}});
dojo.stopEvent=function(evt){
evt=evt||window.event;
del._stopPropagation.call(evt);
del._preventDefault.call(evt);
};
}
del._synthesizeEvent=function(evt,_20a){
var faux=dojo.mixin({},evt,_20a);
del._setKeyChar(faux);
faux.preventDefault=function(){
evt.preventDefault();
};
faux.stopPropagation=function(){
evt.stopPropagation();
};
return faux;
};
if(dojo.isOpera){
dojo.mixin(del,{_fixEvent:function(evt,_20d){
switch(evt.type){
case "keypress":
var c=evt.which;
if(c==3){
c=99;
}
c=((c<41)&&(!evt.shiftKey)?0:c);
if((evt.ctrlKey)&&(!evt.shiftKey)&&(c>=65)&&(c<=90)){
c+=32;
}
return del._synthesizeEvent(evt,{charCode:c});
}
return evt;
}});
}
if(dojo.isSafari){
del._add=del.add;
del._remove=del.remove;
dojo.mixin(del,{add:function(node,_210,fp){
if(!node){
return;
}
var _212=del._add(node,_210,fp);
if(del._normalizeEventName(_210)=="keypress"){
_212._stealthKeyDownHandle=del._add(node,"keydown",function(evt){
var k=evt.keyCode;
var _215=(k!=13)&&(k!=32)&&(k!=27)&&(k<48||k>90)&&(k<96||k>111)&&(k<186||k>192)&&(k<219||k>222);
if(_215||evt.ctrlKey){
var c=_215?0:k;
if(evt.ctrlKey){
if(k==3||k==13){
return;
}else{
if(c>95&&c<106){
c-=48;
}else{
if((!evt.shiftKey)&&(c>=65&&c<=90)){
c+=32;
}else{
c=del._punctMap[c]||c;
}
}
}
}
var faux=del._synthesizeEvent(evt,{type:"keypress",faux:true,charCode:c});
fp.call(evt.currentTarget,faux);
}
});
}
return _212;
},remove:function(node,_219,_21a){
if(node){
if(_21a._stealthKeyDownHandle){
del._remove(node,"keydown",_21a._stealthKeyDownHandle);
}
del._remove(node,_219,_21a);
}
},_fixEvent:function(evt,_21c){
switch(evt.type){
case "keypress":
if(evt.faux){
return evt;
}
var c=evt.charCode;
c=c>=32?c:0;
return del._synthesizeEvent(evt,{charCode:c,faux:true});
}
return evt;
}});
}
})();
if(dojo.isIE){
dojo._ieDispatcher=function(args,_21f){
var ap=Array.prototype,h=dojo._ie_listener.handlers,c=args.callee,ls=c[dojo._ieListenersName],t=h[c.target];
var r=t&&t.apply(_21f,args);
var lls=[].concat(ls);
for(var i in lls){
if(!(i in ap)){
h[lls[i]].apply(_21f,args);
}
}
return r;
};
dojo._getIeDispatcher=function(){
return new Function(dojo._scopeName+"._ieDispatcher(arguments, this)");
};
dojo._event_listener._fixCallback=function(fp){
var f=dojo._event_listener._fixEvent;
return function(e){
return fp.call(this,f(e,this));
};
};
}
}
if(!dojo._hasResource["dojo._base.html"]){
dojo._hasResource["dojo._base.html"]=true;
dojo.provide("dojo._base.html");
try{
document.execCommand("BackgroundImageCache",false,true);
}
catch(e){
}
if(dojo.isIE||dojo.isOpera){
dojo.byId=function(id,doc){
if(dojo.isString(id)){
var _d=doc||dojo.doc;
var te=_d.getElementById(id);
if(te&&te.attributes.id.value==id){
return te;
}else{
var eles=_d.all[id];
if(!eles||!eles.length){
return eles;
}
var i=0;
while((te=eles[i++])){
if(te.attributes.id.value==id){
return te;
}
}
}
}else{
return id;
}
};
}else{
dojo.byId=function(id,doc){
return dojo.isString(id)?(doc||dojo.doc).getElementById(id):id;
};
}
(function(){
var d=dojo;
var _234=null;
dojo.addOnWindowUnload(function(){
_234=null;
});
dojo._destroyElement=function(node){
node=d.byId(node);
try{
if(!_234||_234.ownerDocument!=node.ownerDocument){
_234=node.ownerDocument.createElement("div");
}
_234.appendChild(node.parentNode?node.parentNode.removeChild(node):node);
_234.innerHTML="";
}
catch(e){
}
};
dojo.isDescendant=function(node,_237){
try{
node=d.byId(node);
_237=d.byId(_237);
while(node){
if(node===_237){
return true;
}
node=node.parentNode;
}
}
catch(e){
}
return false;
};
dojo.setSelectable=function(node,_239){
node=d.byId(node);
if(d.isMozilla){
node.style.MozUserSelect=_239?"":"none";
}else{
if(d.isKhtml){
node.style.KhtmlUserSelect=_239?"auto":"none";
}else{
if(d.isIE){
var v=(node.unselectable=_239?"":"on");
d.query("*",node).forEach("item.unselectable = '"+v+"'");
}
}
}
};
var _23b=function(node,ref){
ref.parentNode.insertBefore(node,ref);
return true;
};
var _23e=function(node,ref){
var pn=ref.parentNode;
if(ref==pn.lastChild){
pn.appendChild(node);
}else{
return _23b(node,ref.nextSibling);
}
return true;
};
dojo.place=function(node,_243,_244){
if(!node||!_243){
return false;
}
node=d.byId(node);
_243=d.byId(_243);
if(typeof _244=="number"){
var cn=_243.childNodes;
if(!cn.length||cn.length<=_244){
_243.appendChild(node);
return true;
}
return _23b(node,_244<=0?_243.firstChild:cn[_244]);
}
switch(_244){
case "before":
return _23b(node,_243);
case "after":
return _23e(node,_243);
case "first":
if(_243.firstChild){
return _23b(node,_243.firstChild);
}
default:
_243.appendChild(node);
return true;
}
};
dojo.boxModel="content-box";
if(d.isIE){
var _dcm=document.compatMode;
d.boxModel=_dcm=="BackCompat"||_dcm=="QuirksMode"||d.isIE<6?"border-box":"content-box";
}
var gcs;
if(d.isSafari){
gcs=function(node){
var s;
if(node instanceof HTMLElement){
var dv=node.ownerDocument.defaultView;
s=dv.getComputedStyle(node,null);
if(!s&&node.style){
node.style.display="";
s=dv.getComputedStyle(node,null);
}
}
return s||{};
};
}else{
if(d.isIE){
gcs=function(node){
return node.nodeType==1?node.currentStyle:{};
};
}else{
gcs=function(node){
return node instanceof HTMLElement?node.ownerDocument.defaultView.getComputedStyle(node,null):{};
};
}
}
dojo.getComputedStyle=gcs;
if(!d.isIE){
dojo._toPixelValue=function(_24d,_24e){
return parseFloat(_24e)||0;
};
}else{
dojo._toPixelValue=function(_24f,_250){
if(!_250){
return 0;
}
if(_250=="medium"){
return 4;
}
if(_250.slice&&(_250.slice(-2)=="px")){
return parseFloat(_250);
}
with(_24f){
var _251=style.left;
var _252=runtimeStyle.left;
runtimeStyle.left=currentStyle.left;
try{
style.left=_250;
_250=style.pixelLeft;
}
catch(e){
_250=0;
}
style.left=_251;
runtimeStyle.left=_252;
}
return _250;
};
}
var px=d._toPixelValue;
var astr="DXImageTransform.Microsoft.Alpha";
var af=function(n,f){
try{
return n.filters.item(astr);
}
catch(e){
return f?{}:null;
}
};
dojo._getOpacity=d.isIE?function(node){
try{
return af(node).Opacity/100;
}
catch(e){
return 1;
}
}:function(node){
return gcs(node).opacity;
};
dojo._setOpacity=d.isIE?function(node,_25b){
var ov=_25b*100;
node.style.zoom=1;
af(node,1).Enabled=(_25b==1?false:true);
if(!af(node)){
node.style.filter+=" progid:"+astr+"(Opacity="+ov+")";
}else{
af(node,1).Opacity=ov;
}
if(node.nodeName.toLowerCase()=="tr"){
d.query("> td",node).forEach(function(i){
d._setOpacity(i,_25b);
});
}
return _25b;
}:function(node,_25f){
return node.style.opacity=_25f;
};
var _260={left:true,top:true};
var _261=/margin|padding|width|height|max|min|offset/;
var _262=function(node,type,_265){
type=type.toLowerCase();
if(d.isIE){
if(_265=="auto"){
if(type=="height"){
return node.offsetHeight;
}
if(type=="width"){
return node.offsetWidth;
}
}
if(type=="fontweight"){
switch(_265){
case 700:
return "bold";
case 400:
default:
return "normal";
}
}
}
if(!(type in _260)){
_260[type]=_261.test(type);
}
return _260[type]?px(node,_265):_265;
};
var _266=d.isIE?"styleFloat":"cssFloat";
var _267={"cssFloat":_266,"styleFloat":_266,"float":_266};
dojo.style=function(node,_269,_26a){
var n=d.byId(node),args=arguments.length,op=(_269=="opacity");
_269=_267[_269]||_269;
if(args==3){
return op?d._setOpacity(n,_26a):n.style[_269]=_26a;
}
if(args==2&&op){
return d._getOpacity(n);
}
var s=gcs(n);
if(args==2&&!d.isString(_269)){
for(var x in _269){
d.style(node,x,_269[x]);
}
return s;
}
return (args==1)?s:_262(n,_269,s[_269]||n.style[_269]);
};
dojo._getPadExtents=function(n,_271){
var s=_271||gcs(n),l=px(n,s.paddingLeft),t=px(n,s.paddingTop);
return {l:l,t:t,w:l+px(n,s.paddingRight),h:t+px(n,s.paddingBottom)};
};
dojo._getBorderExtents=function(n,_276){
var ne="none",s=_276||gcs(n),bl=(s.borderLeftStyle!=ne?px(n,s.borderLeftWidth):0),bt=(s.borderTopStyle!=ne?px(n,s.borderTopWidth):0);
return {l:bl,t:bt,w:bl+(s.borderRightStyle!=ne?px(n,s.borderRightWidth):0),h:bt+(s.borderBottomStyle!=ne?px(n,s.borderBottomWidth):0)};
};
dojo._getPadBorderExtents=function(n,_27c){
var s=_27c||gcs(n),p=d._getPadExtents(n,s),b=d._getBorderExtents(n,s);
return {l:p.l+b.l,t:p.t+b.t,w:p.w+b.w,h:p.h+b.h};
};
dojo._getMarginExtents=function(n,_281){
var s=_281||gcs(n),l=px(n,s.marginLeft),t=px(n,s.marginTop),r=px(n,s.marginRight),b=px(n,s.marginBottom);
if(d.isSafari&&(s.position!="absolute")){
r=l;
}
return {l:l,t:t,w:l+r,h:t+b};
};
dojo._getMarginBox=function(node,_288){
var s=_288||gcs(node),me=d._getMarginExtents(node,s);
var l=node.offsetLeft-me.l,t=node.offsetTop-me.t,p=node.parentNode;
if(d.isMoz){
var sl=parseFloat(s.left),st=parseFloat(s.top);
if(!isNaN(sl)&&!isNaN(st)){
l=sl,t=st;
}else{
if(p&&p.style){
var pcs=gcs(p);
if(pcs.overflow!="visible"){
var be=d._getBorderExtents(p,pcs);
l+=be.l,t+=be.t;
}
}
}
}else{
if(d.isOpera){
if(p){
var be=d._getBorderExtents(p);
l-=be.l;
t-=be.t;
}
}
}
return {l:l,t:t,w:node.offsetWidth+me.w,h:node.offsetHeight+me.h};
};
dojo._getContentBox=function(node,_293){
var s=_293||gcs(node),pe=d._getPadExtents(node,s),be=d._getBorderExtents(node,s),w=node.clientWidth,h;
if(!w){
w=node.offsetWidth,h=node.offsetHeight;
}else{
h=node.clientHeight,be.w=be.h=0;
}
if(d.isOpera){
pe.l+=be.l;
pe.t+=be.t;
}
return {l:pe.l,t:pe.t,w:w-pe.w-be.w,h:h-pe.h-be.h};
};
dojo._getBorderBox=function(node,_29a){
var s=_29a||gcs(node),pe=d._getPadExtents(node,s),cb=d._getContentBox(node,s);
return {l:cb.l-pe.l,t:cb.t-pe.t,w:cb.w+pe.w,h:cb.h+pe.h};
};
dojo._setBox=function(node,l,t,w,h,u){
u=u||"px";
var s=node.style;
if(!isNaN(l)){
s.left=l+u;
}
if(!isNaN(t)){
s.top=t+u;
}
if(w>=0){
s.width=w+u;
}
if(h>=0){
s.height=h+u;
}
};
dojo._isButtonTag=function(node){
return node.tagName=="BUTTON"||node.tagName=="INPUT"&&node.getAttribute("type").toUpperCase()=="BUTTON";
};
dojo._usesBorderBox=function(node){
var n=node.tagName;
return d.boxModel=="border-box"||n=="TABLE"||dojo._isButtonTag(node);
};
dojo._setContentSize=function(node,_2a9,_2aa,_2ab){
if(d._usesBorderBox(node)){
var pb=d._getPadBorderExtents(node,_2ab);
if(_2a9>=0){
_2a9+=pb.w;
}
if(_2aa>=0){
_2aa+=pb.h;
}
}
d._setBox(node,NaN,NaN,_2a9,_2aa);
};
dojo._setMarginBox=function(node,_2ae,_2af,_2b0,_2b1,_2b2){
var s=_2b2||gcs(node);
var bb=d._usesBorderBox(node),pb=bb?_2b6:d._getPadBorderExtents(node,s);
if(dojo.isSafari){
if(dojo._isButtonTag(node)){
var ns=node.style;
if(_2b0>=0&&!ns.width){
ns.width="4px";
}
if(_2b1>=0&&!ns.height){
ns.height="4px";
}
}
}
var mb=d._getMarginExtents(node,s);
if(_2b0>=0){
_2b0=Math.max(_2b0-pb.w-mb.w,0);
}
if(_2b1>=0){
_2b1=Math.max(_2b1-pb.h-mb.h,0);
}
d._setBox(node,_2ae,_2af,_2b0,_2b1);
};
var _2b6={l:0,t:0,w:0,h:0};
dojo.marginBox=function(node,box){
var n=d.byId(node),s=gcs(n),b=box;
return !b?d._getMarginBox(n,s):d._setMarginBox(n,b.l,b.t,b.w,b.h,s);
};
dojo.contentBox=function(node,box){
var n=d.byId(node),s=gcs(n),b=box;
return !b?d._getContentBox(n,s):d._setContentSize(n,b.w,b.h,s);
};
var _2c3=function(node,prop){
if(!(node=(node||0).parentNode)){
return 0;
}
var val,_2c7=0,_b=d.body();
while(node&&node.style){
if(gcs(node).position=="fixed"){
return 0;
}
val=node[prop];
if(val){
_2c7+=val-0;
if(node==_b){
break;
}
}
node=node.parentNode;
}
return _2c7;
};
dojo._docScroll=function(){
var _b=d.body(),_w=d.global,de=d.doc.documentElement;
return {y:(_w.pageYOffset||de.scrollTop||_b.scrollTop||0),x:(_w.pageXOffset||d._fixIeBiDiScrollLeft(de.scrollLeft)||_b.scrollLeft||0)};
};
dojo._isBodyLtr=function(){
return !("_bodyLtr" in d)?d._bodyLtr=gcs(d.body()).direction=="ltr":d._bodyLtr;
};
dojo._getIeDocumentElementOffset=function(){
var de=d.doc.documentElement;
return (d.isIE>=7)?{x:de.getBoundingClientRect().left,y:de.getBoundingClientRect().top}:{x:d._isBodyLtr()||window.parent==window?de.clientLeft:de.offsetWidth-de.clientWidth-de.clientLeft,y:de.clientTop};
};
dojo._fixIeBiDiScrollLeft=function(_2cd){
var dd=d.doc;
if(d.isIE&&!dojo._isBodyLtr()){
var de=dd.compatMode=="BackCompat"?dd.body:dd.documentElement;
return _2cd+de.clientWidth-de.scrollWidth;
}
return _2cd;
};
dojo._abs=function(node,_2d1){
var _2d2=node.ownerDocument;
var ret={x:0,y:0};
var db=d.body();
if(d.isIE||(d.isFF>=3)){
var _2d5=node.getBoundingClientRect();
var cs;
if(d.isFF){
var dv=node.ownerDocument.defaultView;
cs=dv.getComputedStyle(db.parentNode,null);
}
var _2d8=(d.isIE)?d._getIeDocumentElementOffset():{x:px(db.parentNode,cs.marginLeft),y:px(db.parentNode,cs.marginTop)};
ret.x=_2d5.left-_2d8.x;
ret.y=_2d5.top-_2d8.y;
}else{
if(node["offsetParent"]){
var _2d9;
if(d.isSafari&&(gcs(node).position=="absolute")&&(node.parentNode==db)){
_2d9=db;
}else{
_2d9=db.parentNode;
}
var cs=gcs(node);
var n=node;
if(d.isOpera&&cs.position!="absolute"){
n=n.offsetParent;
}
ret.x-=_2c3(n,"scrollLeft");
ret.y-=_2c3(n,"scrollTop");
var _2db=node;
do{
var n=_2db.offsetLeft;
if(!d.isOpera||n>0){
ret.x+=isNaN(n)?0:n;
}
var t=_2db.offsetTop;
ret.y+=isNaN(t)?0:t;
var cs=gcs(_2db);
if(_2db!=node){
if(d.isSafari){
ret.x+=px(_2db,cs.borderLeftWidth);
ret.y+=px(_2db,cs.borderTopWidth);
}else{
if(d.isFF){
ret.x+=2*px(_2db,cs.borderLeftWidth);
ret.y+=2*px(_2db,cs.borderTopWidth);
}
}
}
if(d.isFF&&cs.position=="static"){
var _2dd=_2db.parentNode;
while(_2dd!=_2db.offsetParent){
var pcs=gcs(_2dd);
if(pcs.position=="static"){
ret.x+=px(_2db,pcs.borderLeftWidth);
ret.y+=px(_2db,pcs.borderTopWidth);
}
_2dd=_2dd.parentNode;
}
}
_2db=_2db.offsetParent;
}while((_2db!=_2d9)&&_2db);
}else{
if(node.x&&node.y){
ret.x+=isNaN(node.x)?0:node.x;
ret.y+=isNaN(node.y)?0:node.y;
}
}
}
if(_2d1){
var _2df=d._docScroll();
ret.y+=_2df.y;
ret.x+=_2df.x;
}
return ret;
};
dojo.coords=function(node,_2e1){
var n=d.byId(node),s=gcs(n),mb=d._getMarginBox(n,s);
var abs=d._abs(n,_2e1);
mb.x=abs.x;
mb.y=abs.y;
return mb;
};
var _2e6=d.isIE<8;
var _2e7=function(name){
switch(name.toLowerCase()){
case "tabindex":
return _2e6?"tabIndex":"tabindex";
case "for":
case "htmlfor":
return _2e6?"htmlFor":"for";
case "class":
return d.isIE?"className":"class";
default:
return name;
}
};
var _2e9={colspan:"colSpan",enctype:"enctype",frameborder:"frameborder",method:"method",rowspan:"rowSpan",scrolling:"scrolling",shape:"shape",span:"span",type:"type",valuetype:"valueType"};
dojo.hasAttr=function(node,name){
node=d.byId(node);
var _2ec=_2e7(name);
_2ec=_2ec=="htmlFor"?"for":_2ec;
var attr=node.getAttributeNode&&node.getAttributeNode(_2ec);
return attr?attr.specified:false;
};
var _2ee={};
var _ctr=0;
var _2f0=dojo._scopeName+"attrid";
dojo.attr=function(node,name,_2f3){
var args=arguments.length;
if(args==2&&!d.isString(name)){
for(var x in name){
d.attr(node,x,name[x]);
}
return;
}
node=d.byId(node);
name=_2e7(name);
if(args==3){
if(d.isFunction(_2f3)){
var _2f6=d.attr(node,_2f0);
if(!_2f6){
_2f6=_ctr++;
d.attr(node,_2f0,_2f6);
}
if(!_2ee[_2f6]){
_2ee[_2f6]={};
}
var h=_2ee[_2f6][name];
if(h){
d.disconnect(h);
}else{
try{
delete node[name];
}
catch(e){
}
}
_2ee[_2f6][name]=d.connect(node,name,_2f3);
}else{
if((typeof _2f3=="boolean")||(name=="innerHTML")){
node[name]=_2f3;
}else{
if((name=="style")&&(!d.isString(_2f3))){
d.style(node,_2f3);
}else{
node.setAttribute(name,_2f3);
}
}
}
return;
}else{
var prop=_2e9[name.toLowerCase()];
if(prop){
return node[prop];
}else{
var _2f9=node[name];
return (typeof _2f9=="boolean"||typeof _2f9=="function")?_2f9:(d.hasAttr(node,name)?node.getAttribute(name):null);
}
}
};
dojo.removeAttr=function(node,name){
d.byId(node).removeAttribute(_2e7(name));
};
var _2fc="className";
dojo.hasClass=function(node,_2fe){
return ((" "+d.byId(node)[_2fc]+" ").indexOf(" "+_2fe+" ")>=0);
};
dojo.addClass=function(node,_300){
node=d.byId(node);
var cls=node[_2fc];
if((" "+cls+" ").indexOf(" "+_300+" ")<0){
node[_2fc]=cls+(cls?" ":"")+_300;
}
};
dojo.removeClass=function(node,_303){
node=d.byId(node);
var t=d.trim((" "+node[_2fc]+" ").replace(" "+_303+" "," "));
if(node[_2fc]!=t){
node[_2fc]=t;
}
};
dojo.toggleClass=function(node,_306,_307){
if(_307===undefined){
_307=!d.hasClass(node,_306);
}
d[_307?"addClass":"removeClass"](node,_306);
};
})();
}
if(!dojo._hasResource["dojo._base.NodeList"]){
dojo._hasResource["dojo._base.NodeList"]=true;
dojo.provide("dojo._base.NodeList");
(function(){
var d=dojo;
var tnl=function(arr){
arr.constructor=dojo.NodeList;
dojo._mixin(arr,dojo.NodeList.prototype);
return arr;
};
var _30b=function(func,_30d){
return function(){
var _a=arguments;
var aa=d._toArray(_a,0,[null]);
var s=this.map(function(i){
aa[0]=i;
return d[func].apply(d,aa);
});
return (_30d||((_a.length>1)||!d.isString(_a[0])))?this:s;
};
};
dojo.NodeList=function(){
return tnl(Array.apply(null,arguments));
};
dojo.NodeList._wrap=tnl;
dojo.extend(dojo.NodeList,{slice:function(){
var a=d._toArray(arguments);
return tnl(a.slice.apply(this,a));
},splice:function(){
var a=d._toArray(arguments);
return tnl(a.splice.apply(this,a));
},concat:function(){
var a=d._toArray(arguments,0,[this]);
return tnl(a.concat.apply([],a));
},indexOf:function(_315,_316){
return d.indexOf(this,_315,_316);
},lastIndexOf:function(){
return d.lastIndexOf.apply(d,d._toArray(arguments,0,[this]));
},every:function(_317,_318){
return d.every(this,_317,_318);
},some:function(_319,_31a){
return d.some(this,_319,_31a);
},map:function(func,obj){
return d.map(this,func,obj,d.NodeList);
},forEach:function(_31d,_31e){
d.forEach(this,_31d,_31e);
return this;
},coords:function(){
return d.map(this,d.coords);
},attr:_30b("attr"),style:_30b("style"),addClass:_30b("addClass",true),removeClass:_30b("removeClass",true),toggleClass:_30b("toggleClass",true),connect:_30b("connect",true),place:function(_31f,_320){
var item=d.query(_31f)[0];
return this.forEach(function(i){
d.place(i,item,_320);
});
},orphan:function(_323){
return (_323?d._filterQueryResult(this,_323):this).forEach("if(item.parentNode){ item.parentNode.removeChild(item); }");
},adopt:function(_324,_325){
var item=this[0];
return d.query(_324).forEach(function(ai){
d.place(ai,item,_325||"last");
});
},query:function(_328){
if(!_328){
return this;
}
var ret=d.NodeList();
this.forEach(function(item){
ret=ret.concat(d.query(_328,item).filter(function(_32b){
return (_32b!==undefined);
}));
});
return ret;
},filter:function(_32c){
var _32d=this;
var _a=arguments;
var r=d.NodeList();
var rp=function(t){
if(t!==undefined){
r.push(t);
}
};
if(d.isString(_32c)){
_32d=d._filterQueryResult(this,_a[0]);
if(_a.length==1){
return _32d;
}
_a.shift();
}
d.forEach(d.filter(_32d,_a[0],_a[1]),rp);
return r;
},addContent:function(_332,_333){
var ta=d.doc.createElement("span");
if(d.isString(_332)){
ta.innerHTML=_332;
}else{
ta.appendChild(_332);
}
if(_333===undefined){
_333="last";
}
var ct=(_333=="first"||_333=="after")?"lastChild":"firstChild";
this.forEach(function(item){
var tn=ta.cloneNode(true);
while(tn[ct]){
d.place(tn[ct],item,_333);
}
});
return this;
},empty:function(){
return this.forEach("item.innerHTML='';");
},instantiate:function(_338,_339){
var c=d.isFunction(_338)?_338:d.getObject(_338);
return this.forEach(function(i){
new c(_339||{},i);
});
},at:function(){
var nl=new dojo.NodeList();
dojo.forEach(arguments,function(i){
if(this[i]){
nl.push(this[i]);
}
},this);
return nl;
}});
d.forEach(["blur","focus","click","keydown","keypress","keyup","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","submit","load","error"],function(evt){
var _oe="on"+evt;
d.NodeList.prototype[_oe]=function(a,b){
return this.connect(_oe,a,b);
};
});
})();
}
if(!dojo._hasResource["dojo._base.query"]){
dojo._hasResource["dojo._base.query"]=true;
dojo.provide("dojo._base.query");
(function(){
var d=dojo;
var _343=dojo.isIE?"children":"childNodes";
var _344=false;
var _345=function(_346){
if(">~+".indexOf(_346.charAt(_346.length-1))>=0){
_346+=" *";
}
_346+=" ";
var ts=function(s,e){
return d.trim(_346.slice(s,e));
};
var _34a=[];
var _34b=-1;
var _34c=-1;
var _34d=-1;
var _34e=-1;
var _34f=-1;
var inId=-1;
var _351=-1;
var lc="";
var cc="";
var _354;
var x=0;
var ql=_346.length;
var _357=null;
var _cp=null;
var _359=function(){
if(_351>=0){
var tv=(_351==x)?null:ts(_351,x);
_357[(">~+".indexOf(tv)<0)?"tag":"oper"]=tv;
_351=-1;
}
};
var _35b=function(){
if(inId>=0){
_357.id=ts(inId,x).replace(/\\/g,"");
inId=-1;
}
};
var _35c=function(){
if(_34f>=0){
_357.classes.push(ts(_34f+1,x).replace(/\\/g,""));
_34f=-1;
}
};
var _35d=function(){
_35b();
_359();
_35c();
};
for(;lc=cc,cc=_346.charAt(x),x<ql;x++){
if(lc=="\\"){
continue;
}
if(!_357){
_354=x;
_357={query:null,pseudos:[],attrs:[],classes:[],tag:null,oper:null,id:null};
_351=x;
}
if(_34b>=0){
if(cc=="]"){
if(!_cp.attr){
_cp.attr=ts(_34b+1,x);
}else{
_cp.matchFor=ts((_34d||_34b+1),x);
}
var cmf=_cp.matchFor;
if(cmf){
if((cmf.charAt(0)=="\"")||(cmf.charAt(0)=="'")){
_cp.matchFor=cmf.substring(1,cmf.length-1);
}
}
_357.attrs.push(_cp);
_cp=null;
_34b=_34d=-1;
}else{
if(cc=="="){
var _35f=("|~^$*".indexOf(lc)>=0)?lc:"";
_cp.type=_35f+cc;
_cp.attr=ts(_34b+1,x-_35f.length);
_34d=x+1;
}
}
}else{
if(_34c>=0){
if(cc==")"){
if(_34e>=0){
_cp.value=ts(_34c+1,x);
}
_34e=_34c=-1;
}
}else{
if(cc=="#"){
_35d();
inId=x+1;
}else{
if(cc=="."){
_35d();
_34f=x;
}else{
if(cc==":"){
_35d();
_34e=x;
}else{
if(cc=="["){
_35d();
_34b=x;
_cp={};
}else{
if(cc=="("){
if(_34e>=0){
_cp={name:ts(_34e+1,x),value:null};
_357.pseudos.push(_cp);
}
_34c=x;
}else{
if(cc==" "&&lc!=cc){
_35d();
if(_34e>=0){
_357.pseudos.push({name:ts(_34e+1,x)});
}
_357.hasLoops=(_357.pseudos.length||_357.attrs.length||_357.classes.length);
_357.query=ts(_354,x);
_357.otag=_357.tag=(_357["oper"])?null:(_357.tag||"*");
if(_357.tag){
_357.tag=_357.tag.toUpperCase();
}
_34a.push(_357);
_357=null;
}
}
}
}
}
}
}
}
}
return _34a;
};
var _360={"*=":function(attr,_362){
return "[contains(@"+attr+", '"+_362+"')]";
},"^=":function(attr,_364){
return "[starts-with(@"+attr+", '"+_364+"')]";
},"$=":function(attr,_366){
return "[substring(@"+attr+", string-length(@"+attr+")-"+(_366.length-1)+")='"+_366+"']";
},"~=":function(attr,_368){
return "[contains(concat(' ',@"+attr+",' '), ' "+_368+" ')]";
},"|=":function(attr,_36a){
return "[contains(concat(' ',@"+attr+",' '), ' "+_36a+"-')]";
},"=":function(attr,_36c){
return "[@"+attr+"='"+_36c+"']";
}};
var _36d=function(_36e,_36f,_370,_371){
d.forEach(_36f.attrs,function(attr){
var _373;
if(attr.type&&_36e[attr.type]){
_373=_36e[attr.type](attr.attr,attr.matchFor);
}else{
if(attr.attr.length){
_373=_370(attr.attr);
}
}
if(_373){
_371(_373);
}
});
};
var _374=function(_375){
var _376=".";
var _377=_345(d.trim(_375));
while(_377.length){
var tqp=_377.shift();
var _379;
var _37a="";
if(tqp.oper==">"){
_379="/";
tqp=_377.shift();
}else{
if(tqp.oper=="~"){
_379="/following-sibling::";
tqp=_377.shift();
}else{
if(tqp.oper=="+"){
_379="/following-sibling::";
_37a="[position()=1]";
tqp=_377.shift();
}else{
_379="//";
}
}
}
_376+=_379+tqp.tag+_37a;
if(tqp.id){
_376+="[@id='"+tqp.id+"'][1]";
}
d.forEach(tqp.classes,function(cn){
var cnl=cn.length;
var _37d=" ";
if(cn.charAt(cnl-1)=="*"){
_37d="";
cn=cn.substr(0,cnl-1);
}
_376+="[contains(concat(' ',@class,' '), ' "+cn+_37d+"')]";
});
_36d(_360,tqp,function(_37e){
return "[@"+_37e+"]";
},function(_37f){
_376+=_37f;
});
}
return _376;
};
var _380={};
var _381=function(path){
if(_380[path]){
return _380[path];
}
var doc=d.doc;
var _384=_374(path);
var tf=function(_386){
var ret=[];
var _388;
var tdoc=doc;
if(_386){
tdoc=(_386.nodeType==9)?_386:_386.ownerDocument;
}
try{
_388=tdoc.evaluate(_384,_386,null,XPathResult.ANY_TYPE,null);
}
catch(e){
console.debug("failure in exprssion:",_384,"under:",_386);
console.debug(e);
}
var _38a=_388.iterateNext();
while(_38a){
ret.push(_38a);
_38a=_388.iterateNext();
}
return ret;
};
return _380[path]=tf;
};
var _38b={};
var _38c={};
var _38d=function(_38e,_38f){
if(!_38e){
return _38f;
}
if(!_38f){
return _38e;
}
return function(){
return _38e.apply(window,arguments)&&_38f.apply(window,arguments);
};
};
var _390=function(root){
var ret=[];
var te,x=0,tret=root[_343];
while((te=tret[x++])){
if(te.nodeType==1){
ret.push(te);
}
}
return ret;
};
var _396=function(root,_398){
var ret=[];
var te=root;
while(te=te.nextSibling){
if(te.nodeType==1){
ret.push(te);
if(_398){
break;
}
}
}
return ret;
};
var _39b=function(_39c,_39d,_39e,idx){
var nidx=idx+1;
var _3a1=(_39d.length==nidx);
var tqp=_39d[idx];
if(tqp.oper){
var ecn=(tqp.oper==">")?_390(_39c):_396(_39c,(tqp.oper=="+"));
if(!ecn||!ecn.length){
return;
}
nidx++;
_3a1=(_39d.length==nidx);
var tf=_3a5(_39d[idx+1]);
for(var x=0,ecnl=ecn.length,te;x<ecnl,te=ecn[x];x++){
if(tf(te)){
if(_3a1){
_39e.push(te);
}else{
_39b(te,_39d,_39e,nidx);
}
}
}
}
var _3a9=_3aa(tqp)(_39c);
if(_3a1){
while(_3a9.length){
_39e.push(_3a9.shift());
}
}else{
while(_3a9.length){
_39b(_3a9.shift(),_39d,_39e,nidx);
}
}
};
var _3ab=function(_3ac,_3ad){
var ret=[];
var x=_3ac.length-1,te;
while((te=_3ac[x--])){
_39b(te,_3ad,ret,0);
}
return ret;
};
var _3a5=function(q){
if(_38b[q.query]){
return _38b[q.query];
}
var ff=null;
if(q.tag){
if(q.tag=="*"){
ff=_38d(ff,function(elem){
return (elem.nodeType==1);
});
}else{
ff=_38d(ff,function(elem){
return ((elem.nodeType==1)&&(q[_344?"otag":"tag"]==elem.tagName));
});
}
}
if(q.id){
ff=_38d(ff,function(elem){
return ((elem.nodeType==1)&&(elem.id==q.id));
});
}
if(q.hasLoops){
ff=_38d(ff,_3b6(q));
}
return _38b[q.query]=ff;
};
var _3b7=function(node){
var pn=node.parentNode;
var pnc=pn.childNodes;
var nidx=-1;
var _3bc=pn.firstChild;
if(!_3bc){
return nidx;
}
var ci=node["__cachedIndex"];
var cl=pn["__cachedLength"];
if(((typeof cl=="number")&&(cl!=pnc.length))||(typeof ci!="number")){
pn["__cachedLength"]=pnc.length;
var idx=1;
do{
if(_3bc===node){
nidx=idx;
}
if(_3bc.nodeType==1){
_3bc["__cachedIndex"]=idx;
idx++;
}
_3bc=_3bc.nextSibling;
}while(_3bc);
}else{
nidx=ci;
}
return nidx;
};
var _3c0=0;
var _3c1="";
var _3c2=function(elem,attr){
if(attr=="class"){
return elem.className||_3c1;
}
if(attr=="for"){
return elem.htmlFor||_3c1;
}
if(attr=="style"){
return elem.style.cssText||_3c1;
}
return (_344?elem.getAttribute(attr):elem.getAttribute(attr,2))||_3c1;
};
var _3c5={"*=":function(attr,_3c7){
return function(elem){
return (_3c2(elem,attr).indexOf(_3c7)>=0);
};
},"^=":function(attr,_3ca){
return function(elem){
return (_3c2(elem,attr).indexOf(_3ca)==0);
};
},"$=":function(attr,_3cd){
var tval=" "+_3cd;
return function(elem){
var ea=" "+_3c2(elem,attr);
return (ea.lastIndexOf(_3cd)==(ea.length-_3cd.length));
};
},"~=":function(attr,_3d2){
var tval=" "+_3d2+" ";
return function(elem){
var ea=" "+_3c2(elem,attr)+" ";
return (ea.indexOf(tval)>=0);
};
},"|=":function(attr,_3d7){
var _3d8=" "+_3d7+"-";
return function(elem){
var ea=" "+(elem.getAttribute(attr,2)||"");
return ((ea==_3d7)||(ea.indexOf(_3d8)==0));
};
},"=":function(attr,_3dc){
return function(elem){
return (_3c2(elem,attr)==_3dc);
};
}};
var _3de={"checked":function(name,_3e0){
return function(elem){
return !!d.attr(elem,"checked");
};
},"first-child":function(name,_3e3){
return function(elem){
if(elem.nodeType!=1){
return false;
}
var fc=elem.previousSibling;
while(fc&&(fc.nodeType!=1)){
fc=fc.previousSibling;
}
return (!fc);
};
},"last-child":function(name,_3e7){
return function(elem){
if(elem.nodeType!=1){
return false;
}
var nc=elem.nextSibling;
while(nc&&(nc.nodeType!=1)){
nc=nc.nextSibling;
}
return (!nc);
};
},"empty":function(name,_3eb){
return function(elem){
var cn=elem.childNodes;
var cnl=elem.childNodes.length;
for(var x=cnl-1;x>=0;x--){
var nt=cn[x].nodeType;
if((nt==1)||(nt==3)){
return false;
}
}
return true;
};
},"contains":function(name,_3f2){
return function(elem){
if(_3f2.charAt(0)=="\""||_3f2.charAt(0)=="'"){
_3f2=_3f2.substr(1,_3f2.length-2);
}
return (elem.innerHTML.indexOf(_3f2)>=0);
};
},"not":function(name,_3f5){
var ntf=_3a5(_345(_3f5)[0]);
return function(elem){
return (!ntf(elem));
};
},"nth-child":function(name,_3f9){
var pi=parseInt;
if(_3f9=="odd"){
_3f9="2n+1";
}else{
if(_3f9=="even"){
_3f9="2n";
}
}
if(_3f9.indexOf("n")!=-1){
var _3fb=_3f9.split("n",2);
var pred=_3fb[0]?(_3fb[0]=="-"?-1:pi(_3fb[0])):1;
var idx=_3fb[1]?pi(_3fb[1]):0;
var lb=0,ub=-1;
if(pred>0){
if(idx<0){
idx=(idx%pred)&&(pred+(idx%pred));
}else{
if(idx>0){
if(idx>=pred){
lb=idx-idx%pred;
}
idx=idx%pred;
}
}
}else{
if(pred<0){
pred*=-1;
if(idx>0){
ub=idx;
idx=idx%pred;
}
}
}
if(pred>0){
return function(elem){
var i=_3b7(elem);
return (i>=lb)&&(ub<0||i<=ub)&&((i%pred)==idx);
};
}else{
_3f9=idx;
}
}
var _402=pi(_3f9);
return function(elem){
return (_3b7(elem)==_402);
};
}};
var _404=(d.isIE)?function(cond){
var clc=cond.toLowerCase();
return function(elem){
return (_344?elem.getAttribute(cond):elem[cond]||elem[clc]);
};
}:function(cond){
return function(elem){
return (elem&&elem.getAttribute&&elem.hasAttribute(cond));
};
};
var _3b6=function(_40a){
var _40b=(_38c[_40a.query]||_38b[_40a.query]);
if(_40b){
return _40b;
}
var ff=null;
if(_40a.id){
if(_40a.tag!="*"){
ff=_38d(ff,function(elem){
return (elem.tagName==_40a[_344?"otag":"tag"]);
});
}
}
d.forEach(_40a.classes,function(_40e,idx,arr){
var _411=_40e.charAt(_40e.length-1)=="*";
if(_411){
_40e=_40e.substr(0,_40e.length-1);
}
var re=new RegExp("(?:^|\\s)"+_40e+(_411?".*":"")+"(?:\\s|$)");
ff=_38d(ff,function(elem){
return re.test(elem.className);
});
ff.count=idx;
});
d.forEach(_40a.pseudos,function(_414){
if(_3de[_414.name]){
ff=_38d(ff,_3de[_414.name](_414.name,_414.value));
}
});
_36d(_3c5,_40a,_404,function(_415){
ff=_38d(ff,_415);
});
if(!ff){
ff=function(){
return true;
};
}
return _38c[_40a.query]=ff;
};
var _416={};
var _3aa=function(_417,root){
var fHit=_416[_417.query];
if(fHit){
return fHit;
}
if(_417.id&&!_417.hasLoops&&!_417.tag){
return _416[_417.query]=function(root){
return [d.byId(_417.id)];
};
}
var _41b=_3b6(_417);
var _41c;
if(_417.tag&&_417.id&&!_417.hasLoops){
_41c=function(root){
var te=d.byId(_417.id,(root.ownerDocument||root));
if(_41b(te)){
return [te];
}
};
}else{
var tret;
if(!_417.hasLoops){
_41c=function(root){
var ret=[];
var te,x=0,tret=root.getElementsByTagName(_417[_344?"otag":"tag"]);
while((te=tret[x++])){
ret.push(te);
}
return ret;
};
}else{
_41c=function(root){
var ret=[];
var te,x=0,tret=root.getElementsByTagName(_417[_344?"otag":"tag"]);
while((te=tret[x++])){
if(_41b(te)){
ret.push(te);
}
}
return ret;
};
}
}
return _416[_417.query]=_41c;
};
var _428={};
var _429={"*":d.isIE?function(root){
return root.all;
}:function(root){
return root.getElementsByTagName("*");
},"~":_396,"+":function(root){
return _396(root,true);
},">":_390};
var _42d=function(_42e){
var _42f=_345(d.trim(_42e));
if(_42f.length==1){
var tt=_3aa(_42f[0]);
tt.nozip=true;
return tt;
}
var sqf=function(root){
var _433=_42f.slice(0);
var _434;
if(_433[0].oper==">"){
_434=[root];
}else{
_434=_3aa(_433.shift())(root);
}
return _3ab(_434,_433);
};
return sqf;
};
var _435=((document["evaluate"]&&!d.isSafari)?function(_436,root){
var _438=_436.split(" ");
if((!_344)&&(document["evaluate"])&&(_436.indexOf(":")==-1)&&(_436.indexOf("+")==-1)){
if(((_438.length>2)&&(_436.indexOf(">")==-1))||(_438.length>3)||(_436.indexOf("[")>=0)||((1==_438.length)&&(0<=_436.indexOf(".")))){
return _381(_436);
}
}
return _42d(_436);
}:_42d);
var _439=function(_43a){
if(_429[_43a]){
return _429[_43a];
}
if(0>_43a.indexOf(",")){
return _429[_43a]=_435(_43a);
}else{
var _43b=_43a.split(/\s*,\s*/);
var tf=function(root){
var _43e=0;
var ret=[];
var tp;
while((tp=_43b[_43e++])){
ret=ret.concat(_435(tp,tp.indexOf(" "))(root));
}
return ret;
};
return _429[_43a]=tf;
}
};
var _441=0;
var _zip=function(arr){
if(arr&&arr.nozip){
return d.NodeList._wrap(arr);
}
var ret=new d.NodeList();
if(!arr){
return ret;
}
if(arr[0]){
ret.push(arr[0]);
}
if(arr.length<2){
return ret;
}
_441++;
if(d.isIE&&_344){
var _445=_441+"";
arr[0].setAttribute("_zipIdx",_445);
for(var x=1,te;te=arr[x];x++){
if(arr[x].getAttribute("_zipIdx")!=_445){
ret.push(te);
}
te.setAttribute("_zipIdx",_445);
}
}else{
arr[0]["_zipIdx"]=_441;
for(var x=1,te;te=arr[x];x++){
if(arr[x]["_zipIdx"]!=_441){
ret.push(te);
}
te["_zipIdx"]=_441;
}
}
return ret;
};
d.query=function(_448,root){
if(_448.constructor==d.NodeList){
return _448;
}
if(!d.isString(_448)){
return new d.NodeList(_448);
}
if(d.isString(root)){
root=d.byId(root);
}
root=root||d.doc;
var od=root.ownerDocument||root.documentElement;
_344=(root.contentType&&root.contentType=="application/xml")||(!!od)&&(d.isIE?od.xml:(root.xmlVersion||od.xmlVersion));
return _zip(_439(_448)(root));
};
d.query.pseudos=_3de;
d._filterQueryResult=function(_44b,_44c){
var tnl=new d.NodeList();
var ff=(_44c)?_3a5(_345(_44c)[0]):function(){
return true;
};
for(var x=0,te;te=_44b[x];x++){
if(ff(te)){
tnl.push(te);
}
}
return tnl;
};
})();
}
if(!dojo._hasResource["dojo._base.xhr"]){
dojo._hasResource["dojo._base.xhr"]=true;
dojo.provide("dojo._base.xhr");
(function(){
var _d=dojo;
function setValue(obj,name,_454){
var val=obj[name];
if(_d.isString(val)){
obj[name]=[val,_454];
}else{
if(_d.isArray(val)){
val.push(_454);
}else{
obj[name]=_454;
}
}
};
dojo.formToObject=function(_456){
var ret={};
var _458="file|submit|image|reset|button|";
_d.forEach(dojo.byId(_456).elements,function(item){
var _in=item.name;
var type=(item.type||"").toLowerCase();
if(_in&&type&&_458.indexOf(type)==-1&&!item.disabled){
if(type=="radio"||type=="checkbox"){
if(item.checked){
setValue(ret,_in,item.value);
}
}else{
if(item.multiple){
ret[_in]=[];
_d.query("option",item).forEach(function(opt){
if(opt.selected){
setValue(ret,_in,opt.value);
}
});
}else{
setValue(ret,_in,item.value);
if(type=="image"){
ret[_in+".x"]=ret[_in+".y"]=ret[_in].x=ret[_in].y=0;
}
}
}
}
});
return ret;
};
dojo.objectToQuery=function(map){
var enc=encodeURIComponent;
var _45f=[];
var _460={};
for(var name in map){
var _462=map[name];
if(_462!=_460[name]){
var _463=enc(name)+"=";
if(_d.isArray(_462)){
for(var i=0;i<_462.length;i++){
_45f.push(_463+enc(_462[i]));
}
}else{
_45f.push(_463+enc(_462));
}
}
}
return _45f.join("&");
};
dojo.formToQuery=function(_465){
return _d.objectToQuery(_d.formToObject(_465));
};
dojo.formToJson=function(_466,_467){
return _d.toJson(_d.formToObject(_466),_467);
};
dojo.queryToObject=function(str){
var ret={};
var qp=str.split("&");
var dec=decodeURIComponent;
_d.forEach(qp,function(item){
if(item.length){
var _46d=item.split("=");
var name=dec(_46d.shift());
var val=dec(_46d.join("="));
if(_d.isString(ret[name])){
ret[name]=[ret[name]];
}
if(_d.isArray(ret[name])){
ret[name].push(val);
}else{
ret[name]=val;
}
}
});
return ret;
};
dojo._blockAsync=false;
dojo._contentHandlers={"text":function(xhr){
return xhr.responseText;
},"json":function(xhr){
return _d.fromJson(xhr.responseText||null);
},"json-comment-filtered":function(xhr){
if(!dojo.config.useCommentedJson){
console.warn("Consider using the standard mimetype:application/json."+" json-commenting can introduce security issues. To"+" decrease the chances of hijacking, use the standard the 'json' handler and"+" prefix your json with: {}&&\n"+"Use djConfig.useCommentedJson=true to turn off this message.");
}
var _473=xhr.responseText;
var _474=_473.indexOf("/*");
var _475=_473.lastIndexOf("*/");
if(_474==-1||_475==-1){
throw new Error("JSON was not comment filtered");
}
return _d.fromJson(_473.substring(_474+2,_475));
},"javascript":function(xhr){
return _d.eval(xhr.responseText);
},"xml":function(xhr){
var _478=xhr.responseXML;
if(_d.isIE&&(!_478||_478.documentElement==null)){
_d.forEach(["MSXML2","Microsoft","MSXML","MSXML3"],function(_479){
try{
var dom=new ActiveXObject(_479+".XMLDOM");
dom.async=false;
dom.loadXML(xhr.responseText);
_478=dom;
}
catch(e){
}
});
}
return _478;
}};
dojo._contentHandlers["json-comment-optional"]=function(xhr){
var _47c=_d._contentHandlers;
if(xhr.responseText&&xhr.responseText.indexOf("/*")!=-1){
return _47c["json-comment-filtered"](xhr);
}else{
return _47c["json"](xhr);
}
};
dojo._ioSetArgs=function(args,_47e,_47f,_480){
var _481={args:args,url:args.url};
var _482=null;
if(args.form){
var form=_d.byId(args.form);
var _484=form.getAttributeNode("action");
_481.url=_481.url||(_484?_484.value:null);
_482=_d.formToObject(form);
}
var _485=[{}];
if(_482){
_485.push(_482);
}
if(args.content){
_485.push(args.content);
}
if(args.preventCache){
_485.push({"dojo.preventCache":new Date().valueOf()});
}
_481.query=_d.objectToQuery(_d.mixin.apply(null,_485));
_481.handleAs=args.handleAs||"text";
var d=new _d.Deferred(_47e);
d.addCallbacks(_47f,function(_487){
return _480(_487,d);
});
var ld=args.load;
if(ld&&_d.isFunction(ld)){
d.addCallback(function(_489){
return ld.call(args,_489,_481);
});
}
var err=args.error;
if(err&&_d.isFunction(err)){
d.addErrback(function(_48b){
return err.call(args,_48b,_481);
});
}
var _48c=args.handle;
if(_48c&&_d.isFunction(_48c)){
d.addBoth(function(_48d){
return _48c.call(args,_48d,_481);
});
}
d.ioArgs=_481;
return d;
};
var _48e=function(dfd){
dfd.canceled=true;
var xhr=dfd.ioArgs.xhr;
var _at=typeof xhr.abort;
if(_at=="function"||_at=="object"||_at=="unknown"){
xhr.abort();
}
var err=dfd.ioArgs.error;
if(!err){
err=new Error("xhr cancelled");
err.dojoType="cancel";
}
return err;
};
var _493=function(dfd){
var ret=_d._contentHandlers[dfd.ioArgs.handleAs](dfd.ioArgs.xhr);
return (typeof ret=="undefined")?null:ret;
};
var _496=function(_497,dfd){
console.debug(_497);
return _497;
};
var _499=null;
var _49a=[];
var _49b=function(){
var now=(new Date()).getTime();
if(!_d._blockAsync){
for(var i=0,tif;i<_49a.length&&(tif=_49a[i]);i++){
var dfd=tif.dfd;
var func=function(){
if(!dfd||dfd.canceled||!tif.validCheck(dfd)){
_49a.splice(i--,1);
}else{
if(tif.ioCheck(dfd)){
_49a.splice(i--,1);
tif.resHandle(dfd);
}else{
if(dfd.startTime){
if(dfd.startTime+(dfd.ioArgs.args.timeout||0)<now){
_49a.splice(i--,1);
var err=new Error("timeout exceeded");
err.dojoType="timeout";
dfd.errback(err);
dfd.cancel();
}
}
}
}
};
if(dojo.config.isDebug){
func.call(this);
}else{
try{
func.call(this);
}
catch(e){
dfd.errback(e);
}
}
}
}
if(!_49a.length){
clearInterval(_499);
_499=null;
return;
}
};
dojo._ioCancelAll=function(){
try{
_d.forEach(_49a,function(i){
try{
i.dfd.cancel();
}
catch(e){
}
});
}
catch(e){
}
};
if(_d.isIE){
_d.addOnWindowUnload(_d._ioCancelAll);
}
_d._ioWatch=function(dfd,_4a4,_4a5,_4a6){
if(dfd.ioArgs.args.timeout){
dfd.startTime=(new Date()).getTime();
}
_49a.push({dfd:dfd,validCheck:_4a4,ioCheck:_4a5,resHandle:_4a6});
if(!_499){
_499=setInterval(_49b,50);
}
_49b();
};
var _4a7="application/x-www-form-urlencoded";
var _4a8=function(dfd){
return dfd.ioArgs.xhr.readyState;
};
var _4aa=function(dfd){
return 4==dfd.ioArgs.xhr.readyState;
};
var _4ac=function(dfd){
var xhr=dfd.ioArgs.xhr;
if(_d._isDocumentOk(xhr)){
dfd.callback(dfd);
}else{
var err=new Error("Unable to load "+dfd.ioArgs.url+" status:"+xhr.status);
err.status=xhr.status;
err.responseText=xhr.responseText;
dfd.errback(err);
}
};
dojo._ioAddQueryToUrl=function(_4b0){
if(_4b0.query.length){
_4b0.url+=(_4b0.url.indexOf("?")==-1?"?":"&")+_4b0.query;
_4b0.query=null;
}
};
dojo.xhr=function(_4b1,args,_4b3){
var dfd=_d._ioSetArgs(args,_48e,_493,_496);
dfd.ioArgs.xhr=_d._xhrObj(dfd.ioArgs.args);
if(_4b3){
if("postData" in args){
dfd.ioArgs.query=args.postData;
}else{
if("putData" in args){
dfd.ioArgs.query=args.putData;
}
}
}else{
_d._ioAddQueryToUrl(dfd.ioArgs);
}
var _4b5=dfd.ioArgs;
var xhr=_4b5.xhr;
xhr.open(_4b1,_4b5.url,args.sync!==true,args.user||undefined,args.password||undefined);
if(args.headers){
for(var hdr in args.headers){
if(hdr.toLowerCase()==="content-type"&&!args.contentType){
args.contentType=args.headers[hdr];
}else{
xhr.setRequestHeader(hdr,args.headers[hdr]);
}
}
}
xhr.setRequestHeader("Content-Type",args.contentType||_4a7);
if(!args.headers||!args.headers["X-Requested-With"]){
xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");
}
if(dojo.config.isDebug){
xhr.send(_4b5.query);
}else{
try{
xhr.send(_4b5.query);
}
catch(e){
dfd.ioArgs.error=e;
dfd.cancel();
}
}
_d._ioWatch(dfd,_4a8,_4aa,_4ac);
xhr=null;
return dfd;
};
dojo.xhrGet=function(args){
return _d.xhr("GET",args);
};
dojo.rawXhrPost=dojo.xhrPost=function(args){
return _d.xhr("POST",args,true);
};
dojo.rawXhrPut=dojo.xhrPut=function(args){
return _d.xhr("PUT",args,true);
};
dojo.xhrDelete=function(args){
return _d.xhr("DELETE",args);
};
})();
}
if(!dojo._hasResource["dojo._base.fx"]){
dojo._hasResource["dojo._base.fx"]=true;
dojo.provide("dojo._base.fx");
(function(){
var d=dojo;
dojo._Line=function(_4bd,end){
this.start=_4bd;
this.end=end;
this.getValue=function(n){
return ((this.end-this.start)*n)+this.start;
};
};
d.declare("dojo._Animation",null,{constructor:function(args){
d.mixin(this,args);
if(d.isArray(this.curve)){
this.curve=new d._Line(this.curve[0],this.curve[1]);
}
},duration:350,repeat:0,rate:10,_percent:0,_startRepeatCount:0,_fire:function(evt,args){
if(this[evt]){
if(dojo.config.isDebug){
this[evt].apply(this,args||[]);
}else{
try{
this[evt].apply(this,args||[]);
}
catch(e){
console.error("exception in animation handler for:",evt);
console.error(e);
}
}
}
return this;
},play:function(_4c3,_4c4){
var _t=this;
if(_4c4){
_t._stopTimer();
_t._active=_t._paused=false;
_t._percent=0;
}else{
if(_t._active&&!_t._paused){
return _t;
}
}
_t._fire("beforeBegin");
var de=_4c3||_t.delay;
var _p=dojo.hitch(_t,"_play",_4c4);
if(de>0){
setTimeout(_p,de);
return _t;
}
_p();
return _t;
},_play:function(_4c8){
var _t=this;
_t._startTime=new Date().valueOf();
if(_t._paused){
_t._startTime-=_t.duration*_t._percent;
}
_t._endTime=_t._startTime+_t.duration;
_t._active=true;
_t._paused=false;
var _4ca=_t.curve.getValue(_t._percent);
if(!_t._percent){
if(!_t._startRepeatCount){
_t._startRepeatCount=_t.repeat;
}
_t._fire("onBegin",[_4ca]);
}
_t._fire("onPlay",[_4ca]);
_t._cycle();
return _t;
},pause:function(){
this._stopTimer();
if(!this._active){
return this;
}
this._paused=true;
this._fire("onPause",[this.curve.getValue(this._percent)]);
return this;
},gotoPercent:function(_4cb,_4cc){
this._stopTimer();
this._active=this._paused=true;
this._percent=_4cb;
if(_4cc){
this.play();
}
return this;
},stop:function(_4cd){
if(!this._timer){
return this;
}
this._stopTimer();
if(_4cd){
this._percent=1;
}
this._fire("onStop",[this.curve.getValue(this._percent)]);
this._active=this._paused=false;
return this;
},status:function(){
if(this._active){
return this._paused?"paused":"playing";
}
return "stopped";
},_cycle:function(){
var _t=this;
if(_t._active){
var curr=new Date().valueOf();
var step=(curr-_t._startTime)/(_t._endTime-_t._startTime);
if(step>=1){
step=1;
}
_t._percent=step;
if(_t.easing){
step=_t.easing(step);
}
_t._fire("onAnimate",[_t.curve.getValue(step)]);
if(_t._percent<1){
_t._startTimer();
}else{
_t._active=false;
if(_t.repeat>0){
_t.repeat--;
_t.play(null,true);
}else{
if(_t.repeat==-1){
_t.play(null,true);
}else{
if(_t._startRepeatCount){
_t.repeat=_t._startRepeatCount;
_t._startRepeatCount=0;
}
}
}
_t._percent=0;
_t._fire("onEnd");
_t._stopTimer();
}
}
return _t;
}});
var ctr=0;
var _4d2=[];
var _4d3={run:function(){
}};
var _4d4=null;
dojo._Animation.prototype._startTimer=function(){
if(!this._timer){
this._timer=d.connect(_4d3,"run",this,"_cycle");
ctr++;
}
if(!_4d4){
_4d4=setInterval(d.hitch(_4d3,"run"),this.rate);
}
};
dojo._Animation.prototype._stopTimer=function(){
if(this._timer){
d.disconnect(this._timer);
this._timer=null;
ctr--;
}
if(ctr<=0){
clearInterval(_4d4);
_4d4=null;
ctr=0;
}
};
var _4d5=(d.isIE)?function(node){
var ns=node.style;
if(!ns.width.length&&d.style(node,"width")=="auto"){
ns.width="auto";
}
}:function(){
};
dojo._fade=function(args){
args.node=d.byId(args.node);
var _4d9=d.mixin({properties:{}},args);
var _4da=(_4d9.properties.opacity={});
_4da.start=!("start" in _4d9)?function(){
return Number(d.style(_4d9.node,"opacity"));
}:_4d9.start;
_4da.end=_4d9.end;
var anim=d.animateProperty(_4d9);
d.connect(anim,"beforeBegin",d.partial(_4d5,_4d9.node));
return anim;
};
dojo.fadeIn=function(args){
return d._fade(d.mixin({end:1},args));
};
dojo.fadeOut=function(args){
return d._fade(d.mixin({end:0},args));
};
dojo._defaultEasing=function(n){
return 0.5+((Math.sin((n+1.5)*Math.PI))/2);
};
var _4df=function(_4e0){
this._properties=_4e0;
for(var p in _4e0){
var prop=_4e0[p];
if(prop.start instanceof d.Color){
prop.tempColor=new d.Color();
}
}
this.getValue=function(r){
var ret={};
for(var p in this._properties){
var prop=this._properties[p];
var _4e7=prop.start;
if(_4e7 instanceof d.Color){
ret[p]=d.blendColors(_4e7,prop.end,r,prop.tempColor).toCss();
}else{
if(!d.isArray(_4e7)){
ret[p]=((prop.end-_4e7)*r)+_4e7+(p!="opacity"?prop.units||"px":"");
}
}
}
return ret;
};
};
dojo.animateProperty=function(args){
args.node=d.byId(args.node);
if(!args.easing){
args.easing=d._defaultEasing;
}
var anim=new d._Animation(args);
d.connect(anim,"beforeBegin",anim,function(){
var pm={};
for(var p in this.properties){
if(p=="width"||p=="height"){
this.node.display="block";
}
var prop=this.properties[p];
prop=pm[p]=d.mixin({},(d.isObject(prop)?prop:{end:prop}));
if(d.isFunction(prop.start)){
prop.start=prop.start();
}
if(d.isFunction(prop.end)){
prop.end=prop.end();
}
var _4ed=(p.toLowerCase().indexOf("color")>=0);
function getStyle(node,p){
var v=({height:node.offsetHeight,width:node.offsetWidth})[p];
if(v!==undefined){
return v;
}
v=d.style(node,p);
return (p=="opacity")?Number(v):(_4ed?v:parseFloat(v));
};
if(!("end" in prop)){
prop.end=getStyle(this.node,p);
}else{
if(!("start" in prop)){
prop.start=getStyle(this.node,p);
}
}
if(_4ed){
prop.start=new d.Color(prop.start);
prop.end=new d.Color(prop.end);
}else{
prop.start=(p=="opacity")?Number(prop.start):parseFloat(prop.start);
}
}
this.curve=new _4df(pm);
});
d.connect(anim,"onAnimate",d.hitch(d,"style",anim.node));
return anim;
};
dojo.anim=function(node,_4f2,_4f3,_4f4,_4f5,_4f6){
return d.animateProperty({node:node,duration:_4f3||d._Animation.prototype.duration,properties:_4f2,easing:_4f4,onEnd:_4f5}).play(_4f6||0);
};
})();
}
if(!dojo._hasResource["dojo._base.browser"]){
dojo._hasResource["dojo._base.browser"]=true;
dojo.provide("dojo._base.browser");
if(dojo.config.require){
dojo.forEach(dojo.config.require,"dojo['require'](item);");
}
}
if(!dojo._hasResource["dojo.back"]){
dojo._hasResource["dojo.back"]=true;
dojo.provide("dojo.back");
(function(){
var back=dojo.back;
function getHash(){
var h=window.location.hash;
if(h.charAt(0)=="#"){
h=h.substring(1);
}
return dojo.isMozilla?h:decodeURIComponent(h);
};
function setHash(h){
if(!h){
h="";
}
window.location.hash=encodeURIComponent(h);
_4fa=history.length;
};
if(dojo.exists("tests.back-hash")){
back.getHash=getHash;
back.setHash=setHash;
}
var _4fb=(typeof (window)!=="undefined")?window.location.href:"";
var _4fc=(typeof (window)!=="undefined")?getHash():"";
var _4fd=null;
var _4fe=null;
var _4ff=null;
var _500=null;
var _501=[];
var _502=[];
var _503=false;
var _504=false;
var _4fa;
function handleBackButton(){
var _505=_502.pop();
if(!_505){
return;
}
var last=_502[_502.length-1];
if(!last&&_502.length==0){
last=_4fd;
}
if(last){
if(last.kwArgs["back"]){
last.kwArgs["back"]();
}else{
if(last.kwArgs["backButton"]){
last.kwArgs["backButton"]();
}else{
if(last.kwArgs["handle"]){
last.kwArgs.handle("back");
}
}
}
}
_501.push(_505);
};
back.goBack=handleBackButton;
function handleForwardButton(){
var last=_501.pop();
if(!last){
return;
}
if(last.kwArgs["forward"]){
last.kwArgs.forward();
}else{
if(last.kwArgs["forwardButton"]){
last.kwArgs.forwardButton();
}else{
if(last.kwArgs["handle"]){
last.kwArgs.handle("forward");
}
}
}
_502.push(last);
};
back.goForward=handleForwardButton;
function createState(url,args,hash){
return {"url":url,"kwArgs":args,"urlHash":hash};
};
function getUrlQuery(url){
var _50c=url.split("?");
if(_50c.length<2){
return null;
}else{
return _50c[1];
}
};
function loadIframeHistory(){
var url=(dojo.config["dojoIframeHistoryUrl"]||dojo.moduleUrl("dojo","resources/iframe_history.html"))+"?"+(new Date()).getTime();
_503=true;
if(_500){
dojo.isSafari?_500.location=url:window.frames[_500.name].location=url;
}else{
}
return url;
};
function checkLocation(){
if(!_504){
var hsl=_502.length;
var hash=getHash();
if((hash===_4fc||window.location.href==_4fb)&&(hsl==1)){
handleBackButton();
return;
}
if(_501.length>0){
if(_501[_501.length-1].urlHash===hash){
handleForwardButton();
return;
}
}
if((hsl>=2)&&(_502[hsl-2])){
if(_502[hsl-2].urlHash===hash){
handleBackButton();
return;
}
}
if(dojo.isSafari&&dojo.isSafari<3){
var _510=history.length;
if(_510>_4fa){
handleForwardButton();
}else{
if(_510<_4fa){
handleBackButton();
}
}
_4fa=_510;
}
}
};
back.init=function(){
if(dojo.byId("dj_history")){
return;
}
var src=dojo.config["dojoIframeHistoryUrl"]||dojo.moduleUrl("dojo","resources/iframe_history.html");
document.write("<iframe style=\"border:0;width:1px;height:1px;position:absolute;visibility:hidden;bottom:0;right:0;\" name=\"dj_history\" id=\"dj_history\" src=\""+src+"\"></iframe>");
};
back.setInitialState=function(args){
_4fd=createState(_4fb,args,_4fc);
};
back.addToHistory=function(args){
_501=[];
var hash=null;
var url=null;
if(!_500){
if(dojo.config["useXDomain"]&&!dojo.config["dojoIframeHistoryUrl"]){
console.warn("dojo.back: When using cross-domain Dojo builds,"+" please save iframe_history.html to your domain and set djConfig.dojoIframeHistoryUrl"+" to the path on your domain to iframe_history.html");
}
_500=window.frames["dj_history"];
}
if(!_4ff){
_4ff=document.createElement("a");
dojo.body().appendChild(_4ff);
_4ff.style.display="none";
}
if(args["changeUrl"]){
hash=""+((args["changeUrl"]!==true)?args["changeUrl"]:(new Date()).getTime());
if(_502.length==0&&_4fd.urlHash==hash){
_4fd=createState(url,args,hash);
return;
}else{
if(_502.length>0&&_502[_502.length-1].urlHash==hash){
_502[_502.length-1]=createState(url,args,hash);
return;
}
}
_504=true;
setTimeout(function(){
setHash(hash);
_504=false;
},1);
_4ff.href=hash;
if(dojo.isIE){
url=loadIframeHistory();
var _516=args["back"]||args["backButton"]||args["handle"];
var tcb=function(_518){
if(getHash()!=""){
setTimeout(function(){
setHash(hash);
},1);
}
_516.apply(this,[_518]);
};
if(args["back"]){
args.back=tcb;
}else{
if(args["backButton"]){
args.backButton=tcb;
}else{
if(args["handle"]){
args.handle=tcb;
}
}
}
var _519=args["forward"]||args["forwardButton"]||args["handle"];
var tfw=function(_51b){
if(getHash()!=""){
setHash(hash);
}
if(_519){
_519.apply(this,[_51b]);
}
};
if(args["forward"]){
args.forward=tfw;
}else{
if(args["forwardButton"]){
args.forwardButton=tfw;
}else{
if(args["handle"]){
args.handle=tfw;
}
}
}
}else{
if(!dojo.isIE){
if(!_4fe){
_4fe=setInterval(checkLocation,200);
}
}
}
}else{
url=loadIframeHistory();
}
_502.push(createState(url,args,hash));
};
back._iframeLoaded=function(evt,_51d){
var _51e=getUrlQuery(_51d.href);
if(_51e==null){
if(_502.length==1){
handleBackButton();
}
return;
}
if(_503){
_503=false;
return;
}
if(_502.length>=2&&_51e==getUrlQuery(_502[_502.length-2].url)){
handleBackButton();
}else{
if(_501.length>0&&_51e==getUrlQuery(_501[_501.length-1].url)){
handleForwardButton();
}
}
};
})();
}
({"dateTimeFormats-appendItem-Second":"{0} ({2}: {1})","field-dayperiod":"Dayperiod","field-minute":"Minute","eraNames":["BCE","CE"],"field-weekday":"Day of the Week","days-standAlone-wide":["1","2","3","4","5","6","7"],"months-standAlone-narrow":["1","2","3","4","5","6","7","8","9","10","11","12"],"dateTimeFormats-appendItem-Year":"{0} {1}","field-era":"Era","field-hour":"Hour","quarters-standAlone-abbr":["Q1","Q2","Q3","Q4"],"timeFormat-full":"HH:mm:ss v","dateTimeFormats-appendItem-Week":"{0} ({2}: {1})","dateTimeFormats-appendItem-Timezone":"{0} {1}","months-standAlone-abbr":["1","2","3","4","5","6","7","8","9","10","11","12"],"dateTimeFormats-appendItem-Month":"{0} ({2}: {1})","days-standAlone-narrow":["1","2","3","4","5","6","7"],"eraAbbr":["BCE","CE"],"dateFormat-long":"yyyy MMMM d","timeFormat-medium":"HH:mm:ss","field-zone":"Zone","dateTimeFormats-appendItem-Minute":"{0} ({2}: {1})","dateFormat-medium":"yyyy MMM d","quarters-standAlone-wide":["Q1","Q2","Q3","Q4"],"dateTimeFormat":"{1} {0}","field-year":"Year","quarters-standAlone-narrow":["1","2","3","4"],"months-standAlone-wide":["1","2","3","4","5","6","7","8","9","10","11","12"],"dateTimeFormats-appendItem-Day":"{0} ({2}: {1})","field-week":"Week","quarters-format-narrow":["1","2","3","4"],"timeFormat-long":"HH:mm:ss z","months-format-abbr":["1","2","3","4","5","6","7","8","9","10","11","12"],"timeFormat-short":"HH:mm","field-month":"Month","quarters-format-abbr":["Q1","Q2","Q3","Q4"],"days-format-abbr":["1","2","3","4","5","6","7"],"dateTimeFormats-appendItem-Quarter":"{0} ({2}: {1})","days-format-narrow":["1","2","3","4","5","6","7"],"pm":"PM","field-second":"Second","field-day":"Day","dateTimeFormats-appendItem-Day-Of-Week":"{0} {1}","months-format-narrow":["1","2","3","4","5","6","7","8","9","10","11","12"],"dateTimeFormats-appendItem-Hour":"{0} ({2}: {1})","am":"AM","days-standAlone-abbr":["1","2","3","4","5","6","7"],"dateFormat-short":"yyyy-MM-dd","dateFormat-full":"EEEE, yyyy MMMM dd","months-format-wide":["1","2","3","4","5","6","7","8","9","10","11","12"],"dateTimeAvailableFormats":["H:mm","L","E, M-d","LLL","E MMM d","E MMMM d","MMMM d","MMM d","M-d","d","mm:ss","yyyy","yyyy-M","EEE, yyyy-M-d","yyyy MMM","EEE, yyyy MMM d","yyyy MMMM","yyyy Q","yyyy QQQ"],"dateTimeFormats-appendItem-Era":"{0} {1}","quarters-format-wide":["Q1","Q2","Q3","Q4"],"eraNarrow":["BCE","CE"],"days-format-wide":["1","2","3","4","5","6","7"]});
if(!dojo._hasResource["dojo.regexp"]){
dojo._hasResource["dojo.regexp"]=true;
dojo.provide("dojo.regexp");
dojo.regexp.escapeString=function(str,_520){
return str.replace(/([\.$?*!=:|{}\(\)\[\]\\\/^])/g,function(ch){
if(_520&&_520.indexOf(ch)!=-1){
return ch;
}
return "\\"+ch;
});
};
dojo.regexp.buildGroupRE=function(arr,re,_524){
if(!(arr instanceof Array)){
return re(arr);
}
var b=[];
for(var i=0;i<arr.length;i++){
b.push(re(arr[i]));
}
return dojo.regexp.group(b.join("|"),_524);
};
dojo.regexp.group=function(_527,_528){
return "("+(_528?"?:":"")+_527+")";
};
}
if(!dojo._hasResource["dojo.cookie"]){
dojo._hasResource["dojo.cookie"]=true;
dojo.provide("dojo.cookie");
dojo.cookie=function(name,_52a,_52b){
var c=document.cookie;
if(arguments.length==1){
var _52d=c.match(new RegExp("(?:^|; )"+dojo.regexp.escapeString(name)+"=([^;]*)"));
return _52d?decodeURIComponent(_52d[1]):undefined;
}else{
_52b=_52b||{};
var exp=_52b.expires;
if(typeof exp=="number"){
var d=new Date();
d.setTime(d.getTime()+exp*24*60*60*1000);
exp=_52b.expires=d;
}
if(exp&&exp.toUTCString){
_52b.expires=exp.toUTCString();
}
_52a=encodeURIComponent(_52a);
var _530=name+"="+_52a,_531;
for(_531 in _52b){
_530+="; "+_531;
var _532=_52b[_531];
if(_532!==true){
_530+="="+_532;
}
}
document.cookie=_530;
}
};
dojo.cookie.isSupported=function(){
if(!("cookieEnabled" in navigator)){
this("__djCookieTest__","CookiesAllowed");
navigator.cookieEnabled=this("__djCookieTest__")=="CookiesAllowed";
if(navigator.cookieEnabled){
this("__djCookieTest__","",{expires:-1});
}
}
return navigator.cookieEnabled;
};
}
if(!dojo._hasResource["dojo.date"]){
dojo._hasResource["dojo.date"]=true;
dojo.provide("dojo.date");
dojo.date.getDaysInMonth=function(_533){
var _534=_533.getMonth();
var days=[31,28,31,30,31,30,31,31,30,31,30,31];
if(_534==1&&dojo.date.isLeapYear(_533)){
return 29;
}
return days[_534];
};
dojo.date.isLeapYear=function(_536){
var year=_536.getFullYear();
return !(year%400)||(!(year%4)&&!!(year%100));
};
dojo.date.getTimezoneName=function(_538){
var str=_538.toString();
var tz="";
var _53b;
var pos=str.indexOf("(");
if(pos>-1){
tz=str.substring(++pos,str.indexOf(")"));
}else{
var pat=/([A-Z\/]+) \d{4}$/;
if((_53b=str.match(pat))){
tz=_53b[1];
}else{
str=_538.toLocaleString();
pat=/ ([A-Z\/]+)$/;
if((_53b=str.match(pat))){
tz=_53b[1];
}
}
}
return (tz=="AM"||tz=="PM")?"":tz;
};
dojo.date.compare=function(_53e,_53f,_540){
_53e=new Date(Number(_53e));
_53f=new Date(Number(_53f||new Date()));
if(_540!=="undefined"){
if(_540=="date"){
_53e.setHours(0,0,0,0);
_53f.setHours(0,0,0,0);
}else{
if(_540=="time"){
_53e.setFullYear(0,0,0);
_53f.setFullYear(0,0,0);
}
}
}
if(_53e>_53f){
return 1;
}
if(_53e<_53f){
return -1;
}
return 0;
};
dojo.date.add=function(date,_542,_543){
var sum=new Date(Number(date));
var _545=false;
var _546="Date";
switch(_542){
case "day":
break;
case "weekday":
var days,_548;
var mod=_543%5;
if(!mod){
days=(_543>0)?5:-5;
_548=(_543>0)?((_543-5)/5):((_543+5)/5);
}else{
days=mod;
_548=parseInt(_543/5);
}
var strt=date.getDay();
var adj=0;
if(strt==6&&_543>0){
adj=1;
}else{
if(strt==0&&_543<0){
adj=-1;
}
}
var trgt=strt+days;
if(trgt==0||trgt==6){
adj=(_543>0)?2:-2;
}
_543=(7*_548)+days+adj;
break;
case "year":
_546="FullYear";
_545=true;
break;
case "week":
_543*=7;
break;
case "quarter":
_543*=3;
case "month":
_545=true;
_546="Month";
break;
case "hour":
case "minute":
case "second":
case "millisecond":
_546="UTC"+_542.charAt(0).toUpperCase()+_542.substring(1)+"s";
}
if(_546){
sum["set"+_546](sum["get"+_546]()+_543);
}
if(_545&&(sum.getDate()<date.getDate())){
sum.setDate(0);
}
return sum;
};
dojo.date.difference=function(_54d,_54e,_54f){
_54e=_54e||new Date();
_54f=_54f||"day";
var _550=_54e.getFullYear()-_54d.getFullYear();
var _551=1;
switch(_54f){
case "quarter":
var m1=_54d.getMonth();
var m2=_54e.getMonth();
var q1=Math.floor(m1/3)+1;
var q2=Math.floor(m2/3)+1;
q2+=(_550*4);
_551=q2-q1;
break;
case "weekday":
var days=Math.round(dojo.date.difference(_54d,_54e,"day"));
var _557=parseInt(dojo.date.difference(_54d,_54e,"week"));
var mod=days%7;
if(mod==0){
days=_557*5;
}else{
var adj=0;
var aDay=_54d.getDay();
var bDay=_54e.getDay();
_557=parseInt(days/7);
mod=days%7;
var _55c=new Date(_54d);
_55c.setDate(_55c.getDate()+(_557*7));
var _55d=_55c.getDay();
if(days>0){
switch(true){
case aDay==6:
adj=-1;
break;
case aDay==0:
adj=0;
break;
case bDay==6:
adj=-1;
break;
case bDay==0:
adj=-2;
break;
case (_55d+mod)>5:
adj=-2;
}
}else{
if(days<0){
switch(true){
case aDay==6:
adj=0;
break;
case aDay==0:
adj=1;
break;
case bDay==6:
adj=2;
break;
case bDay==0:
adj=1;
break;
case (_55d+mod)<0:
adj=2;
}
}
}
days+=adj;
days-=(_557*2);
}
_551=days;
break;
case "year":
_551=_550;
break;
case "month":
_551=(_54e.getMonth()-_54d.getMonth())+(_550*12);
break;
case "week":
_551=parseInt(dojo.date.difference(_54d,_54e,"day")/7);
break;
case "day":
_551/=24;
case "hour":
_551/=60;
case "minute":
_551/=60;
case "second":
_551/=1000;
case "millisecond":
_551*=_54e.getTime()-_54d.getTime();
}
return Math.round(_551);
};
}
if(!dojo._hasResource["dojo.i18n"]){
dojo._hasResource["dojo.i18n"]=true;
dojo.provide("dojo.i18n");
dojo.i18n.getLocalization=function(_55e,_55f,_560){
_560=dojo.i18n.normalizeLocale(_560);
var _561=_560.split("-");
var _562=[_55e,"nls",_55f].join(".");
var _563=dojo._loadedModules[_562];
if(_563){
var _564;
for(var i=_561.length;i>0;i--){
var loc=_561.slice(0,i).join("_");
if(_563[loc]){
_564=_563[loc];
break;
}
}
if(!_564){
_564=_563.ROOT;
}
if(_564){
var _567=function(){
};
_567.prototype=_564;
return new _567();
}
}
throw new Error("Bundle not found: "+_55f+" in "+_55e+" , locale="+_560);
};
dojo.i18n.normalizeLocale=function(_568){
var _569=_568?_568.toLowerCase():dojo.locale;
if(_569=="root"){
_569="ROOT";
}
return _569;
};
dojo.i18n._requireLocalization=function(_56a,_56b,_56c,_56d){
var _56e=dojo.i18n.normalizeLocale(_56c);
var _56f=[_56a,"nls",_56b].join(".");
var _570="";
if(_56d){
var _571=_56d.split(",");
for(var i=0;i<_571.length;i++){
if(_56e["indexOf"](_571[i])==0){
if(_571[i].length>_570.length){
_570=_571[i];
}
}
}
if(!_570){
_570="ROOT";
}
}
var _573=_56d?_570:_56e;
var _574=dojo._loadedModules[_56f];
var _575=null;
if(_574){
if(dojo.config.localizationComplete&&_574._built){
return;
}
var _576=_573.replace(/-/g,"_");
var _577=_56f+"."+_576;
_575=dojo._loadedModules[_577];
}
if(!_575){
_574=dojo["provide"](_56f);
var syms=dojo._getModuleSymbols(_56a);
var _579=syms.concat("nls").join("/");
var _57a;
dojo.i18n._searchLocalePath(_573,_56d,function(loc){
var _57c=loc.replace(/-/g,"_");
var _57d=_56f+"."+_57c;
var _57e=false;
if(!dojo._loadedModules[_57d]){
dojo["provide"](_57d);
var _57f=[_579];
if(loc!="ROOT"){
_57f.push(loc);
}
_57f.push(_56b);
var _580=_57f.join("/")+".js";
_57e=dojo._loadPath(_580,null,function(hash){
var _582=function(){
};
_582.prototype=_57a;
_574[_57c]=new _582();
for(var j in hash){
_574[_57c][j]=hash[j];
}
});
}else{
_57e=true;
}
if(_57e&&_574[_57c]){
_57a=_574[_57c];
}else{
_574[_57c]=_57a;
}
if(_56d){
return true;
}
});
}
if(_56d&&_56e!=_570){
_574[_56e.replace(/-/g,"_")]=_574[_570.replace(/-/g,"_")];
}
};
(function(){
var _584=dojo.config.extraLocale;
if(_584){
if(!_584 instanceof Array){
_584=[_584];
}
var req=dojo.i18n._requireLocalization;
dojo.i18n._requireLocalization=function(m,b,_588,_589){
req(m,b,_588,_589);
if(_588){
return;
}
for(var i=0;i<_584.length;i++){
req(m,b,_584[i],_589);
}
};
}
})();
dojo.i18n._searchLocalePath=function(_58b,down,_58d){
_58b=dojo.i18n.normalizeLocale(_58b);
var _58e=_58b.split("-");
var _58f=[];
for(var i=_58e.length;i>0;i--){
_58f.push(_58e.slice(0,i).join("-"));
}
_58f.push(false);
if(down){
_58f.reverse();
}
for(var j=_58f.length-1;j>=0;j--){
var loc=_58f[j]||"ROOT";
var stop=_58d(loc);
if(stop){
break;
}
}
};
dojo.i18n._preloadLocalizations=function(_594,_595){
function preload(_596){
_596=dojo.i18n.normalizeLocale(_596);
dojo.i18n._searchLocalePath(_596,true,function(loc){
for(var i=0;i<_595.length;i++){
if(_595[i]==loc){
dojo["require"](_594+"_"+loc);
return true;
}
}
return false;
});
};
preload();
var _599=dojo.config.extraLocale||[];
for(var i=0;i<_599.length;i++){
preload(_599[i]);
}
};
}
if(!dojo._hasResource["dojo.cldr.supplemental"]){
dojo._hasResource["dojo.cldr.supplemental"]=true;
dojo.provide("dojo.cldr.supplemental");
dojo.cldr.supplemental.getFirstDayOfWeek=function(_59b){
var _59c={mv:5,ae:6,af:6,bh:6,dj:6,dz:6,eg:6,er:6,et:6,iq:6,ir:6,jo:6,ke:6,kw:6,lb:6,ly:6,ma:6,om:6,qa:6,sa:6,sd:6,so:6,tn:6,ye:6,as:0,au:0,az:0,bw:0,ca:0,cn:0,fo:0,ge:0,gl:0,gu:0,hk:0,ie:0,il:0,is:0,jm:0,jp:0,kg:0,kr:0,la:0,mh:0,mo:0,mp:0,mt:0,nz:0,ph:0,pk:0,sg:0,th:0,tt:0,tw:0,um:0,us:0,uz:0,vi:0,za:0,zw:0,et:0,mw:0,ng:0,tj:0,sy:4};
var _59d=dojo.cldr.supplemental._region(_59b);
var dow=_59c[_59d];
return (dow===undefined)?1:dow;
};
dojo.cldr.supplemental._region=function(_59f){
_59f=dojo.i18n.normalizeLocale(_59f);
var tags=_59f.split("-");
var _5a1=tags[1];
if(!_5a1){
_5a1={de:"de",en:"us",es:"es",fi:"fi",fr:"fr",he:"il",hu:"hu",it:"it",ja:"jp",ko:"kr",nl:"nl",pt:"br",sv:"se",zh:"cn"}[tags[0]];
}else{
if(_5a1.length==4){
_5a1=tags[2];
}
}
return _5a1;
};
dojo.cldr.supplemental.getWeekend=function(_5a2){
var _5a3={eg:5,il:5,sy:5,"in":0,ae:4,bh:4,dz:4,iq:4,jo:4,kw:4,lb:4,ly:4,ma:4,om:4,qa:4,sa:4,sd:4,tn:4,ye:4};
var _5a4={ae:5,bh:5,dz:5,iq:5,jo:5,kw:5,lb:5,ly:5,ma:5,om:5,qa:5,sa:5,sd:5,tn:5,ye:5,af:5,ir:5,eg:6,il:6,sy:6};
var _5a5=dojo.cldr.supplemental._region(_5a2);
var _5a6=_5a3[_5a5];
var end=_5a4[_5a5];
if(_5a6===undefined){
_5a6=6;
}
if(end===undefined){
end=0;
}
return {start:_5a6,end:end};
};
}
if(!dojo._hasResource["dojo.string"]){
dojo._hasResource["dojo.string"]=true;
dojo.provide("dojo.string");
dojo.string.rep=function(str,num){
if(num<=0||!str){
return "";
}
var buf=[];
for(;;){
if(num&1){
buf.push(str);
}
if(!(num>>=1)){
break;
}
str+=str;
}
return buf.join("");
};
dojo.string.pad=function(text,size,ch,end){
if(!ch){
ch="0";
}
var out=String(text),pad=dojo.string.rep(ch,Math.ceil((size-out.length)/ch.length));
return end?out+pad:pad+out;
};
dojo.string.substitute=function(_5b1,map,_5b3,_5b4){
_5b4=_5b4||dojo.global;
_5b3=(!_5b3)?function(v){
return v;
}:dojo.hitch(_5b4,_5b3);
return _5b1.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(_5b6,key,_5b8){
var _5b9=dojo.getObject(key,false,map);
if(_5b8){
_5b9=dojo.getObject(_5b8,false,_5b4).call(_5b4,_5b9,key);
}
return _5b3(_5b9,key).toString();
});
};
dojo.string.trim=function(str){
str=str.replace(/^\s+/,"");
for(var i=str.length-1;i>=0;i--){
if(/\S/.test(str.charAt(i))){
str=str.substring(0,i+1);
break;
}
}
return str;
};
}
if(!dojo._hasResource["dojo.date.locale"]){
dojo._hasResource["dojo.date.locale"]=true;
dojo.provide("dojo.date.locale");
(function(){
function formatPattern(_5bc,_5bd,_5be,_5bf){
return _5bf.replace(/([a-z])\1*/ig,function(_5c0){
var s,pad;
var c=_5c0.charAt(0);
var l=_5c0.length;
var _5c5=["abbr","wide","narrow"];
switch(c){
case "G":
s=_5bd[(l<4)?"eraAbbr":"eraNames"][_5bc.getFullYear()<0?0:1];
break;
case "y":
s=_5bc.getFullYear();
switch(l){
case 1:
break;
case 2:
if(!_5be){
s=String(s);
s=s.substr(s.length-2);
break;
}
default:
pad=true;
}
break;
case "Q":
case "q":
s=Math.ceil((_5bc.getMonth()+1)/3);
pad=true;
break;
case "M":
var m=_5bc.getMonth();
if(l<3){
s=m+1;
pad=true;
}else{
var _5c7=["months","format",_5c5[l-3]].join("-");
s=_5bd[_5c7][m];
}
break;
case "w":
var _5c8=0;
s=dojo.date.locale._getWeekOfYear(_5bc,_5c8);
pad=true;
break;
case "d":
s=_5bc.getDate();
pad=true;
break;
case "D":
s=dojo.date.locale._getDayOfYear(_5bc);
pad=true;
break;
case "E":
var d=_5bc.getDay();
if(l<3){
s=d+1;
pad=true;
}else{
var _5ca=["days","format",_5c5[l-3]].join("-");
s=_5bd[_5ca][d];
}
break;
case "a":
var _5cb=(_5bc.getHours()<12)?"am":"pm";
s=_5bd[_5cb];
break;
case "h":
case "H":
case "K":
case "k":
var h=_5bc.getHours();
switch(c){
case "h":
s=(h%12)||12;
break;
case "H":
s=h;
break;
case "K":
s=(h%12);
break;
case "k":
s=h||24;
break;
}
pad=true;
break;
case "m":
s=_5bc.getMinutes();
pad=true;
break;
case "s":
s=_5bc.getSeconds();
pad=true;
break;
case "S":
s=Math.round(_5bc.getMilliseconds()*Math.pow(10,l-3));
pad=true;
break;
case "v":
case "z":
s=dojo.date.getTimezoneName(_5bc);
if(s){
break;
}
l=4;
case "Z":
var _5cd=_5bc.getTimezoneOffset();
var tz=[(_5cd<=0?"+":"-"),dojo.string.pad(Math.floor(Math.abs(_5cd)/60),2),dojo.string.pad(Math.abs(_5cd)%60,2)];
if(l==4){
tz.splice(0,0,"GMT");
tz.splice(3,0,":");
}
s=tz.join("");
break;
default:
throw new Error("dojo.date.locale.format: invalid pattern char: "+_5bf);
}
if(pad){
s=dojo.string.pad(s,l);
}
return s;
});
};
dojo.date.locale.format=function(_5cf,_5d0){
_5d0=_5d0||{};
var _5d1=dojo.i18n.normalizeLocale(_5d0.locale);
var _5d2=_5d0.formatLength||"short";
var _5d3=dojo.date.locale._getGregorianBundle(_5d1);
var str=[];
var _5d5=dojo.hitch(this,formatPattern,_5cf,_5d3,_5d0.fullYear);
if(_5d0.selector=="year"){
var year=_5cf.getFullYear();
if(_5d1.match(/^zh|^ja/)){
year+="年";
}
return year;
}
if(_5d0.selector!="time"){
var _5d7=_5d0.datePattern||_5d3["dateFormat-"+_5d2];
if(_5d7){
str.push(_processPattern(_5d7,_5d5));
}
}
if(_5d0.selector!="date"){
var _5d8=_5d0.timePattern||_5d3["timeFormat-"+_5d2];
if(_5d8){
str.push(_processPattern(_5d8,_5d5));
}
}
var _5d9=str.join(" ");
return _5d9;
};
dojo.date.locale.regexp=function(_5da){
return dojo.date.locale._parseInfo(_5da).regexp;
};
dojo.date.locale._parseInfo=function(_5db){
_5db=_5db||{};
var _5dc=dojo.i18n.normalizeLocale(_5db.locale);
var _5dd=dojo.date.locale._getGregorianBundle(_5dc);
var _5de=_5db.formatLength||"short";
var _5df=_5db.datePattern||_5dd["dateFormat-"+_5de];
var _5e0=_5db.timePattern||_5dd["timeFormat-"+_5de];
var _5e1;
if(_5db.selector=="date"){
_5e1=_5df;
}else{
if(_5db.selector=="time"){
_5e1=_5e0;
}else{
_5e1=_5df+" "+_5e0;
}
}
var _5e2=[];
var re=_processPattern(_5e1,dojo.hitch(this,_buildDateTimeRE,_5e2,_5dd,_5db));
return {regexp:re,tokens:_5e2,bundle:_5dd};
};
dojo.date.locale.parse=function(_5e4,_5e5){
var info=dojo.date.locale._parseInfo(_5e5);
var _5e7=info.tokens,_5e8=info.bundle;
var re=new RegExp("^"+info.regexp+"$",info.strict?"":"i");
var _5ea=re.exec(_5e4);
if(!_5ea){
return null;
}
var _5eb=["abbr","wide","narrow"];
var _5ec=[1970,0,1,0,0,0,0];
var amPm="";
var _5ee=dojo.every(_5ea,function(v,i){
if(!i){
return true;
}
var _5f1=_5e7[i-1];
var l=_5f1.length;
switch(_5f1.charAt(0)){
case "y":
if(l!=2&&_5e5.strict){
_5ec[0]=v;
}else{
if(v<100){
v=Number(v);
var year=""+new Date().getFullYear();
var _5f4=year.substring(0,2)*100;
var _5f5=Math.min(Number(year.substring(2,4))+20,99);
var num=(v<_5f5)?_5f4+v:_5f4-100+v;
_5ec[0]=num;
}else{
if(_5e5.strict){
return false;
}
_5ec[0]=v;
}
}
break;
case "M":
if(l>2){
var _5f7=_5e8["months-format-"+_5eb[l-3]].concat();
if(!_5e5.strict){
v=v.replace(".","").toLowerCase();
_5f7=dojo.map(_5f7,function(s){
return s.replace(".","").toLowerCase();
});
}
v=dojo.indexOf(_5f7,v);
if(v==-1){
return false;
}
}else{
v--;
}
_5ec[1]=v;
break;
case "E":
case "e":
var days=_5e8["days-format-"+_5eb[l-3]].concat();
if(!_5e5.strict){
v=v.toLowerCase();
days=dojo.map(days,function(d){
return d.toLowerCase();
});
}
v=dojo.indexOf(days,v);
if(v==-1){
return false;
}
break;
case "D":
_5ec[1]=0;
case "d":
_5ec[2]=v;
break;
case "a":
var am=_5e5.am||_5e8.am;
var pm=_5e5.pm||_5e8.pm;
if(!_5e5.strict){
var _5fd=/\./g;
v=v.replace(_5fd,"").toLowerCase();
am=am.replace(_5fd,"").toLowerCase();
pm=pm.replace(_5fd,"").toLowerCase();
}
if(_5e5.strict&&v!=am&&v!=pm){
return false;
}
amPm=(v==pm)?"p":(v==am)?"a":"";
break;
case "K":
if(v==24){
v=0;
}
case "h":
case "H":
case "k":
if(v>23){
return false;
}
_5ec[3]=v;
break;
case "m":
_5ec[4]=v;
break;
case "s":
_5ec[5]=v;
break;
case "S":
_5ec[6]=v;
}
return true;
});
var _5fe=+_5ec[3];
if(amPm==="p"&&_5fe<12){
_5ec[3]=_5fe+12;
}else{
if(amPm==="a"&&_5fe==12){
_5ec[3]=0;
}
}
var _5ff=new Date(_5ec[0],_5ec[1],_5ec[2],_5ec[3],_5ec[4],_5ec[5],_5ec[6]);
if(_5e5.strict){
_5ff.setFullYear(_5ec[0]);
}
var _600=_5e7.join(""),_601=_600.indexOf("d")!=-1,_602=_600.indexOf("M")!=-1;
if(!_5ee||(_602&&_5ff.getMonth()>_5ec[1])||(_601&&_5ff.getDate()>_5ec[2])){
return null;
}
if((_602&&_5ff.getMonth()<_5ec[1])||(_601&&_5ff.getDate()<_5ec[2])){
_5ff=dojo.date.add(_5ff,"hour",1);
}
return _5ff;
};
function _processPattern(_603,_604,_605,_606){
var _607=function(x){
return x;
};
_604=_604||_607;
_605=_605||_607;
_606=_606||_607;
var _609=_603.match(/(''|[^'])+/g);
var _60a=_603.charAt(0)=="'";
dojo.forEach(_609,function(_60b,i){
if(!_60b){
_609[i]="";
}else{
_609[i]=(_60a?_605:_604)(_60b);
_60a=!_60a;
}
});
return _606(_609.join(""));
};
function _buildDateTimeRE(_60d,_60e,_60f,_610){
_610=dojo.regexp.escapeString(_610);
if(!_60f.strict){
_610=_610.replace(" a"," ?a");
}
return _610.replace(/([a-z])\1*/ig,function(_611){
var s;
var c=_611.charAt(0);
var l=_611.length;
var p2="",p3="";
if(_60f.strict){
if(l>1){
p2="0"+"{"+(l-1)+"}";
}
if(l>2){
p3="0"+"{"+(l-2)+"}";
}
}else{
p2="0?";
p3="0{0,2}";
}
switch(c){
case "y":
s="\\d{2,4}";
break;
case "M":
s=(l>2)?"\\S+?":p2+"[1-9]|1[0-2]";
break;
case "D":
s=p2+"[1-9]|"+p3+"[1-9][0-9]|[12][0-9][0-9]|3[0-5][0-9]|36[0-6]";
break;
case "d":
s="[12]\\d|"+p2+"[1-9]|3[01]";
break;
case "w":
s=p2+"[1-9]|[1-4][0-9]|5[0-3]";
break;
case "E":
s="\\S+";
break;
case "h":
s=p2+"[1-9]|1[0-2]";
break;
case "k":
s=p2+"\\d|1[01]";
break;
case "H":
s=p2+"\\d|1\\d|2[0-3]";
break;
case "K":
s=p2+"[1-9]|1\\d|2[0-4]";
break;
case "m":
case "s":
s="[0-5]\\d";
break;
case "S":
s="\\d{"+l+"}";
break;
case "a":
var am=_60f.am||_60e.am||"AM";
var pm=_60f.pm||_60e.pm||"PM";
if(_60f.strict){
s=am+"|"+pm;
}else{
s=am+"|"+pm;
if(am!=am.toLowerCase()){
s+="|"+am.toLowerCase();
}
if(pm!=pm.toLowerCase()){
s+="|"+pm.toLowerCase();
}
if(s.indexOf(".")!=-1){
s+="|"+s.replace(/\./g,"");
}
}
s=s.replace(/\./g,"\\.");
break;
default:
s=".*";
}
if(_60d){
_60d.push(_611);
}
return "("+s+")";
}).replace(/[\xa0 ]/g,"[\\s\\xa0]");
};
})();
(function(){
var _619=[];
dojo.date.locale.addCustomFormats=function(_61a,_61b){
_619.push({pkg:_61a,name:_61b});
};
dojo.date.locale._getGregorianBundle=function(_61c){
var _61d={};
dojo.forEach(_619,function(desc){
var _61f=dojo.i18n.getLocalization(desc.pkg,desc.name,_61c);
_61d=dojo.mixin(_61d,_61f);
},this);
return _61d;
};
})();
dojo.date.locale.addCustomFormats("dojo.cldr","gregorian");
dojo.date.locale.getNames=function(item,type,use,_623){
var _624;
var _625=dojo.date.locale._getGregorianBundle(_623);
var _626=[item,use,type];
if(use=="standAlone"){
var key=_626.join("-");
_624=_625[key];
if(_624[0]==1){
_624=undefined;
}
}
_626[1]="format";
return (_624||_625[_626.join("-")]).concat();
};
dojo.date.locale.isWeekend=function(_628,_629){
var _62a=dojo.cldr.supplemental.getWeekend(_629);
var day=(_628||new Date()).getDay();
if(_62a.end<_62a.start){
_62a.end+=7;
if(day<_62a.start){
day+=7;
}
}
return day>=_62a.start&&day<=_62a.end;
};
dojo.date.locale._getDayOfYear=function(_62c){
return dojo.date.difference(new Date(_62c.getFullYear(),0,1,_62c.getHours()),_62c)+1;
};
dojo.date.locale._getWeekOfYear=function(_62d,_62e){
if(arguments.length==1){
_62e=0;
}
var _62f=new Date(_62d.getFullYear(),0,1).getDay();
var adj=(_62f-_62e+7)%7;
var week=Math.floor((dojo.date.locale._getDayOfYear(_62d)+adj-1)/7);
if(_62f==_62e){
week++;
}
return week;
};
}
if(!dojo._hasResource["dojo.date.stamp"]){
dojo._hasResource["dojo.date.stamp"]=true;
dojo.provide("dojo.date.stamp");
dojo.date.stamp.fromISOString=function(_632,_633){
if(!dojo.date.stamp._isoRegExp){
dojo.date.stamp._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/;
}
var _634=dojo.date.stamp._isoRegExp.exec(_632);
var _635=null;
if(_634){
_634.shift();
if(_634[1]){
_634[1]--;
}
if(_634[6]){
_634[6]*=1000;
}
if(_633){
_633=new Date(_633);
dojo.map(["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],function(prop){
return _633["get"+prop]();
}).forEach(function(_637,_638){
if(_634[_638]===undefined){
_634[_638]=_637;
}
});
}
_635=new Date(_634[0]||1970,_634[1]||0,_634[2]||1,_634[3]||0,_634[4]||0,_634[5]||0,_634[6]||0);
var _639=0;
var _63a=_634[7]&&_634[7].charAt(0);
if(_63a!="Z"){
_639=((_634[8]||0)*60)+(Number(_634[9])||0);
if(_63a!="-"){
_639*=-1;
}
}
if(_63a){
_639-=_635.getTimezoneOffset();
}
if(_639){
_635.setTime(_635.getTime()+_639*60000);
}
}
return _635;
};
dojo.date.stamp.toISOString=function(_63b,_63c){
var _=function(n){
return (n<10)?"0"+n:n;
};
_63c=_63c||{};
var _63f=[];
var _640=_63c.zulu?"getUTC":"get";
var date="";
if(_63c.selector!="time"){
var year=_63b[_640+"FullYear"]();
date=["0000".substr((year+"").length)+year,_(_63b[_640+"Month"]()+1),_(_63b[_640+"Date"]())].join("-");
}
_63f.push(date);
if(_63c.selector!="date"){
var time=[_(_63b[_640+"Hours"]()),_(_63b[_640+"Minutes"]()),_(_63b[_640+"Seconds"]())].join(":");
var _644=_63b[_640+"Milliseconds"]();
if(_63c.milliseconds){
time+="."+(_644<100?"0":"")+_(_644);
}
if(_63c.zulu){
time+="Z";
}else{
if(_63c.selector!="time"){
var _645=_63b.getTimezoneOffset();
var _646=Math.abs(_645);
time+=(_645>0?"-":"+")+_(Math.floor(_646/60))+":"+_(_646%60);
}
}
_63f.push(time);
}
return _63f.join("T");
};
}
if(!dojo._hasResource["dojo.parser"]){
dojo._hasResource["dojo.parser"]=true;
dojo.provide("dojo.parser");
dojo.parser=new function(){
var d=dojo;
var _648=d._scopeName+"Type";
var qry="["+_648+"]";
function val2type(_64a){
if(d.isString(_64a)){
return "string";
}
if(typeof _64a=="number"){
return "number";
}
if(typeof _64a=="boolean"){
return "boolean";
}
if(d.isFunction(_64a)){
return "function";
}
if(d.isArray(_64a)){
return "array";
}
if(_64a instanceof Date){
return "date";
}
if(_64a instanceof d._Url){
return "url";
}
return "object";
};
function str2obj(_64b,type){
switch(type){
case "string":
return _64b;
case "number":
return _64b.length?Number(_64b):NaN;
case "boolean":
return typeof _64b=="boolean"?_64b:!(_64b.toLowerCase()=="false");
case "function":
if(d.isFunction(_64b)){
_64b=_64b.toString();
_64b=d.trim(_64b.substring(_64b.indexOf("{")+1,_64b.length-1));
}
try{
if(_64b.search(/[^\w\.]+/i)!=-1){
_64b=d.parser._nameAnonFunc(new Function(_64b),this);
}
return d.getObject(_64b,false);
}
catch(e){
return new Function();
}
case "array":
return _64b?_64b.split(/\s*,\s*/):[];
case "date":
switch(_64b){
case "":
return new Date("");
case "now":
return new Date();
default:
return d.date.stamp.fromISOString(_64b);
}
case "url":
return d.baseUrl+_64b;
default:
return d.fromJson(_64b);
}
};
var _64d={};
function getClassInfo(_64e){
if(!_64d[_64e]){
var cls=d.getObject(_64e);
if(!d.isFunction(cls)){
throw new Error("Could not load class '"+_64e+"'. Did you spell the name correctly and use a full path, like 'dijit.form.Button'?");
}
var _650=cls.prototype;
var _651={};
for(var name in _650){
if(name.charAt(0)=="_"){
continue;
}
var _653=_650[name];
_651[name]=val2type(_653);
}
_64d[_64e]={cls:cls,params:_651};
}
return _64d[_64e];
};
this._functionFromScript=function(_654){
var _655="";
var _656="";
var _657=_654.getAttribute("args");
if(_657){
d.forEach(_657.split(/\s*,\s*/),function(part,idx){
_655+="var "+part+" = arguments["+idx+"]; ";
});
}
var _65a=_654.getAttribute("with");
if(_65a&&_65a.length){
d.forEach(_65a.split(/\s*,\s*/),function(part){
_655+="with("+part+"){";
_656+="}";
});
}
return new Function(_655+_654.innerHTML+_656);
};
this.instantiate=function(_65c){
var _65d=[];
d.forEach(_65c,function(node){
if(!node){
return;
}
var type=node.getAttribute(_648);
if((!type)||(!type.length)){
return;
}
var _660=getClassInfo(type);
var _661=_660.cls;
var ps=_661._noScript||_661.prototype._noScript;
var _663={};
var _664=node.attributes;
for(var name in _660.params){
var item=_664.getNamedItem(name);
if(!item||(!item.specified&&(!dojo.isIE||name.toLowerCase()!="value"))){
continue;
}
var _667=item.value;
switch(name){
case "class":
_667=node.className;
break;
case "style":
_667=node.style&&node.style.cssText;
}
var _668=_660.params[name];
_663[name]=str2obj(_667,_668);
}
if(!ps){
var _669=[],_66a=[];
d.query("> script[type^='dojo/']",node).orphan().forEach(function(_66b){
var _66c=_66b.getAttribute("event"),type=_66b.getAttribute("type"),nf=d.parser._functionFromScript(_66b);
if(_66c){
if(type=="dojo/connect"){
_669.push({event:_66c,func:nf});
}else{
_663[_66c]=nf;
}
}else{
_66a.push(nf);
}
});
}
var _66e=_661["markupFactory"];
if(!_66e&&_661["prototype"]){
_66e=_661.prototype["markupFactory"];
}
var _66f=_66e?_66e(_663,node,_661):new _661(_663,node);
_65d.push(_66f);
var _670=node.getAttribute("jsId");
if(_670){
d.setObject(_670,_66f);
}
if(!ps){
d.forEach(_669,function(_671){
d.connect(_66f,_671.event,null,_671.func);
});
d.forEach(_66a,function(func){
func.call(_66f);
});
}
});
d.forEach(_65d,function(_673){
if(_673&&_673.startup&&!_673._started&&(!_673.getParent||!_673.getParent())){
_673.startup();
}
});
return _65d;
};
this.parse=function(_674){
var list=d.query(qry,_674);
var _676=this.instantiate(list);
return _676;
};
}();
(function(){
var _677=function(){
if(dojo.config["parseOnLoad"]==true){
dojo.parser.parse();
}
};
if(dojo.exists("dijit.wai.onload")&&(dijit.wai.onload===dojo._loaders[0])){
dojo._loaders.splice(1,0,_677);
}else{
dojo._loaders.unshift(_677);
}
})();
dojo.parser._anonCtr=0;
dojo.parser._anon={};
dojo.parser._nameAnonFunc=function(_678,_679){
var jpn="$joinpoint";
var nso=(_679||dojo.parser._anon);
if(dojo.isIE){
var cn=_678["__dojoNameCache"];
if(cn&&nso[cn]===_678){
return _678["__dojoNameCache"];
}
}
var ret="__"+dojo.parser._anonCtr++;
while(typeof nso[ret]!="undefined"){
ret="__"+dojo.parser._anonCtr++;
}
nso[ret]=_678;
return ret;
};
}
if(!dojo._hasResource["dojo.io.iframe"]){
dojo._hasResource["dojo.io.iframe"]=true;
dojo.provide("dojo.io.iframe");
dojo.io.iframe={create:function(_67e,_67f,uri){
if(window[_67e]){
return window[_67e];
}
if(window.frames[_67e]){
return window.frames[_67e];
}
var _681=null;
var turi=uri;
if(!turi){
if(dojo.config["useXDomain"]&&!dojo.config["dojoBlankHtmlUrl"]){
console.warn("dojo.io.iframe.create: When using cross-domain Dojo builds,"+" please save dojo/resources/blank.html to your domain and set djConfig.dojoBlankHtmlUrl"+" to the path on your domain to blank.html");
}
turi=(dojo.config["dojoBlankHtmlUrl"]||dojo.moduleUrl("dojo","resources/blank.html"));
}
var _683=dojo.isIE?"<iframe name=\""+_67e+"\" src=\""+turi+"\" onload=\""+_67f+"\">":"iframe";
_681=dojo.doc.createElement(_683);
with(_681){
name=_67e;
setAttribute("name",_67e);
id=_67e;
}
dojo.body().appendChild(_681);
window[_67e]=_681;
with(_681.style){
if(!(dojo.isSafari<3)){
position="absolute";
}
left=top="1px";
height=width="1px";
visibility="hidden";
}
if(!dojo.isIE){
this.setSrc(_681,turi,true);
_681.onload=new Function(_67f);
}
return _681;
},setSrc:function(_684,src,_686){
try{
if(!_686){
if(dojo.isSafari){
_684.location=src;
}else{
frames[_684.name].location=src;
}
}else{
var idoc;
if(dojo.isIE||dojo.isSafari>2){
idoc=_684.contentWindow.document;
}else{
if(dojo.isSafari){
idoc=_684.document;
}else{
idoc=_684.contentWindow;
}
}
if(!idoc){
_684.location=src;
return;
}else{
idoc.location.replace(src);
}
}
}
catch(e){
console.debug("dojo.io.iframe.setSrc: ",e);
}
},doc:function(_688){
var doc=_688.contentDocument||(((_688.name)&&(_688.document)&&(document.getElementsByTagName("iframe")[_688.name].contentWindow)&&(document.getElementsByTagName("iframe")[_688.name].contentWindow.document)))||((_688.name)&&(document.frames[_688.name])&&(document.frames[_688.name].document))||null;
return doc;
},send:function(args){
if(!this["_frame"]){
this._frame=this.create(this._iframeName,dojo._scopeName+".io.iframe._iframeOnload();");
}
var dfd=dojo._ioSetArgs(args,function(dfd){
dfd.canceled=true;
dfd.ioArgs._callNext();
},function(dfd){
var _68e=null;
try{
var _68f=dfd.ioArgs;
var dii=dojo.io.iframe;
var ifd=dii.doc(dii._frame);
var _692=_68f.handleAs;
_68e=ifd;
if(_692!="html"){
if(_692=="xml"){
if(dojo.isIE){
dojo.query("a",dii._frame.contentWindow.document.documentElement).orphan();
var _693=(dii._frame.contentWindow.document).documentElement.innerText;
_693=_693.replace(/>\s+</g,"><");
if(!this._ieXmlDom){
for(var i=0,a=["MSXML2","Microsoft","MSXML","MSXML3"],l=a.length;i<l;i++){
try{
var test=new ActiveXObject(a[i]+".XmlDom");
this._ieXmlDom=a[i]+".XmlDom";
break;
}
catch(e){
}
}
if(!this._ieXmlDom){
throw new Error("dojo.io.iframe.send (return handler): your copy of Internet Explorer does not support XML documents.");
}
}
var _xml=new ActiveXObject(this._ieXmlDom);
_xml.async=false;
_xml.loadXML(_693);
_68e=_xml;
}
}else{
_68e=ifd.getElementsByTagName("textarea")[0].value;
if(_692=="json"){
_68e=dojo.fromJson(_68e);
}else{
if(_692=="javascript"){
_68e=dojo.eval(_68e);
}
}
}
}
}
catch(e){
_68e=e;
}
finally{
_68f._callNext();
}
return _68e;
},function(_699,dfd){
dfd.ioArgs._hasError=true;
dfd.ioArgs._callNext();
return _699;
});
dfd.ioArgs._callNext=function(){
if(!this["_calledNext"]){
this._calledNext=true;
dojo.io.iframe._currentDfd=null;
dojo.io.iframe._fireNextRequest();
}
};
this._dfdQueue.push(dfd);
this._fireNextRequest();
dojo._ioWatch(dfd,function(dfd){
return !dfd.ioArgs["_hasError"];
},function(dfd){
return (!!dfd.ioArgs["_finished"]);
},function(dfd){
if(dfd.ioArgs._finished){
dfd.callback(dfd);
}else{
dfd.errback(new Error("Invalid dojo.io.iframe request state"));
}
});
return dfd;
},_currentDfd:null,_dfdQueue:[],_iframeName:dojo._scopeName+"IoIframe",_fireNextRequest:function(){
try{
if((this._currentDfd)||(this._dfdQueue.length==0)){
return;
}
var dfd=this._currentDfd=this._dfdQueue.shift();
var _69f=dfd.ioArgs;
var args=_69f.args;
_69f._contentToClean=[];
var fn=dojo.byId(args["form"]);
var _6a2=args["content"]||{};
if(fn){
if(_6a2){
var _6a3=function(name,_6a5){
var tn;
if(dojo.isIE){
tn=dojo.doc.createElement("<input type='hidden' name='"+name+"'>");
}else{
tn=dojo.doc.createElement("input");
tn.type="hidden";
tn.name=name;
}
tn.value=_6a5;
fn.appendChild(tn);
_69f._contentToClean.push(name);
};
for(var x in _6a2){
var val=_6a2[x];
if(dojo.isArray(val)&&val.length>1){
var i;
for(i=0;i<val.length;i++){
_6a3(x,val[i]);
}
}else{
if(!fn[x]){
_6a3(x,val);
}else{
fn[x].value=val;
}
}
}
}
var _6aa=fn.getAttributeNode("action");
var _6ab=fn.getAttributeNode("method");
var _6ac=fn.getAttributeNode("target");
if(args["url"]){
_69f._originalAction=_6aa?_6aa.value:null;
if(_6aa){
_6aa.value=args.url;
}else{
fn.setAttribute("action",args.url);
}
}
if(!_6ab||!_6ab.value){
if(_6ab){
_6ab.value=(args["method"])?args["method"]:"post";
}else{
fn.setAttribute("method",(args["method"])?args["method"]:"post");
}
}
_69f._originalTarget=_6ac?_6ac.value:null;
if(_6ac){
_6ac.value=this._iframeName;
}else{
fn.setAttribute("target",this._iframeName);
}
fn.target=this._iframeName;
fn.submit();
}else{
var _6ad=args.url+(args.url.indexOf("?")>-1?"&":"?")+_69f.query;
this.setSrc(this._frame,_6ad,true);
}
}
catch(e){
dfd.errback(e);
}
},_iframeOnload:function(){
var dfd=this._currentDfd;
if(!dfd){
this._fireNextRequest();
return;
}
var _6af=dfd.ioArgs;
var args=_6af.args;
var _6b1=dojo.byId(args.form);
if(_6b1){
var _6b2=_6af._contentToClean;
for(var i=0;i<_6b2.length;i++){
var key=_6b2[i];
for(var j=0;j<_6b1.childNodes.length;j++){
var _6b6=_6b1.childNodes[j];
if(_6b6.name==key){
dojo._destroyElement(_6b6);
break;
}
}
}
if(_6af["_originalAction"]){
_6b1.setAttribute("action",_6af._originalAction);
}
if(_6af["_originalTarget"]){
_6b1.setAttribute("target",_6af._originalTarget);
_6b1.target=_6af._originalTarget;
}
}
_6af._finished=true;
}};
}
if(!dojo._hasResource["dojo.io.script"]){
dojo._hasResource["dojo.io.script"]=true;
dojo.provide("dojo.io.script");
dojo.io.script={get:function(args){
var dfd=this._makeScriptDeferred(args);
var _6b9=dfd.ioArgs;
dojo._ioAddQueryToUrl(_6b9);
if(this._canAttach(_6b9)){
this.attach(_6b9.id,_6b9.url,args.frameDoc);
}
dojo._ioWatch(dfd,this._validCheck,this._ioCheck,this._resHandle);
return dfd;
},attach:function(id,url,_6bc){
var doc=(_6bc||dojo.doc);
var _6be=doc.createElement("script");
_6be.type="text/javascript";
_6be.src=url;
_6be.id=id;
_6be.charset="utf-8";
doc.getElementsByTagName("head")[0].appendChild(_6be);
},remove:function(id,_6c0){
dojo._destroyElement(dojo.byId(id,_6c0));
if(this["jsonp_"+id]){
delete this["jsonp_"+id];
}
},_makeScriptDeferred:function(args){
var dfd=dojo._ioSetArgs(args,this._deferredCancel,this._deferredOk,this._deferredError);
var _6c3=dfd.ioArgs;
_6c3.id=dojo._scopeName+"IoScript"+(this._counter++);
_6c3.canDelete=false;
if(args.callbackParamName){
_6c3.query=_6c3.query||"";
if(_6c3.query.length>0){
_6c3.query+="&";
}
_6c3.query+=args.callbackParamName+"="+(args.frameDoc?"parent.":"")+dojo._scopeName+".io.script.jsonp_"+_6c3.id+"._jsonpCallback";
_6c3.frameDoc=args.frameDoc;
_6c3.canDelete=true;
dfd._jsonpCallback=this._jsonpCallback;
this["jsonp_"+_6c3.id]=dfd;
}
return dfd;
},_deferredCancel:function(dfd){
dfd.canceled=true;
if(dfd.ioArgs.canDelete){
dojo.io.script._addDeadScript(dfd.ioArgs);
}
},_deferredOk:function(dfd){
if(dfd.ioArgs.canDelete){
dojo.io.script._addDeadScript(dfd.ioArgs);
}
if(dfd.ioArgs.json){
return dfd.ioArgs.json;
}else{
return dfd.ioArgs;
}
},_deferredError:function(_6c6,dfd){
if(dfd.ioArgs.canDelete){
if(_6c6.dojoType=="timeout"){
dojo.io.script.remove(dfd.ioArgs.id,dfd.ioArgs.frameDoc);
}else{
dojo.io.script._addDeadScript(dfd.ioArgs);
}
}
console.debug("dojo.io.script error",_6c6);
return _6c6;
},_deadScripts:[],_counter:1,_addDeadScript:function(_6c8){
dojo.io.script._deadScripts.push({id:_6c8.id,frameDoc:_6c8.frameDoc});
_6c8.frameDoc=null;
},_validCheck:function(dfd){
var _6ca=dojo.io.script;
var _6cb=_6ca._deadScripts;
if(_6cb&&_6cb.length>0){
for(var i=0;i<_6cb.length;i++){
_6ca.remove(_6cb[i].id,_6cb[i].frameDoc);
_6cb[i].frameDoc=null;
}
dojo.io.script._deadScripts=[];
}
return true;
},_ioCheck:function(dfd){
if(dfd.ioArgs.json){
return true;
}
var _6ce=dfd.ioArgs.args.checkString;
if(_6ce&&eval("typeof("+_6ce+") != 'undefined'")){
return true;
}
return false;
},_resHandle:function(dfd){
if(dojo.io.script._ioCheck(dfd)){
dfd.callback(dfd);
}else{
dfd.errback(new Error("inconceivable dojo.io.script._resHandle error"));
}
},_canAttach:function(_6d0){
return true;
},_jsonpCallback:function(json){
this.ioArgs.json=json;
}};
}
if(!dojo._hasResource["dojo.dnd.common"]){
dojo._hasResource["dojo.dnd.common"]=true;
dojo.provide("dojo.dnd.common");
dojo.dnd._isMac=navigator.appVersion.indexOf("Macintosh")>=0;
dojo.dnd._copyKey=dojo.dnd._isMac?"metaKey":"ctrlKey";
dojo.dnd.getCopyKeyState=function(e){
return e[dojo.dnd._copyKey];
};
dojo.dnd._uniqueId=0;
dojo.dnd.getUniqueId=function(){
var id;
do{
id=dojo._scopeName+"Unique"+(++dojo.dnd._uniqueId);
}while(dojo.byId(id));
return id;
};
dojo.dnd._empty={};
dojo.dnd.isFormElement=function(e){
var t=e.target;
if(t.nodeType==3){
t=t.parentNode;
}
return " button textarea input select option ".indexOf(" "+t.tagName.toLowerCase()+" ")>=0;
};
}
if(!dojo._hasResource["dojo.dnd.autoscroll"]){
dojo._hasResource["dojo.dnd.autoscroll"]=true;
dojo.provide("dojo.dnd.autoscroll");
dojo.dnd.getViewport=function(){
var d=dojo.doc,dd=d.documentElement,w=window,b=dojo.body();
if(dojo.isMozilla){
return {w:dd.clientWidth,h:w.innerHeight};
}else{
if(!dojo.isOpera&&w.innerWidth){
return {w:w.innerWidth,h:w.innerHeight};
}else{
if(!dojo.isOpera&&dd&&dd.clientWidth){
return {w:dd.clientWidth,h:dd.clientHeight};
}else{
if(b.clientWidth){
return {w:b.clientWidth,h:b.clientHeight};
}
}
}
}
return null;
};
dojo.dnd.V_TRIGGER_AUTOSCROLL=32;
dojo.dnd.H_TRIGGER_AUTOSCROLL=32;
dojo.dnd.V_AUTOSCROLL_VALUE=16;
dojo.dnd.H_AUTOSCROLL_VALUE=16;
dojo.dnd.autoScroll=function(e){
var v=dojo.dnd.getViewport(),dx=0,dy=0;
if(e.clientX<dojo.dnd.H_TRIGGER_AUTOSCROLL){
dx=-dojo.dnd.H_AUTOSCROLL_VALUE;
}else{
if(e.clientX>v.w-dojo.dnd.H_TRIGGER_AUTOSCROLL){
dx=dojo.dnd.H_AUTOSCROLL_VALUE;
}
}
if(e.clientY<dojo.dnd.V_TRIGGER_AUTOSCROLL){
dy=-dojo.dnd.V_AUTOSCROLL_VALUE;
}else{
if(e.clientY>v.h-dojo.dnd.V_TRIGGER_AUTOSCROLL){
dy=dojo.dnd.V_AUTOSCROLL_VALUE;
}
}
window.scrollBy(dx,dy);
};
dojo.dnd._validNodes={"div":1,"p":1,"td":1};
dojo.dnd._validOverflow={"auto":1,"scroll":1};
dojo.dnd.autoScrollNodes=function(e){
for(var n=e.target;n;){
if(n.nodeType==1&&(n.tagName.toLowerCase() in dojo.dnd._validNodes)){
var s=dojo.getComputedStyle(n);
if(s.overflow.toLowerCase() in dojo.dnd._validOverflow){
var b=dojo._getContentBox(n,s),t=dojo._abs(n,true);
var w=Math.min(dojo.dnd.H_TRIGGER_AUTOSCROLL,b.w/2),h=Math.min(dojo.dnd.V_TRIGGER_AUTOSCROLL,b.h/2),rx=e.pageX-t.x,ry=e.pageY-t.y,dx=0,dy=0;
if(dojo.isSafari||dojo.isOpera){
rx+=dojo.body().scrollLeft,ry+=dojo.body().scrollTop;
}
if(rx>0&&rx<b.w){
if(rx<w){
dx=-w;
}else{
if(rx>b.w-w){
dx=w;
}
}
}
if(ry>0&&ry<b.h){
if(ry<h){
dy=-h;
}else{
if(ry>b.h-h){
dy=h;
}
}
}
var _6e9=n.scrollLeft,_6ea=n.scrollTop;
n.scrollLeft=n.scrollLeft+dx;
n.scrollTop=n.scrollTop+dy;
if(_6e9!=n.scrollLeft||_6ea!=n.scrollTop){
return;
}
}
}
try{
n=n.parentNode;
}
catch(x){
n=null;
}
}
dojo.dnd.autoScroll(e);
};
}
if(!dojo._hasResource["dojo.dnd.Mover"]){
dojo._hasResource["dojo.dnd.Mover"]=true;
dojo.provide("dojo.dnd.Mover");
dojo.declare("dojo.dnd.Mover",null,{constructor:function(node,e,host){
this.node=dojo.byId(node);
this.marginBox={l:e.pageX,t:e.pageY};
this.mouseButton=e.button;
var h=this.host=host,d=node.ownerDocument,_6f0=dojo.connect(d,"onmousemove",this,"onFirstMove");
this.events=[dojo.connect(d,"onmousemove",this,"onMouseMove"),dojo.connect(d,"onmouseup",this,"onMouseUp"),dojo.connect(d,"ondragstart",dojo.stopEvent),dojo.connect(d.body,"onselectstart",dojo.stopEvent),_6f0];
if(h&&h.onMoveStart){
h.onMoveStart(this);
}
},onMouseMove:function(e){
dojo.dnd.autoScroll(e);
var m=this.marginBox;
this.host.onMove(this,{l:m.l+e.pageX,t:m.t+e.pageY});
dojo.stopEvent(e);
},onMouseUp:function(e){
if(dojo.isSafari&&dojo.dnd._isMac&&this.mouseButton==2?e.button==0:this.mouseButton==e.button){
this.destroy();
}
dojo.stopEvent(e);
},onFirstMove:function(){
var s=this.node.style,l,t,h=this.host;
switch(s.position){
case "relative":
case "absolute":
l=Math.round(parseFloat(s.left));
t=Math.round(parseFloat(s.top));
break;
default:
s.position="absolute";
var m=dojo.marginBox(this.node);
var b=dojo.doc.body;
var bs=dojo.getComputedStyle(b);
var bm=dojo._getMarginBox(b,bs);
var bc=dojo._getContentBox(b,bs);
l=m.l-(bc.l-bm.l);
t=m.t-(bc.t-bm.t);
break;
}
this.marginBox.l=l-this.marginBox.l;
this.marginBox.t=t-this.marginBox.t;
if(h&&h.onFirstMove){
h.onFirstMove(this);
}
dojo.disconnect(this.events.pop());
},destroy:function(){
dojo.forEach(this.events,dojo.disconnect);
var h=this.host;
if(h&&h.onMoveStop){
h.onMoveStop(this);
}
this.events=this.node=this.host=null;
}});
}
if(!dojo._hasResource["dojo.dnd.Moveable"]){
dojo._hasResource["dojo.dnd.Moveable"]=true;
dojo.provide("dojo.dnd.Moveable");
dojo.declare("dojo.dnd.Moveable",null,{handle:"",delay:0,skip:false,constructor:function(node,_6ff){
this.node=dojo.byId(node);
if(!_6ff){
_6ff={};
}
this.handle=_6ff.handle?dojo.byId(_6ff.handle):null;
if(!this.handle){
this.handle=this.node;
}
this.delay=_6ff.delay>0?_6ff.delay:0;
this.skip=_6ff.skip;
this.mover=_6ff.mover?_6ff.mover:dojo.dnd.Mover;
this.events=[dojo.connect(this.handle,"onmousedown",this,"onMouseDown"),dojo.connect(this.handle,"ondragstart",this,"onSelectStart"),dojo.connect(this.handle,"onselectstart",this,"onSelectStart")];
},markupFactory:function(_700,node){
return new dojo.dnd.Moveable(node,_700);
},destroy:function(){
dojo.forEach(this.events,dojo.disconnect);
this.events=this.node=this.handle=null;
},onMouseDown:function(e){
if(this.skip&&dojo.dnd.isFormElement(e)){
return;
}
if(this.delay){
this.events.push(dojo.connect(this.handle,"onmousemove",this,"onMouseMove"),dojo.connect(this.handle,"onmouseup",this,"onMouseUp"));
this._lastX=e.pageX;
this._lastY=e.pageY;
}else{
this.onDragDetected(e);
}
dojo.stopEvent(e);
},onMouseMove:function(e){
if(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay){
this.onMouseUp(e);
this.onDragDetected(e);
}
dojo.stopEvent(e);
},onMouseUp:function(e){
for(var i=0;i<2;++i){
dojo.disconnect(this.events.pop());
}
dojo.stopEvent(e);
},onSelectStart:function(e){
if(!this.skip||!dojo.dnd.isFormElement(e)){
dojo.stopEvent(e);
}
},onDragDetected:function(e){
new this.mover(this.node,e,this);
},onMoveStart:function(_708){
dojo.publish("/dnd/move/start",[_708]);
dojo.addClass(dojo.body(),"dojoMove");
dojo.addClass(this.node,"dojoMoveItem");
},onMoveStop:function(_709){
dojo.publish("/dnd/move/stop",[_709]);
dojo.removeClass(dojo.body(),"dojoMove");
dojo.removeClass(this.node,"dojoMoveItem");
},onFirstMove:function(_70a){
},onMove:function(_70b,_70c){
this.onMoving(_70b,_70c);
var s=_70b.node.style;
s.left=_70c.l+"px";
s.top=_70c.t+"px";
this.onMoved(_70b,_70c);
},onMoving:function(_70e,_70f){
},onMoved:function(_710,_711){
}});
}
if(!dojo._hasResource["dojo.dnd.move"]){
dojo._hasResource["dojo.dnd.move"]=true;
dojo.provide("dojo.dnd.move");
dojo.declare("dojo.dnd.move.constrainedMoveable",dojo.dnd.Moveable,{constraints:function(){
},within:false,markupFactory:function(_712,node){
return new dojo.dnd.move.constrainedMoveable(node,_712);
},constructor:function(node,_715){
if(!_715){
_715={};
}
this.constraints=_715.constraints;
this.within=_715.within;
},onFirstMove:function(_716){
var c=this.constraintBox=this.constraints.call(this,_716);
c.r=c.l+c.w;
c.b=c.t+c.h;
if(this.within){
var mb=dojo.marginBox(_716.node);
c.r-=mb.w;
c.b-=mb.h;
}
},onMove:function(_719,_71a){
var c=this.constraintBox,s=_719.node.style;
s.left=(_71a.l<c.l?c.l:c.r<_71a.l?c.r:_71a.l)+"px";
s.top=(_71a.t<c.t?c.t:c.b<_71a.t?c.b:_71a.t)+"px";
}});
dojo.declare("dojo.dnd.move.boxConstrainedMoveable",dojo.dnd.move.constrainedMoveable,{box:{},markupFactory:function(_71d,node){
return new dojo.dnd.move.boxConstrainedMoveable(node,_71d);
},constructor:function(node,_720){
var box=_720&&_720.box;
this.constraints=function(){
return box;
};
}});
dojo.declare("dojo.dnd.move.parentConstrainedMoveable",dojo.dnd.move.constrainedMoveable,{area:"content",markupFactory:function(_722,node){
return new dojo.dnd.move.parentConstrainedMoveable(node,_722);
},constructor:function(node,_725){
var area=_725&&_725.area;
this.constraints=function(){
var n=this.node.parentNode,s=dojo.getComputedStyle(n),mb=dojo._getMarginBox(n,s);
if(area=="margin"){
return mb;
}
var t=dojo._getMarginExtents(n,s);
mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;
if(area=="border"){
return mb;
}
t=dojo._getBorderExtents(n,s);
mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;
if(area=="padding"){
return mb;
}
t=dojo._getPadExtents(n,s);
mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;
return mb;
};
}});
dojo.dnd.move.constrainedMover=function(fun,_72c){
dojo.deprecated("dojo.dnd.move.constrainedMover, use dojo.dnd.move.constrainedMoveable instead");
var _72d=function(node,e,_730){
dojo.dnd.Mover.call(this,node,e,_730);
};
dojo.extend(_72d,dojo.dnd.Mover.prototype);
dojo.extend(_72d,{onMouseMove:function(e){
dojo.dnd.autoScroll(e);
var m=this.marginBox,c=this.constraintBox,l=m.l+e.pageX,t=m.t+e.pageY;
l=l<c.l?c.l:c.r<l?c.r:l;
t=t<c.t?c.t:c.b<t?c.b:t;
this.host.onMove(this,{l:l,t:t});
},onFirstMove:function(){
dojo.dnd.Mover.prototype.onFirstMove.call(this);
var c=this.constraintBox=fun.call(this);
c.r=c.l+c.w;
c.b=c.t+c.h;
if(_72c){
var mb=dojo.marginBox(this.node);
c.r-=mb.w;
c.b-=mb.h;
}
}});
return _72d;
};
dojo.dnd.move.boxConstrainedMover=function(box,_739){
dojo.deprecated("dojo.dnd.move.boxConstrainedMover, use dojo.dnd.move.boxConstrainedMoveable instead");
return dojo.dnd.move.constrainedMover(function(){
return box;
},_739);
};
dojo.dnd.move.parentConstrainedMover=function(area,_73b){
dojo.deprecated("dojo.dnd.move.parentConstrainedMover, use dojo.dnd.move.parentConstrainedMoveable instead");
var fun=function(){
var n=this.node.parentNode,s=dojo.getComputedStyle(n),mb=dojo._getMarginBox(n,s);
if(area=="margin"){
return mb;
}
var t=dojo._getMarginExtents(n,s);
mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;
if(area=="border"){
return mb;
}
t=dojo._getBorderExtents(n,s);
mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;
if(area=="padding"){
return mb;
}
t=dojo._getPadExtents(n,s);
mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;
return mb;
};
return dojo.dnd.move.constrainedMover(fun,_73b);
};
dojo.dnd.constrainedMover=dojo.dnd.move.constrainedMover;
dojo.dnd.boxConstrainedMover=dojo.dnd.move.boxConstrainedMover;
dojo.dnd.parentConstrainedMover=dojo.dnd.move.parentConstrainedMover;
}
if(!dojo._hasResource["dojo.dnd.TimedMoveable"]){
dojo._hasResource["dojo.dnd.TimedMoveable"]=true;
dojo.provide("dojo.dnd.TimedMoveable");
(function(){
var _741=dojo.dnd.Moveable.prototype.onMove;
dojo.declare("dojo.dnd.TimedMoveable",dojo.dnd.Moveable,{timeout:40,constructor:function(node,_743){
if(!_743){
_743={};
}
if(_743.timeout&&typeof _743.timeout=="number"&&_743.timeout>=0){
this.timeout=_743.timeout;
}
},markupFactory:function(_744,node){
return new dojo.dnd.TimedMoveable(node,_744);
},onMoveStop:function(_746){
if(_746._timer){
clearTimeout(_746._timer);
_741.call(this,_746,_746._leftTop);
}
dojo.dnd.Moveable.prototype.onMoveStop.apply(this,arguments);
},onMove:function(_747,_748){
_747._leftTop=_748;
if(!_747._timer){
var _t=this;
_747._timer=setTimeout(function(){
_747._timer=null;
_741.call(_t,_747,_747._leftTop);
},this.timeout);
}
}});
})();
}
if(!dojo._hasResource["dojo.fx"]){
dojo._hasResource["dojo.fx"]=true;
dojo.provide("dojo.fx");
dojo.provide("dojo.fx.Toggler");
(function(){
var _74a={_fire:function(evt,args){
if(this[evt]){
this[evt].apply(this,args||[]);
}
return this;
}};
var _74d=function(_74e){
this._index=-1;
this._animations=_74e||[];
this._current=this._onAnimateCtx=this._onEndCtx=null;
this.duration=0;
dojo.forEach(this._animations,function(a){
this.duration+=a.duration;
if(a.delay){
this.duration+=a.delay;
}
},this);
};
dojo.extend(_74d,{_onAnimate:function(){
this._fire("onAnimate",arguments);
},_onEnd:function(){
dojo.disconnect(this._onAnimateCtx);
dojo.disconnect(this._onEndCtx);
this._onAnimateCtx=this._onEndCtx=null;
if(this._index+1==this._animations.length){
this._fire("onEnd");
}else{
this._current=this._animations[++this._index];
this._onAnimateCtx=dojo.connect(this._current,"onAnimate",this,"_onAnimate");
this._onEndCtx=dojo.connect(this._current,"onEnd",this,"_onEnd");
this._current.play(0,true);
}
},play:function(_750,_751){
if(!this._current){
this._current=this._animations[this._index=0];
}
if(!_751&&this._current.status()=="playing"){
return this;
}
var _752=dojo.connect(this._current,"beforeBegin",this,function(){
this._fire("beforeBegin");
}),_753=dojo.connect(this._current,"onBegin",this,function(arg){
this._fire("onBegin",arguments);
}),_755=dojo.connect(this._current,"onPlay",this,function(arg){
this._fire("onPlay",arguments);
dojo.disconnect(_752);
dojo.disconnect(_753);
dojo.disconnect(_755);
});
if(this._onAnimateCtx){
dojo.disconnect(this._onAnimateCtx);
}
this._onAnimateCtx=dojo.connect(this._current,"onAnimate",this,"_onAnimate");
if(this._onEndCtx){
dojo.disconnect(this._onEndCtx);
}
this._onEndCtx=dojo.connect(this._current,"onEnd",this,"_onEnd");
this._current.play.apply(this._current,arguments);
return this;
},pause:function(){
if(this._current){
var e=dojo.connect(this._current,"onPause",this,function(arg){
this._fire("onPause",arguments);
dojo.disconnect(e);
});
this._current.pause();
}
return this;
},gotoPercent:function(_759,_75a){
this.pause();
var _75b=this.duration*_759;
this._current=null;
dojo.some(this._animations,function(a){
if(a.duration<=_75b){
this._current=a;
return true;
}
_75b-=a.duration;
return false;
});
if(this._current){
this._current.gotoPercent(_75b/this._current.duration,_75a);
}
return this;
},stop:function(_75d){
if(this._current){
if(_75d){
for(;this._index+1<this._animations.length;++this._index){
this._animations[this._index].stop(true);
}
this._current=this._animations[this._index];
}
var e=dojo.connect(this._current,"onStop",this,function(arg){
this._fire("onStop",arguments);
dojo.disconnect(e);
});
this._current.stop();
}
return this;
},status:function(){
return this._current?this._current.status():"stopped";
},destroy:function(){
if(this._onAnimateCtx){
dojo.disconnect(this._onAnimateCtx);
}
if(this._onEndCtx){
dojo.disconnect(this._onEndCtx);
}
}});
dojo.extend(_74d,_74a);
dojo.fx.chain=function(_760){
return new _74d(_760);
};
var _761=function(_762){
this._animations=_762||[];
this._connects=[];
this._finished=0;
this.duration=0;
dojo.forEach(_762,function(a){
var _764=a.duration;
if(a.delay){
_764+=a.delay;
}
if(this.duration<_764){
this.duration=_764;
}
this._connects.push(dojo.connect(a,"onEnd",this,"_onEnd"));
},this);
this._pseudoAnimation=new dojo._Animation({curve:[0,1],duration:this.duration});
dojo.forEach(["beforeBegin","onBegin","onPlay","onAnimate","onPause","onStop"],function(evt){
this._connects.push(dojo.connect(this._pseudoAnimation,evt,dojo.hitch(this,"_fire",evt)));
},this);
};
dojo.extend(_761,{_doAction:function(_766,args){
dojo.forEach(this._animations,function(a){
a[_766].apply(a,args);
});
return this;
},_onEnd:function(){
if(++this._finished==this._animations.length){
this._fire("onEnd");
}
},_call:function(_769,args){
var t=this._pseudoAnimation;
t[_769].apply(t,args);
},play:function(_76c,_76d){
this._finished=0;
this._doAction("play",arguments);
this._call("play",arguments);
return this;
},pause:function(){
this._doAction("pause",arguments);
this._call("pause",arguments);
return this;
},gotoPercent:function(_76e,_76f){
var ms=this.duration*_76e;
dojo.forEach(this._animations,function(a){
a.gotoPercent(a.duration<ms?1:(ms/a.duration),_76f);
});
this._call("gotoPercent",arguments);
return this;
},stop:function(_772){
this._doAction("stop",arguments);
this._call("stop",arguments);
return this;
},status:function(){
return this._pseudoAnimation.status();
},destroy:function(){
dojo.forEach(this._connects,dojo.disconnect);
}});
dojo.extend(_761,_74a);
dojo.fx.combine=function(_773){
return new _761(_773);
};
})();
dojo.declare("dojo.fx.Toggler",null,{constructor:function(args){
var _t=this;
dojo.mixin(_t,args);
_t.node=args.node;
_t._showArgs=dojo.mixin({},args);
_t._showArgs.node=_t.node;
_t._showArgs.duration=_t.showDuration;
_t.showAnim=_t.showFunc(_t._showArgs);
_t._hideArgs=dojo.mixin({},args);
_t._hideArgs.node=_t.node;
_t._hideArgs.duration=_t.hideDuration;
_t.hideAnim=_t.hideFunc(_t._hideArgs);
dojo.connect(_t.showAnim,"beforeBegin",dojo.hitch(_t.hideAnim,"stop",true));
dojo.connect(_t.hideAnim,"beforeBegin",dojo.hitch(_t.showAnim,"stop",true));
},node:null,showFunc:dojo.fadeIn,hideFunc:dojo.fadeOut,showDuration:200,hideDuration:200,show:function(_776){
return this.showAnim.play(_776||0);
},hide:function(_777){
return this.hideAnim.play(_777||0);
}});
dojo.fx.wipeIn=function(args){
args.node=dojo.byId(args.node);
var node=args.node,s=node.style,o;
var anim=dojo.animateProperty(dojo.mixin({properties:{height:{start:function(){
o=s.overflow;
s.overflow="hidden";
if(s.visibility=="hidden"||s.display=="none"){
s.height="1px";
s.display="";
s.visibility="";
return 1;
}else{
var _77d=dojo.style(node,"height");
return Math.max(_77d,1);
}
},end:function(){
return node.scrollHeight;
}}}},args));
dojo.connect(anim,"onEnd",function(){
s.height="auto";
s.overflow=o;
});
return anim;
};
dojo.fx.wipeOut=function(args){
var node=args.node=dojo.byId(args.node);
var s=node.style;
var o;
var anim=dojo.animateProperty(dojo.mixin({properties:{height:{end:1}}},args));
dojo.connect(anim,"beforeBegin",function(){
o=s.overflow;
s.overflow="hidden";
s.display="";
});
dojo.connect(anim,"onEnd",function(){
s.overflow=o;
s.height="auto";
s.display="none";
});
return anim;
};
dojo.fx.slideTo=function(args){
var node=(args.node=dojo.byId(args.node));
var top=null;
var left=null;
var init=(function(n){
return function(){
var cs=dojo.getComputedStyle(n);
var pos=cs.position;
top=(pos=="absolute"?n.offsetTop:parseInt(cs.top)||0);
left=(pos=="absolute"?n.offsetLeft:parseInt(cs.left)||0);
if(pos!="absolute"&&pos!="relative"){
var ret=dojo.coords(n,true);
top=ret.y;
left=ret.x;
n.style.position="absolute";
n.style.top=top+"px";
n.style.left=left+"px";
}
};
})(node);
init();
var anim=dojo.animateProperty(dojo.mixin({properties:{top:{end:args.top||0},left:{end:args.left||0}}},args));
dojo.connect(anim,"beforeBegin",anim,init);
return anim;
};
}
if(!dojo._hasResource["dijit._base.focus"]){
dojo._hasResource["dijit._base.focus"]=true;
dojo.provide("dijit._base.focus");
dojo.mixin(dijit,{_curFocus:null,_prevFocus:null,isCollapsed:function(){
var _78d=dojo.doc;
if(_78d.selection){
var s=_78d.selection;
if(s.type=="Text"){
return !s.createRange().htmlText.length;
}else{
return !s.createRange().length;
}
}else{
var _78f=dojo.global;
var _790=_78f.getSelection();
if(dojo.isString(_790)){
return !_790;
}else{
return _790.isCollapsed||!_790.toString();
}
}
},getBookmark:function(){
var _791,_792=dojo.doc.selection;
if(_792){
var _793=_792.createRange();
if(_792.type.toUpperCase()=="CONTROL"){
if(_793.length){
_791=[];
var i=0,len=_793.length;
while(i<len){
_791.push(_793.item(i++));
}
}else{
_791=null;
}
}else{
_791=_793.getBookmark();
}
}else{
if(window.getSelection){
_792=dojo.global.getSelection();
if(_792){
_793=_792.getRangeAt(0);
_791=_793.cloneRange();
}
}else{
console.warn("No idea how to store the current selection for this browser!");
}
}
return _791;
},moveToBookmark:function(_796){
var _797=dojo.doc;
if(_797.selection){
var _798;
if(dojo.isArray(_796)){
_798=_797.body.createControlRange();
dojo.forEach(_796,function(n){
_798.addElement(n);
});
}else{
_798=_797.selection.createRange();
_798.moveToBookmark(_796);
}
_798.select();
}else{
var _79a=dojo.global.getSelection&&dojo.global.getSelection();
if(_79a&&_79a.removeAllRanges){
_79a.removeAllRanges();
_79a.addRange(_796);
}else{
console.warn("No idea how to restore selection for this browser!");
}
}
},getFocus:function(menu,_79c){
return {node:menu&&dojo.isDescendant(dijit._curFocus,menu.domNode)?dijit._prevFocus:dijit._curFocus,bookmark:!dojo.withGlobal(_79c||dojo.global,dijit.isCollapsed)?dojo.withGlobal(_79c||dojo.global,dijit.getBookmark):null,openedForWindow:_79c};
},focus:function(_79d){
if(!_79d){
return;
}
var node="node" in _79d?_79d.node:_79d,_79f=_79d.bookmark,_7a0=_79d.openedForWindow;
if(node){
var _7a1=(node.tagName.toLowerCase()=="iframe")?node.contentWindow:node;
if(_7a1&&_7a1.focus){
try{
_7a1.focus();
}
catch(e){
}
}
dijit._onFocusNode(node);
}
if(_79f&&dojo.withGlobal(_7a0||dojo.global,dijit.isCollapsed)){
if(_7a0){
_7a0.focus();
}
try{
dojo.withGlobal(_7a0||dojo.global,dijit.moveToBookmark,null,[_79f]);
}
catch(e){
}
}
},_activeStack:[],registerWin:function(_7a2){
if(!_7a2){
_7a2=window;
}
dojo.connect(_7a2.document,"onmousedown",function(evt){
dijit._justMouseDowned=true;
setTimeout(function(){
dijit._justMouseDowned=false;
},0);
dijit._onTouchNode(evt.target||evt.srcElement);
});
var doc=_7a2.document;
if(doc){
if(dojo.isIE){
doc.attachEvent("onactivate",function(evt){
if(evt.srcElement.tagName.toLowerCase()!="#document"){
dijit._onFocusNode(evt.srcElement);
}
});
doc.attachEvent("ondeactivate",function(evt){
dijit._onBlurNode(evt.srcElement);
});
}else{
doc.addEventListener("focus",function(evt){
dijit._onFocusNode(evt.target);
},true);
doc.addEventListener("blur",function(evt){
dijit._onBlurNode(evt.target);
},true);
}
}
doc=null;
},_onBlurNode:function(node){
dijit._prevFocus=dijit._curFocus;
dijit._curFocus=null;
if(dijit._justMouseDowned){
return;
}
if(dijit._clearActiveWidgetsTimer){
clearTimeout(dijit._clearActiveWidgetsTimer);
}
dijit._clearActiveWidgetsTimer=setTimeout(function(){
delete dijit._clearActiveWidgetsTimer;
dijit._setStack([]);
dijit._prevFocus=null;
},100);
},_onTouchNode:function(node){
if(dijit._clearActiveWidgetsTimer){
clearTimeout(dijit._clearActiveWidgetsTimer);
delete dijit._clearActiveWidgetsTimer;
}
var _7ab=[];
try{
while(node){
if(node.dijitPopupParent){
node=dijit.byId(node.dijitPopupParent).domNode;
}else{
if(node.tagName&&node.tagName.toLowerCase()=="body"){
if(node===dojo.body()){
break;
}
node=dijit.getDocumentWindow(node.ownerDocument).frameElement;
}else{
var id=node.getAttribute&&node.getAttribute("widgetId");
if(id){
_7ab.unshift(id);
}
node=node.parentNode;
}
}
}
}
catch(e){
}
dijit._setStack(_7ab);
},_onFocusNode:function(node){
if(!node){
return;
}
if(node.nodeType==9){
return;
}
if(node.nodeType==9){
var _7ae=dijit.getDocumentWindow(node).frameElement;
if(!_7ae){
return;
}
node=_7ae;
}
dijit._onTouchNode(node);
if(node==dijit._curFocus){
return;
}
if(dijit._curFocus){
dijit._prevFocus=dijit._curFocus;
}
dijit._curFocus=node;
dojo.publish("focusNode",[node]);
},_setStack:function(_7af){
var _7b0=dijit._activeStack;
dijit._activeStack=_7af;
for(var _7b1=0;_7b1<Math.min(_7b0.length,_7af.length);_7b1++){
if(_7b0[_7b1]!=_7af[_7b1]){
break;
}
}
for(var i=_7b0.length-1;i>=_7b1;i--){
var _7b3=dijit.byId(_7b0[i]);
if(_7b3){
_7b3._focused=false;
_7b3._hasBeenBlurred=true;
if(_7b3._onBlur){
_7b3._onBlur();
}
if(_7b3._setStateClass){
_7b3._setStateClass();
}
dojo.publish("widgetBlur",[_7b3]);
}
}
for(i=_7b1;i<_7af.length;i++){
_7b3=dijit.byId(_7af[i]);
if(_7b3){
_7b3._focused=true;
if(_7b3._onFocus){
_7b3._onFocus();
}
if(_7b3._setStateClass){
_7b3._setStateClass();
}
dojo.publish("widgetFocus",[_7b3]);
}
}
}});
dojo.addOnLoad(dijit.registerWin);
}
if(!dojo._hasResource["dijit._base.manager"]){
dojo._hasResource["dijit._base.manager"]=true;
dojo.provide("dijit._base.manager");
dojo.declare("dijit.WidgetSet",null,{constructor:function(){
this._hash={};
},add:function(_7b4){
if(this._hash[_7b4.id]){
throw new Error("Tried to register widget with id=="+_7b4.id+" but that id is already registered");
}
this._hash[_7b4.id]=_7b4;
},remove:function(id){
delete this._hash[id];
},forEach:function(func){
for(var id in this._hash){
func(this._hash[id]);
}
},filter:function(_7b8){
var res=new dijit.WidgetSet();
this.forEach(function(_7ba){
if(_7b8(_7ba)){
res.add(_7ba);
}
});
return res;
},byId:function(id){
return this._hash[id];
},byClass:function(cls){
return this.filter(function(_7bd){
return _7bd.declaredClass==cls;
});
}});
dijit.registry=new dijit.WidgetSet();
dijit._widgetTypeCtr={};
dijit.getUniqueId=function(_7be){
var id;
do{
id=_7be+"_"+(_7be in dijit._widgetTypeCtr?++dijit._widgetTypeCtr[_7be]:dijit._widgetTypeCtr[_7be]=0);
}while(dijit.byId(id));
return id;
};
if(dojo.isIE){
dojo.addOnWindowUnload(function(){
dijit.registry.forEach(function(_7c0){
_7c0.destroy();
});
});
}
dijit.byId=function(id){
return (dojo.isString(id))?dijit.registry.byId(id):id;
};
dijit.byNode=function(node){
return dijit.registry.byId(node.getAttribute("widgetId"));
};
dijit.getEnclosingWidget=function(node){
while(node){
if(node.getAttribute&&node.getAttribute("widgetId")){
return dijit.registry.byId(node.getAttribute("widgetId"));
}
node=node.parentNode;
}
return null;
};
dijit._tabElements={area:true,button:true,input:true,object:true,select:true,textarea:true};
dijit._isElementShown=function(elem){
var _7c5=dojo.style(elem);
return (_7c5.visibility!="hidden")&&(_7c5.visibility!="collapsed")&&(_7c5.display!="none")&&(dojo.attr(elem,"type")!="hidden");
};
dijit.isTabNavigable=function(elem){
if(dojo.hasAttr(elem,"disabled")){
return false;
}
var _7c7=dojo.hasAttr(elem,"tabindex");
var _7c8=dojo.attr(elem,"tabindex");
if(_7c7&&_7c8>=0){
return true;
}
var name=elem.nodeName.toLowerCase();
if(((name=="a"&&dojo.hasAttr(elem,"href"))||dijit._tabElements[name])&&(!_7c7||_7c8>=0)){
return true;
}
return false;
};
dijit._getTabNavigable=function(root){
var _7cb,last,_7cd,_7ce,_7cf,_7d0;
var _7d1=function(_7d2){
dojo.query("> *",_7d2).forEach(function(_7d3){
var _7d4=dijit._isElementShown(_7d3);
if(_7d4&&dijit.isTabNavigable(_7d3)){
var _7d5=dojo.attr(_7d3,"tabindex");
if(!dojo.hasAttr(_7d3,"tabindex")||_7d5==0){
if(!_7cb){
_7cb=_7d3;
}
last=_7d3;
}else{
if(_7d5>0){
if(!_7cd||_7d5<_7ce){
_7ce=_7d5;
_7cd=_7d3;
}
if(!_7cf||_7d5>=_7d0){
_7d0=_7d5;
_7cf=_7d3;
}
}
}
}
if(_7d4&&_7d3.nodeName.toUpperCase()!="SELECT"){
_7d1(_7d3);
}
});
};
if(dijit._isElementShown(root)){
_7d1(root);
}
return {first:_7cb,last:last,lowest:_7cd,highest:_7cf};
};
dijit.getFirstInTabbingOrder=function(root){
var _7d7=dijit._getTabNavigable(dojo.byId(root));
return _7d7.lowest?_7d7.lowest:_7d7.first;
};
dijit.getLastInTabbingOrder=function(root){
var _7d9=dijit._getTabNavigable(dojo.byId(root));
return _7d9.last?_7d9.last:_7d9.highest;
};
dijit.defaultDuration=dojo.config["defaultDuration"]||200;
}
if(!dojo._hasResource["dojo.AdapterRegistry"]){
dojo._hasResource["dojo.AdapterRegistry"]=true;
dojo.provide("dojo.AdapterRegistry");
dojo.AdapterRegistry=function(_7da){
this.pairs=[];
this.returnWrappers=_7da||false;
};
dojo.extend(dojo.AdapterRegistry,{register:function(name,_7dc,wrap,_7de,_7df){
this.pairs[((_7df)?"unshift":"push")]([name,_7dc,wrap,_7de]);
},match:function(){
for(var i=0;i<this.pairs.length;i++){
var pair=this.pairs[i];
if(pair[1].apply(this,arguments)){
if((pair[3])||(this.returnWrappers)){
return pair[2];
}else{
return pair[2].apply(this,arguments);
}
}
}
throw new Error("No match found");
},unregister:function(name){
for(var i=0;i<this.pairs.length;i++){
var pair=this.pairs[i];
if(pair[0]==name){
this.pairs.splice(i,1);
return true;
}
}
return false;
}});
}
if(!dojo._hasResource["dijit._base.place"]){
dojo._hasResource["dijit._base.place"]=true;
dojo.provide("dijit._base.place");
dijit.getViewport=function(){
var _7e5=dojo.global;
var _7e6=dojo.doc;
var w=0,h=0;
var de=_7e6.documentElement;
var dew=de.clientWidth,deh=de.clientHeight;
if(dojo.isMozilla){
var minw,minh,maxw,maxh;
var dbw=_7e6.body.clientWidth;
if(dbw>dew){
minw=dew;
maxw=dbw;
}else{
maxw=dew;
minw=dbw;
}
var dbh=_7e6.body.clientHeight;
if(dbh>deh){
minh=deh;
maxh=dbh;
}else{
maxh=deh;
minh=dbh;
}
w=(maxw>_7e5.innerWidth)?minw:maxw;
h=(maxh>_7e5.innerHeight)?minh:maxh;
}else{
if(!dojo.isOpera&&_7e5.innerWidth){
w=_7e5.innerWidth;
h=_7e5.innerHeight;
}else{
if(dojo.isIE&&de&&deh){
w=dew;
h=deh;
}else{
if(dojo.body().clientWidth){
w=dojo.body().clientWidth;
h=dojo.body().clientHeight;
}
}
}
}
var _7f2=dojo._docScroll();
return {w:w,h:h,l:_7f2.x,t:_7f2.y};
};
dijit.placeOnScreen=function(node,pos,_7f5,_7f6){
var _7f7=dojo.map(_7f5,function(_7f8){
return {corner:_7f8,pos:pos};
});
return dijit._place(node,_7f7);
};
dijit._place=function(node,_7fa,_7fb){
var view=dijit.getViewport();
if(!node.parentNode||String(node.parentNode.tagName).toLowerCase()!="body"){
dojo.body().appendChild(node);
}
var best=null;
dojo.some(_7fa,function(_7fe){
var _7ff=_7fe.corner;
var pos=_7fe.pos;
if(_7fb){
_7fb(node,_7fe.aroundCorner,_7ff);
}
var _801=node.style;
var _802=_801.display;
var _803=_801.visibility;
_801.visibility="hidden";
_801.display="";
var mb=dojo.marginBox(node);
_801.display=_802;
_801.visibility=_803;
var _805=(_7ff.charAt(1)=="L"?pos.x:Math.max(view.l,pos.x-mb.w)),_806=(_7ff.charAt(0)=="T"?pos.y:Math.max(view.t,pos.y-mb.h)),endX=(_7ff.charAt(1)=="L"?Math.min(view.l+view.w,_805+mb.w):pos.x),endY=(_7ff.charAt(0)=="T"?Math.min(view.t+view.h,_806+mb.h):pos.y),_809=endX-_805,_80a=endY-_806,_80b=(mb.w-_809)+(mb.h-_80a);
if(best==null||_80b<best.overflow){
best={corner:_7ff,aroundCorner:_7fe.aroundCorner,x:_805,y:_806,w:_809,h:_80a,overflow:_80b};
}
return !_80b;
});
node.style.left=best.x+"px";
node.style.top=best.y+"px";
if(best.overflow&&_7fb){
_7fb(node,best.aroundCorner,best.corner);
}
return best;
};
dijit.placeOnScreenAroundNode=function(node,_80d,_80e,_80f){
_80d=dojo.byId(_80d);
var _810=_80d.style.display;
_80d.style.display="";
var _811=_80d.offsetWidth;
var _812=_80d.offsetHeight;
var _813=dojo.coords(_80d,true);
_80d.style.display=_810;
return dijit._placeOnScreenAroundRect(node,_813.x,_813.y,_811,_812,_80e,_80f);
};
dijit.placeOnScreenAroundRectangle=function(node,_815,_816,_817){
return dijit._placeOnScreenAroundRect(node,_815.x,_815.y,_815.width,_815.height,_816,_817);
};
dijit._placeOnScreenAroundRect=function(node,x,y,_81b,_81c,_81d,_81e){
var _81f=[];
for(var _820 in _81d){
_81f.push({aroundCorner:_820,corner:_81d[_820],pos:{x:x+(_820.charAt(1)=="L"?0:_81b),y:y+(_820.charAt(0)=="T"?0:_81c)}});
}
return dijit._place(node,_81f,_81e);
};
dijit.placementRegistry=new dojo.AdapterRegistry();
dijit.placementRegistry.register("node",function(n,x){
return typeof x=="object"&&typeof x.offsetWidth!="undefined"&&typeof x.offsetHeight!="undefined";
},dijit.placeOnScreenAroundNode);
dijit.placementRegistry.register("rect",function(n,x){
return typeof x=="object"&&"x" in x&&"y" in x&&"width" in x&&"height" in x;
},dijit.placeOnScreenAroundRectangle);
dijit.placeOnScreenAroundElement=function(node,_826,_827,_828){
return dijit.placementRegistry.match.apply(dijit.placementRegistry,arguments);
};
}
if(!dojo._hasResource["dijit._base.window"]){
dojo._hasResource["dijit._base.window"]=true;
dojo.provide("dijit._base.window");
dijit.getDocumentWindow=function(doc){
if(dojo.isIE&&window!==document.parentWindow&&!doc._parentWindow){
doc.parentWindow.execScript("document._parentWindow = window;","Javascript");
var win=doc._parentWindow;
doc._parentWindow=null;
return win;
}
return doc._parentWindow||doc.parentWindow||doc.defaultView;
};
}
if(!dojo._hasResource["dijit._base.popup"]){
dojo._hasResource["dijit._base.popup"]=true;
dojo.provide("dijit._base.popup");
dijit.popup=new function(){
var _82b=[],_82c=1000,_82d=1;
this.prepare=function(node){
var s=node.style;
s.visibility="hidden";
s.position="absolute";
s.top="-9999px";
if(s.display=="none"){
s.display="";
}
dojo.body().appendChild(node);
};
this.open=function(args){
var _831=args.popup,_832=args.orient||{"BL":"TL","TL":"BL"},_833=args.around,id=(args.around&&args.around.id)?(args.around.id+"_dropdown"):("popup_"+_82d++);
var _835=dojo.doc.createElement("div");
dijit.setWaiRole(_835,"presentation");
_835.id=id;
_835.className="dijitPopup";
_835.style.zIndex=_82c+_82b.length;
_835.style.left=_835.style.top="0px";
_835.style.visibility="hidden";
if(args.parent){
_835.dijitPopupParent=args.parent.id;
}
dojo.body().appendChild(_835);
var s=_831.domNode.style;
s.display="";
s.visibility="";
s.position="";
_835.appendChild(_831.domNode);
var _837=new dijit.BackgroundIframe(_835);
var best=_833?dijit.placeOnScreenAroundElement(_835,_833,_832,_831.orient?dojo.hitch(_831,"orient"):null):dijit.placeOnScreen(_835,args,_832=="R"?["TR","BR","TL","BL"]:["TL","BL","TR","BR"]);
_835.style.visibility="visible";
var _839=[];
var _83a=function(){
for(var pi=_82b.length-1;pi>0&&_82b[pi].parent===_82b[pi-1].widget;pi--){
}
return _82b[pi];
};
_839.push(dojo.connect(_835,"onkeypress",this,function(evt){
if(evt.charOrCode==dojo.keys.ESCAPE&&args.onCancel){
dojo.stopEvent(evt);
args.onCancel();
}else{
if(evt.charOrCode===dojo.keys.TAB){
dojo.stopEvent(evt);
var _83d=_83a();
if(_83d&&_83d.onCancel){
_83d.onCancel();
}
}
}
}));
if(_831.onCancel){
_839.push(dojo.connect(_831,"onCancel",null,args.onCancel));
}
_839.push(dojo.connect(_831,_831.onExecute?"onExecute":"onChange",null,function(){
var _83e=_83a();
if(_83e&&_83e.onExecute){
_83e.onExecute();
}
}));
_82b.push({wrapper:_835,iframe:_837,widget:_831,parent:args.parent,onExecute:args.onExecute,onCancel:args.onCancel,onClose:args.onClose,handlers:_839});
if(_831.onOpen){
_831.onOpen(best);
}
return best;
};
this.close=function(_83f){
while(dojo.some(_82b,function(elem){
return elem.widget==_83f;
})){
var top=_82b.pop(),_842=top.wrapper,_843=top.iframe,_844=top.widget,_845=top.onClose;
if(_844.onClose){
_844.onClose();
}
dojo.forEach(top.handlers,dojo.disconnect);
if(!_844||!_844.domNode){
return;
}
this.prepare(_844.domNode);
_843.destroy();
dojo._destroyElement(_842);
if(_845){
_845();
}
}
};
}();
dijit._frames=new function(){
var _846=[];
this.pop=function(){
var _847;
if(_846.length){
_847=_846.pop();
_847.style.display="";
}else{
if(dojo.isIE){
var burl=dojo.config["dojoBlankHtmlUrl"]||(dojo.moduleUrl("dojo","resources/blank.html")+"")||"javascript:\"\"";
var html="<iframe src='"+burl+"'"+" style='position: absolute; left: 0px; top: 0px;"+"z-index: -1; filter:Alpha(Opacity=\"0\");'>";
_847=dojo.doc.createElement(html);
}else{
_847=dojo.doc.createElement("iframe");
_847.src="javascript:\"\"";
_847.className="dijitBackgroundIframe";
}
_847.tabIndex=-1;
dojo.body().appendChild(_847);
}
return _847;
};
this.push=function(_84a){
_84a.style.display="none";
if(dojo.isIE){
_84a.style.removeExpression("width");
_84a.style.removeExpression("height");
}
_846.push(_84a);
};
}();
if(dojo.isIE<7){
dojo.addOnLoad(function(){
var f=dijit._frames;
dojo.forEach([f.pop()],f.push);
});
}
dijit.BackgroundIframe=function(node){
if(!node.id){
throw new Error("no id");
}
if((dojo.isIE&&dojo.isIE<7)||(dojo.isFF&&dojo.isFF<3&&dojo.hasClass(dojo.body(),"dijit_a11y"))){
var _84d=dijit._frames.pop();
node.appendChild(_84d);
if(dojo.isIE){
_84d.style.setExpression("width",dojo._scopeName+".doc.getElementById('"+node.id+"').offsetWidth");
_84d.style.setExpression("height",dojo._scopeName+".doc.getElementById('"+node.id+"').offsetHeight");
}
this.iframe=_84d;
}
};
dojo.extend(dijit.BackgroundIframe,{destroy:function(){
if(this.iframe){
dijit._frames.push(this.iframe);
delete this.iframe;
}
}});
}
if(!dojo._hasResource["dijit._base.scroll"]){
dojo._hasResource["dijit._base.scroll"]=true;
dojo.provide("dijit._base.scroll");
dijit.scrollIntoView=function(node){
try{
node=dojo.byId(node);
var doc=node.ownerDocument||dojo.doc;
var body=doc.body||dojo.body();
var html=doc.documentElement||body.parentNode;
if((!((dojo.isFF&&dojo.isFF>=3)||dojo.isIE||dojo.isSafari)||node==body||node==html)&&(typeof node.scrollIntoView=="function")){
node.scrollIntoView(false);
return;
}
var ltr=dojo._isBodyLtr();
var _853=dojo.isIE&&dojo.isIE>=8&&!_854;
var rtl=!ltr&&!_853;
var _856=body;
var _854=doc.compatMode=="BackCompat";
if(_854){
html._offsetWidth=html._clientWidth=body._offsetWidth=body.clientWidth;
html._offsetHeight=html._clientHeight=body._offsetHeight=body.clientHeight;
}else{
if(dojo.isSafari){
body._offsetWidth=body._clientWidth=html.clientWidth;
body._offsetHeight=body._clientHeight=html.clientHeight;
}else{
_856=html;
}
html._offsetHeight=html.clientHeight;
html._offsetWidth=html.clientWidth;
}
function isFixedPosition(_857){
var ie=dojo.isIE;
return ((ie&&(ie<=6||(ie>=7&&_854)))?false:(dojo.style(_857,"position").toLowerCase()=="fixed"));
};
function addPseudoAttrs(_859){
var _85a=_859.parentNode;
var _85b=_859.offsetParent;
if(_85b==null||isFixedPosition(_859)){
_85b=html;
_85a=(_859==body)?html:null;
}
_859._offsetParent=_85b;
_859._parent=_85a;
var bp=dojo._getBorderExtents(_859);
_859._borderStart={H:(_853&&!ltr)?(bp.w-bp.l):bp.l,V:bp.t};
_859._borderSize={H:bp.w,V:bp.h};
_859._scrolledAmount={H:_859.scrollLeft,V:_859.scrollTop};
_859._offsetSize={H:_859._offsetWidth||_859.offsetWidth,V:_859._offsetHeight||_859.offsetHeight};
_859._offsetStart={H:(_853&&!ltr)?_85b.clientWidth-_859.offsetLeft-_859._offsetSize.H:_859.offsetLeft,V:_859.offsetTop};
_859._clientSize={H:_859._clientWidth||_859.clientWidth,V:_859._clientHeight||_859.clientHeight};
if(_859!=body&&_859!=html&&_859!=node){
for(var dir in _859._offsetSize){
var _85e=_859._offsetSize[dir]-_859._clientSize[dir]-_859._borderSize[dir];
var _85f=_859._clientSize[dir]>0&&_85e>0;
if(_85f){
_859._offsetSize[dir]-=_85e;
if(dojo.isIE&&rtl&&dir=="H"){
_859._offsetStart[dir]+=_85e;
}
}
}
}
};
var _860=node;
while(_860!=null){
if(isFixedPosition(_860)){
node.scrollIntoView(false);
return;
}
addPseudoAttrs(_860);
_860=_860._parent;
}
if(dojo.isIE&&node._parent){
var _861=node._offsetParent;
node._offsetStart.H+=_861._borderStart.H;
node._offsetStart.V+=_861._borderStart.V;
}
if(dojo.isIE&&dojo.isIE>=7&&_856==html&&rtl&&body._offsetStart&&body._offsetStart.H==0){
var _862=html.scrollWidth-html._offsetSize.H;
if(_862>0){
body._offsetStart.H=-_862;
}
}
if(dojo.isIE&&dojo.isIE<=6&&!_854){
html._offsetSize.H+=html._borderSize.H;
html._offsetSize.V+=html._borderSize.V;
}
if(rtl&&body._offsetStart&&_856==html&&html._scrolledAmount){
var ofs=body._offsetStart.H;
if(ofs<0){
html._scrolledAmount.H+=ofs;
body._offsetStart.H=0;
}
}
_860=node;
while(_860){
var _864=_860._parent;
if(!_864){
break;
}
if(_864.tagName=="TD"){
var _865=_864._parent._parent._parent;
if(_864!=_860._offsetParent&&_864._offsetParent!=_860._offsetParent){
_864=_865;
}
}
var _866=_860._offsetParent==_864;
for(var dir in _860._offsetStart){
var _868=dir=="H"?"V":"H";
if(rtl&&dir=="H"&&(_864!=html)&&(_864!=body)&&(dojo.isIE||dojo.isSafari)&&_864._clientSize.H>0&&_864.scrollWidth>_864._clientSize.H){
var _869=_864.scrollWidth-_864._clientSize.H;
if(_869>0){
_864._scrolledAmount.H-=_869;
}
}
if(_864._offsetParent.tagName=="TABLE"){
if(dojo.isIE){
_864._offsetStart[dir]-=_864._offsetParent._borderStart[dir];
_864._borderStart[dir]=_864._borderSize[dir]=0;
}else{
_864._offsetStart[dir]+=_864._offsetParent._borderStart[dir];
}
}
if(dojo.isIE){
_864._offsetStart[dir]+=_864._offsetParent._borderStart[dir];
}
var _86a=_860._offsetStart[dir]-_864._scrolledAmount[dir]-(_866?0:_864._offsetStart[dir])-_864._borderStart[dir];
var _86b=_86a+_860._offsetSize[dir]-_864._offsetSize[dir]+_864._borderSize[dir];
var _86c=(dir=="H")?"scrollLeft":"scrollTop";
var _86d=dir=="H"&&rtl;
var _86e=_86d?-_86b:_86a;
var _86f=_86d?-_86a:_86b;
var _870=(_86e*_86f<=0)?0:Math[(_86e<0)?"max":"min"](_86e,_86f);
if(_870!=0){
var _871=_864[_86c];
_864[_86c]+=(_86d)?-_870:_870;
var _872=_864[_86c]-_871;
}
if(_866){
_860._offsetStart[dir]+=_864._offsetStart[dir];
}
_860._offsetStart[dir]-=_864[_86c];
}
_860._parent=_864._parent;
_860._offsetParent=_864._offsetParent;
}
_864=node;
var next;
while(_864&&_864.removeAttribute){
next=_864.parentNode;
_864.removeAttribute("_offsetParent");
_864.removeAttribute("_parent");
_864=next;
}
}
catch(error){
console.error("scrollIntoView: "+error);
node.scrollIntoView(false);
}
};
}
if(!dojo._hasResource["dijit._base.sniff"]){
dojo._hasResource["dijit._base.sniff"]=true;
dojo.provide("dijit._base.sniff");
(function(){
var d=dojo;
var ie=d.isIE;
var _876=d.isOpera;
var maj=Math.floor;
var ff=d.isFF;
var _879=d.boxModel.replace(/-/,"");
var _87a={dj_ie:ie,dj_ie6:maj(ie)==6,dj_ie7:maj(ie)==7,dj_iequirks:ie&&d.isQuirks,dj_opera:_876,dj_opera8:maj(_876)==8,dj_opera9:maj(_876)==9,dj_khtml:d.isKhtml,dj_safari:d.isSafari,dj_gecko:d.isMozilla,dj_ff2:maj(ff)==2,dj_ff3:maj(ff)==3};
_87a["dj_"+_879]=true;
var html=dojo.doc.documentElement;
for(var p in _87a){
if(_87a[p]){
if(html.className){
html.className+=" "+p;
}else{
html.className=p;
}
}
}
dojo._loaders.unshift(function(){
if(!dojo._isBodyLtr()){
html.className+=" dijitRtl";
for(var p in _87a){
if(_87a[p]){
html.className+=" "+p+"-rtl";
}
}
}
});
})();
}
if(!dojo._hasResource["dijit._base.typematic"]){
dojo._hasResource["dijit._base.typematic"]=true;
dojo.provide("dijit._base.typematic");
dijit.typematic={_fireEventAndReload:function(){
this._timer=null;
this._callback(++this._count,this._node,this._evt);
this._currentTimeout=(this._currentTimeout<0)?this._initialDelay:((this._subsequentDelay>1)?this._subsequentDelay:Math.round(this._currentTimeout*this._subsequentDelay));
this._timer=setTimeout(dojo.hitch(this,"_fireEventAndReload"),this._currentTimeout);
},trigger:function(evt,_87f,node,_881,obj,_883,_884){
if(obj!=this._obj){
this.stop();
this._initialDelay=_884||500;
this._subsequentDelay=_883||0.9;
this._obj=obj;
this._evt=evt;
this._node=node;
this._currentTimeout=-1;
this._count=-1;
this._callback=dojo.hitch(_87f,_881);
this._fireEventAndReload();
}
},stop:function(){
if(this._timer){
clearTimeout(this._timer);
this._timer=null;
}
if(this._obj){
this._callback(-1,this._node,this._evt);
this._obj=null;
}
},addKeyListener:function(node,_886,_887,_888,_889,_88a){
if(_886.keyCode){
_886.charOrCode=_886.keyCode;
dojo.deprecated("keyCode attribute parameter for dijit.typematic.addKeyListener is deprecated. Use charOrCode instead.","","2.0");
}else{
if(_886.charCode){
_886.charOrCode=String.fromCharCode(_886.charCode);
dojo.deprecated("charCode attribute parameter for dijit.typematic.addKeyListener is deprecated. Use charOrCode instead.","","2.0");
}
}
return [dojo.connect(node,"onkeypress",this,function(evt){
if(evt.charOrCode==_886.charOrCode&&(_886.ctrlKey===undefined||_886.ctrlKey==evt.ctrlKey)&&(_886.altKey===undefined||_886.altKey==evt.ctrlKey)&&(_886.shiftKey===undefined||_886.shiftKey==evt.ctrlKey)){
dojo.stopEvent(evt);
dijit.typematic.trigger(_886,_887,node,_888,_886,_889,_88a);
}else{
if(dijit.typematic._obj==_886){
dijit.typematic.stop();
}
}
}),dojo.connect(node,"onkeyup",this,function(evt){
if(dijit.typematic._obj==_886){
dijit.typematic.stop();
}
})];
},addMouseListener:function(node,_88e,_88f,_890,_891){
var dc=dojo.connect;
return [dc(node,"mousedown",this,function(evt){
dojo.stopEvent(evt);
dijit.typematic.trigger(evt,_88e,node,_88f,node,_890,_891);
}),dc(node,"mouseup",this,function(evt){
dojo.stopEvent(evt);
dijit.typematic.stop();
}),dc(node,"mouseout",this,function(evt){
dojo.stopEvent(evt);
dijit.typematic.stop();
}),dc(node,"mousemove",this,function(evt){
dojo.stopEvent(evt);
}),dc(node,"dblclick",this,function(evt){
dojo.stopEvent(evt);
if(dojo.isIE){
dijit.typematic.trigger(evt,_88e,node,_88f,node,_890,_891);
setTimeout(dojo.hitch(this,dijit.typematic.stop),50);
}
})];
},addListener:function(_898,_899,_89a,_89b,_89c,_89d,_89e){
return this.addKeyListener(_899,_89a,_89b,_89c,_89d,_89e).concat(this.addMouseListener(_898,_89b,_89c,_89d,_89e));
}};
}
if(!dojo._hasResource["dijit._base.wai"]){
dojo._hasResource["dijit._base.wai"]=true;
dojo.provide("dijit._base.wai");
dijit.wai={onload:function(){
var div=dojo.doc.createElement("div");
div.id="a11yTestNode";
div.style.cssText="border: 1px solid;"+"border-color:red green;"+"position: absolute;"+"height: 5px;"+"top: -999px;"+"background-image: url(\""+(dojo.config.blankGif||dojo.moduleUrl("dojo","resources/blank.gif"))+"\");";
dojo.body().appendChild(div);
var cs=dojo.getComputedStyle(div);
if(cs){
var _8a1=cs.backgroundImage;
var _8a2=(cs.borderTopColor==cs.borderRightColor)||(_8a1!=null&&(_8a1=="none"||_8a1=="url(invalid-url:)"));
dojo[_8a2?"addClass":"removeClass"](dojo.body(),"dijit_a11y");
if(dojo.isIE){
div.outerHTML="";
}else{
dojo.body().removeChild(div);
}
}
}};
if(dojo.isIE||dojo.isMoz){
dojo._loaders.unshift(dijit.wai.onload);
}
dojo.mixin(dijit,{_XhtmlRoles:/banner|contentinfo|definition|main|navigation|search|note|secondary|seealso/,hasWaiRole:function(elem,role){
var _8a5=this.getWaiRole(elem);
if(role){
return (_8a5.indexOf(role)>-1);
}else{
return (_8a5.length>0);
}
},getWaiRole:function(elem){
return dojo.trim((dojo.attr(elem,"role")||"").replace(this._XhtmlRoles,"").replace("wairole:",""));
},setWaiRole:function(elem,role){
var _8a9=dojo.attr(elem,"role")||"";
if(dojo.isFF<3||!this._XhtmlRoles.test(_8a9)){
dojo.attr(elem,"role",dojo.isFF<3?"wairole:"+role:role);
}else{
if((" "+_8a9+" ").indexOf(" "+role+" ")<0){
var _8aa=dojo.trim(_8a9.replace(this._XhtmlRoles,""));
var _8ab=dojo.trim(_8a9.replace(_8aa,""));
dojo.attr(elem,"role",_8ab+(_8ab?" ":"")+role);
}
}
},removeWaiRole:function(elem,role){
var _8ae=dojo.attr(elem,"role");
if(!_8ae){
return;
}
if(role){
var _8af=dojo.isFF<3?"wairole:"+role:role;
var t=dojo.trim((" "+_8ae+" ").replace(" "+_8af+" "," "));
dojo.attr(elem,"role",t);
}else{
elem.removeAttribute("role");
}
},hasWaiState:function(elem,_8b2){
if(dojo.isFF<3){
return elem.hasAttributeNS("http://www.w3.org/2005/07/aaa",_8b2);
}else{
return elem.hasAttribute?elem.hasAttribute("aria-"+_8b2):!!elem.getAttribute("aria-"+_8b2);
}
},getWaiState:function(elem,_8b4){
if(dojo.isFF<3){
return elem.getAttributeNS("http://www.w3.org/2005/07/aaa",_8b4);
}else{
var _8b5=elem.getAttribute("aria-"+_8b4);
return _8b5?_8b5:"";
}
},setWaiState:function(elem,_8b7,_8b8){
if(dojo.isFF<3){
elem.setAttributeNS("http://www.w3.org/2005/07/aaa","aaa:"+_8b7,_8b8);
}else{
elem.setAttribute("aria-"+_8b7,_8b8);
}
},removeWaiState:function(elem,_8ba){
if(dojo.isFF<3){
elem.removeAttributeNS("http://www.w3.org/2005/07/aaa",_8ba);
}else{
elem.removeAttribute("aria-"+_8ba);
}
}});
}
if(!dojo._hasResource["dijit._base"]){
dojo._hasResource["dijit._base"]=true;
dojo.provide("dijit._base");
}
if(!dojo._hasResource["dijit._Widget"]){
dojo._hasResource["dijit._Widget"]=true;
dojo.provide("dijit._Widget");
dojo.require("dijit._base");
dojo.connect(dojo,"connect",function(_8bb,_8bc){
if(_8bb&&dojo.isFunction(_8bb._onConnect)){
_8bb._onConnect(_8bc);
}
});
dijit._connectOnUseEventHandler=function(_8bd){
};
dijit._lastKeyDownNode=null;
if(dojo.isIE){
dojo.doc.attachEvent("onkeydown",function(evt){
dijit._lastKeyDownNode=evt.srcElement;
});
}else{
dojo.doc.addEventListener("keydown",function(evt){
dijit._lastKeyDownNode=evt.target;
},true);
}
(function(){
var _8c0={};
var _8c1=function(dc){
if(!_8c0[dc]){
var r=[];
var _8c4;
var _8c5=dojo.getObject(dc).prototype;
for(var _8c6 in _8c5){
if(dojo.isFunction(_8c5[_8c6])&&(_8c4=_8c6.match(/^_set([a-zA-Z]*)Attr$/))&&_8c4[1]){
r.push(_8c4[1].charAt(0).toLowerCase()+_8c4[1].substr(1));
}
}
_8c0[dc]=r;
}
return _8c0[dc]||[];
};
dojo.declare("dijit._Widget",null,{id:"",lang:"",dir:"","class":"",style:"",title:"",srcNodeRef:null,domNode:null,containerNode:null,attributeMap:{id:"",dir:"",lang:"","class":"",style:"",title:""},_deferredConnects:{onClick:"",onDblClick:"",onKeyDown:"",onKeyPress:"",onKeyUp:"",onMouseMove:"",onMouseDown:"",onMouseOut:"",onMouseOver:"",onMouseLeave:"",onMouseEnter:"",onMouseUp:""},onClick:dijit._connectOnUseEventHandler,onDblClick:dijit._connectOnUseEventHandler,onKeyDown:dijit._connectOnUseEventHandler,onKeyPress:dijit._connectOnUseEventHandler,onKeyUp:dijit._connectOnUseEventHandler,onMouseDown:dijit._connectOnUseEventHandler,onMouseMove:dijit._connectOnUseEventHandler,onMouseOut:dijit._connectOnUseEventHandler,onMouseOver:dijit._connectOnUseEventHandler,onMouseLeave:dijit._connectOnUseEventHandler,onMouseEnter:dijit._connectOnUseEventHandler,onMouseUp:dijit._connectOnUseEventHandler,_blankGif:(dojo.config.blankGif||dojo.moduleUrl("dojo","resources/blank.gif")),postscript:function(_8c7,_8c8){
this.create(_8c7,_8c8);
},create:function(_8c9,_8ca){
this.srcNodeRef=dojo.byId(_8ca);
this._connects=[];
this._deferredConnects=dojo.clone(this._deferredConnects);
for(var attr in this.attributeMap){
delete this._deferredConnects[attr];
}
for(attr in this._deferredConnects){
if(this[attr]!==dijit._connectOnUseEventHandler){
delete this._deferredConnects[attr];
}
}
if(this.srcNodeRef&&(typeof this.srcNodeRef.id=="string")){
this.id=this.srcNodeRef.id;
}
if(_8c9){
this.params=_8c9;
dojo.mixin(this,_8c9);
}
this.postMixInProperties();
if(!this.id){
this.id=dijit.getUniqueId(this.declaredClass.replace(/\./g,"_"));
}
dijit.registry.add(this);
this.buildRendering();
if(this.domNode){
this._applyAttributes();
for(attr in this.params){
this._onConnect(attr);
}
}
if(this.domNode){
this.domNode.setAttribute("widgetId",this.id);
}
this.postCreate();
if(this.srcNodeRef&&!this.srcNodeRef.parentNode){
delete this.srcNodeRef;
}
this._created=true;
},_applyAttributes:function(){
var _8cc=function(attr,_8ce){
if((_8ce.params&&attr in _8ce.params)||_8ce[attr]){
_8ce.attr(attr,_8ce[attr]);
}
};
for(var attr in this.attributeMap){
_8cc(attr,this);
}
dojo.forEach(_8c1(this.declaredClass),function(a){
if(!(a in this.attributeMap)){
_8cc(a,this);
}
},this);
},postMixInProperties:function(){
},buildRendering:function(){
this.domNode=this.srcNodeRef||dojo.doc.createElement("div");
},postCreate:function(){
},startup:function(){
this._started=true;
},destroyRecursive:function(_8d1){
this.destroyDescendants(_8d1);
this.destroy(_8d1);
},destroy:function(_8d2){
this.uninitialize();
dojo.forEach(this._connects,function(_8d3){
dojo.forEach(_8d3,dojo.disconnect);
});
dojo.forEach(this._supportingWidgets||[],function(w){
if(w.destroy){
w.destroy();
}
});
this.destroyRendering(_8d2);
dijit.registry.remove(this.id);
},destroyRendering:function(_8d5){
if(this.bgIframe){
this.bgIframe.destroy(_8d5);
delete this.bgIframe;
}
if(this.domNode){
if(!_8d5){
dojo._destroyElement(this.domNode);
}
delete this.domNode;
}
if(this.srcNodeRef){
if(!_8d5){
dojo._destroyElement(this.srcNodeRef);
}
delete this.srcNodeRef;
}
},destroyDescendants:function(_8d6){
dojo.forEach(this.getDescendants(),function(_8d7){
if(_8d7.destroy){
_8d7.destroy(_8d6);
}
});
},uninitialize:function(){
return false;
},onFocus:function(){
},onBlur:function(){
},_onFocus:function(e){
this.onFocus();
},_onBlur:function(){
this.onBlur();
},_onConnect:function(_8d9){
if(_8d9 in this._deferredConnects){
var _8da=this[this._deferredConnects[_8d9]||"domNode"];
this.connect(_8da,_8d9.toLowerCase(),this[_8d9]);
delete this._deferredConnects[_8d9];
}
},_setClassAttr:function(_8db){
var _8dc=this[this.attributeMap["class"]||"domNode"];
dojo.removeClass(_8dc,this["class"]);
this["class"]=_8db;
dojo.addClass(_8dc,_8db);
},_setStyleAttr:function(_8dd){
var _8de=this[this.attributeMap["style"]||"domNode"];
if(_8de.style.cssText){
_8de.style.cssText+="; "+_8dd;
}else{
_8de.style.cssText=_8dd;
}
this["style"]=_8dd;
},setAttribute:function(attr,_8e0){
dojo.deprecated(this.declaredClass+"::setAttribute() is deprecated. Use attr() instead.","","2.0");
this.attr(attr,_8e0);
},_attrToDom:function(attr,_8e2){
var _8e3=this.attributeMap[attr];
dojo.forEach(dojo.isArray(_8e3)?_8e3:[_8e3],function(_8e4){
var _8e5=this[_8e4.node||_8e4||"domNode"];
var type=_8e4.type||"attribute";
switch(type){
case "attribute":
if(dojo.isFunction(_8e2)){
_8e2=dojo.hitch(this,_8e2);
}
if(/^on[A-Z][a-zA-Z]*$/.test(attr)){
attr=attr.toLowerCase();
}
dojo.attr(_8e5,attr,_8e2);
break;
case "innerHTML":
_8e5.innerHTML=_8e2;
break;
case "class":
dojo.removeClass(_8e5,this[attr]);
dojo.addClass(_8e5,_8e2);
break;
}
},this);
this[attr]=_8e2;
},attr:function(name,_8e8){
var args=arguments.length;
if(args==1&&!dojo.isString(name)){
for(var x in name){
this.attr(x,name[x]);
}
return this;
}
var _8eb=this._getAttrNames(name);
if(args==2){
if(this[_8eb.s]){
return this[_8eb.s](_8e8)||this;
}else{
if(name in this.attributeMap){
this._attrToDom(name,_8e8);
}
this[name]=_8e8;
}
return this;
}else{
if(this[_8eb.g]){
return this[_8eb.g]();
}else{
return this[name];
}
}
},_attrPairNames:{},_getAttrNames:function(name){
var apn=this._attrPairNames;
if(apn[name]){
return apn[name];
}
var uc=name.charAt(0).toUpperCase()+name.substr(1);
return apn[name]={n:name+"Node",s:"_set"+uc+"Attr",g:"_get"+uc+"Attr"};
},toString:function(){
return "[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]";
},getDescendants:function(){
if(this.containerNode){
var list=dojo.query("[widgetId]",this.containerNode);
return list.map(dijit.byNode);
}else{
return [];
}
},nodesWithKeyClick:["input","button"],connect:function(obj,_8f1,_8f2){
var d=dojo;
var dc=d.connect;
var _8f5=[];
if(_8f1=="ondijitclick"){
if(!this.nodesWithKeyClick[obj.tagName.toLowerCase()]){
var m=d.hitch(this,_8f2);
_8f5.push(dc(obj,"onkeydown",this,function(e){
if((e.keyCode==d.keys.ENTER||e.keyCode==d.keys.SPACE)&&!e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey){
dijit._lastKeyDownNode=e.target;
d.stopEvent(e);
}
}),dc(obj,"onkeyup",this,function(e){
if((e.keyCode==d.keys.ENTER||e.keyCode==d.keys.SPACE)&&e.target===dijit._lastKeyDownNode&&!e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey){
dijit._lastKeyDownNode=null;
return m(e);
}
}));
}
_8f1="onclick";
}
_8f5.push(dc(obj,_8f1,this,_8f2));
this._connects.push(_8f5);
return _8f5;
},disconnect:function(_8f9){
for(var i=0;i<this._connects.length;i++){
if(this._connects[i]==_8f9){
dojo.forEach(_8f9,dojo.disconnect);
this._connects.splice(i,1);
return;
}
}
},isLeftToRight:function(){
return dojo._isBodyLtr();
},isFocusable:function(){
return this.focus&&(dojo.style(this.domNode,"display")!="none");
},placeAt:function(_8fb,_8fc){
if(_8fb["declaredClass"]&&_8fb["addChild"]){
_8fb.addChild(this,_8fc);
}else{
dojo.place(this.domNode,_8fb,_8fc);
}
return this;
}});
})();
}
if(!dojo._hasResource["dijit._Templated"]){
dojo._hasResource["dijit._Templated"]=true;
dojo.provide("dijit._Templated");
dojo.declare("dijit._Templated",null,{templateNode:null,templateString:null,templatePath:null,widgetsInTemplate:false,_skipNodeCache:false,_stringRepl:function(tmpl){
var _8fe=this.declaredClass,_8ff=this;
return dojo.string.substitute(tmpl,this,function(_900,key){
if(key.charAt(0)=="!"){
_900=_8ff[key.substr(1)];
}
if(typeof _900=="undefined"){
throw new Error(_8fe+" template:"+key);
}
if(_900==null){
return "";
}
return key.charAt(0)=="!"?_900:_900.toString().replace(/"/g,"&quot;");
},this);
},buildRendering:function(){
var _902=dijit._Templated.getCachedTemplate(this.templatePath,this.templateString,this._skipNodeCache);
var node;
if(dojo.isString(_902)){
node=dijit._Templated._createNodesFromText(this._stringRepl(_902))[0];
}else{
node=_902.cloneNode(true);
}
this.domNode=node;
this._attachTemplateNodes(node);
var _904=this.srcNodeRef;
if(_904&&_904.parentNode){
_904.parentNode.replaceChild(node,_904);
}
if(this.widgetsInTemplate){
var cw=(this._supportingWidgets=dojo.parser.parse(node));
this._attachTemplateNodes(cw,function(n,p){
return n[p];
});
}
this._fillContent(_904);
},_fillContent:function(_908){
var dest=this.containerNode;
if(_908&&dest){
while(_908.hasChildNodes()){
dest.appendChild(_908.firstChild);
}
}
},_attachTemplateNodes:function(_90a,_90b){
_90b=_90b||function(n,p){
return n.getAttribute(p);
};
var _90e=dojo.isArray(_90a)?_90a:(_90a.all||_90a.getElementsByTagName("*"));
var x=dojo.isArray(_90a)?0:-1;
var _910={};
for(;x<_90e.length;x++){
var _911=(x==-1)?_90a:_90e[x];
if(this.widgetsInTemplate&&_90b(_911,"dojoType")){
continue;
}
var _912=_90b(_911,"dojoAttachPoint");
if(_912){
var _913,_914=_912.split(/\s*,\s*/);
while((_913=_914.shift())){
if(dojo.isArray(this[_913])){
this[_913].push(_911);
}else{
this[_913]=_911;
}
}
}
var _915=_90b(_911,"dojoAttachEvent");
if(_915){
var _916,_917=_915.split(/\s*,\s*/);
var trim=dojo.trim;
while((_916=_917.shift())){
if(_916){
var _919=null;
if(_916.indexOf(":")!=-1){
var _91a=_916.split(":");
_916=trim(_91a[0]);
_919=trim(_91a[1]);
}else{
_916=trim(_916);
}
if(!_919){
_919=_916;
}
this.connect(_911,_916,_919);
}
}
}
var role=_90b(_911,"waiRole");
if(role){
dijit.setWaiRole(_911,role);
}
var _91c=_90b(_911,"waiState");
if(_91c){
dojo.forEach(_91c.split(/\s*,\s*/),function(_91d){
if(_91d.indexOf("-")!=-1){
var pair=_91d.split("-");
dijit.setWaiState(_911,pair[0],pair[1]);
}
});
}
}
}});
dijit._Templated._templateCache={};
dijit._Templated.getCachedTemplate=function(_91f,_920,_921){
var _922=dijit._Templated._templateCache;
var key=_920||_91f;
var _924=_922[key];
if(_924){
if(!_924.ownerDocument||_924.ownerDocument==dojo.doc){
return _924;
}
dojo._destroyElement(_924);
}
if(!_920){
_920=dijit._Templated._sanitizeTemplateString(dojo._getText(_91f));
}
_920=dojo.string.trim(_920);
if(_921||_920.match(/\$\{([^\}]+)\}/g)){
return (_922[key]=_920);
}else{
return (_922[key]=dijit._Templated._createNodesFromText(_920)[0]);
}
};
dijit._Templated._sanitizeTemplateString=function(_925){
if(_925){
_925=_925.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");
var _926=_925.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);
if(_926){
_925=_926[1];
}
}else{
_925="";
}
return _925;
};
if(dojo.isIE){
dojo.addOnWindowUnload(function(){
var _927=dijit._Templated._templateCache;
for(var key in _927){
var _929=_927[key];
if(!isNaN(_929.nodeType)){
dojo._destroyElement(_929);
}
delete _927[key];
}
});
}
(function(){
var _92a={cell:{re:/^<t[dh][\s\r\n>]/i,pre:"<table><tbody><tr>",post:"</tr></tbody></table>"},row:{re:/^<tr[\s\r\n>]/i,pre:"<table><tbody>",post:"</tbody></table>"},section:{re:/^<(thead|tbody|tfoot)[\s\r\n>]/i,pre:"<table>",post:"</table>"}};
var tn;
dijit._Templated._createNodesFromText=function(text){
if(tn&&tn.ownerDocument!=dojo.doc){
dojo._destroyElement(tn);
tn=undefined;
}
if(!tn){
tn=dojo.doc.createElement("div");
tn.style.display="none";
dojo.body().appendChild(tn);
}
var _92d="none";
var _92e=text.replace(/^\s+/,"");
for(var type in _92a){
var map=_92a[type];
if(map.re.test(_92e)){
_92d=type;
text=map.pre+text+map.post;
break;
}
}
tn.innerHTML=text;
if(tn.normalize){
tn.normalize();
}
var tag={cell:"tr",row:"tbody",section:"table"}[_92d];
var _932=(typeof tag!="undefined")?tn.getElementsByTagName(tag)[0]:tn;
var _933=[];
while(_932.firstChild){
_933.push(_932.removeChild(_932.firstChild));
}
tn.innerHTML="";
return _933;
};
})();
dojo.extend(dijit._Widget,{dojoAttachEvent:"",dojoAttachPoint:"",waiRole:"",waiState:""});
}
if(!dojo._hasResource["dijit._Container"]){
dojo._hasResource["dijit._Container"]=true;
dojo.provide("dijit._Container");
dojo.declare("dijit._Contained",null,{getParent:function(){
for(var p=this.domNode.parentNode;p;p=p.parentNode){
var id=p.getAttribute&&p.getAttribute("widgetId");
if(id){
var _936=dijit.byId(id);
return _936.isContainer?_936:null;
}
}
return null;
},_getSibling:function(_937){
var node=this.domNode;
do{
node=node[_937+"Sibling"];
}while(node&&node.nodeType!=1);
if(!node){
return null;
}
var id=node.getAttribute("widgetId");
return dijit.byId(id);
},getPreviousSibling:function(){
return this._getSibling("previous");
},getNextSibling:function(){
return this._getSibling("next");
},getIndexInParent:function(){
var p=this.getParent();
if(!p||!p.getIndexOfChild){
return -1;
}
return p.getIndexOfChild(this);
}});
dojo.declare("dijit._Container",null,{isContainer:true,buildRendering:function(){
this.inherited(arguments);
if(!this.containerNode){
this.containerNode=this.domNode;
}
},addChild:function(_93b,_93c){
var _93d=this.containerNode;
if(_93c&&typeof _93c=="number"){
var _93e=dojo.query("> [widgetId]",_93d);
if(_93e&&_93e.length>=_93c){
_93d=_93e[_93c-1];
_93c="after";
}
}
dojo.place(_93b.domNode,_93d,_93c);
if(this._started&&!_93b._started){
_93b.startup();
}
},removeChild:function(_93f){
if(typeof _93f=="number"&&_93f>0){
_93f=this.getChildren()[_93f];
}
if(!_93f||!_93f.domNode){
return;
}
var node=_93f.domNode;
node.parentNode.removeChild(node);
},_nextElement:function(node){
do{
node=node.nextSibling;
}while(node&&node.nodeType!=1);
return node;
},_firstElement:function(node){
node=node.firstChild;
if(node&&node.nodeType!=1){
node=this._nextElement(node);
}
return node;
},getChildren:function(){
return dojo.query("> [widgetId]",this.containerNode).map(dijit.byNode);
},hasChildren:function(){
return !!this._firstElement(this.containerNode);
},destroyDescendants:function(_943){
dojo.forEach(this.getChildren(),function(_944){
_944.destroyRecursive(_943);
});
},_getSiblingOfChild:function(_945,dir){
var node=_945.domNode;
var _948=(dir>0?"nextSibling":"previousSibling");
do{
node=node[_948];
}while(node&&(node.nodeType!=1||!dijit.byNode(node)));
return node?dijit.byNode(node):null;
},getIndexOfChild:function(_949){
var _94a=this.getChildren();
for(var i=0,c;c=_94a[i];i++){
if(c==_949){
return i;
}
}
return -1;
}});
dojo.declare("dijit._KeyNavContainer",[dijit._Container],{_keyNavCodes:{},connectKeyNavHandlers:function(_94d,_94e){
var _94f=this._keyNavCodes={};
var prev=dojo.hitch(this,this.focusPrev);
var next=dojo.hitch(this,this.focusNext);
dojo.forEach(_94d,function(code){
_94f[code]=prev;
});
dojo.forEach(_94e,function(code){
_94f[code]=next;
});
this.connect(this.domNode,"onkeypress","_onContainerKeypress");
this.connect(this.domNode,"onfocus","_onContainerFocus");
},startupKeyNavChildren:function(){
dojo.forEach(this.getChildren(),dojo.hitch(this,"_startupChild"));
},addChild:function(_954,_955){
dijit._KeyNavContainer.superclass.addChild.apply(this,arguments);
this._startupChild(_954);
},focus:function(){
this.focusFirstChild();
},focusFirstChild:function(){
this.focusChild(this._getFirstFocusableChild());
},focusNext:function(){
if(this.focusedChild&&this.focusedChild.hasNextFocalNode&&this.focusedChild.hasNextFocalNode()){
this.focusedChild.focusNext();
return;
}
var _956=this._getNextFocusableChild(this.focusedChild,1);
if(_956.getFocalNodes){
this.focusChild(_956,_956.getFocalNodes()[0]);
}else{
this.focusChild(_956);
}
},focusPrev:function(){
if(this.focusedChild&&this.focusedChild.hasPrevFocalNode&&this.focusedChild.hasPrevFocalNode()){
this.focusedChild.focusPrev();
return;
}
var _957=this._getNextFocusableChild(this.focusedChild,-1);
if(_957.getFocalNodes){
var _958=_957.getFocalNodes();
this.focusChild(_957,_958[_958.length-1]);
}else{
this.focusChild(_957);
}
},focusChild:function(_959,node){
if(_959){
if(this.focusedChild&&_959!==this.focusedChild){
this._onChildBlur(this.focusedChild);
}
this.focusedChild=_959;
if(node&&_959.focusFocalNode){
_959.focusFocalNode(node);
}else{
_959.focus();
}
}
},_startupChild:function(_95b){
if(_95b.getFocalNodes){
dojo.forEach(_95b.getFocalNodes(),function(node){
dojo.attr(node,"tabindex",-1);
this._connectNode(node);
},this);
}else{
var node=_95b.focusNode||_95b.domNode;
if(_95b.isFocusable && _95b.isFocusable()){
dojo.attr(node,"tabindex",-1);
}
this._connectNode(node);
}
},_connectNode:function(node){
this.connect(node,"onfocus","_onNodeFocus");
this.connect(node,"onblur","_onNodeBlur");
},_onContainerFocus:function(evt){
if(evt.target===this.domNode){
this.focusFirstChild();
}
},_onContainerKeypress:function(evt){
if(evt.ctrlKey||evt.altKey){
return;
}
var func=this._keyNavCodes[evt.charOrCode];
if(func){
func();
dojo.stopEvent(evt);
}
},_onNodeFocus:function(evt){
dojo.attr(this.domNode,"tabindex",-1);
var _963=dijit.getEnclosingWidget(evt.target);
if(_963&&_963.isFocusable()){
this.focusedChild=_963;
}
dojo.stopEvent(evt);
},_onNodeBlur:function(evt){
if(this.tabIndex){
dojo.attr(this.domNode,"tabindex",this.tabIndex);
}
dojo.stopEvent(evt);
},_onChildBlur:function(_965){
},_getFirstFocusableChild:function(){
return this._getNextFocusableChild(null,1);
},_getNextFocusableChild:function(_966,dir){
if(_966){
_966=this._getSiblingOfChild(_966,dir);
}
var _968=this.getChildren();
for(var i=0;i<_968.length;i++){
if(!_966){
_966=_968[(dir>0)?0:(_968.length-1)];
}
if(_966.isFocusable()){
return _966;
}
_966=this._getSiblingOfChild(_966,dir);
}
return null;
}});
}
if(!dojo._hasResource["dijit.layout._LayoutWidget"]){
dojo._hasResource["dijit.layout._LayoutWidget"]=true;
dojo.provide("dijit.layout._LayoutWidget");
dojo.declare("dijit.layout._LayoutWidget",[dijit._Widget,dijit._Container,dijit._Contained],{baseClass:"dijitLayoutContainer",isLayoutContainer:true,postCreate:function(){
dojo.addClass(this.domNode,"dijitContainer");
dojo.addClass(this.domNode,this.baseClass);
},startup:function(){
if(this._started){
return;
}
dojo.forEach(this.getChildren(),function(_96a){
_96a.startup();
});
if(!this.getParent||!this.getParent()){
this.resize();
this.connect(dojo.global,"onresize","resize");
}
this.inherited(arguments);
},resize:function(_96b,_96c){
var node=this.domNode;
if(_96b){
dojo.marginBox(node,_96b);
if(_96b.t){
node.style.top=_96b.t+"px";
}
if(_96b.l){
node.style.left=_96b.l+"px";
}
}
var mb=_96c||{};
dojo.mixin(mb,_96b||{});
if(!("h" in mb)||!("w" in mb)){
mb=dojo.mixin(dojo.marginBox(node),mb);
}
var cs=dojo.getComputedStyle(node);
var me=dojo._getMarginExtents(node,cs);
var be=dojo._getBorderExtents(node,cs);
var bb=this._borderBox={w:mb.w-(me.w+be.w),h:mb.h-(me.h+be.h)};
var pe=dojo._getPadExtents(node,cs);
this._contentBox={l:dojo._toPixelValue(node,cs.paddingLeft),t:dojo._toPixelValue(node,cs.paddingTop),w:bb.w-pe.w,h:bb.h-pe.h};
this.layout();
},layout:function(){
},_setupChild:function(_974){
if(_974.baseClass){
dojo.addClass(_974.domNode,this.baseClass+"-"+_974.baseClass);
}
},addChild:function(_975,_976){
this.inherited(arguments);
if(this._started){
this._setupChild(_975);
}
},removeChild:function(_977){
if(_977.baseClass){
dojo.removeClass(_977.domNode,this.baseClass+"-"+_977.baseClass);
}
this.inherited(arguments);
}});
dijit.layout.marginBox2contentBox=function(node,mb){
var cs=dojo.getComputedStyle(node);
var me=dojo._getMarginExtents(node,cs);
var pb=dojo._getPadBorderExtents(node,cs);
return {l:dojo._toPixelValue(node,cs.paddingLeft),t:dojo._toPixelValue(node,cs.paddingTop),w:mb.w-(me.w+pb.w),h:mb.h-(me.h+pb.h)};
};
(function(){
var _97d=function(word){
return word.substring(0,1).toUpperCase()+word.substring(1);
};
var size=function(_980,dim){
_980.resize?_980.resize(dim):dojo.marginBox(_980.domNode,dim);
dojo.mixin(_980,dojo.marginBox(_980.domNode));
dojo.mixin(_980,dim);
};
dijit.layout.layoutChildren=function(_982,dim,_984){
dim=dojo.mixin({},dim);
dojo.addClass(_982,"dijitLayoutContainer");
_984=dojo.filter(_984,function(item){
return item.layoutAlign!="client";
}).concat(dojo.filter(_984,function(item){
return item.layoutAlign=="client";
}));
dojo.forEach(_984,function(_987){
var elm=_987.domNode,pos=_987.layoutAlign;
var _98a=elm.style;
_98a.left=dim.l+"px";
_98a.top=dim.t+"px";
_98a.bottom=_98a.right="auto";
dojo.addClass(elm,"dijitAlign"+_97d(pos));
if(pos=="top"||pos=="bottom"){
size(_987,{w:dim.w});
dim.h-=_987.h;
if(pos=="top"){
dim.t+=_987.h;
}else{
_98a.top=dim.t+dim.h+"px";
}
}else{
if(pos=="left"||pos=="right"){
size(_987,{h:dim.h});
dim.w-=_987.w;
if(pos=="left"){
dim.l+=_987.w;
}else{
_98a.left=dim.l+dim.w+"px";
}
}else{
if(pos=="client"){
size(_987,dim);
}
}
}
});
};
})();
}
if(!dojo._hasResource["dojo.html"]){
dojo._hasResource["dojo.html"]=true;
dojo.provide("dojo.html");
(function(){
var _98b=0;
dojo.html._secureForInnerHtml=function(cont){
return cont.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,"");
};
dojo.html._emptyNode=function(node){
while(node.firstChild){
dojo._destroyElement(node.firstChild);
}
};
dojo.html._setNodeContent=function(node,cont,_990){
if(_990){
dojo.html._emptyNode(node);
}
if(typeof cont=="string"){
var pre="",post="",walk=0,name=node.nodeName.toLowerCase();
switch(name){
case "tr":
pre="<tr>";
post="</tr>";
walk+=1;
case "tbody":
case "thead":
pre="<tbody>"+pre;
post+="</tbody>";
walk+=1;
case "table":
pre="<table>"+pre;
post+="</table>";
walk+=1;
break;
}
if(walk){
var n=node.ownerDocument.createElement("div");
n.innerHTML=pre+cont+post;
do{
n=n.firstChild;
}while(--walk);
dojo.forEach(n.childNodes,function(n){
node.appendChild(n.cloneNode(true));
});
}else{
node.innerHTML=cont;
}
}else{
if(cont.nodeType){
node.appendChild(cont);
}else{
dojo.forEach(cont,function(n){
node.appendChild(n.cloneNode(true));
});
}
}
return node;
};
dojo.declare("dojo.html._ContentSetter",null,{node:"",content:"",id:"",cleanContent:false,extractContent:false,parseContent:false,constructor:function(_998,node){
dojo.mixin(this,_998||{});
node=this.node=dojo.byId(this.node||node);
if(!this.id){
this.id=["Setter",(node)?node.id||node.tagName:"",_98b++].join("_");
}
if(!(this.node||node)){
new Error(this.declaredClass+": no node provided to "+this.id);
}
},set:function(cont,_99b){
if(undefined!==cont){
this.content=cont;
}
if(_99b){
this._mixin(_99b);
}
this.onBegin();
this.setContent();
this.onEnd();
return this.node;
},setContent:function(){
var node=this.node;
if(!node){
console.error("setContent given no node");
}
try{
node=dojo.html._setNodeContent(node,this.content);
}
catch(e){
var _99d=this.onContentError(e);
try{
node.innerHTML=_99d;
}
catch(e){
console.error("Fatal "+this.declaredClass+".setContent could not change content due to "+e.message,e);
}
}
this.node=node;
},empty:function(){
if(this.parseResults&&this.parseResults.length){
dojo.forEach(this.parseResults,function(w){
if(w.destroy){
w.destroy();
}
});
delete this.parseResults;
}
dojo.html._emptyNode(this.node);
},onBegin:function(){
var cont=this.content;
if(dojo.isString(cont)){
if(this.cleanContent){
cont=dojo.html._secureForInnerHtml(cont);
}
if(this.extractContent){
var _9a0=cont.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);
if(_9a0){
cont=_9a0[1];
}
}
}
this.empty();
this.content=cont;
return this.node;
},onEnd:function(){
if(this.parseContent){
this._parse();
}
return this.node;
},tearDown:function(){
delete this.parseResults;
delete this.node;
delete this.content;
},onContentError:function(err){
return "Error occured setting content: "+err;
},_mixin:function(_9a2){
var _9a3={},key;
for(key in _9a2){
if(key in _9a3){
continue;
}
this[key]=_9a2[key];
}
},_parse:function(){
var _9a5=this.node;
try{
this.parseResults=dojo.parser.parse(_9a5,true);
}
catch(e){
this._onError("Content",e,"Error parsing in _ContentSetter#"+this.id);
}
},_onError:function(type,err,_9a8){
var _9a9=this["on"+type+"Error"].call(this,err);
if(_9a8){
console.error(_9a8,err);
}else{
if(_9a9){
dojo.html._setNodeContent(this.node,_9a9,true);
}
}
}});
dojo.html.set=function(node,cont,_9ac){
if(undefined==cont){
console.warn("dojo.html.set: no cont argument provided, using empty string");
cont="";
}
if(!_9ac){
return dojo.html._setNodeContent(node,cont,true);
}else{
var op=new dojo.html._ContentSetter(dojo.mixin(_9ac,{content:cont,node:node}));
return op.set();
}
};
})();
}
if(!dojo._hasResource["dijit.layout.ContentPane"]){
dojo._hasResource["dijit.layout.ContentPane"]=true;
dojo.provide("dijit.layout.ContentPane");
dojo.declare("dijit.layout.ContentPane",dijit._Widget,{href:"",extractContent:false,parseOnLoad:true,preventCache:false,preload:false,refreshOnShow:false,loadingMessage:"<span class='dijitContentPaneLoading'>${loadingState}</span>",errorMessage:"<span class='dijitContentPaneError'>${errorState}</span>",isLoaded:false,baseClass:"dijitContentPane",doLayout:true,_isRealContent:true,postMixInProperties:function(){
this.inherited(arguments);
var _9ae=dojo.i18n.getLocalization("dijit","loading",this.lang);
this.loadingMessage=dojo.string.substitute(this.loadingMessage,_9ae);
this.errorMessage=dojo.string.substitute(this.errorMessage,_9ae);
},buildRendering:function(){
this.inherited(arguments);
if(!this.containerNode){
this.containerNode=this.domNode;
}
},postCreate:function(){
this.domNode.title="";
if(!dijit.hasWaiRole(this.domNode)){
dijit.setWaiRole(this.domNode,"group");
}
dojo.addClass(this.domNode,this.baseClass);
},startup:function(){
if(this._started){
return;
}
if(this.doLayout!="false"&&this.doLayout!==false){
this._checkIfSingleChild();
if(this._singleChild){
this._singleChild.startup();
}
}
this._loadCheck();
this.inherited(arguments);
},_checkIfSingleChild:function(){
var _9af=dojo.query(">",this.containerNode),_9b0=_9af.filter(function(node){
return dojo.hasAttr(node,"dojoType")||dojo.hasAttr(node,"widgetId");
}),_9b2=dojo.filter(_9b0.map(dijit.byNode),function(_9b3){
return _9b3&&_9b3.domNode&&_9b3.resize;
});
if(_9af.length==_9b0.length&&_9b2.length==1){
this.isContainer=true;
this._singleChild=_9b2[0];
}else{
delete this.isContainer;
delete this._singleChild;
}
},refresh:function(){
return this._prepareLoad(true);
},setHref:function(href){
dojo.deprecated("dijit.layout.ContentPane.setHref() is deprecated.\tUse attr('href', ...) instead.","","2.0");
return this.attr("href",href);
},_setHrefAttr:function(href){
this.href=href;
if(this._created){
return this._prepareLoad();
}
},setContent:function(data){
dojo.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use attr('content', ...) instead.","","2.0");
this.attr("content",data);
},_setContentAttr:function(data){
this.href="";
this.cancel();
this._setContent(data||"");
this._isDownloaded=false;
if(this.doLayout!="false"&&this.doLayout!==false){
this._checkIfSingleChild();
if(this._singleChild&&this._singleChild.resize){
this._singleChild.startup();
var cb=this._contentBox||dojo.contentBox(this.containerNode);
this._singleChild.resize({w:cb.w,h:cb.h});
}
}
},_getContentAttr:function(){
return this.containerNode.innerHTML;
},cancel:function(){
if(this._xhrDfd&&(this._xhrDfd.fired==-1)){
this._xhrDfd.cancel();
}
delete this._xhrDfd;
},destroyRecursive:function(_9b9){
if(this._beingDestroyed){
return;
}
this._beingDestroyed=true;
this.inherited(arguments);
},resize:function(size){
dojo.marginBox(this.domNode,size);
var node=this.containerNode,mb=dojo.mixin(dojo.marginBox(node),size||{});
var cb=this._contentBox=dijit.layout.marginBox2contentBox(node,mb);
if(this._singleChild&&this._singleChild.resize){
this._singleChild.resize({w:cb.w,h:cb.h});
}
},_prepareLoad:function(_9be){
this.cancel();
this.isLoaded=false;
this._loadCheck(_9be);
},_isShown:function(){
if("open" in this){
return this.open;
}else{
var node=this.domNode;
return (node.style.display!="none")&&(node.style.visibility!="hidden");
}
},_loadCheck:function(_9c0){
var _9c1=this._isShown();
if(this.href&&(_9c0||(this.preload&&!this.isLoaded&&!this._xhrDfd)||(this.refreshOnShow&&_9c1&&!this._xhrDfd)||(!this.isLoaded&&_9c1&&!this._xhrDfd))){
this._downloadExternalContent();
}
},_downloadExternalContent:function(){
this._setContent(this.onDownloadStart(),true);
var self=this;
var _9c3={preventCache:(this.preventCache||this.refreshOnShow),url:this.href,handleAs:"text"};
if(dojo.isObject(this.ioArgs)){
dojo.mixin(_9c3,this.ioArgs);
}
var hand=this._xhrDfd=(this.ioMethod||dojo.xhrGet)(_9c3);
hand.addCallback(function(html){
try{
self._isDownloaded=true;
self._setContent(html,false);
self.onDownloadEnd();
}
catch(err){
self._onError("Content",err);
}
delete self._xhrDfd;
return html;
});
hand.addErrback(function(err){
if(!hand.cancelled){
self._onError("Download",err);
}
delete self._xhrDfd;
return err;
});
},_onLoadHandler:function(data){
this.isLoaded=true;
try{
this.onLoad(data);
}
catch(e){
console.error("Error "+this.widgetId+" running custom onLoad code");
}
},_onUnloadHandler:function(){
this.isLoaded=false;
try{
this.onUnload();
}
catch(e){
console.error("Error "+this.widgetId+" running custom onUnload code");
}
},destroyDescendants:function(){
if(this._isRealContent){
this._onUnloadHandler();
}
var _9c8=this._contentSetter;
if(_9c8){
_9c8.empty();
}else{
this.inherited(arguments);
dojo.html._emptyNode(this.containerNode);
}
},_setContent:function(cont,_9ca){
this.destroyDescendants();
this._isRealContent=!_9ca;
var _9cb=this._contentSetter;
if(!(_9cb&&_9cb instanceof dojo.html._ContentSetter)){
_9cb=this._contentSetter=new dojo.html._ContentSetter({node:this.containerNode,_onError:dojo.hitch(this,this._onError),onContentError:dojo.hitch(this,function(e){
var _9cd=this.onContentError(e);
try{
this.containerNode.innerHTML=_9cd;
}
catch(e){
console.error("Fatal "+this.id+" could not change content due to "+e.message,e);
}
})});
}
var _9ce=dojo.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:this.parseOnLoad},this._contentSetterParams||{});
dojo.mixin(_9cb,_9ce);
_9cb.set((dojo.isObject(cont)&&cont.domNode)?cont.domNode:cont);
delete this._contentSetterParams;
if(!_9ca){
this._onLoadHandler(cont);
}
},_onError:function(type,err,_9d1){
var _9d2=this["on"+type+"Error"].call(this,err);
if(_9d1){
console.error(_9d1,err);
}else{
if(_9d2){
this._setContent(_9d2,true);
}
}
},_createSubWidgets:function(){
try{
dojo.parser.parse(this.containerNode,true);
}
catch(e){
this._onError("Content",e,"Couldn't create widgets in "+this.id+(this.href?" from "+this.href:""));
}
},onLoad:function(data){
},onUnload:function(){
},onDownloadStart:function(){
return this.loadingMessage;
},onContentError:function(_9d4){
},onDownloadError:function(_9d5){
return this.errorMessage;
},onDownloadEnd:function(){
}});
}
if(!dojo._hasResource["dijit.form.Form"]){
dojo._hasResource["dijit.form.Form"]=true;
dojo.provide("dijit.form.Form");
dojo.declare("dijit.form._FormMixin",null,{reset:function(){
dojo.forEach(this.getDescendants(),function(_9d6){
if(_9d6.reset){
_9d6.reset();
}
});
},validate:function(){
var _9d7=false;
return dojo.every(dojo.map(this.getDescendants(),function(_9d8){
_9d8._hasBeenBlurred=true;
var _9d9=_9d8.disabled||!_9d8.validate||_9d8.validate();
if(!_9d9&&!_9d7){
dijit.scrollIntoView(_9d8.containerNode||_9d8.domNode);
_9d8.focus();
_9d7=true;
}
return _9d9;
}),function(item){
return item;
});
},setValues:function(val){
dojo.deprecated(this.declaredClass+"::setValues() is deprecated. Use attr('value', val) instead.","","2.0");
return this.attr("value",val);
},_setValueAttr:function(obj){
var map={};
dojo.forEach(this.getDescendants(),function(_9de){
if(!_9de.name){
return;
}
var _9df=map[_9de.name]||(map[_9de.name]=[]);
_9df.push(_9de);
});
for(var name in map){
if(!map.hasOwnProperty(name)){
continue;
}
var _9e1=map[name],_9e2=dojo.getObject(name,false,obj);
if(_9e2===undefined){
continue;
}
if(!dojo.isArray(_9e2)){
_9e2=[_9e2];
}
if(typeof _9e1[0].checked=="boolean"){
dojo.forEach(_9e1,function(w,i){
w.attr("value",dojo.indexOf(_9e2,w.value)!=-1);
});
}else{
if(_9e1[0]._multiValue){
_9e1[0].attr("value",_9e2);
}else{
dojo.forEach(_9e1,function(w,i){
w.attr("value",_9e2[i]);
});
}
}
}
},getValues:function(){
dojo.deprecated(this.declaredClass+"::getValues() is deprecated. Use attr('value') instead.","","2.0");
return this.attr("value");
},_getValueAttr:function(){
var obj={};
dojo.forEach(this.getDescendants(),function(_9e8){
var name=_9e8.name;
if(!name||_9e8.disabled){
return;
}
var _9ea=_9e8.attr("value");
if(typeof _9e8.checked=="boolean"){
if(/Radio/.test(_9e8.declaredClass)){
if(_9ea!==false){
dojo.setObject(name,_9ea,obj);
}
}else{
var ary=dojo.getObject(name,false,obj);
if(!ary){
ary=[];
dojo.setObject(name,ary,obj);
}
if(_9ea!==false){
ary.push(_9ea);
}
}
}else{
dojo.setObject(name,_9ea,obj);
}
});
return obj;
},isValid:function(){
this._invalidWidgets=[];
return dojo.every(this.getDescendants(),function(_9ec){
var _9ed=_9ec.disabled||!_9ec.isValid||_9ec.isValid();
if(!_9ed){
this._invalidWidgets.push(_9ec);
}
return _9ed;
},this);
},onValidStateChange:function(_9ee){
},_widgetChange:function(_9ef){
var _9f0=this._lastValidState;
if(!_9ef||this._lastValidState===undefined){
_9f0=this.isValid();
if(this._lastValidState===undefined){
this._lastValidState=_9f0;
}
}else{
if(_9ef.isValid){
this._invalidWidgets=dojo.filter(this._invalidWidgets||[],function(w){
return (w!=_9ef);
},this);
if(!_9ef.isValid()&&!_9ef.attr("disabled")){
this._invalidWidgets.push(_9ef);
}
_9f0=(this._invalidWidgets.length===0);
}
}
if(_9f0!==this._lastValidState){
this._lastValidState=_9f0;
this.onValidStateChange(_9f0);
}
},connectChildren:function(){
dojo.forEach(this._changeConnections,dojo.hitch(this,"disconnect"));
var _9f2=this;
var _9f3=this._changeConnections=[];
dojo.forEach(dojo.filter(this.getDescendants(),function(item){
return item.validate;
}),function(_9f5){
_9f3.push(_9f2.connect(_9f5,"validate",dojo.hitch(_9f2,"_widgetChange",_9f5)));
_9f3.push(_9f2.connect(_9f5,"_setDisabledAttr",dojo.hitch(_9f2,"_widgetChange",_9f5)));
});
this._widgetChange(null);
},startup:function(){
this.inherited(arguments);
this._changeConnections=[];
this.connectChildren();
}});
dojo.declare("dijit.form.Form",[dijit._Widget,dijit._Templated,dijit.form._FormMixin],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",templateString:"<form dojoAttachPoint='containerNode' dojoAttachEvent='onreset:_onReset,onsubmit:_onSubmit' name='${name}'></form>",attributeMap:dojo.mixin(dojo.clone(dijit._Widget.prototype.attributeMap),{action:"",method:"",encType:"","accept-charset":"",accept:"",target:""}),execute:function(_9f6){
},onExecute:function(){
},_setEncTypeAttr:function(_9f7){
this.encType=_9f7;
dojo.attr(this.domNode,"encType",_9f7);
if(dojo.isIE){
this.domNode.encoding=_9f7;
}
},postCreate:function(){
if(dojo.isIE&&this.srcNodeRef&&this.srcNodeRef.attributes){
var item=this.srcNodeRef.attributes.getNamedItem("encType");
if(item&&!item.specified&&(typeof item.value=="string")){
this.attr("encType",item.value);
}
}
this.inherited(arguments);
},onReset:function(e){
return true;
},_onReset:function(e){
var faux={returnValue:true,preventDefault:function(){
this.returnValue=false;
},stopPropagation:function(){
},currentTarget:e.currentTarget,target:e.target};
if(!(this.onReset(faux)===false)&&faux.returnValue){
this.reset();
}
dojo.stopEvent(e);
return false;
},_onSubmit:function(e){
var fp=dijit.form.Form.prototype;
if(this.execute!=fp.execute||this.onExecute!=fp.onExecute){
dojo.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0");
this.onExecute();
this.execute(this.getValues());
}
if(this.onSubmit(e)===false){
dojo.stopEvent(e);
}
},onSubmit:function(e){
return this.isValid();
},submit:function(){
if(!(this.onSubmit()===false)){
this.containerNode.submit();
}
}});
}
if(!dojo._hasResource["dijit.Dialog"]){
dojo._hasResource["dijit.Dialog"]=true;
dojo.provide("dijit.Dialog");
dojo.declare("dijit.DialogUnderlay",[dijit._Widget,dijit._Templated],{templateString:"<div class='dijitDialogUnderlayWrapper' id='${id}_wrapper'><div class='dijitDialogUnderlay ${class}' id='${id}' dojoAttachPoint='node'></div></div>",attributeMap:{},postCreate:function(){
dojo.body().appendChild(this.domNode);
this.bgIframe=new dijit.BackgroundIframe(this.domNode);
},layout:function(){
var _9ff=dijit.getViewport();
var is=this.node.style,os=this.domNode.style;
os.top=_9ff.t+"px";
os.left=_9ff.l+"px";
is.width=_9ff.w+"px";
is.height=_9ff.h+"px";
var _a02=dijit.getViewport();
if(_9ff.w!=_a02.w){
is.width=_a02.w+"px";
}
if(_9ff.h!=_a02.h){
is.height=_a02.h+"px";
}
},show:function(){
this.domNode.style.display="block";
this.layout();
if(this.bgIframe.iframe){
this.bgIframe.iframe.style.display="block";
}
},hide:function(){
this.domNode.style.display="none";
if(this.bgIframe.iframe){
this.bgIframe.iframe.style.display="none";
}
},uninitialize:function(){
if(this.bgIframe){
this.bgIframe.destroy();
}
}});
dojo.declare("dijit._DialogMixin",null,{attributeMap:dijit._Widget.prototype.attributeMap,execute:function(_a03){
},onCancel:function(){
},onExecute:function(){
},_onSubmit:function(){
this.onExecute();
this.execute(this.attr("value"));
},_getFocusItems:function(_a04){
var _a05=dijit._getTabNavigable(dojo.byId(_a04));
this._firstFocusItem=_a05.lowest||_a05.first||_a04;
this._lastFocusItem=_a05.last||_a05.highest||this._firstFocusItem;
if(dojo.isMoz&&this._firstFocusItem.tagName.toLowerCase()=="input"&&dojo.attr(this._firstFocusItem,"type").toLowerCase()=="file"){
dojo.attr(_a04,"tabindex","0");
this._firstFocusItem=_a04;
}
}});
dojo.declare("dijit.Dialog",[dijit.layout.ContentPane,dijit._Templated,dijit.form._FormMixin,dijit._DialogMixin],{templateString:null,templateString:"<div class=\"dijitDialog\" tabindex=\"-1\" waiRole=\"dialog\" waiState=\"labelledby-${id}_title\">\r\n\t<div dojoAttachPoint=\"titleBar\" class=\"dijitDialogTitleBar\">\r\n\t<span dojoAttachPoint=\"titleNode\" class=\"dijitDialogTitle\" id=\"${id}_title\"></span>\r\n\t<span dojoAttachPoint=\"closeButtonNode\" class=\"dijitDialogCloseIcon\" dojoAttachEvent=\"onclick: onCancel\" title=\"${buttonCancel}\">\r\n\t\t<span dojoAttachPoint=\"closeText\" class=\"closeText\" title=\"${buttonCancel}\">x</span>\r\n\t</span>\r\n\t</div>\r\n\t\t<div dojoAttachPoint=\"containerNode\" class=\"dijitDialogPaneContent\"></div>\r\n</div>\r\n",attributeMap:dojo.mixin(dojo.clone(dijit._Widget.prototype.attributeMap),{title:[{node:"titleNode",type:"innerHTML"},{node:"titleBar",type:"attribute"}]}),open:false,duration:dijit.defaultDuration,refocus:true,autofocus:true,_firstFocusItem:null,_lastFocusItem:null,doLayout:false,draggable:true,postMixInProperties:function(){
var _a06=dojo.i18n.getLocalization("dijit","common");
dojo.mixin(this,_a06);
this.inherited(arguments);
},postCreate:function(){
var s=this.domNode.style;
s.visibility="hidden";
s.position="absolute";
s.display="";
s.top="-9999px";
dojo.body().appendChild(this.domNode);
this.inherited(arguments);
this.connect(this,"onExecute","hide");
this.connect(this,"onCancel","hide");
this._modalconnects=[];
},onLoad:function(){
this._position();
this.inherited(arguments);
},_endDrag:function(e){
if(e&&e.node&&e.node===this.domNode){
var vp=dijit.getViewport();
var p=e._leftTop||dojo.coords(e.node,true);
this._relativePosition={t:p.t-vp.t,l:p.l-vp.l};
}
},_setup:function(){
var node=this.domNode;
if(this.titleBar&&this.draggable){
this._moveable=(dojo.isIE==6)?new dojo.dnd.TimedMoveable(node,{handle:this.titleBar}):new dojo.dnd.Moveable(node,{handle:this.titleBar,timeout:0});
dojo.subscribe("/dnd/move/stop",this,"_endDrag");
}else{
dojo.addClass(node,"dijitDialogFixed");
}
this._underlay=new dijit.DialogUnderlay({id:this.id+"_underlay","class":dojo.map(this["class"].split(/\s/),function(s){
return s+"_underlay";
}).join(" ")});
var _a0d=this._underlay;
this._fadeIn=dojo.fadeIn({node:node,duration:this.duration,onBegin:dojo.hitch(_a0d,"show")});
this._fadeOut=dojo.fadeOut({node:node,duration:this.duration,onEnd:function(){
node.style.visibility="hidden";
node.style.top="-9999px";
_a0d.hide();
}});
},uninitialize:function(){
if(this._fadeIn&&this._fadeIn.status()=="playing"){
this._fadeIn.stop();
}
if(this._fadeOut&&this._fadeOut.status()=="playing"){
this._fadeOut.stop();
}
if(this._underlay){
this._underlay.destroy();
}
if(this._moveable){
this._moveable.destroy();
}
},_size:function(){
var mb=dojo.marginBox(this.domNode);
var _a0f=dijit.getViewport();
if(mb.w>=_a0f.w||mb.h>=_a0f.h){
dojo.style(this.containerNode,{width:Math.min(mb.w,Math.floor(_a0f.w*0.75))+"px",height:Math.min(mb.h,Math.floor(_a0f.h*0.75))+"px",overflow:"auto",position:"relative"});
}
},_position:function(){
if(!dojo.hasClass(dojo.body(),"dojoMove")){
var node=this.domNode;
var _a11=dijit.getViewport();
var p=this._relativePosition;
var mb=p?null:dojo.marginBox(node);
dojo.style(node,{left:Math.floor(_a11.l+(p?p.l:(_a11.w-mb.w)/2))+"px",top:Math.floor(_a11.t+(p?p.t:(_a11.h-mb.h)/2))+"px"});
}
},_onKey:function(evt){
if(evt.charOrCode){
var dk=dojo.keys;
var node=evt.target;
if(evt.charOrCode===dk.TAB){
this._getFocusItems(this.domNode);
}
var _a17=(this._firstFocusItem==this._lastFocusItem);
if(node==this._firstFocusItem&&evt.shiftKey&&evt.charOrCode===dk.TAB){
if(!_a17){
dijit.focus(this._lastFocusItem);
}
dojo.stopEvent(evt);
}else{
if(node==this._lastFocusItem&&evt.charOrCode===dk.TAB&&!evt.shiftKey){
if(!_a17){
dijit.focus(this._firstFocusItem);
}
dojo.stopEvent(evt);
}else{
while(node){
if(node==this.domNode){
if(evt.charOrCode==dk.ESCAPE){
this.onCancel();
}else{
return;
}
}
node=node.parentNode;
}
if(evt.charOrCode!==dk.TAB){
dojo.stopEvent(evt);
}else{
if(!dojo.isOpera){
try{
this._firstFocusItem.focus();
}
catch(e){
}
}
}
}
}
}
},show:function(){
if(this.open){
return;
}
if(!this._alreadyInitialized){
this._setup();
this._alreadyInitialized=true;
}
if(this._fadeOut.status()=="playing"){
this._fadeOut.stop();
}
this._modalconnects.push(dojo.connect(window,"onscroll",this,"layout"));
this._modalconnects.push(dojo.connect(window,"onresize",this,"layout"));
this._modalconnects.push(dojo.connect(dojo.doc.documentElement,"onkeypress",this,"_onKey"));
dojo.style(this.domNode,{opacity:0,visibility:""});
dojo.style(this.containerNode,{width:"auto",height:"auto"});
this.open=true;
this._loadCheck();
this._size();
this._position();
this._fadeIn.play();
this._savedFocus=dijit.getFocus(this);
if(this.autofocus){
this._getFocusItems(this.domNode);
setTimeout(dojo.hitch(dijit,"focus",this._firstFocusItem),50);
}
},hide:function(){
if(!this._alreadyInitialized){
return;
}
if(this._fadeIn.status()=="playing"){
this._fadeIn.stop();
}
this._fadeOut.play();
if(this._scrollConnected){
this._scrollConnected=false;
}
dojo.forEach(this._modalconnects,dojo.disconnect);
this._modalconnects=[];
if(this.refocus){
this.connect(this._fadeOut,"onEnd",dojo.hitch(dijit,"focus",this._savedFocus));
}
if(this._relativePosition){
delete this._relativePosition;
}
this.open=false;
},layout:function(){
if(this.domNode.style.visibility!="hidden"){
this._underlay.layout();
this._position();
}
},destroy:function(){
dojo.forEach(this._modalconnects,dojo.disconnect);
if(this.refocus&&this.open){
setTimeout(dojo.hitch(dijit,"focus",this._savedFocus),25);
}
this.inherited(arguments);
}});
dojo.declare("dijit.TooltipDialog",[dijit.layout.ContentPane,dijit._Templated,dijit.form._FormMixin,dijit._DialogMixin],{title:"",doLayout:false,autofocus:true,"class":"dijitTooltipDialog",_firstFocusItem:null,_lastFocusItem:null,templateString:null,templateString:"<div waiRole=\"presentation\">\r\n\t<div class=\"dijitTooltipContainer\" waiRole=\"presentation\">\r\n\t\t<div class =\"dijitTooltipContents dijitTooltipFocusNode\" dojoAttachPoint=\"containerNode\" tabindex=\"-1\" waiRole=\"dialog\"></div>\r\n\t</div>\r\n\t<div class=\"dijitTooltipConnector\" waiRole=\"presentation\"></div>\r\n</div>\r\n",postCreate:function(){
this.inherited(arguments);
this.connect(this.containerNode,"onkeypress","_onKey");
this.containerNode.title=this.title;
},orient:function(node,_a19,_a1a){
this.domNode.className=this["class"]+" dijitTooltipAB"+(_a1a.charAt(1)=="L"?"Left":"Right")+" dijitTooltip"+(_a1a.charAt(0)=="T"?"Below":"Above");
},onOpen:function(pos){
this.orient(this.domNode,pos.aroundCorner,pos.corner);
this._loadCheck();
if(this.autofocus){
this._getFocusItems(this.containerNode);
dijit.focus(this._firstFocusItem);
}
},_onKey:function(evt){
var node=evt.target;
var dk=dojo.keys;
if(evt.charOrCode===dk.TAB){
this._getFocusItems(this.containerNode);
}
var _a1f=(this._firstFocusItem==this._lastFocusItem);
if(evt.charOrCode==dk.ESCAPE){
this.onCancel();
dojo.stopEvent(evt);
}else{
if(node==this._firstFocusItem&&evt.shiftKey&&evt.charOrCode===dk.TAB){
if(!_a1f){
dijit.focus(this._lastFocusItem);
}
dojo.stopEvent(evt);
}else{
if(node==this._lastFocusItem&&evt.charOrCode===dk.TAB&&!evt.shiftKey){
if(!_a1f){
dijit.focus(this._firstFocusItem);
}
dojo.stopEvent(evt);
}else{
if(evt.charOrCode===dk.TAB){
evt.stopPropagation();
}
}
}
}
}});
}
if(!dojo._hasResource["dijit._editor.selection"]){
dojo._hasResource["dijit._editor.selection"]=true;
dojo.provide("dijit._editor.selection");
dojo.mixin(dijit._editor.selection,{getType:function(){
if(dojo.doc.selection){
return dojo.doc.selection.type.toLowerCase();
}else{
var _a20="text";
var oSel;
try{
oSel=dojo.global.getSelection();
}
catch(e){
}
if(oSel&&oSel.rangeCount==1){
var _a22=oSel.getRangeAt(0);
if((_a22.startContainer==_a22.endContainer)&&((_a22.endOffset-_a22.startOffset)==1)&&(_a22.startContainer.nodeType!=3)){
_a20="control";
}
}
return _a20;
}
},getSelectedText:function(){
if(dojo.doc.selection){
if(dijit._editor.selection.getType()=="control"){
return null;
}
return dojo.doc.selection.createRange().text;
}else{
var _a23=dojo.global.getSelection();
if(_a23){
return _a23.toString();
}
}
return "";
},getSelectedHtml:function(){
if(dojo.doc.selection){
if(dijit._editor.selection.getType()=="control"){
return null;
}
return dojo.doc.selection.createRange().htmlText;
}else{
var _a24=dojo.global.getSelection();
if(_a24&&_a24.rangeCount){
var frag=_a24.getRangeAt(0).cloneContents();
var div=dojo.doc.createElement("div");
div.appendChild(frag);
return div.innerHTML;
}
return null;
}
},getSelectedElement:function(){
if(dijit._editor.selection.getType()=="control"){
if(dojo.doc.selection){
var _a27=dojo.doc.selection.createRange();
if(_a27&&_a27.item){
return dojo.doc.selection.createRange().item(0);
}
}else{
var _a28=dojo.global.getSelection();
return _a28.anchorNode.childNodes[_a28.anchorOffset];
}
}
return null;
},getParentElement:function(){
if(dijit._editor.selection.getType()=="control"){
var p=this.getSelectedElement();
if(p){
return p.parentNode;
}
}else{
if(dojo.doc.selection){
var r=dojo.doc.selection.createRange();
r.collapse(true);
return r.parentElement();
}else{
var _a2b=dojo.global.getSelection();
if(_a2b){
var node=_a2b.anchorNode;
while(node&&(node.nodeType!=1)){
node=node.parentNode;
}
return node;
}
}
}
return null;
},hasAncestorElement:function(_a2d){
return this.getAncestorElement.apply(this,arguments)!=null;
},getAncestorElement:function(_a2e){
var node=this.getSelectedElement()||this.getParentElement();
return this.getParentOfType(node,arguments);
},isTag:function(node,tags){
if(node&&node.tagName){
var _nlc=node.tagName.toLowerCase();
for(var i=0;i<tags.length;i++){
var _tlc=String(tags[i]).toLowerCase();
if(_nlc==_tlc){
return _tlc;
}
}
}
return "";
},getParentOfType:function(node,tags){
while(node){
if(this.isTag(node,tags).length){
return node;
}
node=node.parentNode;
}
return null;
},collapse:function(_a37){
if(window["getSelection"]){
var _a38=dojo.global.getSelection();
if(_a38.removeAllRanges){
if(_a37){
_a38.collapseToStart();
}else{
_a38.collapseToEnd();
}
}else{
_a38.collapse(_a37);
}
}else{
if(dojo.doc.selection){
var _a39=dojo.doc.selection.createRange();
_a39.collapse(_a37);
_a39.select();
}
}
},remove:function(){
var _s=dojo.doc.selection;
if(_s){
if(_s.type.toLowerCase()!="none"){
_s.clear();
}
return _s;
}else{
_s=dojo.global.getSelection();
_s.deleteFromDocument();
return _s;
}
},selectElementChildren:function(_a3b,_a3c){
var _a3d=dojo.global;
var _a3e=dojo.doc;
_a3b=dojo.byId(_a3b);
if(_a3e.selection&&dojo.body().createTextRange){
var _a3f=_a3b.ownerDocument.body.createTextRange();
_a3f.moveToElementText(_a3b);
if(!_a3c){
try{
_a3f.select();
}
catch(e){
}
}
}else{
if(_a3d.getSelection){
var _a40=_a3d.getSelection();
if(_a40.setBaseAndExtent){
_a40.setBaseAndExtent(_a3b,0,_a3b,_a3b.innerText.length-1);
}else{
if(_a40.selectAllChildren){
_a40.selectAllChildren(_a3b);
}
}
}
}
},selectElement:function(_a41,_a42){
var _a43,_a44=dojo.doc;
_a41=dojo.byId(_a41);
if(_a44.selection&&dojo.body().createTextRange){
try{
_a43=dojo.body().createControlRange();
_a43.addElement(_a41);
if(!_a42){
_a43.select();
}
}
catch(e){
this.selectElementChildren(_a41,_a42);
}
}else{
if(dojo.global.getSelection){
var _a45=dojo.global.getSelection();
if(_a45.removeAllRanges){
_a43=_a44.createRange();
_a43.selectNode(_a41);
_a45.removeAllRanges();
_a45.addRange(_a43);
}
}
}
}});
}
if(!dojo._hasResource["dijit._editor.range"]){
dojo._hasResource["dijit._editor.range"]=true;
dojo.provide("dijit._editor.range");
dijit.range={};
dijit.range.getIndex=function(node,_a47){
var ret=[],retR=[];
var stop=_a47;
var _a4b=node;
var _a4c,n;
while(node!=stop){
var i=0;
_a4c=node.parentNode;
while((n=_a4c.childNodes[i++])){
if(n===node){
--i;
break;
}
}
if(i>=_a4c.childNodes.length){
dojo.debug("Error finding index of a node in dijit.range.getIndex");
}
ret.unshift(i);
retR.unshift(i-_a4c.childNodes.length);
node=_a4c;
}
if(ret.length>0&&_a4b.nodeType==3){
n=_a4b.previousSibling;
while(n&&n.nodeType==3){
ret[ret.length-1]--;
n=n.previousSibling;
}
n=_a4b.nextSibling;
while(n&&n.nodeType==3){
retR[retR.length-1]++;
n=n.nextSibling;
}
}
return {o:ret,r:retR};
};
dijit.range.getNode=function(_a4f,_a50){
if(!dojo.isArray(_a4f)||_a4f.length==0){
return _a50;
}
var node=_a50;
dojo.every(_a4f,function(i){
if(i>=0&&i<node.childNodes.length){
node=node.childNodes[i];
}else{
node=null;
console.debug("Error: can not find node with index",_a4f,"under parent node",_a50);
return false;
}
return true;
});
return node;
};
dijit.range.getCommonAncestor=function(n1,n2){
var _a55=function(n){
var as=[];
while(n){
as.unshift(n);
if(n.nodeName!="BODY"){
n=n.parentNode;
}else{
break;
}
}
return as;
};
var n1as=_a55(n1);
var n2as=_a55(n2);
var m=Math.min(n1as.length,n2as.length);
var com=n1as[0];
for(var i=1;i<m;i++){
if(n1as[i]===n2as[i]){
com=n1as[i];
}else{
break;
}
}
return com;
};
dijit.range.getAncestor=function(node,_a5e,root){
root=root||node.ownerDocument.body;
while(node&&node!==root){
var name=node.nodeName.toUpperCase();
if(_a5e.test(name)){
return node;
}
node=node.parentNode;
}
return null;
};
dijit.range.BlockTagNames=/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/;
dijit.range.getBlockAncestor=function(node,_a62,root){
root=root||node.ownerDocument.body;
_a62=_a62||dijit.range.BlockTagNames;
var _a64=null,_a65;
while(node&&node!==root){
var name=node.nodeName.toUpperCase();
if(!_a64&&_a62.test(name)){
_a64=node;
}
if(!_a65&&(/^(?:BODY|TD|TH|CAPTION)$/).test(name)){
_a65=node;
}
node=node.parentNode;
}
return {blockNode:_a64,blockContainer:_a65||node.ownerDocument.body};
};
dijit.range.atBeginningOfContainer=function(_a67,node,_a69){
var _a6a=false;
var _a6b=(_a69==0);
if(!_a6b&&node.nodeType==3){
if(dojo.trim(node.nodeValue.substr(0,_a69))==0){
_a6b=true;
}
}
if(_a6b){
var _a6c=node;
_a6a=true;
while(_a6c&&_a6c!==_a67){
if(_a6c.previousSibling){
_a6a=false;
break;
}
_a6c=_a6c.parentNode;
}
}
return _a6a;
};
dijit.range.atEndOfContainer=function(_a6d,node,_a6f){
var _a70=false;
var _a71=(_a6f==(node.length||node.childNodes.length));
if(!_a71&&node.nodeType==3){
if(dojo.trim(node.nodeValue.substr(_a6f))==0){
_a71=true;
}
}
if(_a71){
var _a72=node;
_a70=true;
while(_a72&&_a72!==_a6d){
if(_a72.nextSibling){
_a70=false;
break;
}
_a72=_a72.parentNode;
}
}
return _a70;
};
dijit.range.adjacentNoneTextNode=function(_a73,next){
var node=_a73;
var len=(0-_a73.length)||0;
var prop=next?"nextSibling":"previousSibling";
while(node){
if(node.nodeType!=3){
break;
}
len+=node.length;
node=node[prop];
}
return [node,len];
};
dijit.range._w3c=Boolean(window["getSelection"]);
dijit.range.create=function(win){
if(dijit.range._w3c){
return (win||dojo.global).document.createRange();
}else{
return new dijit.range.W3CRange;
}
};
dijit.range.getSelection=function(win,_a7a){
if(dijit.range._w3c){
return win.getSelection();
}else{
var s=new dijit.range.ie.selection(win);
if(!_a7a){
s._getCurrentSelection();
}
return s;
}
};
if(!dijit.range._w3c){
dijit.range.ie={cachedSelection:{},selection:function(win){
this._ranges=[];
this.addRange=function(r,_a7e){
this._ranges.push(r);
if(!_a7e){
r._select();
}
this.rangeCount=this._ranges.length;
};
this.removeAllRanges=function(){
this._ranges=[];
this.rangeCount=0;
};
var _a7f=function(){
var r=win.document.selection.createRange();
var type=win.document.selection.type.toUpperCase();
if(type=="CONTROL"){
return new dijit.range.W3CRange(dijit.range.ie.decomposeControlRange(r));
}else{
return new dijit.range.W3CRange(dijit.range.ie.decomposeTextRange(r));
}
};
this.getRangeAt=function(i){
return this._ranges[i];
};
this._getCurrentSelection=function(){
this.removeAllRanges();
var r=_a7f();
if(r){
this.addRange(r,true);
}
};
},decomposeControlRange:function(_a84){
var _a85=_a84.item(0),_a86=_a84.item(_a84.length-1);
var _a87=_a85.parentNode,_a88=_a86.parentNode;
var _a89=dijit.range.getIndex(_a85,_a87).o;
var _a8a=dijit.range.getIndex(_a86,_a88).o+1;
return [[_a87,_a89],[_a88,_a8a]];
},getEndPoint:function(_a8b,end){
var _a8d=_a8b.duplicate();
_a8d.collapse(!end);
var _a8e="EndTo"+(end?"End":"Start");
var _a8f=_a8d.parentElement();
var _a90,_a91,_a92;
if(_a8f.childNodes.length>0){
dojo.every(_a8f.childNodes,function(node,i){
var _a95;
if(node.nodeType!=3){
_a8d.moveToElementText(node);
if(_a8d.compareEndPoints(_a8e,_a8b)>0){
_a90=node.previousSibling;
if(_a92&&_a92.nodeType==3){
_a90=_a92;
_a95=true;
}else{
_a90=_a8f;
_a91=i;
return false;
}
}else{
if(i==_a8f.childNodes.length-1){
_a90=_a8f;
_a91=_a8f.childNodes.length;
return false;
}
}
}else{
if(i==_a8f.childNodes.length-1){
_a90=node;
_a95=true;
}
}
if(_a95&&_a90){
var _a96=dijit.range.adjacentNoneTextNode(_a90)[0];
if(_a96){
_a90=_a96.nextSibling;
}else{
_a90=_a8f.firstChild;
}
var _a97=dijit.range.adjacentNoneTextNode(_a90);
_a96=_a97[0];
var _a98=_a97[1];
if(_a96){
_a8d.moveToElementText(_a96);
_a8d.collapse(false);
}else{
_a8d.moveToElementText(_a8f);
}
_a8d.setEndPoint(_a8e,_a8b);
_a91=_a8d.text.length-_a98;
return false;
}
_a92=node;
return true;
});
}else{
_a90=_a8f;
_a91=0;
}
if(!end&&_a90.nodeType!=3&&_a91==_a90.childNodes.length){
if(_a90.nextSibling&&_a90.nextSibling.nodeType==3){
_a90=_a90.nextSibling;
_a91=0;
}
}
return [_a90,_a91];
},setEndPoint:function(_a99,_a9a,_a9b){
var _a9c=_a99.duplicate(),node,len;
if(_a9a.nodeType!=3){
_a9c.moveToElementText(_a9a);
_a9c.collapse(true);
if(_a9b==_a9a.childNodes.length){
if(_a9b>0){
node=_a9a.lastChild;
len=0;
while(node&&node.nodeType==3){
len+=node.length;
_a9a=node;
node=node.previousSibling;
}
if(node){
_a9c.moveToElementText(node);
}
_a9c.collapse(false);
_a9b=len;
}else{
_a9c.moveToElementText(_a9a);
_a9c.collapse(true);
}
}else{
if(_a9b>0){
node=_a9a.childNodes[_a9b-1];
if(node.nodeType==3){
_a9a=node;
_a9b=node.length;
}else{
_a9c.moveToElementText(node);
_a9c.collapse(false);
}
}
}
}
if(_a9a.nodeType==3){
var _a9f=dijit.range.adjacentNoneTextNode(_a9a);
var _aa0=_a9f[0];
len=_a9f[1];
if(_aa0){
_a9c.moveToElementText(_aa0);
_a9c.collapse(false);
if(_aa0.contentEditable!="inherit"){
len++;
}
}else{
_a9c.moveToElementText(_a9a.parentNode);
_a9c.collapse(true);
}
_a9b+=len;
if(_a9b>0){
if(_a9c.move("character",_a9b)!=_a9b){
console.error("Error when moving!");
}
}
}
return _a9c;
},decomposeTextRange:function(_aa1){
var _aa2=dijit.range.ie.getEndPoint(_aa1);
var _aa3=_aa2[0],_aa4=_aa2[1];
var _aa5=_aa2[0],_aa6=_aa2[1];
if(_aa1.htmlText.length){
if(_aa1.htmlText==_aa1.text){
_aa6=_aa4+_aa1.text.length;
}else{
_aa2=dijit.range.ie.getEndPoint(_aa1,true);
_aa5=_aa2[0],_aa6=_aa2[1];
}
}
return [[_aa3,_aa4],[_aa5,_aa6]];
},setRange:function(_aa7,_aa8,_aa9,_aaa,_aab,_aac){
var _aad=dijit.range.ie.setEndPoint(_aa7,_aa8,_aa9);
_aa7.setEndPoint("StartToStart",_aad);
var _aae=_aad;
if(!_aac){
_aae=dijit.range.ie.setEndPoint(_aa7,_aaa,_aab);
}
_aa7.setEndPoint("EndToEnd",_aae);
return _aa7;
}};
dojo.declare("dijit.range.W3CRange",null,{constructor:function(){
if(arguments.length>0){
this.setStart(arguments[0][0][0],arguments[0][0][1]);
this.setEnd(arguments[0][1][0],arguments[0][1][1]);
}else{
this.commonAncestorContainer=null;
this.startContainer=null;
this.startOffset=0;
this.endContainer=null;
this.endOffset=0;
this.collapsed=true;
}
},_simpleSetEndPoint:function(node,_ab0,end){
var r=(this._body||node.ownerDocument.body).createTextRange();
if(node.nodeType!=1){
r.moveToElementText(node.parentNode);
}else{
r.moveToElementText(node);
}
r.collapse(true);
_ab0.setEndPoint(end?"EndToEnd":"StartToStart",r);
},_updateInternal:function(){
if(this.startContainer!==this.endContainer){
this.commonAncestorContainer=dijit.range.getCommonAncestor(this.startContainer,this.endContainer);
}else{
this.commonAncestorContainer=this.startContainer;
}
this.collapsed=(this.startContainer===this.endContainer)&&(this.startOffset==this.endOffset);
},setStart:function(node,_ab4){
_ab4=parseInt(_ab4);
if(this.startContainer===node&&this.startOffset==_ab4){
return;
}
delete this._cachedBookmark;
this.startContainer=node;
this.startOffset=_ab4;
if(!this.endContainer){
this.setEnd(node,_ab4);
}else{
this._updateInternal();
}
},setEnd:function(node,_ab6){
_ab6=parseInt(_ab6);
if(this.endContainer===node&&this.endOffset==_ab6){
return;
}
delete this._cachedBookmark;
this.endContainer=node;
this.endOffset=_ab6;
if(!this.startContainer){
this.setStart(node,_ab6);
}else{
this._updateInternal();
}
},setStartAfter:function(node,_ab8){
this._setPoint("setStart",node,_ab8,1);
},setStartBefore:function(node,_aba){
this._setPoint("setStart",node,_aba,0);
},setEndAfter:function(node,_abc){
this._setPoint("setEnd",node,_abc,1);
},setEndBefore:function(node,_abe){
this._setPoint("setEnd",node,_abe,0);
},_setPoint:function(what,node,_ac1,ext){
var _ac3=dijit.range.getIndex(node,node.parentNode).o;
this[what](node.parentNode,_ac3.pop()+ext);
},_getIERange:function(){
var r=(this._body||this.endContainer.ownerDocument.body).createTextRange();
dijit.range.ie.setRange(r,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);
return r;
},getBookmark:function(body){
this._getIERange();
return this._cachedBookmark;
},_select:function(){
var r=this._getIERange();
r.select();
},deleteContents:function(){
var r=this._getIERange();
r.pasteHTML("");
this.endContainer=this.startContainer;
this.endOffset=this.startOffset;
this.collapsed=true;
},cloneRange:function(){
var r=new dijit.range.W3CRange([[this.startContainer,this.startOffset],[this.endContainer,this.endOffset]]);
r._body=this._body;
return r;
},detach:function(){
this._body=null;
this.commonAncestorContainer=null;
this.startContainer=null;
this.startOffset=0;
this.endContainer=null;
this.endOffset=0;
this.collapsed=true;
}});
}
}
if(!dojo._hasResource["dijit._editor.html"]){
dojo._hasResource["dijit._editor.html"]=true;
dojo.provide("dijit._editor.html");
dijit._editor.escapeXml=function(str,_aca){
str=str.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");
if(!_aca){
str=str.replace(/'/gm,"&#39;");
}
return str;
};
dijit._editor.getNodeHtml=function(node){
var _acc;
switch(node.nodeType){
case 1:
_acc="<"+node.nodeName.toLowerCase();
var _acd=[];
if(dojo.isIE&&node.outerHTML){
var s=node.outerHTML;
s=s.substr(0,s.indexOf(">")).replace(/(['"])[^"']*\1/g,"");
var reg=/(\b\w+)\s?=/g;
var m,key;
while((m=reg.exec(s))){
key=m[1];
if(key.substr(0,3)!="_dj"){
if(key=="src"||key=="href"){
if(node.getAttribute("_djrealurl")){
_acd.push([key,node.getAttribute("_djrealurl")]);
continue;
}
}
var val;
switch(key){
case "style":
val=node.style.cssText.toLowerCase();
break;
case "class":
val=node.className;
break;
default:
val=node.getAttribute(key);
}
if(val!=null){
_acd.push([key,val.toString()]);
}
}
}
}else{
var attr,i=0;
while((attr=node.attributes[i++])){
var n=attr.name;
if(n.substr(0,3)!="_dj"){
var v=attr.value;
if(n=="src"||n=="href"){
if(node.getAttribute("_djrealurl")){
v=node.getAttribute("_djrealurl");
}
}
_acd.push([n,v]);
}
}
}
_acd.sort(function(a,b){
return a[0]<b[0]?-1:(a[0]==b[0]?0:1);
});
var j=0;
while((attr=_acd[j++])){
_acc+=" "+attr[0]+"=\""+(dojo.isString(attr[1])?dijit._editor.escapeXml(attr[1],true):attr[1])+"\"";
}
if(node.childNodes.length){
_acc+=">"+dijit._editor.getChildrenHtml(node)+"</"+node.nodeName.toLowerCase()+">";
}else{
_acc+=" />";
}
break;
case 3:
_acc=dijit._editor.escapeXml(node.nodeValue,true);
break;
case 8:
_acc="<!--"+dijit._editor.escapeXml(node.nodeValue,true)+"-->";
break;
default:
_acc="<!-- Element not recognized - Type: "+node.nodeType+" Name: "+node.nodeName+"-->";
}
return _acc;
};
dijit._editor.getChildrenHtml=function(dom){
var out="";
if(!dom){
return out;
}
var _adb=dom["childNodes"]||dom;
var node,i=0;
while((node=_adb[i++])){
if(!dojo.isIE||(node.parentNode==dom||!node.parentNode)){
out+=dijit._editor.getNodeHtml(node);
}
}
return out;
};
}
if(!dojo._hasResource["dijit._editor.RichText"]){
dojo._hasResource["dijit._editor.RichText"]=true;
dojo.provide("dijit._editor.RichText");
if(!dojo.config["useXDomain"]||dojo.config["allowXdRichTextSave"]){
if(dojo._postLoad){
(function(){
var _add=dojo.doc.createElement("textarea");
_add.id=dijit._scopeName+"._editor.RichText.savedContent";
var s=_add.style;
s.display="none";
s.position="absolute";
s.top="-100px";
s.left="-100px";
s.height="3px";
s.width="3px";
dojo.body().appendChild(_add);
})();
}else{
try{
dojo.doc.write("<textarea id=\""+dijit._scopeName+"._editor.RichText.savedContent\" "+"style=\"display:none;position:absolute;top:-100px;left:-100px;height:3px;width:3px;overflow:hidden;\"></textarea>");
}
catch(e){
}
}
}
dojo.declare("dijit._editor.RichText",dijit._Widget,{constructor:function(_adf){
this.contentPreFilters=[];
this.contentPostFilters=[];
this.contentDomPreFilters=[];
this.contentDomPostFilters=[];
this.editingAreaStyleSheets=[];
this._keyHandlers={};
this.contentPreFilters.push(dojo.hitch(this,"_preFixUrlAttributes"));
if(dojo.isMoz){
this.contentPreFilters.push(this._fixContentForMoz);
this.contentPostFilters.push(this._removeMozBogus);
}
if(dojo.isSafari){
this.contentPostFilters.push(this._removeSafariBogus);
}
this.onLoadDeferred=new dojo.Deferred();
var d=dojo.doc;
this._charset=d.charset||d.characterSet||d.defaultCharset||"UTF-8";
},inheritWidth:false,focusOnLoad:false,name:"",styleSheets:"",_content:"",height:"300px",minHeight:"1em",isClosed:true,isLoaded:false,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",onLoadDeferred:null,isTabIndent:false,postCreate:function(){
if("textarea"==this.domNode.tagName.toLowerCase()){
console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");
}
dojo.publish(dijit._scopeName+"._editor.RichText::init",[this]);
this.open();
this.setupDefaultShortcuts();
},setupDefaultShortcuts:function(){
var exec=dojo.hitch(this,function(cmd,arg){
return function(){
return !this.execCommand(cmd,arg);
};
});
var _ae4={b:exec("bold"),i:exec("italic"),u:exec("underline"),a:exec("selectall"),s:function(){
this.save(true);
},m:function(){
this.isTabIndent=!this.isTabIndent;
},"1":exec("formatblock","h1"),"2":exec("formatblock","h2"),"3":exec("formatblock","h3"),"4":exec("formatblock","h4"),"\\":exec("insertunorderedlist")};
if(!dojo.isIE){
_ae4.Z=exec("redo");
}
for(var key in _ae4){
this.addKeyHandler(key,true,false,_ae4[key]);
}
},events:["onKeyPress","onKeyDown","onKeyUp","onClick"],captureEvents:[],_editorCommandsLocalized:false,_localizeEditorCommands:function(){
if(this._editorCommandsLocalized){
return;
}
this._editorCommandsLocalized=true;
var _ae6=["div","p","pre","h1","h2","h3","h4","h5","h6","ol","ul","address"];
var _ae7="",_ae8,i=0;
while((_ae8=_ae6[i++])){
if(_ae8.charAt(1)!="l"){
_ae7+="<"+_ae8+"><span>content</span></"+_ae8+"><br/>";
}else{
_ae7+="<"+_ae8+"><li>content</li></"+_ae8+"><br/>";
}
}
var div=dojo.doc.createElement("div");
dojo.style(div,{position:"absolute",left:"-2000px",top:"-2000px"});
dojo.doc.body.appendChild(div);
div.innerHTML=_ae7;
var node=div.firstChild;
while(node){
dijit._editor.selection.selectElement(node.firstChild);
dojo.withGlobal(this.window,"selectElement",dijit._editor.selection,[node.firstChild]);
var _aeb=node.tagName.toLowerCase();
this._local2NativeFormatNames[_aeb]=document.queryCommandValue("formatblock");
this._native2LocalFormatNames[this._local2NativeFormatNames[_aeb]]=_aeb;
node=node.nextSibling.nextSibling;
}
dojo.body().removeChild(div);
},open:function(_aec){
if((!this.onLoadDeferred)||(this.onLoadDeferred.fired>=0)){
this.onLoadDeferred=new dojo.Deferred();
}
if(!this.isClosed){
this.close();
}
dojo.publish(dijit._scopeName+"._editor.RichText::open",[this]);
this._content="";
if((arguments.length==1)&&(_aec["nodeName"])){
this.domNode=_aec;
}
var dn=this.domNode;
var html;
if((dn["nodeName"])&&(dn.nodeName.toLowerCase()=="textarea")){
var ta=this.textarea=dn;
this.name=ta.name;
html=this._preFilterContent(ta.value);
dn=this.domNode=dojo.doc.createElement("div");
dn.setAttribute("widgetId",this.id);
ta.removeAttribute("widgetId");
dn.cssText=ta.cssText;
dn.className+=" "+ta.className;
dojo.place(dn,ta,"before");
var _af0=dojo.hitch(this,function(){
with(ta.style){
display="block";
position="absolute";
left=top="-1000px";
if(dojo.isIE){
this.__overflow=overflow;
overflow="hidden";
}
}
});
if(dojo.isIE){
setTimeout(_af0,10);
}else{
_af0();
}
if(ta.form){
dojo.connect(ta.form,"onsubmit",this,function(){
ta.value=this.getValue();
});
}
}else{
html=this._preFilterContent(dijit._editor.getChildrenHtml(dn));
dn.innerHTML="";
}
if(html==""){
html="&nbsp;";
}
var _af1=dojo.contentBox(dn);
this._oldHeight=_af1.h;
this._oldWidth=_af1.w;
this.savedContent=html;
if((dn["nodeName"])&&(dn.nodeName=="LI")){
dn.innerHTML=" <br>";
}
this.editingArea=dn.ownerDocument.createElement("div");
dn.appendChild(this.editingArea);
if(this.name!=""&&(!dojo.config["useXDomain"]||dojo.config["allowXdRichTextSave"])){
var _af2=dojo.byId(dijit._scopeName+"._editor.RichText.savedContent");
if(_af2.value!=""){
var _af3=_af2.value.split(this._SEPARATOR),i=0,dat;
while((dat=_af3[i++])){
var data=dat.split(":");
if(data[0]==this.name){
html=data[1];
_af3.splice(i,1);
break;
}
}
}
this.connect(window,"onbeforeunload","_saveContent");
}
this.isClosed=false;
if(dojo.isIE||dojo.isSafari||dojo.isOpera){
var ifr=(this.editorObject=this.iframe=dojo.doc.createElement("iframe"));
ifr.id=this.id+"_iframe";
this._iframeSrc=this._getIframeDocTxt(html);
ifr.style.border="none";
ifr.style.width="100%";
if(this._layoutMode){
ifr.style.height="100%";
}else{
if(dojo.isIE>=7){
if(this.height){
ifr.style.height=this.height;
}
if(this.minHeight){
ifr.style.minHeight=this.minHeight;
}
}else{
ifr.style.height=this.height?this.height:this.minHeight;
}
}
ifr.frameBorder=0;
ifr._loadFunc=dojo.hitch(this,function(win){
this.window=win;
this.document=this.window.document;
if(dojo.isIE){
this._localizeEditorCommands();
}
this.onLoad();
this.savedContent=this.getValue(true);
});
var s="javascript:parent.dijit.byId(\""+this.id+"\")._iframeSrc";
ifr.setAttribute("src",s);
this.editingArea.appendChild(ifr);
if(dojo.isSafari){
setTimeout(function(){
ifr.setAttribute("src",s);
},0);
}
}else{
this._drawIframe(html);
this.savedContent=this.getValue(true);
}
if(dn.nodeName=="LI"){
dn.lastChild.style.marginTop="-1.2em";
}
dojo.addClass(this.domNode,"RichTextEditable");
},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_localizedIframeTitles:null,_getIframeDocTxt:function(html){
var _cs=dojo.getComputedStyle(this.domNode);
if(dojo.isIE||(!this.height&&!dojo.isMoz)){
html="<div>"+html+"</div>";
}
var font=[_cs.fontWeight,_cs.fontSize,_cs.fontFamily].join(" ");
var _afc=_cs.lineHeight;
if(_afc.indexOf("px")>=0){
_afc=parseFloat(_afc)/parseFloat(_cs.fontSize);
}else{
if(_afc.indexOf("em")>=0){
_afc=parseFloat(_afc);
}else{
_afc="1.0";
}
}
var _afd="";
this.style.replace(/(^|;)(line-|font-?)[^;]+/g,function(_afe){
_afd+=_afe.replace(/^;/g,"")+";";
});
return [this.isLeftToRight()?"<html><head>":"<html dir='rtl'><head>",(dojo.isMoz?"<title>"+this._localizedIframeTitles.iframeEditTitle+"</title>":""),"<meta http-equiv='Content-Type' content='text/html; charset="+this._charset+"'>","<style>","body,html {","\tbackground:transparent;","\tpadding: 1em 0 0 0;","\tmargin: -1em 0 0 0;","}","body{","\ttop:0px; left:0px; right:0px;","\tfont:",font,";",((this.height||dojo.isOpera)?"":"position: fixed;"),"\tmin-height:",this.minHeight,";","\tline-height:",_afc,"}","p{ margin: 1em 0; }",(this.height?"":"body,html{overflow-y:hidden;/*for IE*/} body > div {overflow-x:auto;/*FF:horizontal scrollbar*/ overflow-y:hidden;/*safari*/ min-height:"+this.minHeight+";/*safari*/}"),"li > ul:-moz-first-node, li > ol:-moz-first-node{ padding-top: 1.2em; } ","li{ min-height:1.2em; }","</style>",this._applyEditingAreaStyleSheets(),"</head><body onload='frameElement._loadFunc(window,document)' style='"+_afd+"'>"+html+"</body></html>"].join("");
},_drawIframe:function(html){
if(!this.iframe){
var ifr=this.iframe=dojo.doc.createElement("iframe");
ifr.id=this.id+"_iframe";
var ifrs=ifr.style;
ifrs.border="none";
ifrs.lineHeight="0";
ifrs.verticalAlign="bottom";
this.editorObject=this.iframe;
this._localizedIframeTitles=dojo.i18n.getLocalization("dijit.form","Textarea");
var _b02=dojo.query("label[for=\""+this.id+"\"]");
if(_b02.length){
this._localizedIframeTitles.iframeEditTitle=_b02[0].innerHTML+" "+this._localizedIframeTitles.iframeEditTitle;
}
ifr._loadFunc=function(win){
};
}
this.iframe.style.width=this.inheritWidth?this._oldWidth:"100%";
if(this._layoutMode){
this.iframe.style.height="100%";
}else{
if(this.height){
this.iframe.style.height=this.height;
}else{
this.iframe.height=this._oldHeight;
}
}
var _b04;
if(this.textarea){
_b04=this.srcNodeRef;
}else{
_b04=dojo.doc.createElement("div");
_b04.style.display="none";
_b04.innerHTML=html;
this.editingArea.appendChild(_b04);
}
this.editingArea.appendChild(this.iframe);
var _b05=dojo.hitch(this,function(){
if(!this.editNode){
if(!this.document){
try{
if(this.iframe.contentWindow){
this.window=this.iframe.contentWindow;
this.document=this.iframe.contentWindow.document;
}else{
if(this.iframe.contentDocument){
this.window=this.iframe.contentDocument.window;
this.document=this.iframe.contentDocument;
}
}
}
catch(e){
}
if(!this.document){
setTimeout(_b05,50);
return;
}
var _b06=this.document;
_b06.open();
if(dojo.isAIR){
_b06.body.innerHTML=html;
}else{
_b06.write(this._getIframeDocTxt(html));
}
_b06.close();
dojo._destroyElement(_b04);
}
if(!this.document.body){
setTimeout(_b05,50);
return;
}
this.onLoad();
}else{
dojo._destroyElement(_b04);
this.editNode.innerHTML=html;
this.onDisplayChanged();
}
this._preDomFilterContent(this.editNode);
});
_b05();
},_applyEditingAreaStyleSheets:function(){
var _b07=[];
if(this.styleSheets){
_b07=this.styleSheets.split(";");
this.styleSheets="";
}
_b07=_b07.concat(this.editingAreaStyleSheets);
this.editingAreaStyleSheets=[];
var text="",i=0,url;
while((url=_b07[i++])){
var _b0a=(new dojo._Url(dojo.global.location,url)).toString();
this.editingAreaStyleSheets.push(_b0a);
text+="<link rel=\"stylesheet\" type=\"text/css\" href=\""+_b0a+"\"/>";
}
return text;
},addStyleSheet:function(uri){
var url=uri.toString();
if(url.charAt(0)=="."||(url.charAt(0)!="/"&&!uri.host)){
url=(new dojo._Url(dojo.global.location,url)).toString();
}
if(dojo.indexOf(this.editingAreaStyleSheets,url)>-1){
return;
}
this.editingAreaStyleSheets.push(url);
if(this.document.createStyleSheet){
this.document.createStyleSheet(url);
}else{
var head=this.document.getElementsByTagName("head")[0];
var _b0e=this.document.createElement("link");
with(_b0e){
rel="stylesheet";
type="text/css";
href=url;
}
head.appendChild(_b0e);
}
},removeStyleSheet:function(uri){
var url=uri.toString();
if(url.charAt(0)=="."||(url.charAt(0)!="/"&&!uri.host)){
url=(new dojo._Url(dojo.global.location,url)).toString();
}
var _b11=dojo.indexOf(this.editingAreaStyleSheets,url);
if(_b11==-1){
return;
}
delete this.editingAreaStyleSheets[_b11];
dojo.withGlobal(this.window,"query",dojo,["link:[href=\""+url+"\"]"]).orphan();
},disabled:true,_mozSettingProps:{"styleWithCSS":false},_setDisabledAttr:function(_b12){
if(!this.editNode||"_delayedDisabled" in this){
this._delayedDisabled=_b12;
return;
}
_b12=Boolean(_b12);
if(dojo.isIE||dojo.isSafari||dojo.isOpera){
var _b13=dojo.isIE&&(this.isLoaded||!this.focusOnLoad);
if(_b13){
this.editNode.unselectable="on";
}
this.editNode.contentEditable=!_b12;
if(_b13){
var _b14=this;
setTimeout(function(){
_b14.editNode.unselectable="off";
},0);
}
}else{
try{
this.document.designMode=(_b12?"off":"on");
}
catch(e){
return;
}
if(!_b12&&this._mozSettingProps){
var ps=this._mozSettingProps;
for(var n in ps){
if(ps.hasOwnProperty(n)){
try{
this.document.execCommand(n,false,ps[n]);
}
catch(e){
}
}
}
}
}
this.disabled=_b12;
},_isResized:function(){
return false;
},onLoad:function(e){
if(!this.window.__registeredWindow){
this.window.__registeredWindow=true;
dijit.registerWin(this.window);
}
if(!dojo.isIE&&(this.height||dojo.isMoz)){
this.editNode=this.document.body;
}else{
this.editNode=this.document.body.firstChild;
var _b18=this;
if(dojo.isIE){
var _b19=this.tabStop=dojo.doc.createElement("<div tabIndex=-1>");
this.editingArea.appendChild(_b19);
this.iframe.onfocus=function(){
_b18.editNode.setActive();
};
}
}
this.focusNode=this.editNode;
try{
this.attr("disabled",false);
}
catch(e){
var _b1a=dojo.connect(this,"onClick",this,function(){
this.attr("disabled",false);
dojo.disconnect(_b1a);
});
}
this._preDomFilterContent(this.editNode);
var _b1b=this.events.concat(this.captureEvents);
var ap=(this.iframe)?this.document:this.editNode;
dojo.forEach(_b1b,function(item){
this.connect(ap,item.toLowerCase(),item);
},this);
if(dojo.isIE){
this.connect(this.document,"onmousedown","_onIEMouseDown");
this.editNode.style.zoom=1;
}
if(dojo.isSafari){
this._webkitListener=dojo.connect(this.document,"onmouseup",this,"onDisplayChanged");
}
if(this.focusOnLoad){
dojo.addOnLoad(dojo.hitch(this,"focus"));
}
this.onDisplayChanged(e);
if("_delayedDisabled" in this){
var d=this._delayedDisabled;
delete this._delayedDisabled;
this.attr("disabled",d);
}
this.isLoaded=true;
if(this.onLoadDeferred){
this.onLoadDeferred.callback(true);
}
},onKeyDown:function(e){
if(e.keyCode===dojo.keys.TAB&&this.isTabIndent){
dojo.stopEvent(e);
if(this.queryCommandEnabled((e.shiftKey?"outdent":"indent"))){
this.execCommand((e.shiftKey?"outdent":"indent"));
}
}
if(dojo.isIE){
if(e.keyCode==dojo.keys.TAB&&!this.isTabIndent){
if(e.shiftKey&&!e.ctrlKey&&!e.altKey){
this.iframe.focus();
}else{
if(!e.shiftKey&&!e.ctrlKey&&!e.altKey){
this.tabStop.focus();
}
}
}else{
if(e.keyCode===dojo.keys.BACKSPACE&&this.document.selection.type==="Control"){
dojo.stopEvent(e);
this.execCommand("delete");
}else{
if((65<=e.keyCode&&e.keyCode<=90)||(e.keyCode>=37&&e.keyCode<=40)){
e.charCode=e.keyCode;
this.onKeyPress(e);
}
}
}
}else{
if(dojo.isMoz&&!this.isTabIndent){
if(e.keyCode==dojo.keys.TAB&&!e.shiftKey&&!e.ctrlKey&&!e.altKey&&this.iframe){
var _b20=dojo.isFF<3?this.iframe.contentDocument:this.iframe;
_b20.title=this._localizedIframeTitles.iframeFocusTitle;
this.iframe.focus();
dojo.stopEvent(e);
}else{
if(e.keyCode==dojo.keys.TAB&&e.shiftKey){
if(this.toolbar){
this.toolbar.focus();
}
dojo.stopEvent(e);
}
}
}
}
return true;
},onKeyUp:function(e){
return;
},setDisabled:function(_b22){
dojo.deprecated("dijit.Editor::setDisabled is deprecated","use dijit.Editor::attr(\"disabled\",boolean) instead",2);
this.attr("disabled",_b22);
},_setValueAttr:function(_b23){
this.setValue(_b23);
},onKeyPress:function(e){
var c=(e.keyChar&&e.keyChar.toLowerCase())||e.keyCode;
var _b26=this._keyHandlers[c];
var args=arguments;
if(_b26&&!e.altKey){
dojo.forEach(_b26,function(h){
if((!!h.shift==!!e.shiftKey)&&(!!h.ctrl==!!e.ctrlKey)){
if(!h.handler.apply(this,args)){
e.preventDefault();
}
}
},this);
}
if(!this._onKeyHitch){
this._onKeyHitch=dojo.hitch(this,"onKeyPressed");
}
setTimeout(this._onKeyHitch,1);
return true;
},addKeyHandler:function(key,ctrl,_b2b,_b2c){
if(!dojo.isArray(this._keyHandlers[key])){
this._keyHandlers[key]=[];
}
this._keyHandlers[key].push({shift:_b2b||false,ctrl:ctrl||false,handler:_b2c});
},onKeyPressed:function(){
this.onDisplayChanged();
},onClick:function(e){
this.onDisplayChanged(e);
},_onIEMouseDown:function(e){
if(!this._focused&&!this.disabled){
this.focus();
}
},_onBlur:function(e){
this.inherited(arguments);
var _c=this.getValue(true);
if(_c!=this.savedContent){
this.onChange(_c);
this.savedContent=_c;
}
if(dojo.isMoz&&this.iframe){
var _b31=dojo.isFF<3?this.iframe.contentDocument:this.iframe;
_b31.title=this._localizedIframeTitles.iframeEditTitle;
}
},_initialFocus:true,_onFocus:function(e){
if(dojo.isMoz&&this._initialFocus){
this._initialFocus=false;
if(this.editNode.innerHTML.replace(/^\s+|\s+$/g,"")=="&nbsp;"){
this.placeCursorAtStart();
}
}
this.inherited(arguments);
},blur:function(){
if(!dojo.isIE&&this.window.document.documentElement&&this.window.document.documentElement.focus){
this.window.document.documentElement.focus();
}else{
if(dojo.doc.body.focus){
dojo.doc.body.focus();
}
}
},focus:function(){
if(!dojo.isIE){
dijit.focus(this.iframe);
}else{
if(this.editNode&&this.editNode.focus){
this.iframe.fireEvent("onfocus",document.createEventObject());
}
}
},updateInterval:200,_updateTimer:null,onDisplayChanged:function(e){
if(this._updateTimer){
clearTimeout(this._updateTimer);
}
if(!this._updateHandler){
this._updateHandler=dojo.hitch(this,"onNormalizedDisplayChanged");
}
this._updateTimer=setTimeout(this._updateHandler,this.updateInterval);
},onNormalizedDisplayChanged:function(){
delete this._updateTimer;
},onChange:function(_b34){
},_normalizeCommand:function(cmd,_b36){
var _b37=cmd.toLowerCase();
if(_b37=="formatblock"){
if(dojo.isSafari&&_b36===undefined){
_b37="heading";
}
}else{
if(_b37=="hilitecolor"&&!dojo.isMoz){
_b37="backcolor";
}
}
return _b37;
},_qcaCache:{},queryCommandAvailable:function(_b38){
var ca=this._qcaCache[_b38];
if(ca!=undefined){
return ca;
}
return this._qcaCache[_b38]=this._queryCommandAvailable(_b38);
},_queryCommandAvailable:function(_b3a){
var ie=1;
var _b3c=1<<1;
var _b3d=1<<2;
var _b3e=1<<3;
var _b3f=1<<4;
var _b40=dojo.isSafari;
function isSupportedBy(_b41){
return {ie:Boolean(_b41&ie),mozilla:Boolean(_b41&_b3c),safari:Boolean(_b41&_b3d),safari420:Boolean(_b41&_b3f),opera:Boolean(_b41&_b3e)};
};
var _b42=null;
switch(_b3a.toLowerCase()){
case "bold":
case "italic":
case "underline":
case "subscript":
case "superscript":
case "fontname":
case "fontsize":
case "forecolor":
case "hilitecolor":
case "justifycenter":
case "justifyfull":
case "justifyleft":
case "justifyright":
case "delete":
case "selectall":
case "toggledir":
_b42=isSupportedBy(_b3c|ie|_b3d|_b3e);
break;
case "createlink":
case "unlink":
case "removeformat":
case "inserthorizontalrule":
case "insertimage":
case "insertorderedlist":
case "insertunorderedlist":
case "indent":
case "outdent":
case "formatblock":
case "inserthtml":
case "undo":
case "redo":
case "strikethrough":
case "tabindent":
_b42=isSupportedBy(_b3c|ie|_b3e|_b3f);
break;
case "blockdirltr":
case "blockdirrtl":
case "dirltr":
case "dirrtl":
case "inlinedirltr":
case "inlinedirrtl":
_b42=isSupportedBy(ie);
break;
case "cut":
case "copy":
case "paste":
_b42=isSupportedBy(ie|_b3c|_b3f);
break;
case "inserttable":
_b42=isSupportedBy(_b3c|ie);
break;
case "insertcell":
case "insertcol":
case "insertrow":
case "deletecells":
case "deletecols":
case "deleterows":
case "mergecells":
case "splitcell":
_b42=isSupportedBy(ie|_b3c);
break;
default:
return false;
}
return (dojo.isIE&&_b42.ie)||(dojo.isMoz&&_b42.mozilla)||(dojo.isSafari&&_b42.safari)||(_b40&&_b42.safari420)||(dojo.isOpera&&_b42.opera);
},execCommand:function(_b43,_b44){
var _b45;
this.focus();
_b43=this._normalizeCommand(_b43,_b44);
if(_b44!=undefined){
if(_b43=="heading"){
throw new Error("unimplemented");
}else{
if((_b43=="formatblock")&&dojo.isIE){
_b44="<"+_b44+">";
}
}
}
if(_b43==="inserthorizontalrule"&&dojo.isIE){
_b43="inserthtml";
_b44="<hr>";
}
if(_b43=="inserthtml"){
_b44=this._preFilterContent(_b44);
_b45=true;
if(dojo.isIE){
var _b46=this.document.selection.createRange();
if(this.document.selection.type.toUpperCase()=="CONTROL"){
var n=_b46.item(0);
while(_b46.length){
_b46.remove(_b46.item(0));
}
n.outerHTML=_b44;
}else{
_b46.pasteHTML(_b44);
}
_b46.select();
}else{
if(dojo.isMoz&&!_b44.length){
this._sCall("remove");
}else{
_b45=this.document.execCommand(_b43,false,_b44);
}
}
}else{
if((_b43=="unlink")&&(this.queryCommandEnabled("unlink"))&&(dojo.isMoz||dojo.isSafari)){
var a=this._sCall("getAncestorElement",["a"]);
this._sCall("selectElement",[a]);
_b45=this.document.execCommand("unlink",false,null);
}else{
if((_b43=="hilitecolor")&&(dojo.isMoz)){
this.document.execCommand("styleWithCSS",false,true);
_b45=this.document.execCommand(_b43,false,_b44);
this.document.execCommand("styleWithCSS",false,false);
}else{
if((dojo.isIE)&&((_b43=="backcolor")||(_b43=="forecolor"))){
_b44=arguments.length>1?_b44:null;
_b45=this.document.execCommand(_b43,false,_b44);
}else{
_b44=arguments.length>1?_b44:null;
if(_b44||_b43!="createlink"){
_b45=this.document.execCommand(_b43,false,_b44);
}
}
}
}
}
this.onDisplayChanged();
return _b45;
},queryCommandEnabled:function(_b49){
if(this.disabled){
return false;
}
_b49=this._normalizeCommand(_b49);
if(dojo.isMoz||dojo.isSafari){
if(_b49=="unlink"){
this._sCall("hasAncestorElement",["a"]);
}else{
if(_b49=="inserttable"){
return true;
}
}
}
if(dojo.isSafari){
if(_b49=="copy"){
_b49="cut";
}else{
if(_b49=="paste"){
return true;
}
}
}
var elem=dojo.isIE?this.document.selection.createRange():this.document;
return elem.queryCommandEnabled(_b49);
},queryCommandState:function(_b4b){
if(this.disabled){
return false;
}
_b4b=this._normalizeCommand(_b4b);
return this.document.queryCommandState(_b4b);
},queryCommandValue:function(_b4c){
if(this.disabled){
return false;
}
var r;
_b4c=this._normalizeCommand(_b4c);
if(dojo.isIE&&_b4c=="formatblock"){
r=this._native2LocalFormatNames[this.document.queryCommandValue(_b4c)];
}else{
r=this.document.queryCommandValue(_b4c);
}
return r;
},_sCall:function(name,args){
return dojo.withGlobal(this.window,name,dijit._editor.selection,args);
},placeCursorAtStart:function(){
this.focus();
var _b50=false;
if(dojo.isMoz){
var _b51=this.editNode.firstChild;
while(_b51){
if(_b51.nodeType==3){
if(_b51.nodeValue.replace(/^\s+|\s+$/g,"").length>0){
_b50=true;
this._sCall("selectElement",[_b51]);
break;
}
}else{
if(_b51.nodeType==1){
_b50=true;
this._sCall("selectElementChildren",[_b51]);
break;
}
}
_b51=_b51.nextSibling;
}
}else{
_b50=true;
this._sCall("selectElementChildren",[this.editNode]);
}
if(_b50){
this._sCall("collapse",[true]);
}
},placeCursorAtEnd:function(){
this.focus();
var _b52=false;
if(dojo.isMoz){
var last=this.editNode.lastChild;
while(last){
if(last.nodeType==3){
if(last.nodeValue.replace(/^\s+|\s+$/g,"").length>0){
_b52=true;
this._sCall("selectElement",[last]);
break;
}
}else{
if(last.nodeType==1){
_b52=true;
if(last.lastChild){
this._sCall("selectElement",[last.lastChild]);
}else{
this._sCall("selectElement",[last]);
}
break;
}
}
last=last.previousSibling;
}
}else{
_b52=true;
this._sCall("selectElementChildren",[this.editNode]);
}
if(_b52){
this._sCall("collapse",[false]);
}
},getValue:function(_b54){
if(this.textarea){
if(this.isClosed||!this.isLoaded){
return this.textarea.value;
}
}
return this._postFilterContent(null,_b54);
},_getValueAttr:function(){
return this.getValue();
},setValue:function(html){
if(!this.isLoaded){
this.onLoadDeferred.addCallback(dojo.hitch(this,function(){
this.setValue(html);
}));
return;
}
if(this.textarea&&(this.isClosed||!this.isLoaded)){
this.textarea.value=html;
}else{
html=this._preFilterContent(html);
var node=this.isClosed?this.domNode:this.editNode;
node.innerHTML=html;
this._preDomFilterContent(node);
}
this.onDisplayChanged();
},replaceValue:function(html){
if(this.isClosed){
this.setValue(html);
}else{
if(this.window&&this.window.getSelection&&!dojo.isMoz){
this.setValue(html);
}else{
if(this.window&&this.window.getSelection){
html=this._preFilterContent(html);
this.execCommand("selectall");
if(dojo.isMoz&&!html){
html="&nbsp;";
}
this.execCommand("inserthtml",html);
this._preDomFilterContent(this.editNode);
}else{
if(this.document&&this.document.selection){
this.setValue(html);
}
}
}
}
},_preFilterContent:function(html){
var ec=html;
dojo.forEach(this.contentPreFilters,function(ef){
if(ef){
ec=ef(ec);
}
});
return ec;
},_preDomFilterContent:function(dom){
dom=dom||this.editNode;
dojo.forEach(this.contentDomPreFilters,function(ef){
if(ef&&dojo.isFunction(ef)){
ef(dom);
}
},this);
},_postFilterContent:function(dom,_b5e){
var ec;
if(!dojo.isString(dom)){
dom=dom||this.editNode;
if(this.contentDomPostFilters.length){
if(_b5e){
dom=dojo.clone(dom);
}
dojo.forEach(this.contentDomPostFilters,function(ef){
dom=ef(dom);
});
}
ec=dijit._editor.getChildrenHtml(dom);
}else{
ec=dom;
}
if(!dojo.trim(ec.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length){
ec="";
}
dojo.forEach(this.contentPostFilters,function(ef){
ec=ef(ec);
});
return ec;
},_saveContent:function(e){
var _b63=dojo.byId(dijit._scopeName+"._editor.RichText.savedContent");
_b63.value+=this._SEPARATOR+this.name+":"+this.getValue();
},escapeXml:function(str,_b65){
str=str.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");
if(!_b65){
str=str.replace(/'/gm,"&#39;");
}
return str;
},getNodeHtml:function(node){
dojo.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit._editor.getNodeHtml instead",2);
return dijit._editor.getNodeHtml(node);
},getNodeChildrenHtml:function(dom){
dojo.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit._editor.getChildrenHtml instead",2);
return dijit._editor.getChildrenHtml(dom);
},close:function(save,_b69){
if(this.isClosed){
return false;
}
if(!arguments.length){
save=true;
}
this._content=this.getValue();
var _b6a=(this.savedContent!=this._content);
if(this.interval){
clearInterval(this.interval);
}
if(this._webkitListener){
dojo.disconnect(this._webkitListener);
delete this._webkitListener;
}
if(dojo.isIE){
this.iframe.onfocus=null;
}
this.iframe._loadFunc=null;
if(this.textarea){
with(this.textarea.style){
position="";
left=top="";
if(dojo.isIE){
overflow=this.__overflow;
this.__overflow=null;
}
}
this.textarea.value=save?this._content:this.savedContent;
dojo._destroyElement(this.domNode);
this.domNode=this.textarea;
}else{
this.domNode.innerHTML=save?this._content:this.savedContent;
}
delete this.iframe;
dojo.removeClass(this.domNode,"RichTextEditable");
this.isClosed=true;
this.isLoaded=false;
delete this.editNode;
if(this.window&&this.window._frameElement){
this.window._frameElement=null;
}
this.window=null;
this.document=null;
this.editingArea=null;
this.editorObject=null;
return _b6a;
},destroyRendering:function(_b6b){
this.inherited(arguments,[true]);
},destroy:function(){
if(!this.isClosed){
this.close(false);
}
this.inherited("destroy",arguments);
},_removeMozBogus:function(html){
return html.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"");
},_removeSafariBogus:function(html){
return html.replace(/\sclass="webkit-block-placeholder"/gi,"");
},_fixContentForMoz:function(html){
return html.replace(/<(\/)?strong([ \>])/gi,"<$1b$2").replace(/<(\/)?em([ \>])/gi,"<$1i$2");
},_preFixUrlAttributes:function(html){
return html.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl=$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl=$2$3$5$2");
}});
}
if(!dojo._hasResource["dijit.Toolbar"]){
dojo._hasResource["dijit.Toolbar"]=true;
dojo.provide("dijit.Toolbar");
dojo.declare("dijit.Toolbar",[dijit._Widget,dijit._Templated,dijit._KeyNavContainer],{templateString:"<div class=\"dijit dijitToolbar\" waiRole=\"toolbar\" tabIndex=\"${tabIndex}\" dojoAttachPoint=\"containerNode\">"+"</div>",tabIndex:"0",postCreate:function(){
this.connectKeyNavHandlers(this.isLeftToRight()?[dojo.keys.LEFT_ARROW]:[dojo.keys.RIGHT_ARROW],this.isLeftToRight()?[dojo.keys.RIGHT_ARROW]:[dojo.keys.LEFT_ARROW]);
},startup:function(){
if(this._started){
return;
}
this.startupKeyNavChildren();
this.inherited(arguments);
}});
dojo.declare("dijit.ToolbarSeparator",[dijit._Widget,dijit._Templated],{templateString:"<div class=\"dijitToolbarSeparator dijitInline\"></div>",postCreate:function(){
dojo.setSelectable(this.domNode,false);
},isFocusable:function(){
return false;
}});
}
if(!dojo._hasResource["dijit.form._FormWidget"]){
dojo._hasResource["dijit.form._FormWidget"]=true;
dojo.provide("dijit.form._FormWidget");
dojo.declare("dijit.form._FormWidget",[dijit._Widget,dijit._Templated],{baseClass:"",name:"",alt:"",value:"",type:"text",tabIndex:"0",disabled:false,readOnly:false,intermediateChanges:false,attributeMap:dojo.mixin(dojo.clone(dijit._Widget.prototype.attributeMap),{value:"focusNode",disabled:"focusNode",readOnly:"focusNode",id:"focusNode",tabIndex:"focusNode",alt:"focusNode"}),_setDisabledAttr:function(_b70){
this.disabled=_b70;
dojo.attr(this.focusNode,"disabled",_b70);
dijit.setWaiState(this.focusNode,"disabled",_b70);
if(_b70){
this._hovering=false;
this._active=false;
this.focusNode.removeAttribute("tabIndex");
}else{
this.focusNode.setAttribute("tabIndex",this.tabIndex);
}
this._setStateClass();
},setDisabled:function(_b71){
dojo.deprecated("setDisabled("+_b71+") is deprecated. Use attr('disabled',"+_b71+") instead.","","2.0");
this.attr("disabled",_b71);
},_scroll:true,_onFocus:function(e){
if(this._scroll){
dijit.scrollIntoView(this.domNode);
}
this.inherited(arguments);
},_onMouse:function(_b73){
var _b74=_b73.currentTarget;
if(_b74&&_b74.getAttribute){
this.stateModifier=_b74.getAttribute("stateModifier")||"";
}
if(!this.disabled){
switch(_b73.type){
case "mouseenter":
case "mouseover":
this._hovering=true;
this._active=this._mouseDown;
break;
case "mouseout":
case "mouseleave":
this._hovering=false;
this._active=false;
break;
case "mousedown":
this._active=true;
this._mouseDown=true;
var _b75=this.connect(dojo.body(),"onmouseup",function(){
if(this._mouseDown&&this.isFocusable()){
this.focus();
}
this._active=false;
this._mouseDown=false;
this._setStateClass();
this.disconnect(_b75);
});
break;
}
this._setStateClass();
}
},isFocusable:function(){
return !this.disabled&&!this.readOnly&&this.focusNode&&(dojo.style(this.domNode,"display")!="none");
},focus:function(){
dijit.focus(this.focusNode);
},_setStateClass:function(){
var _b76=this.baseClass.split(" ");
function multiply(_b77){
_b76=_b76.concat(dojo.map(_b76,function(c){
return c+_b77;
}),"dijit"+_b77);
};
if(this.checked){
multiply("Checked");
}
if(this.state){
multiply(this.state);
}
if(this.selected){
multiply("Selected");
}
if(this.disabled){
multiply("Disabled");
}else{
if(this.readOnly){
multiply("ReadOnly");
}else{
if(this._active){
multiply(this.stateModifier+"Active");
}else{
if(this._focused){
multiply("Focused");
}
if(this._hovering){
multiply(this.stateModifier+"Hover");
}
}
}
}
var tn=this.stateNode||this.domNode,_b7a={};
dojo.forEach(tn.className.split(" "),function(c){
_b7a[c]=true;
});
if("_stateClasses" in this){
dojo.forEach(this._stateClasses,function(c){
delete _b7a[c];
});
}
dojo.forEach(_b76,function(c){
_b7a[c]=true;
});
var _b7e=[];
for(var c in _b7a){
_b7e.push(c);
}
tn.className=_b7e.join(" ");
this._stateClasses=_b76;
},compare:function(val1,val2){
if((typeof val1=="number")&&(typeof val2=="number")){
return (isNaN(val1)&&isNaN(val2))?0:(val1-val2);
}else{
if(val1>val2){
return 1;
}else{
if(val1<val2){
return -1;
}else{
return 0;
}
}
}
},onChange:function(_b82){
},_onChangeActive:false,_handleOnChange:function(_b83,_b84){
this._lastValue=_b83;
if(this._lastValueReported==undefined&&(_b84===null||!this._onChangeActive)){
this._resetValue=this._lastValueReported=_b83;
}
if((this.intermediateChanges||_b84||_b84===undefined)&&((typeof _b83!=typeof this._lastValueReported)||this.compare(_b83,this._lastValueReported)!=0)){
this._lastValueReported=_b83;
if(this._onChangeActive){
this.onChange(_b83);
}
}
},create:function(){
this.inherited(arguments);
this._onChangeActive=true;
this._setStateClass();
},destroy:function(){
if(this._layoutHackHandle){
clearTimeout(this._layoutHackHandle);
}
this.inherited(arguments);
},setValue:function(_b85){
dojo.deprecated("dijit.form._FormWidget:setValue("+_b85+") is deprecated.  Use attr('value',"+_b85+") instead.","","2.0");
this.attr("value",_b85);
},getValue:function(){
dojo.deprecated(this.declaredClass+"::getValue() is deprecated. Use attr('value') instead.","","2.0");
return this.attr("value");
},_layoutHack:function(){
if(dojo.isFF==2&&!this._layoutHackHandle){
var node=this.domNode;
var old=node.style.opacity;
node.style.opacity="0.999";
this._layoutHackHandle=setTimeout(dojo.hitch(this,function(){
this._layoutHackHandle=null;
node.style.opacity=old;
}),0);
}
}});
dojo.declare("dijit.form._FormValueWidget",dijit.form._FormWidget,{attributeMap:dojo.mixin(dojo.clone(dijit.form._FormWidget.prototype.attributeMap),{value:""}),postCreate:function(){
if(dojo.isIE||dojo.isSafari){
this.connect(this.focusNode||this.domNode,"onkeydown",this._onKeyDown);
}
if(this._resetValue===undefined){
this._resetValue=this.value;
}
},_setValueAttr:function(_b88,_b89){
this.value=_b88;
this._handleOnChange(_b88,_b89);
},_getValueAttr:function(_b8a){
return this._lastValue;
},undo:function(){
this._setValueAttr(this._lastValueReported,false);
},reset:function(){
this._hasBeenBlurred=false;
this._setValueAttr(this._resetValue,true);
},_valueChanged:function(){
var v=this.attr("value");
var lv=this._lastValueReported;
return ((v!==null&&(v!==undefined)&&v.toString)?v.toString():"")!==((lv!==null&&(lv!==undefined)&&lv.toString)?lv.toString():"");
},_onKeyDown:function(e){
if(e.keyCode==dojo.keys.ESCAPE&&!e.ctrlKey&&!e.altKey){
var te;
if(dojo.isIE){
e.preventDefault();
te=document.createEventObject();
te.keyCode=dojo.keys.ESCAPE;
te.shiftKey=e.shiftKey;
e.srcElement.fireEvent("onkeypress",te);
}else{
if(dojo.isSafari){
te=document.createEvent("Events");
te.initEvent("keypress",true,true);
te.keyCode=dojo.keys.ESCAPE;
te.shiftKey=e.shiftKey;
e.target.dispatchEvent(te);
}
}
}
},_onKeyPress:function(e){
if(e.charOrCode==dojo.keys.ESCAPE&&!e.ctrlKey&&!e.altKey&&this._valueChanged()){
this.undo();
dojo.stopEvent(e);
return false;
}else{
if(this.intermediateChanges){
var _b90=this;
setTimeout(function(){
_b90._handleOnChange(_b90.attr("value"),false);
},0);
}
}
return true;
}});
}
if(!dojo._hasResource["dijit.form.Button"]){
dojo._hasResource["dijit.form.Button"]=true;
dojo.provide("dijit.form.Button");
dojo.declare("dijit.form.Button",dijit.form._FormWidget,{label:"",showLabel:true,iconClass:"",type:"button",baseClass:"dijitButton",templateString:"<span class=\"dijit dijitReset dijitLeft dijitInline\"\r\n\tdojoAttachEvent=\"ondijitclick:_onButtonClick,onmouseenter:_onMouse,onmouseleave:_onMouse,onmousedown:_onMouse\"\r\n\t><span class=\"dijitReset dijitRight dijitInline\"\r\n\t\t><span class=\"dijitReset dijitInline dijitButtonNode\"\r\n\t\t\t><button class=\"dijitReset dijitStretch dijitButtonContents\"\r\n\t\t\t\tdojoAttachPoint=\"titleNode,focusNode\" \r\n\t\t\t\tname=\"${name}\" type=\"${type}\" waiRole=\"button\" waiState=\"labelledby-${id}_label\"\r\n\t\t\t\t><span class=\"dijitReset dijitInline\" dojoAttachPoint=\"iconNode\" \r\n\t\t\t\t\t><span class=\"dijitReset dijitToggleButtonIconChar\">&#10003;</span \r\n\t\t\t\t></span \r\n\t\t\t\t><span class=\"dijitReset dijitInline dijitButtonText\" \r\n\t\t\t\t\tid=\"${id}_label\"  \r\n\t\t\t\t\tdojoAttachPoint=\"containerNode\"\r\n\t\t\t\t></span\r\n\t\t\t></button\r\n\t\t></span\r\n\t></span\r\n></span>\r\n",attributeMap:dojo.mixin(dojo.clone(dijit.form._FormWidget.prototype.attributeMap),{label:{node:"containerNode",type:"innerHTML"},iconClass:{node:"iconNode",type:"class"}}),_onClick:function(e){
if(this.disabled||this.readOnly){
return false;
}
this._clicked();
return this.onClick(e);
},_onButtonClick:function(e){
if(e.type!="click"&&!(this.type=="submit"||this.type=="reset")){
dojo.stopEvent(e);
}
if(this._onClick(e)===false){
e.preventDefault();
}else{
if(this.type=="submit"&&!this.focusNode.form){
for(var node=this.domNode;node.parentNode;node=node.parentNode){
var _b94=dijit.byNode(node);
if(_b94&&typeof _b94._onSubmit=="function"){
_b94._onSubmit(e);
break;
}
}
}
}
},_fillContent:function(_b95){
if(_b95&&!("label" in this.params)){
this.attr("label",_b95.innerHTML);
}
},postCreate:function(){
if(this.showLabel==false){
dojo.addClass(this.containerNode,"dijitDisplayNone");
}
dojo.setSelectable(this.focusNode,false);
this.inherited(arguments);
},onClick:function(e){
return true;
},_clicked:function(e){
},setLabel:function(_b98){
dojo.deprecated("dijit.form.Button.setLabel() is deprecated.  Use attr('label', ...) instead.","","2.0");
this.attr("label",_b98);
},_setLabelAttr:function(_b99){
this.containerNode.innerHTML=this.label=_b99;
this._layoutHack();
if(this.showLabel==false&&!this.params.title){
this.titleNode.title=dojo.trim(this.containerNode.innerText||this.containerNode.textContent||"");
}
}});
dojo.declare("dijit.form.DropDownButton",[dijit.form.Button,dijit._Container],{baseClass:"dijitDropDownButton",templateString:"<span class=\"dijit dijitReset dijitLeft dijitInline\"\r\n\tdojoAttachEvent=\"onmouseenter:_onMouse,onmouseleave:_onMouse,onmousedown:_onMouse,onclick:_onDropDownClick,onkeydown:_onDropDownKeydown,onblur:_onDropDownBlur,onkeypress:_onKey\"\r\n\t><span class='dijitReset dijitRight dijitInline'\r\n\t\t><span class='dijitReset dijitInline dijitButtonNode'\r\n\t\t\t><button class=\"dijitReset dijitStretch dijitButtonContents\" \r\n\t\t\t\ttype=\"${type}\" name=\"${name}\"\r\n\t\t\t\tdojoAttachPoint=\"focusNode,titleNode\" \r\n\t\t\t\twaiRole=\"button\" waiState=\"haspopup-true,labelledby-${id}_label\"\r\n\t\t\t\t><span class=\"dijitReset dijitInline\" \r\n\t\t\t\t\tdojoAttachPoint=\"iconNode\"\r\n\t\t\t\t></span\r\n\t\t\t\t><span class=\"dijitReset dijitInline dijitButtonText\"  \r\n\t\t\t\t\tdojoAttachPoint=\"containerNode,popupStateNode\" \r\n\t\t\t\t\tid=\"${id}_label\"\r\n\t\t\t\t></span\r\n\t\t\t\t><span class=\"dijitReset dijitInline dijitArrowButtonInner\">&thinsp;</span\r\n\t\t\t\t><span class=\"dijitReset dijitInline dijitArrowButtonChar\">&#9660;</span\r\n\t\t\t></button\r\n\t\t></span\r\n\t></span\r\n></span>\r\n",_fillContent:function(){
if(this.srcNodeRef){
var _b9a=dojo.query("*",this.srcNodeRef);
dijit.form.DropDownButton.superclass._fillContent.call(this,_b9a[0]);
this.dropDownContainer=this.srcNodeRef;
}
},startup:function(){
if(this._started){
return;
}
if(!this.dropDown){
var _b9b=dojo.query("[widgetId]",this.dropDownContainer)[0];
this.dropDown=dijit.byNode(_b9b);
delete this.dropDownContainer;
}
dijit.popup.prepare(this.dropDown.domNode);
this.inherited(arguments);
},destroyDescendants:function(){
if(this.dropDown){
this.dropDown.destroyRecursive();
delete this.dropDown;
}
this.inherited(arguments);
},_onArrowClick:function(e){
if(this.disabled||this.readOnly){
return;
}
this._toggleDropDown();
},_onDropDownClick:function(e){
var _b9e=dojo.isFF&&dojo.isFF<3&&navigator.appVersion.indexOf("Macintosh")!=-1;
if(!_b9e||e.detail!=0||this._seenKeydown){
this._onArrowClick(e);
}
this._seenKeydown=false;
},_onDropDownKeydown:function(e){
this._seenKeydown=true;
},_onDropDownBlur:function(e){
this._seenKeydown=false;
},_onKey:function(e){
if(this.disabled||this.readOnly){
return;
}
if(e.charOrCode==dojo.keys.DOWN_ARROW){
if(!this.dropDown||this.dropDown.domNode.style.visibility=="hidden"){
dojo.stopEvent(e);
this._toggleDropDown();
}
}
},_onBlur:function(){
this._closeDropDown();
this.inherited(arguments);
},_toggleDropDown:function(){
if(this.disabled||this.readOnly){
return;
}
dijit.focus(this.popupStateNode);
var _ba2=this.dropDown;
if(!_ba2){
return;
}
if(!this._opened){
if(_ba2.href&&!_ba2.isLoaded){
var self=this;
var _ba4=dojo.connect(_ba2,"onLoad",function(){
dojo.disconnect(_ba4);
self._openDropDown();
});
_ba2._loadCheck(true);
return;
}else{
this._openDropDown();
}
}else{
this._closeDropDown();
}
},_openDropDown:function(){
var _ba5=this.dropDown;
var _ba6=_ba5.domNode.style.width;
var self=this;
dijit.popup.open({parent:this,popup:_ba5,around:this.domNode,orient:this.isLeftToRight()?{"BL":"TL","BR":"TR","TL":"BL","TR":"BR"}:{"BR":"TR","BL":"TL","TR":"BR","TL":"BL"},onExecute:function(){
self._closeDropDown(true);
},onCancel:function(){
self._closeDropDown(true);
},onClose:function(){
_ba5.domNode.style.width=_ba6;
self.popupStateNode.removeAttribute("popupActive");
self._opened=false;
}});
if(this.domNode.offsetWidth>_ba5.domNode.offsetWidth){
var _ba8=null;
if(!this.isLeftToRight()){
_ba8=_ba5.domNode.parentNode;
var _ba9=_ba8.offsetLeft+_ba8.offsetWidth;
}
dojo.marginBox(_ba5.domNode,{w:this.domNode.offsetWidth});
if(_ba8){
_ba8.style.left=_ba9-this.domNode.offsetWidth+"px";
}
}
this.popupStateNode.setAttribute("popupActive","true");
this._opened=true;
if(_ba5.focus){
_ba5.focus();
}
},_closeDropDown:function(_baa){
if(this._opened){
dijit.popup.close(this.dropDown);
if(_baa){
this.focus();
}
this._opened=false;
}
}});
dojo.declare("dijit.form.ComboButton",dijit.form.DropDownButton,{templateString:"<table class='dijit dijitReset dijitInline dijitLeft'\r\n\tcellspacing='0' cellpadding='0' waiRole=\"presentation\"\r\n\t><tbody waiRole=\"presentation\"><tr waiRole=\"presentation\"\r\n\t\t><td class=\"dijitReset dijitStretch dijitButtonContents dijitButtonNode\"\r\n\t\t\tdojoAttachEvent=\"ondijitclick:_onButtonClick,onmouseenter:_onMouse,onmouseleave:_onMouse,onmousedown:_onMouse\"  dojoAttachPoint=\"titleNode\"\r\n\t\t\twaiRole=\"button\" waiState=\"labelledby-${id}_label\"\r\n\t\t\t><div class=\"dijitReset dijitInline\" dojoAttachPoint=\"iconNode\" waiRole=\"presentation\"></div\r\n\t\t\t><div class=\"dijitReset dijitInline dijitButtonText\" id=\"${id}_label\" dojoAttachPoint=\"containerNode\" waiRole=\"presentation\"></div\r\n\t\t></td\r\n\t\t><td class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton'\r\n\t\t\tdojoAttachPoint=\"popupStateNode,focusNode\"\r\n\t\t\tdojoAttachEvent=\"ondijitclick:_onArrowClick, onkeypress:_onKey,onmouseenter:_onMouse,onmouseleave:_onMouse\"\r\n\t\t\tstateModifier=\"DownArrow\"\r\n\t\t\ttitle=\"${optionsTitle}\" name=\"${name}\"\r\n\t\t\twaiRole=\"button\" waiState=\"haspopup-true\"\r\n\t\t\t><div class=\"dijitReset dijitArrowButtonInner\" waiRole=\"presentation\">&thinsp;</div\r\n\t\t\t><div class=\"dijitReset dijitArrowButtonChar\" waiRole=\"presentation\">&#9660;</div\r\n\t\t></td\r\n\t></tr></tbody\r\n></table>\r\n",attributeMap:dojo.mixin(dojo.clone(dijit.form.Button.prototype.attributeMap),{id:"",name:"",tabIndex:["focusNode","titleNode"]}),optionsTitle:"",baseClass:"dijitComboButton",_focusedNode:null,postCreate:function(){
this.inherited(arguments);
this._focalNodes=[this.titleNode,this.popupStateNode];
dojo.forEach(this._focalNodes,dojo.hitch(this,function(node){
if(dojo.isIE){
this.connect(node,"onactivate",this._onNodeFocus);
this.connect(node,"ondeactivate",this._onNodeBlur);
}else{
this.connect(node,"onfocus",this._onNodeFocus);
this.connect(node,"onblur",this._onNodeBlur);
}
}));
},focusFocalNode:function(node){
this._focusedNode=node;
dijit.focus(node);
},hasNextFocalNode:function(){
return this._focusedNode!==this.getFocalNodes()[1];
},focusNext:function(){
this._focusedNode=this.getFocalNodes()[this._focusedNode?1:0];
dijit.focus(this._focusedNode);
},hasPrevFocalNode:function(){
return this._focusedNode!==this.getFocalNodes()[0];
},focusPrev:function(){
this._focusedNode=this.getFocalNodes()[this._focusedNode?0:1];
dijit.focus(this._focusedNode);
},getFocalNodes:function(){
return this._focalNodes;
},_onNodeFocus:function(evt){
this._focusedNode=evt.currentTarget;
var fnc=this._focusedNode==this.focusNode?"dijitDownArrowButtonFocused":"dijitButtonContentsFocused";
dojo.addClass(this._focusedNode,fnc);
},_onNodeBlur:function(evt){
var fnc=evt.currentTarget==this.focusNode?"dijitDownArrowButtonFocused":"dijitButtonContentsFocused";
dojo.removeClass(evt.currentTarget,fnc);
},_onBlur:function(){
this.inherited(arguments);
this._focusedNode=null;
}});
dojo.declare("dijit.form.ToggleButton",dijit.form.Button,{baseClass:"dijitToggleButton",checked:false,attributeMap:dojo.mixin(dojo.clone(dijit.form.Button.prototype.attributeMap),{checked:"focusNode"}),_clicked:function(evt){
this.attr("checked",!this.checked);
},_setCheckedAttr:function(_bb2){
this.checked=_bb2;
dojo.attr(this.focusNode||this.domNode,"checked",_bb2);
dijit.setWaiState(this.focusNode||this.domNode,"pressed",_bb2);
this._setStateClass();
this._handleOnChange(_bb2,true);
},setChecked:function(_bb3){
dojo.deprecated("setChecked("+_bb3+") is deprecated. Use attr('checked',"+_bb3+") instead.","","2.0");
this.attr("checked",_bb3);
},reset:function(){
this._hasBeenBlurred=false;
this.attr("checked",this.params.checked||false);
}});
}
if(!dojo._hasResource["dijit._editor._Plugin"]){
dojo._hasResource["dijit._editor._Plugin"]=true;
dojo.provide("dijit._editor._Plugin");
dojo.declare("dijit._editor._Plugin",null,{constructor:function(args,node){
if(args){
dojo.mixin(this,args);
}
this._connects=[];
},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,queryCommand:null,command:"",commandArg:null,useDefaultCommand:true,buttonClass:dijit.form.Button,getLabel:function(key){
return this.editor.commands[key];
},_initButton:function(_bb7){
if(this.command.length){
var _bb8=this.getLabel(this.command);
var _bb9=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);
if(!this.button){
_bb7=dojo.mixin({label:_bb8,showLabel:false,iconClass:_bb9,dropDown:this.dropDown,tabIndex:"-1"},_bb7||{});
this.button=new this.buttonClass(_bb7);
}
}
},destroy:function(f){
dojo.forEach(this._connects,dojo.disconnect);
},connect:function(o,f,tf){
this._connects.push(dojo.connect(o,f,this,tf));
},updateState:function(){
var e=this.editor;
var c=this.command;
if(!e){
return;
}
if(!e.isLoaded){
return;
}
if(!c.length){
return;
}
if(this.button){
try{
var _bc0=e.queryCommandEnabled(c);
if(this.enabled!==_bc0){
this.enabled=_bc0;
this.button.attr("disabled",!_bc0);
}
if(typeof this.button.checked=="boolean"){
var _bc1=e.queryCommandState(c);
if(this.checked!==_bc1){
this.checked=_bc1;
this.button.attr("checked",e.queryCommandState(c));
}
}
}
catch(err){
console.debug(err);
}
}
},setEditor:function(_bc2){
this.editor=_bc2;
this._initButton();
if(this.command.length&&!this.editor.queryCommandAvailable(this.command)){
if(this.button){
this.button.domNode.style.display="none";
}
}
if(this.button&&this.useDefaultCommand){
this.connect(this.button,"onClick",dojo.hitch(this.editor,"execCommand",this.command,this.commandArg));
}
this.connect(this.editor,"onNormalizedDisplayChanged","updateState");
},setToolbar:function(_bc3){
if(this.button){
_bc3.addChild(this.button);
}
}});
}
if(!dojo._hasResource["dijit._editor.plugins.EnterKeyHandling"]){
dojo._hasResource["dijit._editor.plugins.EnterKeyHandling"]=true;
dojo.provide("dijit._editor.plugins.EnterKeyHandling");
dojo.declare("dijit._editor.plugins.EnterKeyHandling",dijit._editor._Plugin,{blockNodeForEnter:"BR",constructor:function(args){
if(args){
dojo.mixin(this,args);
}
},setEditor:function(_bc5){
this.editor=_bc5;
if(this.blockNodeForEnter=="BR"){
if(dojo.isIE){
_bc5.contentDomPreFilters.push(dojo.hitch(this,"regularPsToSingleLinePs"));
_bc5.contentDomPostFilters.push(dojo.hitch(this,"singleLinePsToRegularPs"));
_bc5.onLoadDeferred.addCallback(dojo.hitch(this,"_fixNewLineBehaviorForIE"));
}else{
_bc5.onLoadDeferred.addCallback(dojo.hitch(this,function(d){
try{
this.editor.document.execCommand("insertBrOnReturn",false,true);
}
catch(e){
}
return d;
}));
}
}else{
if(this.blockNodeForEnter){
dojo["require"]("dijit._editor.range");
var h=dojo.hitch(this,this.handleEnterKey);
_bc5.addKeyHandler(13,0,0,h);
_bc5.addKeyHandler(13,0,1,h);
this.connect(this.editor,"onKeyPressed","onKeyPressed");
}
}
},connect:function(o,f,tf){
if(!this._connects){
this._connects=[];
}
this._connects.push(dojo.connect(o,f,this,tf));
},destroy:function(){
dojo.forEach(this._connects,dojo.disconnect);
this._connects=[];
},onKeyPressed:function(e){
if(this._checkListLater){
if(dojo.withGlobal(this.editor.window,"isCollapsed",dijit)){
var _bcc=dojo.withGlobal(this.editor.window,"getAncestorElement",dijit._editor.selection,["LI"]);
if(!_bcc){
dijit._editor.RichText.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter);
var _bcd=dojo.withGlobal(this.editor.window,"getAncestorElement",dijit._editor.selection,[this.blockNodeForEnter]);
if(_bcd){
_bcd.innerHTML=this.bogusHtmlContent;
if(dojo.isIE){
var r=this.editor.document.selection.createRange();
r.move("character",-1);
r.select();
}
}else{
console.error("onKeyPressed: Cannot find the new block node");
}
}else{
if(dojo.isMoz){
if(_bcc.parentNode.parentNode.nodeName=="LI"){
_bcc=_bcc.parentNode.parentNode;
}
}
var fc=_bcc.firstChild;
if(fc&&fc.nodeType==1&&(fc.nodeName=="UL"||fc.nodeName=="OL")){
_bcc.insertBefore(fc.ownerDocument.createTextNode(" "),fc);
var _bd0=dijit.range.create(this.editor.window);
_bd0.setStart(_bcc.firstChild,0);
var _bd1=dijit.range.getSelection(this.editor.window,true);
_bd1.removeAllRanges();
_bd1.addRange(_bd0);
}
}
}
this._checkListLater=false;
}
if(this._pressedEnterInBlock){
if(this._pressedEnterInBlock.previousSibling){
this.removeTrailingBr(this._pressedEnterInBlock.previousSibling);
}
delete this._pressedEnterInBlock;
}
},bogusHtmlContent:"&nbsp;",blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(e){
if(!this.blockNodeForEnter){
return true;
}
var _bd3,_bd4,_bd5,doc=this.editor.document,br;
if(e.shiftKey||this.blockNodeForEnter=="BR"){
var _bd8=dojo.withGlobal(this.editor.window,"getParentElement",dijit._editor.selection);
var _bd9=dijit.range.getAncestor(_bd8,this.blockNodes);
if(_bd9){
if(!e.shiftKey&&_bd9.tagName=="LI"){
return true;
}
_bd3=dijit.range.getSelection(this.editor.window);
_bd4=_bd3.getRangeAt(0);
if(!_bd4.collapsed){
_bd4.deleteContents();
}
if(dijit.range.atBeginningOfContainer(_bd9,_bd4.startContainer,_bd4.startOffset)){
if(e.shiftKey){
br=doc.createElement("br");
_bd5=dijit.range.create(this.editor.window);
_bd9.insertBefore(br,_bd9.firstChild);
_bd5.setStartBefore(br.nextSibling);
_bd3.removeAllRanges();
_bd3.addRange(_bd5);
}else{
dojo.place(br,_bd9,"before");
}
}else{
if(dijit.range.atEndOfContainer(_bd9,_bd4.startContainer,_bd4.startOffset)){
_bd5=dijit.range.create(this.editor.window);
br=doc.createElement("br");
if(e.shiftKey){
_bd9.appendChild(br);
_bd9.appendChild(doc.createTextNode(" "));
_bd5.setStart(_bd9.lastChild,0);
}else{
dojo.place(br,_bd9,"after");
_bd5.setStartAfter(_bd9);
}
_bd3.removeAllRanges();
_bd3.addRange(_bd5);
}else{
return true;
}
}
}else{
dijit._editor.RichText.prototype.execCommand.call(this.editor,"inserthtml","<br>");
}
return false;
}
var _bda=true;
_bd3=dijit.range.getSelection(this.editor.window);
_bd4=_bd3.getRangeAt(0);
if(!_bd4.collapsed){
_bd4.deleteContents();
}
var _bdb=dijit.range.getBlockAncestor(_bd4.endContainer,null,this.editor.editNode);
var _bdc=_bdb.blockNode;
if((this._checkListLater=(_bdc&&(_bdc.nodeName=="LI"||_bdc.parentNode.nodeName=="LI")))){
if(dojo.isMoz){
this._pressedEnterInBlock=_bdc;
}
if(/^(\s|&nbsp;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|\xA0)<\/span>)?(<br>)?$/.test(_bdc.innerHTML)){
_bdc.innerHTML="";
if(dojo.isSafari){
_bd5=dijit.range.create(this.editor.window);
_bd5.setStart(_bdc,0);
_bd3.removeAllRanges();
_bd3.addRange(_bd5);
}
this._checkListLater=false;
}
return true;
}
if(!_bdb.blockNode||_bdb.blockNode===this.editor.editNode){
try{
dijit._editor.RichText.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter);
}
catch(e2){
}
_bdb={blockNode:dojo.withGlobal(this.editor.window,"getAncestorElement",dijit._editor.selection,[this.blockNodeForEnter]),blockContainer:this.editor.editNode};
if(_bdb.blockNode){
if(_bdb.blockNode!=this.editor.editNode&&(!(_bdb.blockNode.textContent||_bdb.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)){
this.removeTrailingBr(_bdb.blockNode);
return false;
}
}else{
_bdb.blockNode=this.editor.editNode;
}
_bd3=dijit.range.getSelection(this.editor.window);
_bd4=_bd3.getRangeAt(0);
}
var _bdd=doc.createElement(this.blockNodeForEnter);
_bdd.innerHTML=this.bogusHtmlContent;
this.removeTrailingBr(_bdb.blockNode);
if(dijit.range.atEndOfContainer(_bdb.blockNode,_bd4.endContainer,_bd4.endOffset)){
if(_bdb.blockNode===_bdb.blockContainer){
_bdb.blockNode.appendChild(_bdd);
}else{
dojo.place(_bdd,_bdb.blockNode,"after");
}
_bda=false;
_bd5=dijit.range.create(this.editor.window);
_bd5.setStart(_bdd,0);
_bd3.removeAllRanges();
_bd3.addRange(_bd5);
if(this.editor.height){
dijit.scrollIntoView(_bdd);
}
}else{
if(dijit.range.atBeginningOfContainer(_bdb.blockNode,_bd4.startContainer,_bd4.startOffset)){
dojo.place(_bdd,_bdb.blockNode,_bdb.blockNode===_bdb.blockContainer?"first":"before");
if(_bdd.nextSibling&&this.editor.height){
_bd5=dijit.range.create(this.editor.window);
_bd5.setStart(_bdd.nextSibling,0);
_bd3.removeAllRanges();
_bd3.addRange(_bd5);
dijit.scrollIntoView(_bdd.nextSibling);
}
_bda=false;
}else{
if(dojo.isMoz){
this._pressedEnterInBlock=_bdb.blockNode;
}
}
}
return _bda;
},removeTrailingBr:function(_bde){
var para=/P|DIV|LI/i.test(_bde.tagName)?_bde:dijit._editor.selection.getParentOfType(_bde,["P","DIV","LI"]);
if(!para){
return;
}
if(para.lastChild){
if((para.childNodes.length>1&&para.lastChild.nodeType==3&&/^[\s\xAD]*$/.test(para.lastChild.nodeValue))||para.lastChild.tagName=="BR"){
dojo._destroyElement(para.lastChild);
}
}
if(!para.childNodes.length){
para.innerHTML=this.bogusHtmlContent;
}
},_fixNewLineBehaviorForIE:function(d){
if(this.editor.document.__INSERTED_EDITIOR_NEWLINE_CSS===undefined){
var _be1="p{margin:0 !important;}";
var _be2=function(_be3,doc,URI){
if(!_be3){
return null;
}
if(!doc){
doc=document;
}
var _be6=doc.createElement("style");
_be6.setAttribute("type","text/css");
var head=doc.getElementsByTagName("head")[0];
if(!head){
console.debug("No head tag in document, aborting styles");
return null;
}else{
head.appendChild(_be6);
}
if(_be6.styleSheet){
var _be8=function(){
try{
_be6.styleSheet.cssText=_be3;
}
catch(e){
console.debug(e);
}
};
if(_be6.styleSheet.disabled){
setTimeout(_be8,10);
}else{
_be8();
}
}else{
var _be9=doc.createTextNode(_be3);
_be6.appendChild(_be9);
}
return _be6;
};
_be2(_be1,this.editor.document);
this.editor.document.__INSERTED_EDITIOR_NEWLINE_CSS=true;
return d;
}
return null;
},regularPsToSingleLinePs:function(_bea,_beb){
function wrapLinesInPs(el){
function wrapNodes(_bed){
var newP=_bed[0].ownerDocument.createElement("p");
_bed[0].parentNode.insertBefore(newP,_bed[0]);
dojo.forEach(_bed,function(node){
newP.appendChild(node);
});
};
var _bf0=0;
var _bf1=[];
var _bf2;
while(_bf0<el.childNodes.length){
_bf2=el.childNodes[_bf0];
if(_bf2.nodeType==3||(_bf2.nodeType==1&&_bf2.nodeName!="BR"&&dojo.style(_bf2,"display")!="block")){
_bf1.push(_bf2);
}else{
var _bf3=_bf2.nextSibling;
if(_bf1.length){
wrapNodes(_bf1);
_bf0=(_bf0+1)-_bf1.length;
if(_bf2.nodeName=="BR"){
dojo._destroyElement(_bf2);
}
}
_bf1=[];
}
_bf0++;
}
if(_bf1.length){
wrapNodes(_bf1);
}
};
function splitP(el){
var _bf5=null;
var _bf6=[];
var _bf7=el.childNodes.length-1;
for(var i=_bf7;i>=0;i--){
_bf5=el.childNodes[i];
if(_bf5.nodeName=="BR"){
var newP=_bf5.ownerDocument.createElement("p");
dojo.place(newP,el,"after");
if(_bf6.length==0&&i!=_bf7){
newP.innerHTML="&nbsp;";
}
dojo.forEach(_bf6,function(node){
newP.appendChild(node);
});
dojo._destroyElement(_bf5);
_bf6=[];
}else{
_bf6.unshift(_bf5);
}
}
};
var _bfb=[];
var ps=_bea.getElementsByTagName("p");
dojo.forEach(ps,function(p){
_bfb.push(p);
});
dojo.forEach(_bfb,function(p){
if((p.previousSibling)&&(p.previousSibling.nodeName=="P"||dojo.style(p.previousSibling,"display")!="block")){
var newP=p.parentNode.insertBefore(this.document.createElement("p"),p);
newP.innerHTML=_beb?"":"&nbsp;";
}
splitP(p);
},this.editor);
wrapLinesInPs(_bea);
return _bea;
},singleLinePsToRegularPs:function(_c00){
function getParagraphParents(node){
var ps=node.getElementsByTagName("p");
var _c03=[];
for(var i=0;i<ps.length;i++){
var p=ps[i];
var _c06=false;
for(var k=0;k<_c03.length;k++){
if(_c03[k]===p.parentNode){
_c06=true;
break;
}
}
if(!_c06){
_c03.push(p.parentNode);
}
}
return _c03;
};
function isParagraphDelimiter(node){
if(node.nodeType!=1||node.tagName!="P"){
return dojo.style(node,"display")=="block";
}else{
if(!node.childNodes.length||node.innerHTML=="&nbsp;"){
return true;
}
}
return false;
};
var _c09=getParagraphParents(_c00);
for(var i=0;i<_c09.length;i++){
var _c0b=_c09[i];
var _c0c=null;
var node=_c0b.firstChild;
var _c0e=null;
while(node){
if(node.nodeType!="1"||node.tagName!="P"){
_c0c=null;
}else{
if(isParagraphDelimiter(node)){
_c0e=node;
_c0c=null;
}else{
if(_c0c==null){
_c0c=node;
}else{
if((!_c0c.lastChild||_c0c.lastChild.nodeName!="BR")&&(node.firstChild)&&(node.firstChild.nodeName!="BR")){
_c0c.appendChild(this.editor.document.createElement("br"));
}
while(node.firstChild){
_c0c.appendChild(node.firstChild);
}
_c0e=node;
}
}
}
node=node.nextSibling;
if(_c0e){
dojo._destroyElement(_c0e);
_c0e=null;
}
}
}
return _c00;
}});
}
if(!dojo._hasResource["dijit.Editor"]){
dojo._hasResource["dijit.Editor"]=true;
dojo.provide("dijit.Editor");
dojo.declare("dijit.Editor",dijit._editor.RichText,{plugins:null,extraPlugins:null,constructor:function(){
if(!dojo.isArray(this.plugins)){
this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull","dijit._editor.plugins.EnterKeyHandling"];
}
this._plugins=[];
this._editInterval=this.editActionInterval*1000;
if(dojo.isIE){
this.events.push("onBeforeDeactivate");
}
},postCreate:function(){
if(this.customUndo){
dojo["require"]("dijit._editor.range");
this._steps=this._steps.slice(0);
this._undoedSteps=this._undoedSteps.slice(0);
}
if(dojo.isArray(this.extraPlugins)){
this.plugins=this.plugins.concat(this.extraPlugins);
}
this.inherited(arguments);
this.commands=dojo.i18n.getLocalization("dijit._editor","commands",this.lang);
if(!this.toolbar){
this.toolbar=new dijit.Toolbar({});
dojo.place(this.toolbar.domNode,this.editingArea,"before");
}
dojo.forEach(this.plugins,this.addPlugin,this);
this.onNormalizedDisplayChanged();
this.toolbar.startup();
},destroy:function(){
dojo.forEach(this._plugins,function(p){
if(p&&p.destroy){
p.destroy();
}
});
this._plugins=[];
this.toolbar.destroy();
delete this.toolbar;
this.inherited(arguments);
},addPlugin:function(_c10,_c11){
var args=dojo.isString(_c10)?{name:_c10}:_c10;
if(!args.setEditor){
var o={"args":args,"plugin":null,"editor":this};
dojo.publish(dijit._scopeName+".Editor.getPlugin",[o]);
if(!o.plugin){
var pc=dojo.getObject(args.name);
if(pc){
o.plugin=new pc(args);
}
}
if(!o.plugin){
console.warn("Cannot find plugin",_c10);
return;
}
_c10=o.plugin;
}
if(arguments.length>1){
this._plugins[_c11]=_c10;
}else{
this._plugins.push(_c10);
}
_c10.setEditor(this);
if(dojo.isFunction(_c10.setToolbar)){
_c10.setToolbar(this.toolbar);
}
},startup:function(){
},resize:function(){
dijit.layout._LayoutWidget.prototype.resize.apply(this,arguments);
},layout:function(){
this.editingArea.style.height=(this._contentBox.h-dojo.marginBox(this.toolbar.domNode).h)+"px";
if(this.iframe){
this.iframe.style.height="100%";
}
this._layoutMode=true;
},_onIEMouseDown:function(e){
delete this._savedSelection;
if(e.target.tagName=="BODY"){
setTimeout(dojo.hitch(this,"placeCursorAtEnd"),0);
}
this.inherited(arguments);
},onBeforeDeactivate:function(e){
if(this.customUndo){
this.endEditing(true);
}
this._saveSelection();
},customUndo:dojo.isIE,editActionInterval:3,beginEditing:function(cmd){
if(!this._inEditing){
this._inEditing=true;
this._beginEditing(cmd);
}
if(this.editActionInterval>0){
if(this._editTimer){
clearTimeout(this._editTimer);
}
this._editTimer=setTimeout(dojo.hitch(this,this.endEditing),this._editInterval);
}
},_steps:[],_undoedSteps:[],execCommand:function(cmd){
if(this.customUndo&&(cmd=="undo"||cmd=="redo")){
return this[cmd]();
}else{
if(this.customUndo){
this.endEditing();
this._beginEditing();
}
try{
var r=this.inherited("execCommand",arguments);
if(dojo.isSafari&&cmd=="paste"&&!r){
var su=dojo.string.substitute,_isM=navigator.userAgent.indexOf("Macintosh")!=-1;
alert(su(this.commands.systemShortcut,[this.commands[cmd],su(this.commands[_isM?"appleKey":"ctrlKey"],["V"])]));
}
}
catch(e){
if(dojo.isMoz&&/copy|cut|paste/.test(cmd)){
var sub=dojo.string.substitute,_c1d={cut:"X",copy:"C",paste:"V"},_c1e=navigator.userAgent.indexOf("Macintosh")!=-1;
alert(sub(this.commands.systemShortcutFF,[this.commands[cmd],sub(this.commands[_c1e?"appleKey":"ctrlKey"],[_c1d[cmd]])]));
}
r=false;
}
if(this.customUndo){
this._endEditing();
}
return r;
}
},queryCommandEnabled:function(cmd){
if(this.customUndo&&(cmd=="undo"||cmd=="redo")){
return cmd=="undo"?(this._steps.length>1):(this._undoedSteps.length>0);
}else{
return this.inherited("queryCommandEnabled",arguments);
}
},focus:function(){
var _c20=0;
if(this._savedSelection&&dojo.isIE){
_c20=dijit._curFocus!=this.editNode;
}
this.inherited(arguments);
if(_c20){
this._restoreSelection();
}
},_moveToBookmark:function(b){
var _c22=b;
if(dojo.isIE){
if(dojo.isArray(b)){
_c22=[];
dojo.forEach(b,function(n){
_c22.push(dijit.range.getNode(n,this.editNode));
},this);
}
}else{
var r=dijit.range.create(this.window);
r.setStart(dijit.range.getNode(b.startContainer,this.editNode),b.startOffset);
r.setEnd(dijit.range.getNode(b.endContainer,this.editNode),b.endOffset);
_c22=r;
}
dojo.withGlobal(this.window,"moveToBookmark",dijit,[_c22]);
},_changeToStep:function(from,to){
this.setValue(to.text);
var b=to.bookmark;
if(!b){
return;
}
this._moveToBookmark(b);
},undo:function(){
this.endEditing(true);
var s=this._steps.pop();
if(this._steps.length>0){
this.focus();
this._changeToStep(s,this._steps[this._steps.length-1]);
this._undoedSteps.push(s);
this.onDisplayChanged();
return true;
}
return false;
},redo:function(){
this.endEditing(true);
var s=this._undoedSteps.pop();
if(s&&this._steps.length>0){
this.focus();
this._changeToStep(this._steps[this._steps.length-1],s);
this._steps.push(s);
this.onDisplayChanged();
return true;
}
return false;
},endEditing:function(_c2a){
if(this._editTimer){
clearTimeout(this._editTimer);
}
if(this._inEditing){
this._endEditing(_c2a);
this._inEditing=false;
}
},_getBookmark:function(){
var b=dojo.withGlobal(this.window,dijit.getBookmark);
var tmp=[];
if(dojo.isIE){
if(dojo.isArray(b)){
dojo.forEach(b,function(n){
tmp.push(dijit.range.getIndex(n,this.editNode).o);
},this);
b=tmp;
}
}else{
tmp=dijit.range.getIndex(b.startContainer,this.editNode).o;
b={startContainer:tmp,startOffset:b.startOffset,endContainer:b.endContainer===b.startContainer?tmp:dijit.range.getIndex(b.endContainer,this.editNode).o,endOffset:b.endOffset};
}
return b;
},_beginEditing:function(cmd){
if(this._steps.length===0){
this._steps.push({"text":this.savedContent,"bookmark":this._getBookmark()});
}
},_endEditing:function(_c2f){
var v=this.getValue(true);
this._undoedSteps=[];
this._steps.push({text:v,bookmark:this._getBookmark()});
},onKeyDown:function(e){
if(!dojo.isIE&&!this.iframe&&e.keyCode==dojo.keys.TAB&&!this.tabIndent){
this._saveSelection();
}
if(!this.customUndo){
this.inherited("onKeyDown",arguments);
return;
}
var k=e.keyCode,ks=dojo.keys;
if(e.ctrlKey&&!e.altKey){
if(k==90||k==122){
dojo.stopEvent(e);
this.undo();
return;
}else{
if(k==89||k==121){
dojo.stopEvent(e);
this.redo();
return;
}
}
}
this.inherited("onKeyDown",arguments);
switch(k){
case ks.ENTER:
case ks.BACKSPACE:
case ks.DELETE:
this.beginEditing();
break;
case 88:
case 86:
if(e.ctrlKey&&!e.altKey&&!e.metaKey){
this.endEditing();
if(e.keyCode==88){
this.beginEditing("cut");
setTimeout(dojo.hitch(this,this.endEditing),1);
}else{
this.beginEditing("paste");
setTimeout(dojo.hitch(this,this.endEditing),1);
}
break;
}
default:
if(!e.ctrlKey&&!e.altKey&&!e.metaKey&&(e.keyCode<dojo.keys.F1||e.keyCode>dojo.keys.F15)){
this.beginEditing();
break;
}
case ks.ALT:
this.endEditing();
break;
case ks.UP_ARROW:
case ks.DOWN_ARROW:
case ks.LEFT_ARROW:
case ks.RIGHT_ARROW:
case ks.HOME:
case ks.END:
case ks.PAGE_UP:
case ks.PAGE_DOWN:
this.endEditing(true);
break;
case ks.CTRL:
case ks.SHIFT:
case ks.TAB:
break;
}
},_onBlur:function(){
this.inherited("_onBlur",arguments);
this.endEditing(true);
},_saveSelection:function(){
this._savedSelection=this._getBookmark();
},_restoreSelection:function(){
if(this._savedSelection){
if(dojo.withGlobal(this.window,"isCollapsed",dijit)){
this._moveToBookmark(this._savedSelection);
}
delete this._savedSelection;
}
},_onFocus:function(){
setTimeout(dojo.hitch(this,"_restoreSelection"),0);
this.inherited(arguments);
},onClick:function(){
this.endEditing(true);
this.inherited("onClick",arguments);
}});
dojo.subscribe(dijit._scopeName+".Editor.getPlugin",null,function(o){
if(o.plugin){
return;
}
var args=o.args,p;
var _p=dijit._editor._Plugin;
var name=args.name;
switch(name){
case "undo":
case "redo":
case "cut":
case "copy":
case "paste":
case "insertOrderedList":
case "insertUnorderedList":
case "indent":
case "outdent":
case "justifyCenter":
case "justifyFull":
case "justifyLeft":
case "justifyRight":
case "delete":
case "selectAll":
case "removeFormat":
case "unlink":
case "insertHorizontalRule":
p=new _p({command:name});
break;
case "bold":
case "italic":
case "underline":
case "strikethrough":
case "subscript":
case "superscript":
p=new _p({buttonClass:dijit.form.ToggleButton,command:name});
break;
case "|":
p=new _p({button:new dijit.ToolbarSeparator()});
}
o.plugin=p;
});
}
if(!dojo._hasResource["dijit.form.TextBox"]){
dojo._hasResource["dijit.form.TextBox"]=true;
dojo.provide("dijit.form.TextBox");
dojo.declare("dijit.form.TextBox",dijit.form._FormValueWidget,{trim:false,uppercase:false,lowercase:false,propercase:false,maxLength:"",templateString:"<input class=\"dijit dijitReset dijitLeft\" dojoAttachPoint='textbox,focusNode' name=\"${name}\"\r\n\tdojoAttachEvent='onmouseenter:_onMouse,onmouseleave:_onMouse,onfocus:_onMouse,onblur:_onMouse,onkeypress:_onKeyPress'\r\n\tautocomplete=\"off\" type=\"${type}\"\r\n\t/>\r\n",baseClass:"dijitTextBox",attributeMap:dojo.mixin(dojo.clone(dijit.form._FormValueWidget.prototype.attributeMap),{maxLength:"focusNode"}),_getValueAttr:function(){
return this.parse(this.attr("displayedValue"),this.constraints);
},_setValueAttr:function(_c39,_c3a,_c3b){
var _c3c;
if(_c39!==undefined){
_c3c=this.filter(_c39);
if(_c3c!==null&&((typeof _c3c!="number")||!isNaN(_c3c))){
if(typeof _c3b!="string"){
_c3b=this.format(_c3c,this.constraints);
}
}else{
_c3b="";
}
}
if(_c3b!=null&&_c3b!=undefined){
this.textbox.value=_c3b;
}
dijit.form.TextBox.superclass._setValueAttr.call(this,_c3c,_c3a);
},displayedValue:"",getDisplayedValue:function(){
dojo.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use attr('displayedValue') instead.","","2.0");
return this.attr("displayedValue");
},_getDisplayedValueAttr:function(){
return this.filter(this.textbox.value);
},setDisplayedValue:function(_c3d){
dojo.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use attr('displayedValue', ...) instead.","","2.0");
this.attr("displayedValue",_c3d);
},_setDisplayedValueAttr:function(_c3e){
this.textbox.value=_c3e;
this._setValueAttr(this.attr("value"));
},format:function(_c3f,_c40){
return ((_c3f==null||_c3f==undefined)?"":(_c3f.toString?_c3f.toString():_c3f));
},parse:function(_c41,_c42){
return _c41;
},postCreate:function(){
this.textbox.setAttribute("value",this.textbox.value);
this.inherited(arguments);
this._layoutHack();
},filter:function(val){
if(typeof val!="string"){
return val;
}
if(this.trim){
val=dojo.trim(val);
}
if(this.uppercase){
val=val.toUpperCase();
}
if(this.lowercase){
val=val.toLowerCase();
}
if(this.propercase){
val=val.replace(/[^\s]+/g,function(word){
return word.substring(0,1).toUpperCase()+word.substring(1);
});
}
return val;
},_setBlurValue:function(){
this._setValueAttr(this.attr("value"),(this.isValid?this.isValid():true));
},_onBlur:function(){
this._setBlurValue();
this.inherited(arguments);
}});
dijit.selectInputText=function(_c45,_c46,stop){
var _c48=dojo.global;
var _c49=dojo.doc;
_c45=dojo.byId(_c45);
if(isNaN(_c46)){
_c46=0;
}
if(isNaN(stop)){
stop=_c45.value?_c45.value.length:0;
}
_c45.focus();
if(_c49["selection"]&&dojo.body()["createTextRange"]){
if(_c45.createTextRange){
var _c4a=_c45.createTextRange();
with(_c4a){
collapse(true);
moveStart("character",_c46);
moveEnd("character",stop);
select();
}
}
}else{
if(_c48["getSelection"]){
var _c4b=_c48.getSelection();
if(_c45.setSelectionRange){
_c45.setSelectionRange(_c46,stop);
}
}
}
};
}
if(!dojo._hasResource["dijit.Tooltip"]){
dojo._hasResource["dijit.Tooltip"]=true;
dojo.provide("dijit.Tooltip");
dojo.declare("dijit._MasterTooltip",[dijit._Widget,dijit._Templated],{duration:dijit.defaultDuration,templateString:"<div class=\"dijitTooltip dijitTooltipLeft\" id=\"dojoTooltip\">\r\n\t<div class=\"dijitTooltipContainer dijitTooltipContents\" dojoAttachPoint=\"containerNode\" waiRole='alert'></div>\r\n\t<div class=\"dijitTooltipConnector\"></div>\r\n</div>\r\n",postCreate:function(){
dojo.body().appendChild(this.domNode);
this.bgIframe=new dijit.BackgroundIframe(this.domNode);
this.fadeIn=dojo.fadeIn({node:this.domNode,duration:this.duration,onEnd:dojo.hitch(this,"_onShow")});
this.fadeOut=dojo.fadeOut({node:this.domNode,duration:this.duration,onEnd:dojo.hitch(this,"_onHide")});
},show:function(_c4c,_c4d,_c4e){
if(this.aroundNode&&this.aroundNode===_c4d){
return;
}
if(this.fadeOut.status()=="playing"){
this._onDeck=arguments;
return;
}
this.containerNode.innerHTML=_c4c;
this.domNode.style.top=(this.domNode.offsetTop+1)+"px";
var _c4f={};
var ltr=this.isLeftToRight();
dojo.forEach((_c4e&&_c4e.length)?_c4e:dijit.Tooltip.defaultPosition,function(pos){
switch(pos){
case "after":
_c4f[ltr?"BR":"BL"]=ltr?"BL":"BR";
break;
case "before":
_c4f[ltr?"BL":"BR"]=ltr?"BR":"BL";
break;
case "below":
_c4f[ltr?"BL":"BR"]=ltr?"TL":"TR";
_c4f[ltr?"BR":"BL"]=ltr?"TR":"TL";
break;
case "above":
default:
_c4f[ltr?"TL":"TR"]=ltr?"BL":"BR";
_c4f[ltr?"TR":"TL"]=ltr?"BR":"BL";
break;
}
});
var pos=dijit.placeOnScreenAroundElement(this.domNode,_c4d,_c4f,dojo.hitch(this,"orient"));
dojo.style(this.domNode,"opacity",0);
this.fadeIn.play();
this.isShowingNow=true;
this.aroundNode=_c4d;
},orient:function(node,_c54,_c55){
node.className="dijitTooltip "+{"BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[_c54+"-"+_c55];
},_onShow:function(){
if(dojo.isIE){
this.domNode.style.filter="";
}
},hide:function(_c56){
if(this._onDeck&&this._onDeck[1]==_c56){
this._onDeck=null;
}else{
if(this.aroundNode===_c56){
this.fadeIn.stop();
this.isShowingNow=false;
this.aroundNode=null;
this.fadeOut.play();
}else{
}
}
},_onHide:function(){
this.domNode.style.cssText="";
if(this._onDeck){
this.show.apply(this,this._onDeck);
this._onDeck=null;
}
}});
dijit.showTooltip=function(_c57,_c58,_c59){
if(!dijit._masterTT){
dijit._masterTT=new dijit._MasterTooltip();
}
return dijit._masterTT.show(_c57,_c58,_c59);
};
dijit.hideTooltip=function(_c5a){
if(!dijit._masterTT){
dijit._masterTT=new dijit._MasterTooltip();
}
return dijit._masterTT.hide(_c5a);
};
dojo.declare("dijit.Tooltip",dijit._Widget,{label:"",showDelay:400,connectId:[],position:[],postCreate:function(){
dojo.addClass(this.domNode,"dijitTooltipData");
this._connectNodes=[];
dojo.forEach(this.connectId,function(id){
var node=dojo.byId(id);
if(node){
this._connectNodes.push(node);
dojo.forEach(["onMouseEnter","onMouseLeave","onFocus","onBlur"],function(_c5d){
this.connect(node,_c5d.toLowerCase(),"_"+_c5d);
},this);
if(dojo.isIE){
node.style.zoom=1;
}
}
},this);
},_onMouseEnter:function(e){
this._onHover(e);
},_onMouseLeave:function(e){
this._onUnHover(e);
},_onFocus:function(e){
this._focus=true;
this._onHover(e);
this.inherited(arguments);
},_onBlur:function(e){
this._focus=false;
this._onUnHover(e);
this.inherited(arguments);
},_onHover:function(e){
if(!this._showTimer){
var _c63=e.target;
this._showTimer=setTimeout(dojo.hitch(this,function(){
this.open(_c63);
}),this.showDelay);
}
},_onUnHover:function(e){
if(this._focus){
return;
}
if(this._showTimer){
clearTimeout(this._showTimer);
delete this._showTimer;
}
this.close();
},open:function(_c65){
_c65=_c65||this._connectNodes[0];
if(!_c65){
return;
}
if(this._showTimer){
clearTimeout(this._showTimer);
delete this._showTimer;
}
dijit.showTooltip(this.label||this.domNode.innerHTML,_c65,this.position);
this._connectNode=_c65;
},close:function(){
if(this._connectNode){
dijit.hideTooltip(this._connectNode);
delete this._connectNode;
}
if(this._showTimer){
clearTimeout(this._showTimer);
delete this._showTimer;
}
},uninitialize:function(){
this.close();
}});
dijit.Tooltip.defaultPosition=["after","before"];
}
if(!dojo._hasResource["dijit.form.ValidationTextBox"]){
dojo._hasResource["dijit.form.ValidationTextBox"]=true;
dojo.provide("dijit.form.ValidationTextBox");
dojo.declare("dijit.form.ValidationTextBox",dijit.form.TextBox,{templateString:"<div class=\"dijit dijitReset dijitInlineTable dijitLeft\"\r\n\tid=\"widget_${id}\"\r\n\tdojoAttachEvent=\"onmouseenter:_onMouse,onmouseleave:_onMouse,onmousedown:_onMouse\" waiRole=\"presentation\"\r\n\t><div style=\"overflow:hidden;\"\r\n\t\t><div class=\"dijitReset dijitValidationIcon\"><br></div\r\n\t\t><div class=\"dijitReset dijitValidationIconText\">&Chi;</div\r\n\t\t><div class=\"dijitReset dijitInputField\"\r\n\t\t\t><input class=\"dijitReset\" dojoAttachPoint='textbox,focusNode' dojoAttachEvent='onfocus:_update,onkeyup:_update,onblur:_onMouse,onkeypress:_onKeyPress' autocomplete=\"off\"\r\n\t\t\ttype='${type}' name='${name}'\r\n\t\t/></div\r\n\t></div\r\n></div>\r\n",baseClass:"dijitTextBox",required:false,promptMessage:"",invalidMessage:"$_unset_$",constraints:{},regExp:".*",regExpGen:function(_c66){
return this.regExp;
},state:"",tooltipPosition:[],_setValueAttr:function(){
this.inherited(arguments);
this.validate(this._focused);
},validator:function(_c67,_c68){
return (new RegExp("^(?:"+this.regExpGen(_c68)+")"+(this.required?"":"?")+"$")).test(_c67)&&(!this.required||!this._isEmpty(_c67))&&(this._isEmpty(_c67)||this.parse(_c67,_c68)!==undefined);
},_isValidSubset:function(){
return this.textbox.value.search(this._partialre)==0;
},isValid:function(_c69){
return this.validator(this.textbox.value,this.constraints);
},_isEmpty:function(_c6a){
return /^\s*$/.test(_c6a);
},getErrorMessage:function(_c6b){
return this.invalidMessage;
},getPromptMessage:function(_c6c){
return this.promptMessage;
},_maskValidSubsetError:true,validate:function(_c6d){
var _c6e="";
var _c6f=this.disabled||this.isValid(_c6d);
if(_c6f){
this._maskValidSubsetError=true;
}
var _c70=!_c6f&&_c6d&&this._isValidSubset();
var _c71=this._isEmpty(this.textbox.value);
this.state=(_c6f||(!this._hasBeenBlurred&&_c71)||_c70)?"":"Error";
if(this.state=="Error"){
this._maskValidSubsetError=false;
}
this._setStateClass();
dijit.setWaiState(this.focusNode,"invalid",_c6f?"false":"true");
if(_c6d){
if(_c71){
_c6e=this.getPromptMessage(true);
}
if(!_c6e&&(this.state=="Error"||(_c70&&!this._maskValidSubsetError))){
_c6e=this.getErrorMessage(true);
}
}
this.displayMessage(_c6e);
return _c6f;
},_message:"",displayMessage:function(_c72){
if(this._message==_c72){
return;
}
this._message=_c72;
dijit.hideTooltip(this.domNode);
if(_c72){
dijit.showTooltip(_c72,this.domNode,this.tooltipPosition);
}
},_refreshState:function(){
this.validate(this._focused);
},_update:function(e){
this._refreshState();
this._onMouse(e);
},constructor:function(){
this.constraints={};
},postMixInProperties:function(){
this.inherited(arguments);
this.constraints.locale=this.lang;
this.messages=dojo.i18n.getLocalization("dijit.form","validate",this.lang);
if(this.invalidMessage=="$_unset_$"){
this.invalidMessage=this.messages.invalidMessage;
}
var p=this.regExpGen(this.constraints);
this.regExp=p;
var _c75="";
if(p!=".*"){
this.regExp.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(re){
switch(re.charAt(0)){
case "{":
case "+":
case "?":
case "*":
case "^":
case "$":
case "|":
case "(":
_c75+=re;
break;
case ")":
_c75+="|$)";
break;
default:
_c75+="(?:"+re+"|$)";
break;
}
});
}
try{
"".search(_c75);
}
catch(e){
_c75=this.regExp;
console.debug("RegExp error in "+this.declaredClass+": "+this.regExp);
}
this._partialre="^(?:"+_c75+")$";
},_setDisabledAttr:function(_c77){
this.inherited(arguments);
if(this.valueNode){
this.valueNode.disabled=_c77;
}
this._refreshState();
},_setRequiredAttr:function(_c78){
this.required=_c78;
dijit.setWaiState(this.focusNode,"required",_c78);
this._refreshState();
},postCreate:function(){
if(dojo.isIE){
var s=dojo.getComputedStyle(this.focusNode);
if(s){
var ff=s.fontFamily;
if(ff){
this.focusNode.style.fontFamily=ff;
}
}
}
this.inherited(arguments);
}});
dojo.declare("dijit.form.MappedTextBox",dijit.form.ValidationTextBox,{serialize:function(val,_c7c){
return val.toString?val.toString():"";
},toString:function(){
var val=this.filter(this.attr("value"));
return val!=null?(typeof val=="string"?val:this.serialize(val,this.constraints)):"";
},validate:function(){
this.valueNode.value=this.toString();
return this.inherited(arguments);
},buildRendering:function(){
this.inherited(arguments);
var _c7e=this.textbox;
var _c7f=(this.valueNode=dojo.doc.createElement("input"));
_c7f.setAttribute("type",_c7e.type);
dojo.style(_c7f,"display","none");
this.valueNode.name=this.textbox.name;
dojo.place(_c7f,_c7e,"after");
this.textbox.name=this.textbox.name+"_displayed_";
this.textbox.removeAttribute("name");
},_setDisabledAttr:function(_c80){
this.inherited(arguments);
dojo.attr(this.valueNode,"disabled",_c80);
}});
dojo.declare("dijit.form.RangeBoundTextBox",dijit.form.MappedTextBox,{rangeMessage:"",rangeCheck:function(_c81,_c82){
var _c83="min" in _c82;
var _c84="max" in _c82;
if(_c83||_c84){
return (!_c83||this.compare(_c81,_c82.min)>=0)&&(!_c84||this.compare(_c81,_c82.max)<=0);
}
return true;
},isInRange:function(_c85){
return this.rangeCheck(this.attr("value"),this.constraints);
},_isDefinitelyOutOfRange:function(){
var val=this.attr("value");
var _c87=false;
var _c88=false;
if("min" in this.constraints){
var min=this.constraints.min;
val=this.compare(val,((typeof min=="number")&&min>=0&&val!=0)?0:min);
_c87=(typeof val=="number")&&val<0;
}
if("max" in this.constraints){
var max=this.constraints.max;
val=this.compare(val,((typeof max!="number")||max>0)?max:0);
_c88=(typeof val=="number")&&val>0;
}
return _c87||_c88;
},_isValidSubset:function(){
return this.inherited(arguments)&&!this._isDefinitelyOutOfRange();
},isValid:function(_c8b){
return this.inherited(arguments)&&((this._isEmpty(this.textbox.value)&&!this.required)||this.isInRange(_c8b));
},getErrorMessage:function(_c8c){
if(dijit.form.RangeBoundTextBox.superclass.isValid.call(this,false)&&!this.isInRange(_c8c)){
return this.rangeMessage;
}
return this.inherited(arguments);
},postMixInProperties:function(){
this.inherited(arguments);
if(!this.rangeMessage){
this.messages=dojo.i18n.getLocalization("dijit.form","validate",this.lang);
this.rangeMessage=this.messages.rangeMessage;
}
},postCreate:function(){
this.inherited(arguments);
if(this.constraints.min!==undefined){
dijit.setWaiState(this.focusNode,"valuemin",this.constraints.min);
}
if(this.constraints.max!==undefined){
dijit.setWaiState(this.focusNode,"valuemax",this.constraints.max);
}
},_setValueAttr:function(_c8d,_c8e){
dijit.setWaiState(this.focusNode,"valuenow",_c8d);
this.inherited(arguments);
}});
}
if(!dojo._hasResource["dojo.data.util.sorter"]){
dojo._hasResource["dojo.data.util.sorter"]=true;
dojo.provide("dojo.data.util.sorter");
dojo.data.util.sorter.basicComparator=function(a,b){
var ret=0;
if(a>b||typeof a==="undefined"||a===null){
ret=1;
}else{
if(a<b||typeof b==="undefined"||b===null){
ret=-1;
}
}
return ret;
};
dojo.data.util.sorter.createSortFunction=function(_c92,_c93){
var _c94=[];
function createSortFunction(attr,dir){
return function(_c97,_c98){
var a=_c93.getValue(_c97,attr);
var b=_c93.getValue(_c98,attr);
var _c9b=null;
if(_c93.comparatorMap){
if(typeof attr!=="string"){
attr=_c93.getIdentity(attr);
}
_c9b=_c93.comparatorMap[attr]||dojo.data.util.sorter.basicComparator;
}
_c9b=_c9b||dojo.data.util.sorter.basicComparator;
return dir*_c9b(a,b);
};
};
var _c9c;
for(var i=0;i<_c92.length;i++){
_c9c=_c92[i];
if(_c9c.attribute){
var _c9e=(_c9c.descending)?-1:1;
_c94.push(createSortFunction(_c9c.attribute,_c9e));
}
}
return function(rowA,rowB){
var i=0;
while(i<_c94.length){
var ret=_c94[i++](rowA,rowB);
if(ret!==0){
return ret;
}
}
return 0;
};
};
}
if(!dojo._hasResource["dojo.data.util.simpleFetch"]){
dojo._hasResource["dojo.data.util.simpleFetch"]=true;
dojo.provide("dojo.data.util.simpleFetch");
dojo.data.util.simpleFetch.fetch=function(_ca3){
_ca3=_ca3||{};
if(!_ca3.store){
_ca3.store=this;
}
var self=this;
var _ca5=function(_ca6,_ca7){
if(_ca7.onError){
var _ca8=_ca7.scope||dojo.global;
_ca7.onError.call(_ca8,_ca6,_ca7);
}
};
var _ca9=function(_caa,_cab){
var _cac=_cab.abort||null;
var _cad=false;
var _cae=_cab.start?_cab.start:0;
var _caf=(_cab.count&&(_cab.count!==Infinity))?(_cae+_cab.count):_caa.length;
_cab.abort=function(){
_cad=true;
if(_cac){
_cac.call(_cab);
}
};
var _cb0=_cab.scope||dojo.global;
if(!_cab.store){
_cab.store=self;
}
if(_cab.onBegin){
_cab.onBegin.call(_cb0,_caa.length,_cab);
}
if(_cab.sort){
_caa.sort(dojo.data.util.sorter.createSortFunction(_cab.sort,self));
}
if(_cab.onItem){
for(var i=_cae;(i<_caa.length)&&(i<_caf);++i){
var item=_caa[i];
if(!_cad){
_cab.onItem.call(_cb0,item,_cab);
}
}
}
if(_cab.onComplete&&!_cad){
var _cb3=null;
if(!_cab.onItem){
_cb3=_caa.slice(_cae,_caf);
}
_cab.onComplete.call(_cb0,_cb3,_cab);
}
};
this._fetchItems(_ca3,_ca9,_ca5);
return _ca3;
};
}
if(!dojo._hasResource["dojo.data.util.filter"]){
dojo._hasResource["dojo.data.util.filter"]=true;
dojo.provide("dojo.data.util.filter");
dojo.data.util.filter.patternToRegExp=function(_cb4,_cb5){
var rxp="^";
var c=null;
for(var i=0;i<_cb4.length;i++){
c=_cb4.charAt(i);
switch(c){
case "\\":
rxp+=c;
i++;
rxp+=_cb4.charAt(i);
break;
case "*":
rxp+=".*";
break;
case "?":
rxp+=".";
break;
case "$":
case "^":
case "/":
case "+":
case ".":
case "|":
case "(":
case ")":
case "{":
case "}":
case "[":
case "]":
rxp+="\\";
default:
rxp+=c;
}
}
rxp+="$";
if(_cb5){
return new RegExp(rxp,"mi");
}else{
return new RegExp(rxp,"m");
}
};
}
if(!dojo._hasResource["dijit.form.ComboBox"]){
dojo._hasResource["dijit.form.ComboBox"]=true;
dojo.provide("dijit.form.ComboBox");
dojo.declare("dijit.form.ComboBoxMixin",null,{item:null,pageSize:Infinity,store:null,fetchProperties:{},query:{},autoComplete:true,highlightMatch:"first",searchDelay:100,searchAttr:"name",labelAttr:"",labelType:"text",queryExpr:"${0}*",ignoreCase:true,hasDownArrow:true,templateString:"<div class=\"dijit dijitReset dijitInlineTable dijitLeft\"\r\n\tid=\"widget_${id}\"\r\n\tdojoAttachEvent=\"onmouseenter:_onMouse,onmouseleave:_onMouse,onmousedown:_onMouse\" dojoAttachPoint=\"comboNode\" waiRole=\"combobox\" tabIndex=\"-1\"\r\n\t><div style=\"overflow:hidden;\"\r\n\t\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton'\r\n\t\t\tdojoAttachPoint=\"downArrowNode\" waiRole=\"presentation\"\r\n\t\t\tdojoAttachEvent=\"onmousedown:_onArrowMouseDown,onmouseup:_onMouse,onmouseenter:_onMouse,onmouseleave:_onMouse\"\r\n\t\t\t><div class=\"dijitArrowButtonInner\">&thinsp;</div\r\n\t\t\t><div class=\"dijitArrowButtonChar\">&#9660;</div\r\n\t\t></div\r\n\t\t><div class=\"dijitReset dijitValidationIcon\"><br></div\r\n\t\t><div class=\"dijitReset dijitValidationIconText\">&Chi;</div\r\n\t\t><div class=\"dijitReset dijitInputField\"\r\n\t\t\t><input type=\"text\" autocomplete=\"off\" name=\"${name}\" class='dijitReset'\r\n\t\t\tdojoAttachEvent=\"onkeypress:_onKeyPress, onfocus:_update, compositionend\"\r\n\t\t\tdojoAttachPoint=\"textbox,focusNode\" waiRole=\"textbox\" waiState=\"haspopup-true,autocomplete-list\"\r\n\t\t/></div\r\n\t></div\r\n></div>\r\n",baseClass:"dijitComboBox",_getCaretPos:function(_cb9){
var pos=0;
if(typeof (_cb9.selectionStart)=="number"){
pos=_cb9.selectionStart;
}else{
if(dojo.isIE){
var tr=dojo.doc.selection.createRange().duplicate();
var ntr=_cb9.createTextRange();
tr.move("character",0);
ntr.move("character",0);
try{
ntr.setEndPoint("EndToEnd",tr);
pos=String(ntr.text).replace(/\r/g,"").length;
}
catch(e){
}
}
}
return pos;
},_setCaretPos:function(_cbd,_cbe){
_cbe=parseInt(_cbe);
dijit.selectInputText(_cbd,_cbe,_cbe);
},_setDisabledAttr:function(_cbf){
dijit.setWaiState(this.comboNode,"disabled",_cbf);
},_onKeyPress:function(evt){
var key=evt.charOrCode;
if(evt.altKey||(evt.ctrlKey&&(key!="x"&&key!="v"))||evt.key==dojo.keys.SHIFT){
return;
}
var _cc2=false;
var pw=this._popupWidget;
var dk=dojo.keys;
if(this._isShowingNow){
pw.handleKey(key);
}
switch(key){
case dk.PAGE_DOWN:
case dk.DOWN_ARROW:
if(!this._isShowingNow||this._prev_key_esc){
this._arrowPressed();
_cc2=true;
}else{
this._announceOption(pw.getHighlightedOption());
}
dojo.stopEvent(evt);
this._prev_key_backspace=false;
this._prev_key_esc=false;
break;
case dk.PAGE_UP:
case dk.UP_ARROW:
if(this._isShowingNow){
this._announceOption(pw.getHighlightedOption());
}
dojo.stopEvent(evt);
this._prev_key_backspace=false;
this._prev_key_esc=false;
break;
case dk.ENTER:
var _cc5;
if(this._isShowingNow&&(_cc5=pw.getHighlightedOption())){
if(_cc5==pw.nextButton){
this._nextSearch(1);
dojo.stopEvent(evt);
break;
}else{
if(_cc5==pw.previousButton){
this._nextSearch(-1);
dojo.stopEvent(evt);
break;
}
}
}else{
this._setDisplayedValueAttr(this.attr("displayedValue"),true);
}
evt.preventDefault();
case dk.TAB:
var _cc6=this.attr("displayedValue");
if(pw&&(_cc6==pw._messages["previousMessage"]||_cc6==pw._messages["nextMessage"])){
break;
}
if(this._isShowingNow){
this._prev_key_backspace=false;
this._prev_key_esc=false;
if(pw.getHighlightedOption()){
pw.attr("value",{target:pw.getHighlightedOption()});
}
this._lastQuery=null;
this._hideResultList();
}
break;
case " ":
this._prev_key_backspace=false;
this._prev_key_esc=false;
if(this._isShowingNow&&pw.getHighlightedOption()){
dojo.stopEvent(evt);
this._selectOption();
this._hideResultList();
}else{
_cc2=true;
}
break;
case dk.ESCAPE:
this._prev_key_backspace=false;
this._prev_key_esc=true;
if(this._isShowingNow){
dojo.stopEvent(evt);
this._hideResultList();
}else{
this.inherited(arguments);
}
break;
case dk.DELETE:
case dk.BACKSPACE:
this._prev_key_esc=false;
this._prev_key_backspace=true;
_cc2=true;
break;
case dk.RIGHT_ARROW:
case dk.LEFT_ARROW:
this._prev_key_backspace=false;
this._prev_key_esc=false;
break;
default:
this._prev_key_backspace=false;
this._prev_key_esc=false;
_cc2=typeof key=="string"||key==229;
}
if(this.searchTimer){
clearTimeout(this.searchTimer);
}
if(_cc2){
setTimeout(dojo.hitch(this,"_startSearchFromInput"),1);
}
},_autoCompleteText:function(text){
var fn=this.focusNode;
dijit.selectInputText(fn,fn.value.length);
var _cc9=this.ignoreCase?"toLowerCase":"substr";
if(text[_cc9](0).indexOf(this.focusNode.value[_cc9](0))==0){
var cpos=this._getCaretPos(fn);
if((cpos+1)>fn.value.length){
fn.value=text;
dijit.selectInputText(fn,cpos);
}
}else{
fn.value=text;
dijit.selectInputText(fn);
}
},_openResultList:function(_ccb,_ccc){
if(this.disabled||this.readOnly||(_ccc.query[this.searchAttr]!=this._lastQuery)){
return;
}
this._popupWidget.clearResultList();
if(!_ccb.length){
this._hideResultList();
return;
}
var _ccd=new String(this.store.getValue(_ccb[0],this.searchAttr));
if(_ccd&&this.autoComplete&&!this._prev_key_backspace&&(_ccc.query[this.searchAttr]!="*")){
this._autoCompleteText(_ccd);
}
_ccc._maxOptions=this._maxOptions;
this._popupWidget.createOptions(_ccb,_ccc,dojo.hitch(this,"_getMenuLabelFromItem"));
this._showResultList();
if(_ccc.direction){
if(1==_ccc.direction){
this._popupWidget.highlightFirstOption();
}else{
if(-1==_ccc.direction){
this._popupWidget.highlightLastOption();
}
}
this._announceOption(this._popupWidget.getHighlightedOption());
}
},_showResultList:function(){
this._hideResultList();
var _cce=this._popupWidget.getItems(),_ccf=Math.min(_cce.length,this.maxListLength);
this._arrowPressed();
this.displayMessage("");
dojo.style(this._popupWidget.domNode,{width:"",height:""});
var best=this.open();
var _cd1=dojo.marginBox(this._popupWidget.domNode);
this._popupWidget.domNode.style.overflow=((best.h==_cd1.h)&&(best.w==_cd1.w))?"hidden":"auto";
var _cd2=best.w;
if(best.h<this._popupWidget.domNode.scrollHeight){
_cd2+=16;
}
dojo.marginBox(this._popupWidget.domNode,{h:best.h,w:Math.max(_cd2,this.domNode.offsetWidth)});
dijit.setWaiState(this.comboNode,"expanded","true");
},_hideResultList:function(){
if(this._isShowingNow){
dijit.popup.close(this._popupWidget);
this._arrowIdle();
this._isShowingNow=false;
dijit.setWaiState(this.comboNode,"expanded","false");
dijit.removeWaiState(this.focusNode,"activedescendant");
}
},_setBlurValue:function(){
var _cd3=this.attr("displayedValue");
var pw=this._popupWidget;
if(pw&&(_cd3==pw._messages["previousMessage"]||_cd3==pw._messages["nextMessage"])){
this._setValueAttr(this._lastValueReported,true);
}else{
this.attr("displayedValue",_cd3);
}
},_onBlur:function(){
this._hideResultList();
this._arrowIdle();
this.inherited(arguments);
},_announceOption:function(node){
if(node==null){
return;
}
var _cd6;
if(node==this._popupWidget.nextButton||node==this._popupWidget.previousButton){
_cd6=node.innerHTML;
}else{
_cd6=this.store.getValue(node.item,this.searchAttr);
}
this.focusNode.value=this.focusNode.value.substring(0,this._getCaretPos(this.focusNode));
dijit.setWaiState(this.focusNode,"activedescendant",dojo.attr(node,"id"));
this._autoCompleteText(_cd6);
},_selectOption:function(evt){
var tgt=null;
if(!evt){
evt={target:this._popupWidget.getHighlightedOption()};
}
if(!evt.target){
this.attr("displayedValue",this.attr("displayedValue"));
return;
}else{
tgt=evt.target;
}
if(!evt.noHide){
this._hideResultList();
this._setCaretPos(this.focusNode,this.store.getValue(tgt.item,this.searchAttr).length);
}
this._doSelect(tgt);
},_doSelect:function(tgt){
this.item=tgt.item;
this.attr("value",this.store.getValue(tgt.item,this.searchAttr));
},_onArrowMouseDown:function(evt){
if(this.disabled||this.readOnly){
return;
}
dojo.stopEvent(evt);
this.focus();
if(this._isShowingNow){
this._hideResultList();
}else{
this._startSearch("");
}
},_startSearchFromInput:function(){
this._startSearch(this.focusNode.value.replace(/([\\\*\?])/g,"\\$1"));
},_getQueryString:function(text){
return dojo.string.substitute(this.queryExpr,[text]);
},_startSearch:function(key){
if(!this._popupWidget){
var _cdd=this.id+"_popup";
this._popupWidget=new dijit.form._ComboBoxMenu({onChange:dojo.hitch(this,this._selectOption),id:_cdd});
dijit.removeWaiState(this.focusNode,"activedescendant");
dijit.setWaiState(this.textbox,"owns",_cdd);
}
this.item=null;
var _cde=dojo.clone(this.query);
this._lastInput=key;
this._lastQuery=_cde[this.searchAttr]=this._getQueryString(key);
this.searchTimer=setTimeout(dojo.hitch(this,function(_cdf,_ce0){
var _ce1={queryOptions:{ignoreCase:this.ignoreCase,deep:true},query:_cdf,onBegin:dojo.hitch(this,"_setMaxOptions"),onComplete:dojo.hitch(this,"_openResultList"),onError:function(_ce2){
console.error("dijit.form.ComboBox: "+_ce2);
dojo.hitch(_ce0,"_hideResultList")();
},start:0,count:this.pageSize};
dojo.mixin(_ce1,_ce0.fetchProperties);
var _ce3=_ce0.store.fetch(_ce1);
var _ce4=function(_ce5,_ce6){
_ce5.start+=_ce5.count*_ce6;
_ce5.direction=_ce6;
this.store.fetch(_ce5);
};
this._nextSearch=this._popupWidget.onPage=dojo.hitch(this,_ce4,_ce3);
},_cde,this),this.searchDelay);
},_setMaxOptions:function(size,_ce8){
this._maxOptions=size;
},_getValueField:function(){
return this.searchAttr;
},_arrowPressed:function(){
if(!this.disabled&&!this.readOnly&&this.hasDownArrow){
dojo.addClass(this.downArrowNode,"dijitArrowButtonActive");
}
},_arrowIdle:function(){
if(!this.disabled&&!this.readOnly&&this.hasDownArrow){
dojo.removeClass(this.downArrowNode,"dojoArrowButtonPushed");
}
},compositionend:function(evt){
this._onKeyPress({charOrCode:229});
},constructor:function(){
this.query={};
this.fetchProperties={};
},postMixInProperties:function(){
if(!this.hasDownArrow){
this.baseClass="dijitTextBox";
}
if(!this.store){
var _cea=this.srcNodeRef;
this.store=new dijit.form._ComboBoxDataStore(_cea);
if(!this.value||((typeof _cea.selectedIndex=="number")&&_cea.selectedIndex.toString()===this.value)){
var item=this.store.fetchSelectedItem();
if(item){
this.value=this.store.getValue(item,this._getValueField());
}
}
}
},_postCreate:function(){
var _cec=dojo.query("label[for=\""+this.id+"\"]");
if(_cec.length){
_cec[0].id=(this.id+"_label");
var cn=this.comboNode;
dijit.setWaiState(cn,"labelledby",_cec[0].id);
}
},uninitialize:function(){
if(this._popupWidget){
this._hideResultList();
this._popupWidget.destroy();
}
},_getMenuLabelFromItem:function(item){
var _cef=this.store.getValue(item,this.labelAttr||this.searchAttr);
var _cf0=this.labelType;
if(this.highlightMatch!="none"&&this.labelType=="text"&&this._lastInput){
_cef=this.doHighlight(_cef,this._escapeHtml(this._lastInput));
_cf0="html";
}
return {html:_cf0=="html",label:_cef};
},doHighlight:function(_cf1,find){
var _cf3="i"+(this.highlightMatch=="all"?"g":"");
var _cf4=this._escapeHtml(_cf1);
var ret=_cf4.replace(new RegExp("^("+find+")",_cf3),"<span class=\"dijitComboBoxHighlightMatch\">$1</span>");
if(_cf4==ret){
ret=_cf4.replace(new RegExp(" ("+find+")",_cf3)," <span class=\"dijitComboBoxHighlightMatch\">$1</span>");
}
return ret;
},_escapeHtml:function(str){
str=String(str).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");
return str;
},open:function(){
this._isShowingNow=true;
return dijit.popup.open({popup:this._popupWidget,around:this.domNode,parent:this});
},reset:function(){
this.item=null;
this.inherited(arguments);
}});
dojo.declare("dijit.form._ComboBoxMenu",[dijit._Widget,dijit._Templated],{templateString:"<ul class='dijitReset dijitMenu' dojoAttachEvent='onmousedown:_onMouseDown,onmouseup:_onMouseUp,onmouseover:_onMouseOver,onmouseout:_onMouseOut' tabIndex='-1' style='overflow: \"auto\"; overflow-x: \"hidden\";'>"+"<li class='dijitMenuItem dijitMenuPreviousButton' dojoAttachPoint='previousButton'></li>"+"<li class='dijitMenuItem dijitMenuNextButton' dojoAttachPoint='nextButton'></li>"+"</ul>",_messages:null,postMixInProperties:function(){
this._messages=dojo.i18n.getLocalization("dijit.form","ComboBox",this.lang);
this.inherited("postMixInProperties",arguments);
},_setValueAttr:function(_cf7){
this.value=_cf7;
this.onChange(_cf7);
},onChange:function(_cf8){
},onPage:function(_cf9){
},postCreate:function(){
this.previousButton.innerHTML=this._messages["previousMessage"];
this.nextButton.innerHTML=this._messages["nextMessage"];
this.inherited(arguments);
},onClose:function(){
this._blurOptionNode();
},_createOption:function(item,_cfb){
var _cfc=_cfb(item);
var _cfd=dojo.doc.createElement("li");
dijit.setWaiRole(_cfd,"option");
if(_cfc.html){
_cfd.innerHTML=_cfc.label;
}else{
_cfd.appendChild(dojo.doc.createTextNode(_cfc.label));
}
if(_cfd.innerHTML==""){
_cfd.innerHTML="&nbsp;";
}
_cfd.item=item;
return _cfd;
},createOptions:function(_cfe,_cff,_d00){
this.previousButton.style.display=(_cff.start==0)?"none":"";
dojo.attr(this.previousButton,"id",this.id+"_prev");
dojo.forEach(_cfe,function(item,i){
var _d03=this._createOption(item,_d00);
_d03.className="dijitReset dijitMenuItem";
dojo.attr(_d03,"id",this.id+i);
this.domNode.insertBefore(_d03,this.nextButton);
},this);
var _d04=false;
if(_cff._maxOptions&&_cff._maxOptions!=-1){
if((_cff.start+_cff.count)<_cff._maxOptions){
_d04=true;
}else{
if((_cff.start+_cff.count)>(_cff._maxOptions-1)){
if(_cff.count==_cfe.length){
_d04=true;
}
}
}
}else{
if(_cff.count==_cfe.length){
_d04=true;
}
}
this.nextButton.style.display=_d04?"":"none";
dojo.attr(this.nextButton,"id",this.id+"_next");
},clearResultList:function(){
while(this.domNode.childNodes.length>2){
this.domNode.removeChild(this.domNode.childNodes[this.domNode.childNodes.length-2]);
}
},getItems:function(){
return this.domNode.childNodes;
},getListLength:function(){
return this.domNode.childNodes.length-2;
},_onMouseDown:function(evt){
dojo.stopEvent(evt);
},_onMouseUp:function(evt){
if(evt.target===this.domNode){
return;
}else{
if(evt.target==this.previousButton){
this.onPage(-1);
}else{
if(evt.target==this.nextButton){
this.onPage(1);
}else{
var tgt=evt.target;
while(!tgt.item){
tgt=tgt.parentNode;
}
this._setValueAttr({target:tgt},true);
}
}
}
},_onMouseOver:function(evt){
if(evt.target===this.domNode){
return;
}
var tgt=evt.target;
if(!(tgt==this.previousButton||tgt==this.nextButton)){
while(!tgt.item){
tgt=tgt.parentNode;
}
}
this._focusOptionNode(tgt);
},_onMouseOut:function(evt){
if(evt.target===this.domNode){
return;
}
this._blurOptionNode();
},_focusOptionNode:function(node){
if(this._highlighted_option!=node){
this._blurOptionNode();
this._highlighted_option=node;
dojo.addClass(this._highlighted_option,"dijitMenuItemHover");
}
},_blurOptionNode:function(){
if(this._highlighted_option){
dojo.removeClass(this._highlighted_option,"dijitMenuItemHover");
this._highlighted_option=null;
}
},_highlightNextOption:function(){
var fc=this.domNode.firstChild;
if(!this.getHighlightedOption()){
this._focusOptionNode(fc.style.display=="none"?fc.nextSibling:fc);
}else{
var ns=this._highlighted_option.nextSibling;
if(ns&&ns.style.display!="none"){
this._focusOptionNode(ns);
}
}
dijit.scrollIntoView(this._highlighted_option);
},highlightFirstOption:function(){
this._focusOptionNode(this.domNode.firstChild.nextSibling);
dijit.scrollIntoView(this._highlighted_option);
},highlightLastOption:function(){
this._focusOptionNode(this.domNode.lastChild.previousSibling);
dijit.scrollIntoView(this._highlighted_option);
},_highlightPrevOption:function(){
var lc=this.domNode.lastChild;
if(!this.getHighlightedOption()){
this._focusOptionNode(lc.style.display=="none"?lc.previousSibling:lc);
}else{
var ps=this._highlighted_option.previousSibling;
if(ps&&ps.style.display!="none"){
this._focusOptionNode(ps);
}
}
dijit.scrollIntoView(this._highlighted_option);
},_page:function(up){
var _d11=0;
var _d12=this.domNode.scrollTop;
var _d13=dojo.style(this.domNode,"height");
if(!this.getHighlightedOption()){
this._highlightNextOption();
}
while(_d11<_d13){
if(up){
if(!this.getHighlightedOption().previousSibling||this._highlighted_option.previousSibling.style.display=="none"){
break;
}
this._highlightPrevOption();
}else{
if(!this.getHighlightedOption().nextSibling||this._highlighted_option.nextSibling.style.display=="none"){
break;
}
this._highlightNextOption();
}
var _d14=this.domNode.scrollTop;
_d11+=(_d14-_d12)*(up?-1:1);
_d12=_d14;
}
},pageUp:function(){
this._page(true);
},pageDown:function(){
this._page(false);
},getHighlightedOption:function(){
var ho=this._highlighted_option;
return (ho&&ho.parentNode)?ho:null;
},handleKey:function(key){
switch(key){
case dojo.keys.DOWN_ARROW:
this._highlightNextOption();
break;
case dojo.keys.PAGE_DOWN:
this.pageDown();
break;
case dojo.keys.UP_ARROW:
this._highlightPrevOption();
break;
case dojo.keys.PAGE_UP:
this.pageUp();
break;
}
}});
dojo.declare("dijit.form.ComboBox",[dijit.form.ValidationTextBox,dijit.form.ComboBoxMixin],{postMixInProperties:function(){
dijit.form.ComboBoxMixin.prototype.postMixInProperties.apply(this,arguments);
dijit.form.ValidationTextBox.prototype.postMixInProperties.apply(this,arguments);
},postCreate:function(){
dijit.form.ComboBoxMixin.prototype._postCreate.apply(this,arguments);
dijit.form.ValidationTextBox.prototype.postCreate.apply(this,arguments);
},_setDisabledAttr:function(_d17){
dijit.form.ValidationTextBox.prototype._setDisabledAttr.apply(this,arguments);
dijit.form.ComboBoxMixin.prototype._setDisabledAttr.apply(this,arguments);
},_setValueAttr:function(_d18,_d19){
if(!_d18){
_d18="";
}
dijit.form.ValidationTextBox.prototype._setValueAttr.call(this,_d18,_d19);
}});
dojo.declare("dijit.form._ComboBoxDataStore",null,{constructor:function(root){
this.root=root;
dojo.query("> option",root).forEach(function(node){
node.innerHTML=dojo.trim(node.innerHTML);
});
},getValue:function(item,_d1d,_d1e){
return (_d1d=="value")?item.value:(item.innerText||item.textContent||"");
},isItemLoaded:function(_d1f){
return true;
},getFeatures:function(){
return {"dojo.data.api.Read":true,"dojo.data.api.Identity":true};
},_fetchItems:function(args,_d21,_d22){
if(!args.query){
args.query={};
}
if(!args.query.name){
args.query.name="";
}
if(!args.queryOptions){
args.queryOptions={};
}
var _d23=dojo.data.util.filter.patternToRegExp(args.query.name,args.queryOptions.ignoreCase),_d24=dojo.query("> option",this.root).filter(function(_d25){
return (_d25.innerText||_d25.textContent||"").match(_d23);
});
if(args.sort){
_d24.sort(dojo.data.util.sorter.createSortFunction(args.sort,this));
}
_d21(_d24,args);
},close:function(_d26){
return;
},getLabel:function(item){
return item.innerHTML;
},getIdentity:function(item){
return dojo.attr(item,"value");
},fetchItemByIdentity:function(args){
var item=dojo.query("option[value='"+args.identity+"']",this.root)[0];
args.onItem(item);
},fetchSelectedItem:function(){
var root=this.root,si=root.selectedIndex;
return dojo.query("> option:nth-child("+(si!=-1?si+1:1)+")",root)[0];
}});
dojo.extend(dijit.form._ComboBoxDataStore,dojo.data.util.simpleFetch);
}
if(!dojo._hasResource["dijit.form.FilteringSelect"]){
dojo._hasResource["dijit.form.FilteringSelect"]=true;
dojo.provide("dijit.form.FilteringSelect");
dojo.declare("dijit.form.FilteringSelect",[dijit.form.MappedTextBox,dijit.form.ComboBoxMixin],{_isvalid:true,required:true,_lastDisplayedValue:"",isValid:function(){
return this._isvalid||(!this.required&&this.attr("displayedValue")=="");
},_callbackSetLabel:function(_d2d,_d2e,_d2f){
if((_d2e&&_d2e.query[this.searchAttr]!=this._lastQuery)||(!_d2e&&_d2d.length&&this.store.getIdentity(_d2d[0])!=this._lastQuery)){
return;
}
if(!_d2d.length){
if(_d2f||!this._focused){
this.valueNode.value="";
}
dijit.form.TextBox.superclass._setValueAttr.call(this,"",_d2f||!this._focused);
this._isvalid=false;
this.validate(this._focused);
this.item=null;
}else{
this._setValueFromItem(_d2d[0],_d2f);
}
},_openResultList:function(_d30,_d31){
if(_d31.query[this.searchAttr]!=this._lastQuery){
return;
}
this._isvalid=_d30.length!=0;
this.validate(true);
dijit.form.ComboBoxMixin.prototype._openResultList.apply(this,arguments);
},_getValueAttr:function(){
return this.valueNode.value;
},_getValueField:function(){
return "value";
},_setValue:function(_d32,_d33,_d34){
this.valueNode.value=_d32;
dijit.form.FilteringSelect.superclass._setValueAttr.call(this,_d32,_d34,_d33);
this._lastDisplayedValue=_d33;
},_setValueAttr:function(_d35,_d36){
if(!this._onChangeActive){
_d36=null;
}
this._lastQuery=_d35;
if(_d35===null){
this._setDisplayedValueAttr("",_d36);
return;
}
var self=this;
var _d38=function(item,_d3a){
if(item){
if(self.store.isItemLoaded(item)){
self._callbackSetLabel([item],undefined,_d3a);
}else{
self.store.loadItem({item:item,onItem:function(_d3b,_d3c){
self._callbackSetLabel(_d3b,_d3c,_d3a);
}});
}
}else{
self._isvalid=false;
self.validate(false);
}
};
this.store.fetchItemByIdentity({identity:_d35,onItem:function(item){
_d38(item,_d36);
}});
},_setValueFromItem:function(item,_d3f){
this._isvalid=true;
this.item=item;
this._setValue(this.store.getIdentity(item),this.labelFunc(item,this.store),_d3f);
},labelFunc:function(item,_d41){
return _d41.getValue(item,this.searchAttr);
},_doSelect:function(tgt){
this._setValueFromItem(tgt.item,true);
},_setDisplayedValueAttr:function(_d43,_d44){
if(!this._created){
_d44=false;
}
if(this.store){
var _d45=dojo.clone(this.query);
this._lastQuery=_d45[this.searchAttr]=_d43.replace(/([\\\*\?])/g,"\\$1");
this.textbox.value=_d43;
this._lastDisplayedValue=_d43;
var _d46=this;
var _d47={query:_d45,queryOptions:{ignoreCase:this.ignoreCase,deep:true},onComplete:function(_d48,_d49){
dojo.hitch(_d46,"_callbackSetLabel")(_d48,_d49,_d44);
},onError:function(_d4a){
console.error("dijit.form.FilteringSelect: "+_d4a);
dojo.hitch(_d46,"_setValue")("",_d43,false);
}};
dojo.mixin(_d47,this.fetchProperties);
this.store.fetch(_d47);
}
},postMixInProperties:function(){
dijit.form.ComboBoxMixin.prototype.postMixInProperties.apply(this,arguments);
dijit.form.MappedTextBox.prototype.postMixInProperties.apply(this,arguments);
},postCreate:function(){
dijit.form.ComboBoxMixin.prototype._postCreate.apply(this,arguments);
dijit.form.MappedTextBox.prototype.postCreate.apply(this,arguments);
},_setDisabledAttr:function(attr,_d4c){
dijit.form.MappedTextBox.prototype._setDisabledAttr.apply(this,arguments);
dijit.form.ComboBoxMixin.prototype._setDisabledAttr.apply(this,arguments);
},undo:function(){
this.attr("displayedValue",this._lastDisplayedValue);
},_valueChanged:function(){
return this.attr("displayedValue")!=this._lastDisplayedValue;
}});
}
if(!dojo._hasResource["dojo.data.ItemFileReadStore"]){
dojo._hasResource["dojo.data.ItemFileReadStore"]=true;
dojo.provide("dojo.data.ItemFileReadStore");
dojo.declare("dojo.data.ItemFileReadStore",null,{constructor:function(_d4d){
this._arrayOfAllItems=[];
this._arrayOfTopLevelItems=[];
this._loadFinished=false;
this._jsonFileUrl=_d4d.url;
this._jsonData=_d4d.data;
this._datatypeMap=_d4d.typeMap||{};
if(!this._datatypeMap["Date"]){
this._datatypeMap["Date"]={type:Date,deserialize:function(_d4e){
return dojo.date.stamp.fromISOString(_d4e);
}};
}
this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};
this._itemsByIdentity=null;
this._storeRefPropName="_S";
this._itemNumPropName="_0";
this._rootItemPropName="_RI";
this._reverseRefMap="_RRM";
this._loadInProgress=false;
this._queuedFetches=[];
if(_d4d.urlPreventCache!==undefined){
this.urlPreventCache=_d4d.urlPreventCache?true:false;
}
if(_d4d.clearOnClose){
this.clearOnClose=true;
}
},url:"",data:null,typeMap:null,clearOnClose:false,urlPreventCache:false,_assertIsItem:function(item){
if(!this.isItem(item)){
throw new Error("dojo.data.ItemFileReadStore: Invalid item argument.");
}
},_assertIsAttribute:function(_d50){
if(typeof _d50!=="string"){
throw new Error("dojo.data.ItemFileReadStore: Invalid attribute argument.");
}
},getValue:function(item,_d52,_d53){
var _d54=this.getValues(item,_d52);
return (_d54.length>0)?_d54[0]:_d53;
},getValues:function(item,_d56){
this._assertIsItem(item);
this._assertIsAttribute(_d56);
return item[_d56]||[];
},getAttributes:function(item){
this._assertIsItem(item);
var _d58=[];
for(var key in item){
if((key!==this._storeRefPropName)&&(key!==this._itemNumPropName)&&(key!==this._rootItemPropName)&&(key!==this._reverseRefMap)){
_d58.push(key);
}
}
return _d58;
},hasAttribute:function(item,_d5b){
return this.getValues(item,_d5b).length>0;
},containsValue:function(item,_d5d,_d5e){
var _d5f=undefined;
if(typeof _d5e==="string"){
_d5f=dojo.data.util.filter.patternToRegExp(_d5e,false);
}
return this._containsValue(item,_d5d,_d5e,_d5f);
},_containsValue:function(item,_d61,_d62,_d63){
return dojo.some(this.getValues(item,_d61),function(_d64){
if(_d64!==null&&!dojo.isObject(_d64)&&_d63){
if(_d64.toString().match(_d63)){
return true;
}
}else{
if(_d62===_d64){
return true;
}
}
});
},isItem:function(_d65){
if(_d65&&_d65[this._storeRefPropName]===this){
if(this._arrayOfAllItems[_d65[this._itemNumPropName]]===_d65){
return true;
}
}
return false;
},isItemLoaded:function(_d66){
return this.isItem(_d66);
},loadItem:function(_d67){
this._assertIsItem(_d67.item);
},getFeatures:function(){
return this._features;
},getLabel:function(item){
if(this._labelAttr&&this.isItem(item)){
return this.getValue(item,this._labelAttr);
}
return undefined;
},getLabelAttributes:function(item){
if(this._labelAttr){
return [this._labelAttr];
}
return null;
},_fetchItems:function(_d6a,_d6b,_d6c){
var self=this;
var _d6e=function(_d6f,_d70){
var _d71=[];
if(_d6f.query){
var _d72=_d6f.queryOptions?_d6f.queryOptions.ignoreCase:false;
var _d73={};
for(var key in _d6f.query){
var _d75=_d6f.query[key];
if(typeof _d75==="string"){
_d73[key]=dojo.data.util.filter.patternToRegExp(_d75,_d72);
}
}
for(var i=0;i<_d70.length;++i){
var _d77=true;
var _d78=_d70[i];
if(_d78===null){
_d77=false;
}else{
for(var key in _d6f.query){
var _d75=_d6f.query[key];
if(!self._containsValue(_d78,key,_d75,_d73[key])){
_d77=false;
}
}
}
if(_d77){
_d71.push(_d78);
}
}
_d6b(_d71,_d6f);
}else{
for(var i=0;i<_d70.length;++i){
var item=_d70[i];
if(item!==null){
_d71.push(item);
}
}
_d6b(_d71,_d6f);
}
};
if(this._loadFinished){
_d6e(_d6a,this._getItemsArray(_d6a.queryOptions));
}else{
if(this._jsonFileUrl){
if(this._loadInProgress){
this._queuedFetches.push({args:_d6a,filter:_d6e});
}else{
this._loadInProgress=true;
var _d7a={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache};
var _d7b=dojo.xhrGet(_d7a);
_d7b.addCallback(function(data){
try{
self._getItemsFromLoadedData(data);
self._loadFinished=true;
self._loadInProgress=false;
_d6e(_d6a,self._getItemsArray(_d6a.queryOptions));
self._handleQueuedFetches();
}
catch(e){
self._loadFinished=true;
self._loadInProgress=false;
_d6c(e,_d6a);
}
});
_d7b.addErrback(function(_d7d){
self._loadInProgress=false;
_d6c(_d7d,_d6a);
});
}
}else{
if(this._jsonData){
try{
this._loadFinished=true;
this._getItemsFromLoadedData(this._jsonData);
this._jsonData=null;
_d6e(_d6a,this._getItemsArray(_d6a.queryOptions));
}
catch(e){
_d6c(e,_d6a);
}
}else{
_d6c(new Error("dojo.data.ItemFileReadStore: No JSON source data was provided as either URL or a nested Javascript object."),_d6a);
}
}
}
},_handleQueuedFetches:function(){
if(this._queuedFetches.length>0){
for(var i=0;i<this._queuedFetches.length;i++){
var _d7f=this._queuedFetches[i];
var _d80=_d7f.args;
var _d81=_d7f.filter;
if(_d81){
_d81(_d80,this._getItemsArray(_d80.queryOptions));
}else{
this.fetchItemByIdentity(_d80);
}
}
this._queuedFetches=[];
}
},_getItemsArray:function(_d82){
if(_d82&&_d82.deep){
return this._arrayOfAllItems;
}
return this._arrayOfTopLevelItems;
},close:function(_d83){
if(this.clearOnClose&&(this._jsonFileUrl!=="")){
this._arrayOfAllItems=[];
this._arrayOfTopLevelItems=[];
this._loadFinished=false;
this._itemsByIdentity=null;
this._loadInProgress=false;
this._queuedFetches=[];
}
},_getItemsFromLoadedData:function(_d84){
var _d85=false;
function valueIsAnItem(_d86){
var _d87=((_d86!=null)&&(typeof _d86=="object")&&(!dojo.isArray(_d86)||_d85)&&(!dojo.isFunction(_d86))&&(_d86.constructor==Object||dojo.isArray(_d86))&&(typeof _d86._reference=="undefined")&&(typeof _d86._type=="undefined")&&(typeof _d86._value=="undefined"));
return _d87;
};
var self=this;
function addItemAndSubItemsToArrayOfAllItems(_d89){
self._arrayOfAllItems.push(_d89);
for(var _d8a in _d89){
var _d8b=_d89[_d8a];
if(_d8b){
if(dojo.isArray(_d8b)){
var _d8c=_d8b;
for(var k=0;k<_d8c.length;++k){
var _d8e=_d8c[k];
if(valueIsAnItem(_d8e)){
addItemAndSubItemsToArrayOfAllItems(_d8e);
}
}
}else{
if(valueIsAnItem(_d8b)){
addItemAndSubItemsToArrayOfAllItems(_d8b);
}
}
}
}
};
this._labelAttr=_d84.label;
var i;
var item;
this._arrayOfAllItems=[];
this._arrayOfTopLevelItems=_d84.items;
for(i=0;i<this._arrayOfTopLevelItems.length;++i){
item=this._arrayOfTopLevelItems[i];
if(dojo.isArray(item)){
_d85=true;
}
addItemAndSubItemsToArrayOfAllItems(item);
item[this._rootItemPropName]=true;
}
var _d91={};
var key;
for(i=0;i<this._arrayOfAllItems.length;++i){
item=this._arrayOfAllItems[i];
for(key in item){
if(key!==this._rootItemPropName){
var _d93=item[key];
if(_d93!==null){
if(!dojo.isArray(_d93)){
item[key]=[_d93];
}
}else{
item[key]=[null];
}
}
_d91[key]=key;
}
}
while(_d91[this._storeRefPropName]){
this._storeRefPropName+="_";
}
while(_d91[this._itemNumPropName]){
this._itemNumPropName+="_";
}
while(_d91[this._reverseRefMap]){
this._reverseRefMap+="_";
}
var _d94;
var _d95=_d84.identifier;
if(_d95){
this._itemsByIdentity={};
this._features["dojo.data.api.Identity"]=_d95;
for(i=0;i<this._arrayOfAllItems.length;++i){
item=this._arrayOfAllItems[i];
_d94=item[_d95];
var _d96=_d94[0];
if(!this._itemsByIdentity[_d96]){
this._itemsByIdentity[_d96]=item;
}else{
if(this._jsonFileUrl){
throw new Error("dojo.data.ItemFileReadStore:  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+_d95+"].  Value collided: ["+_d96+"]");
}else{
if(this._jsonData){
throw new Error("dojo.data.ItemFileReadStore:  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+_d95+"].  Value collided: ["+_d96+"]");
}
}
}
}
}else{
this._features["dojo.data.api.Identity"]=Number;
}
for(i=0;i<this._arrayOfAllItems.length;++i){
item=this._arrayOfAllItems[i];
item[this._storeRefPropName]=this;
item[this._itemNumPropName]=i;
}
for(i=0;i<this._arrayOfAllItems.length;++i){
item=this._arrayOfAllItems[i];
for(key in item){
_d94=item[key];
for(var j=0;j<_d94.length;++j){
_d93=_d94[j];
if(_d93!==null&&typeof _d93=="object"){
if(_d93._type&&_d93._value){
var type=_d93._type;
var _d99=this._datatypeMap[type];
if(!_d99){
throw new Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+type+"'");
}else{
if(dojo.isFunction(_d99)){
_d94[j]=new _d99(_d93._value);
}else{
if(dojo.isFunction(_d99.deserialize)){
_d94[j]=_d99.deserialize(_d93._value);
}else{
throw new Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");
}
}
}
}
if(_d93._reference){
var _d9a=_d93._reference;
if(!dojo.isObject(_d9a)){
_d94[j]=this._itemsByIdentity[_d9a];
}else{
for(var k=0;k<this._arrayOfAllItems.length;++k){
var _d9c=this._arrayOfAllItems[k];
var _d9d=true;
for(var _d9e in _d9a){
if(_d9c[_d9e]!=_d9a[_d9e]){
_d9d=false;
}
}
if(_d9d){
_d94[j]=_d9c;
}
}
}
if(this.referenceIntegrity){
var _d9f=_d94[j];
if(this.isItem(_d9f)){
this._addReferenceToMap(_d9f,item,key);
}
}
}else{
if(this.isItem(_d93)){
if(this.referenceIntegrity){
this._addReferenceToMap(_d93,item,key);
}
}
}
}
}
}
}
},_addReferenceToMap:function(_da0,_da1,_da2){
},getIdentity:function(item){
var _da4=this._features["dojo.data.api.Identity"];
if(_da4===Number){
return item[this._itemNumPropName];
}else{
var _da5=item[_da4];
if(_da5){
return _da5[0];
}
}
return null;
},fetchItemByIdentity:function(_da6){
if(!this._loadFinished){
var self=this;
if(this._jsonFileUrl){
if(this._loadInProgress){
this._queuedFetches.push({args:_da6});
}else{
this._loadInProgress=true;
var _da8={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache};
var _da9=dojo.xhrGet(_da8);
_da9.addCallback(function(data){
var _dab=_da6.scope?_da6.scope:dojo.global;
try{
self._getItemsFromLoadedData(data);
self._loadFinished=true;
self._loadInProgress=false;
var item=self._getItemByIdentity(_da6.identity);
if(_da6.onItem){
_da6.onItem.call(_dab,item);
}
self._handleQueuedFetches();
}
catch(error){
self._loadInProgress=false;
if(_da6.onError){
_da6.onError.call(_dab,error);
}
}
});
_da9.addErrback(function(_dad){
self._loadInProgress=false;
if(_da6.onError){
var _dae=_da6.scope?_da6.scope:dojo.global;
_da6.onError.call(_dae,_dad);
}
});
}
}else{
if(this._jsonData){
self._getItemsFromLoadedData(self._jsonData);
self._jsonData=null;
self._loadFinished=true;
var item=self._getItemByIdentity(_da6.identity);
if(_da6.onItem){
var _db0=_da6.scope?_da6.scope:dojo.global;
_da6.onItem.call(_db0,item);
}
}
}
}else{
var item=this._getItemByIdentity(_da6.identity);
if(_da6.onItem){
var _db0=_da6.scope?_da6.scope:dojo.global;
_da6.onItem.call(_db0,item);
}
}
},_getItemByIdentity:function(_db1){
var item=null;
if(this._itemsByIdentity){
item=this._itemsByIdentity[_db1];
}else{
item=this._arrayOfAllItems[_db1];
}
if(item===undefined){
item=null;
}
return item;
},getIdentityAttributes:function(item){
var _db4=this._features["dojo.data.api.Identity"];
if(_db4===Number){
return null;
}else{
return [_db4];
}
},_forceLoad:function(){
var self=this;
if(this._jsonFileUrl){
var _db6={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,sync:true};
var _db7=dojo.xhrGet(_db6);
_db7.addCallback(function(data){
try{
if(self._loadInProgress!==true&&!self._loadFinished){
self._getItemsFromLoadedData(data);
self._loadFinished=true;
}else{
if(self._loadInProgress){
throw new Error("dojo.data.ItemFileReadStore:  Unable to perform a synchronous load, an async load is in progress.");
}
}
}
catch(e){
console.log(e);
throw e;
}
});
_db7.addErrback(function(_db9){
throw _db9;
});
}else{
if(this._jsonData){
self._getItemsFromLoadedData(self._jsonData);
self._jsonData=null;
self._loadFinished=true;
}
}
}});
dojo.extend(dojo.data.ItemFileReadStore,dojo.data.util.simpleFetch);
}
if(!dojo._hasResource["dijit._editor.plugins.FontChoice"]){
dojo._hasResource["dijit._editor.plugins.FontChoice"]=true;
dojo.provide("dijit._editor.plugins.FontChoice");
dojo.declare("dijit._editor.plugins.FontChoice",dijit._editor._Plugin,{_uniqueId:0,buttonClass:dijit.form.FilteringSelect,useDefaultCommand:false,_initButton:function(){
var cmd=this.command;
var _dbb=this.custom||{fontName:this.generic?["serif","sans-serif","monospace","cursive","fantasy"]:["Arial","Times New Roman","Comic Sans MS","Courier New"],fontSize:[1,2,3,4,5,6,7],formatBlock:["p","h1","h2","h3","pre"]}[cmd];
this._availableValues=_dbb;
var _dbc=dojo.i18n.getLocalization("dijit._editor","FontChoice");
var _dbd=dojo.map(_dbb,function(_dbe){
var name=_dbc[_dbe]||_dbe;
var _dc0=name;
switch(cmd){
case "fontName":
_dc0="<div style='font-family: "+_dbe+"'>"+name+"</div>";
break;
case "fontSize":
_dc0="<font size="+_dbe+"'>"+name+"</font>";
break;
case "formatBlock":
_dc0="<"+_dbe+">"+name+"</"+_dbe+">";
}
return {label:_dc0,name:name,value:_dbe};
});
this.inherited(arguments,[{required:false,labelType:"html",labelAttr:"label",searchAttr:"name",store:new dojo.data.ItemFileReadStore({data:{identifier:"value",items:_dbd}})}]);
this.button.attr("value","");
this.connect(this.button,"onChange",function(_dc1){
if(this.updating){
return;
}
if(dojo.isIE||!this._focusHandle){
this.editor.focus();
}else{
dijit.focus(this._focusHandle);
}
if(this.command=="fontName"&&_dc1.indexOf(" ")!=-1){
_dc1="'"+_dc1+"'";
}
this.editor.execCommand(this.editor._normalizeCommand(this.command),_dc1);
});
},updateState:function(){
this.inherited(arguments);
var _e=this.editor;
var _c=this.command;
if(!_e||!_e.isLoaded||!_c.length){
return;
}
if(this.button){
var _dc4;
try{
_dc4=_e.queryCommandValue(_c)||"";
}
catch(e){
_dc4="";
}
var _dc5=dojo.isString(_dc4)&&_dc4.match(/'([^']*)'/);
if(_dc5){
_dc4=_dc5[1];
}
if(this.generic&&_c=="fontName"){
var map={"Arial":"sans-serif","Helvetica":"sans-serif","Myriad":"sans-serif","Times":"serif","Times New Roman":"serif","Comic Sans MS":"cursive","Apple Chancery":"cursive","Courier":"monospace","Courier New":"monospace","Papyrus":"fantasy"};
_dc4=map[_dc4]||_dc4;
}else{
if(_c=="fontSize"&&_dc4.indexOf&&_dc4.indexOf("px")!=-1){
var _dc7=parseInt(_dc4);
_dc4={10:1,13:2,16:3,18:4,24:5,32:6,48:7}[_dc7]||_dc4;
}
}
this.updating=true;
this.button.attr("value",dojo.indexOf(this._availableValues,_dc4)<0?"":_dc4);
delete this.updating;
}
if(this.editor.iframe){
this._focusHandle=dijit.getFocus(this.editor.iframe);
}
},setToolbar:function(){
this.inherited(arguments);
var _dc8=this.button;
if(!_dc8.id){
_dc8.id=dijit._scopeName+"EditorButton-"+this.command+(this._uniqueId++);
}
var _dc9=dojo.doc.createElement("label");
dojo.addClass(_dc9,"dijit dijitReset dijitLeft dijitInline");
_dc9.setAttribute("for",_dc8.id);
var _dca=dojo.i18n.getLocalization("dijit._editor","FontChoice");
_dc9.appendChild(dojo.doc.createTextNode(_dca[this.command]));
dojo.place(_dc9,this.button.domNode,"before");
}});
dojo.subscribe(dijit._scopeName+".Editor.getPlugin",null,function(o){
if(o.plugin){
return;
}
switch(o.args.name){
case "fontName":
case "fontSize":
case "formatBlock":
o.plugin=new dijit._editor.plugins.FontChoice({command:o.args.name});
}
});
}
if(!dojo._hasResource["dijit._editor.plugins.LinkDialog"]){
dojo._hasResource["dijit._editor.plugins.LinkDialog"]=true;
dojo.provide("dijit._editor.plugins.LinkDialog");
dojo.declare("dijit._editor.plugins.LinkDialog",dijit._editor._Plugin,{buttonClass:dijit.form.DropDownButton,useDefaultCommand:false,urlRegExp:"((https?|ftps?)\\://|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?",linkDialogTemplate:["<table><tr><td>","<label for='${id}_urlInput'>${url}</label>","</td><td>","<input dojoType='dijit.form.ValidationTextBox' regExp='${urlRegExp}' required='true' id='${id}_urlInput' name='urlInput'>","</td></tr><tr><td>","<label for='${id}_textInput'>${text}</label>","</td><td>","<input dojoType='dijit.form.ValidationTextBox' required='true' id='${id}_textInput' name='textInput'>","</td></tr><tr><td colspan='2'>","<button dojoType='dijit.form.Button' type='submit'>${set}</button>","</td></tr></table>"].join(""),_initButton:function(){
var _dcc=this;
this.tag=this.command=="insertImage"?"img":"a";
var _dcd=dojo.i18n.getLocalization("dijit._editor","LinkDialog",this.lang);
var _dce=(this.dropDown=new dijit.TooltipDialog({title:_dcd[this.command+"Title"],execute:dojo.hitch(this,"setValue"),onOpen:function(){
_dcc._onOpenDialog();
dijit.TooltipDialog.prototype.onOpen.apply(this,arguments);
},onCancel:function(){
setTimeout(dojo.hitch(_dcc,"_onCloseDialog"),0);
},onClose:dojo.hitch(this,"_onCloseDialog")}));
_dcd.urlRegExp=this.urlRegExp;
_dcd.id=dijit.getUniqueId(this.editor.id);
this._setContent(_dce.title+"<div style='border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'></div>"+dojo.string.substitute(this.linkDialogTemplate,_dcd));
_dce.startup();
this.inherited(arguments);
},_setContent:function(_dcf){
this.dropDown.attr("content",_dcf);
},setValue:function(args){
this._onCloseDialog();
if(dojo.isIE){
var a=dojo.withGlobal(this.editor.window,"getAncestorElement",dijit._editor.selection,[this.tag]);
if(a){
dojo.withGlobal(this.editor.window,"selectElement",dijit._editor.selection,[a]);
}
}
args.tag=this.tag;
args.refAttr=this.tag=="img"?"src":"href";
var _dd2="<${tag} ${refAttr}='${urlInput}' _djrealurl='${urlInput}'"+(args.tag=="img"?" alt='${textInput}'>":">${textInput}")+"</${tag}>";
this.editor.execCommand("inserthtml",dojo.string.substitute(_dd2,args));
},_onCloseDialog:function(){
this.editor.focus();
},_onOpenDialog:function(){
var a=dojo.withGlobal(this.editor.window,"getAncestorElement",dijit._editor.selection,[this.tag]);
var url,text;
if(a){
url=a.getAttribute("_djrealurl");
text=this.tag=="img"?a.getAttribute("alt"):a.textContent||a.innerText;
dojo.withGlobal(this.editor.window,"selectElement",dijit._editor.selection,[a,true]);
}else{
text=dojo.withGlobal(this.editor.window,dijit._editor.selection.getSelectedText);
}
this.dropDown.reset();
this.dropDown.setValues({urlInput:url||"",textInput:text||""});
}});
dojo.subscribe(dijit._scopeName+".Editor.getPlugin",null,function(o){
if(o.plugin){
return;
}
switch(o.args.name){
case "createLink":
case "insertImage":
o.plugin=new dijit._editor.plugins.LinkDialog({command:o.args.name});
}
});
}
if(!dojo._hasResource["dojo.colors"]){
dojo._hasResource["dojo.colors"]=true;
dojo.provide("dojo.colors");
(function(){
var _dd7=function(m1,m2,h){
if(h<0){
++h;
}
if(h>1){
--h;
}
var h6=6*h;
if(h6<1){
return m1+(m2-m1)*h6;
}
if(2*h<1){
return m2;
}
if(3*h<2){
return m1+(m2-m1)*(2/3-h)*6;
}
return m1;
};
dojo.colorFromRgb=function(_ddc,obj){
var m=_ddc.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);
if(m){
var c=m[2].split(/\s*,\s*/),l=c.length,t=m[1];
if((t=="rgb"&&l==3)||(t=="rgba"&&l==4)){
var r=c[0];
if(r.charAt(r.length-1)=="%"){
var a=dojo.map(c,function(x){
return parseFloat(x)*2.56;
});
if(l==4){
a[3]=c[3];
}
return dojo.colorFromArray(a,obj);
}
return dojo.colorFromArray(c,obj);
}
if((t=="hsl"&&l==3)||(t=="hsla"&&l==4)){
var H=((parseFloat(c[0])%360)+360)%360/360,S=parseFloat(c[1])/100,L=parseFloat(c[2])/100,m2=L<=0.5?L*(S+1):L+S-L*S,m1=2*L-m2,a=[_dd7(m1,m2,H+1/3)*256,_dd7(m1,m2,H)*256,_dd7(m1,m2,H-1/3)*256,1];
if(l==4){
a[3]=c[3];
}
return dojo.colorFromArray(a,obj);
}
}
return null;
};
var _dea=function(c,low,high){
c=Number(c);
return isNaN(c)?high:c<low?low:c>high?high:c;
};
dojo.Color.prototype.sanitize=function(){
var t=this;
t.r=Math.round(_dea(t.r,0,255));
t.g=Math.round(_dea(t.g,0,255));
t.b=Math.round(_dea(t.b,0,255));
t.a=_dea(t.a,0,1);
return this;
};
})();
dojo.colors.makeGrey=function(g,a){
return dojo.colorFromArray([g,g,g,a]);
};
dojo.Color.named=dojo.mixin({aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],transparent:[0,0,0,0],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]},dojo.Color.named);
}
if(!dojo._hasResource["dijit.ColorPalette"]){
dojo._hasResource["dijit.ColorPalette"]=true;
dojo.provide("dijit.ColorPalette");
dojo.declare("dijit.ColorPalette",[dijit._Widget,dijit._Templated],{defaultTimeout:500,timeoutChangeRate:0.9,palette:"7x10",value:null,_currentFocus:0,_xDim:null,_yDim:null,_palettes:{"7x10":[["white","seashell","cornsilk","lemonchiffon","lightyellow","palegreen","paleturquoise","lightcyan","lavender","plum"],["lightgray","pink","bisque","moccasin","khaki","lightgreen","lightseagreen","lightskyblue","cornflowerblue","violet"],["silver","lightcoral","sandybrown","orange","palegoldenrod","chartreuse","mediumturquoise","skyblue","mediumslateblue","orchid"],["gray","red","orangered","darkorange","yellow","limegreen","darkseagreen","royalblue","slateblue","mediumorchid"],["dimgray","crimson","chocolate","coral","gold","forestgreen","seagreen","blue","blueviolet","darkorchid"],["darkslategray","firebrick","saddlebrown","sienna","olive","green","darkcyan","mediumblue","darkslateblue","darkmagenta"],["black","darkred","maroon","brown","darkolivegreen","darkgreen","midnightblue","navy","indigo","purple"]],"3x4":[["white","lime","green","blue"],["silver","yellow","fuchsia","navy"],["gray","red","purple","black"]]},_imagePaths:{"7x10":dojo.moduleUrl("dijit.themes","a11y/colors7x10.png"),"3x4":dojo.moduleUrl("dijit.themes","a11y/colors3x4.png")},_paletteCoords:{"leftOffset":3,"topOffset":3,"cWidth":20,"cHeight":20},templateString:"<div class=\"dijitInline dijitColorPalette\">\r\n\t<div class=\"dijitColorPaletteInner\" dojoAttachPoint=\"divNode\" waiRole=\"grid\" tabIndex=\"${tabIndex}\">\r\n\t\t<img class=\"dijitColorPaletteUnder\" dojoAttachPoint=\"imageNode\" waiRole=\"presentation\" alt=\"\">\r\n\t</div>\t\r\n</div>\r\n",_paletteDims:{"7x10":{"width":"206px","height":"145px"},"3x4":{"width":"86px","height":"64px"}},tabIndex:"0",postCreate:function(){
dojo.mixin(this.divNode.style,this._paletteDims[this.palette]);
this.imageNode.setAttribute("src",this._imagePaths[this.palette]);
var _df1=this._palettes[this.palette];
this.domNode.style.position="relative";
this._cellNodes=[];
this.colorNames=dojo.i18n.getLocalization("dojo","colors",this.lang);
var url=this._blankGif,_df3=new dojo.Color(),_df4=this._paletteCoords;
for(var row=0;row<_df1.length;row++){
for(var col=0;col<_df1[row].length;col++){
var _df7=dojo.doc.createElement("img");
_df7.src=url;
dojo.addClass(_df7,"dijitPaletteImg");
var _df8=_df1[row][col],_df9=_df3.setColor(dojo.Color.named[_df8]);
_df7.alt=this.colorNames[_df8];
_df7.color=_df9.toHex();
var _dfa=_df7.style;
_dfa.color=_dfa.backgroundColor=_df7.color;
var _dfb=dojo.doc.createElement("span");
_dfb.appendChild(_df7);
dojo.forEach(["Dijitclick","MouseEnter","Focus","Blur"],function(_dfc){
this.connect(_dfb,"on"+_dfc.toLowerCase(),"_onCell"+_dfc);
},this);
this.divNode.appendChild(_dfb);
var _dfd=_dfb.style;
_dfd.top=_df4.topOffset+(row*_df4.cHeight)+"px";
_dfd.left=_df4.leftOffset+(col*_df4.cWidth)+"px";
dojo.attr(_dfb,"tabindex","-1");
_dfb.title=this.colorNames[_df8];
dojo.addClass(_dfb,"dijitPaletteCell");
dijit.setWaiRole(_dfb,"gridcell");
_dfb.index=this._cellNodes.length;
this._cellNodes.push(_dfb);
}
}
this._xDim=_df1[0].length;
this._yDim=_df1.length;
this.connect(this.divNode,"onfocus","_onDivNodeFocus");
var _dfe={UP_ARROW:-this._xDim,DOWN_ARROW:this._xDim,RIGHT_ARROW:1,LEFT_ARROW:-1};
for(var key in _dfe){
this._connects.push(dijit.typematic.addKeyListener(this.domNode,{charOrCode:dojo.keys[key],ctrlKey:false,altKey:false,shiftKey:false},this,function(){
var _e00=_dfe[key];
return function(_e01){
this._navigateByKey(_e00,_e01);
};
}(),this.timeoutChangeRate,this.defaultTimeout));
}
},focus:function(){
this._focusFirst();
},onChange:function(_e02){
},_focusFirst:function(){
this._currentFocus=0;
var _e03=this._cellNodes[this._currentFocus];
window.setTimeout(function(){
dijit.focus(_e03);
},0);
},_onDivNodeFocus:function(evt){
if(evt.target===this.divNode){
this._focusFirst();
}
},_onFocus:function(){
dojo.attr(this.divNode,"tabindex","-1");
},_onBlur:function(){
this._removeCellHighlight(this._currentFocus);
dojo.attr(this.divNode,"tabindex",this.tabIndex);
},_onCellDijitclick:function(evt){
var _e06=evt.currentTarget;
if(this._currentFocus!=_e06.index){
this._currentFocus=_e06.index;
window.setTimeout(function(){
dijit.focus(_e06);
},0);
}
this._selectColor(_e06);
dojo.stopEvent(evt);
},_onCellMouseEnter:function(evt){
var _e08=evt.currentTarget;
this._setCurrent(_e08);
window.setTimeout(function(){
dijit.focus(_e08);
},0);
},_onCellFocus:function(evt){
this._setCurrent(evt.currentTarget);
},_setCurrent:function(node){
this._removeCellHighlight(this._currentFocus);
this._currentFocus=node.index;
dojo.addClass(node,"dijitPaletteCellHighlight");
},_onCellBlur:function(evt){
this._removeCellHighlight(this._currentFocus);
},_removeCellHighlight:function(_e0c){
dojo.removeClass(this._cellNodes[_e0c],"dijitPaletteCellHighlight");
},_selectColor:function(_e0d){
var img=_e0d.getElementsByTagName("img")[0];
this.onChange(this.value=img.color);
},_navigateByKey:function(_e0f,_e10){
if(_e10==-1){
return;
}
var _e11=this._currentFocus+_e0f;
if(_e11<this._cellNodes.length&&_e11>-1){
var _e12=this._cellNodes[_e11];
_e12.focus();
}
}});
}
if(!dojo._hasResource["dijit._editor.plugins.TextColor"]){
dojo._hasResource["dijit._editor.plugins.TextColor"]=true;
dojo.provide("dijit._editor.plugins.TextColor");
dojo.declare("dijit._editor.plugins.TextColor",dijit._editor._Plugin,{buttonClass:dijit.form.DropDownButton,constructor:function(){
this.dropDown=new dijit.ColorPalette();
this.connect(this.dropDown,"onChange",function(_e13){
this.editor.execCommand(this.command,_e13);
});
}});
dojo.subscribe(dijit._scopeName+".Editor.getPlugin",null,function(o){
if(o.plugin){
return;
}
switch(o.args.name){
case "foreColor":
case "hiliteColor":
o.plugin=new dijit._editor.plugins.TextColor({command:o.args.name});
}
});
}
if(!dojo._hasResource["dojo.number"]){
dojo._hasResource["dojo.number"]=true;
dojo.provide("dojo.number");
dojo.number.format=function(_e15,_e16){
_e16=dojo.mixin({},_e16||{});
var _e17=dojo.i18n.normalizeLocale(_e16.locale);
var _e18=dojo.i18n.getLocalization("dojo.cldr","number",_e17);
_e16.customs=_e18;
var _e19=_e16.pattern||_e18[(_e16.type||"decimal")+"Format"];
if(isNaN(_e15)){
return null;
}
return dojo.number._applyPattern(_e15,_e19,_e16);
};
dojo.number._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;
dojo.number._applyPattern=function(_e1a,_e1b,_e1c){
_e1c=_e1c||{};
var _e1d=_e1c.customs.group;
var _e1e=_e1c.customs.decimal;
var _e1f=_e1b.split(";");
var _e20=_e1f[0];
_e1b=_e1f[(_e1a<0)?1:0]||("-"+_e20);
if(_e1b.indexOf("%")!=-1){
_e1a*=100;
}else{
if(_e1b.indexOf("‰")!=-1){
_e1a*=1000;
}else{
if(_e1b.indexOf("¤")!=-1){
_e1d=_e1c.customs.currencyGroup||_e1d;
_e1e=_e1c.customs.currencyDecimal||_e1e;
_e1b=_e1b.replace(/\u00a4{1,3}/,function(_e21){
var prop=["symbol","currency","displayName"][_e21.length-1];
return _e1c[prop]||_e1c.currency||"";
});
}else{
if(_e1b.indexOf("E")!=-1){
throw new Error("exponential notation not supported");
}
}
}
}
var _e23=dojo.number._numberPatternRE;
var _e24=_e20.match(_e23);
if(!_e24){
throw new Error("unable to find a number expression in pattern: "+_e1b);
}
if(_e1c.fractional===false){
_e1c.places=0;
}
return _e1b.replace(_e23,dojo.number._formatAbsolute(_e1a,_e24[0],{decimal:_e1e,group:_e1d,places:_e1c.places,round:_e1c.round}));
};
dojo.number.round=function(_e25,_e26,_e27){
var _e28=String(_e25).split(".");
var _e29=(_e28[1]&&_e28[1].length)||0;
if(_e29>_e26){
var _e2a=Math.pow(10,_e26);
if(_e27>0){
_e2a*=10/_e27;
_e26++;
}
_e25=Math.round(_e25*_e2a)/_e2a;
_e28=String(_e25).split(".");
_e29=(_e28[1]&&_e28[1].length)||0;
if(_e29>_e26){
_e28[1]=_e28[1].substr(0,_e26);
_e25=Number(_e28.join("."));
}
}
return _e25;
};
dojo.number._formatAbsolute=function(_e2b,_e2c,_e2d){
_e2d=_e2d||{};
if(_e2d.places===true){
_e2d.places=0;
}
if(_e2d.places===Infinity){
_e2d.places=6;
}
var _e2e=_e2c.split(".");
var _e2f=(_e2d.places>=0)?_e2d.places:(_e2e[1]&&_e2e[1].length)||0;
if(!(_e2d.round<0)){
_e2b=dojo.number.round(_e2b,_e2f,_e2d.round);
}
var _e30=String(Math.abs(_e2b)).split(".");
var _e31=_e30[1]||"";
if(_e2d.places){
var _e32=dojo.isString(_e2d.places)&&_e2d.places.indexOf(",");
if(_e32){
_e2d.places=_e2d.places.substring(_e32+1);
}
_e30[1]=dojo.string.pad(_e31.substr(0,_e2d.places),_e2d.places,"0",true);
}else{
if(_e2e[1]&&_e2d.places!==0){
var pad=_e2e[1].lastIndexOf("0")+1;
if(pad>_e31.length){
_e30[1]=dojo.string.pad(_e31,pad,"0",true);
}
var _e34=_e2e[1].length;
if(_e34<_e31.length){
_e30[1]=_e31.substr(0,_e34);
}
}else{
if(_e30[1]){
_e30.pop();
}
}
}
var _e35=_e2e[0].replace(",","");
pad=_e35.indexOf("0");
if(pad!=-1){
pad=_e35.length-pad;
if(pad>_e30[0].length){
_e30[0]=dojo.string.pad(_e30[0],pad);
}
if(_e35.indexOf("#")==-1){
_e30[0]=_e30[0].substr(_e30[0].length-pad);
}
}
var _e36=_e2e[0].lastIndexOf(",");
var _e37,_e38;
if(_e36!=-1){
_e37=_e2e[0].length-_e36-1;
var _e39=_e2e[0].substr(0,_e36);
_e36=_e39.lastIndexOf(",");
if(_e36!=-1){
_e38=_e39.length-_e36-1;
}
}
var _e3a=[];
for(var _e3b=_e30[0];_e3b;){
var off=_e3b.length-_e37;
_e3a.push((off>0)?_e3b.substr(off):_e3b);
_e3b=(off>0)?_e3b.slice(0,off):"";
if(_e38){
_e37=_e38;
delete _e38;
}
}
_e30[0]=_e3a.reverse().join(_e2d.group||",");
return _e30.join(_e2d.decimal||".");
};
dojo.number.regexp=function(_e3d){
return dojo.number._parseInfo(_e3d).regexp;
};
dojo.number._parseInfo=function(_e3e){
_e3e=_e3e||{};
var _e3f=dojo.i18n.normalizeLocale(_e3e.locale);
var _e40=dojo.i18n.getLocalization("dojo.cldr","number",_e3f);
var _e41=_e3e.pattern||_e40[(_e3e.type||"decimal")+"Format"];
var _e42=_e40.group;
var _e43=_e40.decimal;
var _e44=1;
if(_e41.indexOf("%")!=-1){
_e44/=100;
}else{
if(_e41.indexOf("‰")!=-1){
_e44/=1000;
}else{
var _e45=_e41.indexOf("¤")!=-1;
if(_e45){
_e42=_e40.currencyGroup||_e42;
_e43=_e40.currencyDecimal||_e43;
}
}
}
var _e46=_e41.split(";");
if(_e46.length==1){
_e46.push("-"+_e46[0]);
}
var re=dojo.regexp.buildGroupRE(_e46,function(_e48){
_e48="(?:"+dojo.regexp.escapeString(_e48,".")+")";
return _e48.replace(dojo.number._numberPatternRE,function(_e49){
var _e4a={signed:false,separator:_e3e.strict?_e42:[_e42,""],fractional:_e3e.fractional,decimal:_e43,exponent:false};
var _e4b=_e49.split(".");
var _e4c=_e3e.places;
if(_e4b.length==1||_e4c===0){
_e4a.fractional=false;
}else{
if(_e4c===undefined){
_e4c=_e3e.pattern?_e4b[1].lastIndexOf("0")+1:Infinity;
}
if(_e4c&&_e3e.fractional==undefined){
_e4a.fractional=true;
}
if(!_e3e.places&&(_e4c<_e4b[1].length)){
_e4c+=","+_e4b[1].length;
}
_e4a.places=_e4c;
}
var _e4d=_e4b[0].split(",");
if(_e4d.length>1){
_e4a.groupSize=_e4d.pop().length;
if(_e4d.length>1){
_e4a.groupSize2=_e4d.pop().length;
}
}
return "("+dojo.number._realNumberRegexp(_e4a)+")";
});
},true);
if(_e45){
re=re.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/g,function(_e4e,_e4f,_e50,_e51){
var prop=["symbol","currency","displayName"][_e50.length-1];
var _e53=dojo.regexp.escapeString(_e3e[prop]||_e3e.currency||"");
_e4f=_e4f?"[\\s\\xa0]":"";
_e51=_e51?"[\\s\\xa0]":"";
if(!_e3e.strict){
if(_e4f){
_e4f+="*";
}
if(_e51){
_e51+="*";
}
return "(?:"+_e4f+_e53+_e51+")?";
}
return _e4f+_e53+_e51;
});
}
return {regexp:re.replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:_e42,decimal:_e43,factor:_e44};
};
dojo.number.parse=function(_e54,_e55){
var info=dojo.number._parseInfo(_e55);
var _e57=(new RegExp("^"+info.regexp+"$")).exec(_e54);
if(!_e57){
return NaN;
}
var _e58=_e57[1];
if(!_e57[1]){
if(!_e57[2]){
return NaN;
}
_e58=_e57[2];
info.factor*=-1;
}
_e58=_e58.replace(new RegExp("["+info.group+"\\s\\xa0"+"]","g"),"").replace(info.decimal,".");
return Number(_e58)*info.factor;
};
dojo.number._realNumberRegexp=function(_e59){
_e59=_e59||{};
if(!("places" in _e59)){
_e59.places=Infinity;
}
if(typeof _e59.decimal!="string"){
_e59.decimal=".";
}
if(!("fractional" in _e59)||/^0/.test(_e59.places)){
_e59.fractional=[true,false];
}
if(!("exponent" in _e59)){
_e59.exponent=[true,false];
}
if(!("eSigned" in _e59)){
_e59.eSigned=[true,false];
}
var _e5a=dojo.number._integerRegexp(_e59);
var _e5b=dojo.regexp.buildGroupRE(_e59.fractional,function(q){
var re="";
if(q&&(_e59.places!==0)){
re="\\"+_e59.decimal;
if(_e59.places==Infinity){
re="(?:"+re+"\\d+)?";
}else{
re+="\\d{"+_e59.places+"}";
}
}
return re;
},true);
var _e5e=dojo.regexp.buildGroupRE(_e59.exponent,function(q){
if(q){
return "([eE]"+dojo.number._integerRegexp({signed:_e59.eSigned})+")";
}
return "";
});
var _e60=_e5a+_e5b;
if(_e5b){
_e60="(?:(?:"+_e60+")|(?:"+_e5b+"))";
}
return _e60+_e5e;
};
dojo.number._integerRegexp=function(_e61){
_e61=_e61||{};
if(!("signed" in _e61)){
_e61.signed=[true,false];
}
if(!("separator" in _e61)){
_e61.separator="";
}else{
if(!("groupSize" in _e61)){
_e61.groupSize=3;
}
}
var _e62=dojo.regexp.buildGroupRE(_e61.signed,function(q){
return q?"[-+]":"";
},true);
var _e64=dojo.regexp.buildGroupRE(_e61.separator,function(sep){
if(!sep){
return "(?:0|[1-9]\\d*)";
}
sep=dojo.regexp.escapeString(sep);
if(sep==" "){
sep="\\s";
}else{
if(sep==" "){
sep="\\s\\xa0";
}
}
var grp=_e61.groupSize,grp2=_e61.groupSize2;
if(grp2){
var _e68="(?:0|[1-9]\\d{0,"+(grp2-1)+"}(?:["+sep+"]\\d{"+grp2+"})*["+sep+"]\\d{"+grp+"})";
return ((grp-grp2)>0)?"(?:"+_e68+"|(?:0|[1-9]\\d{0,"+(grp-1)+"}))":_e68;
}
return "(?:0|[1-9]\\d{0,"+(grp-1)+"}(?:["+sep+"]\\d{"+grp+"})*)";
},true);
return _e62+_e64;
};
}
if(!dojo._hasResource["dijit.form.Slider"]){
dojo._hasResource["dijit.form.Slider"]=true;
dojo.provide("dijit.form.Slider");
dojo.declare("dijit.form.HorizontalSlider",[dijit.form._FormValueWidget,dijit._Container],{templateString:"<table class=\"dijit dijitReset dijitSlider\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" rules=\"none\" dojoAttachEvent=\"onkeypress:_onKeyPress\"\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\r\n\t\t><td dojoAttachPoint=\"containerNode,topDecoration\" class=\"dijitReset\" style=\"text-align:center;width:100%;\"></td\r\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\"\r\n\t\t\t><div class=\"dijitSliderDecrementIconH\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"decrementButton\"><span class=\"dijitSliderButtonInner\">-</span></div\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"\r\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper dijitSliderLeftBumper\" dojoAttachEvent=\"onclick:_onClkDecBumper\"></div\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"\r\n\t\t\t><input dojoAttachPoint=\"valueNode\" type=\"hidden\" name=\"${name}\"\r\n\t\t\t/><div class=\"dijitReset dijitSliderBarContainerH\" waiRole=\"presentation\" dojoAttachPoint=\"sliderBarContainer\"\r\n\t\t\t\t><div waiRole=\"presentation\" dojoAttachPoint=\"progressBar\" class=\"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH\" dojoAttachEvent=\"onclick:_onBarClick\"\r\n\t\t\t\t\t><div class=\"dijitSliderMoveable dijitSliderMoveableH\" \r\n\t\t\t\t\t\t><div dojoAttachPoint=\"sliderHandle,focusNode\" class=\"dijitSliderImageHandle dijitSliderImageHandleH\" dojoAttachEvent=\"onmousedown:_onHandleClick\" waiRole=\"slider\" valuemin=\"${minimum}\" valuemax=\"${maximum}\"></div\r\n\t\t\t\t\t></div\r\n\t\t\t\t></div\r\n\t\t\t\t><div waiRole=\"presentation\" dojoAttachPoint=\"remainingBar\" class=\"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH\" dojoAttachEvent=\"onclick:_onBarClick\"></div\r\n\t\t\t></div\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"\r\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper dijitSliderRightBumper\" dojoAttachEvent=\"onclick:_onClkIncBumper\"></div\r\n\t\t></td\r\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\" style=\"right:0px;\"\r\n\t\t\t><div class=\"dijitSliderIncrementIconH\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"incrementButton\"><span class=\"dijitSliderButtonInner\">+</span></div\r\n\t\t></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\r\n\t\t><td dojoAttachPoint=\"containerNode,bottomDecoration\" class=\"dijitReset\" style=\"text-align:center;\"></td\r\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\r\n\t></tr\r\n></table>\r\n",value:0,showButtons:true,minimum:0,maximum:100,discreteValues:Infinity,pageIncrement:2,clickSelect:true,slideDuration:dijit.defaultDuration,widgetsInTemplate:true,attributeMap:dojo.mixin(dojo.clone(dijit.form._FormWidget.prototype.attributeMap),{id:"",name:"valueNode"}),baseClass:"dijitSlider",_mousePixelCoord:"pageX",_pixelCount:"w",_startingPixelCoord:"x",_startingPixelCount:"l",_handleOffsetCoord:"left",_progressPixelSize:"width",_onKeyPress:function(e){
if(this.disabled||this.readOnly||e.altKey||e.ctrlKey){
return;
}
switch(e.charOrCode){
case dojo.keys.HOME:
this._setValueAttr(this.minimum,true);
break;
case dojo.keys.END:
this._setValueAttr(this.maximum,true);
break;
case ((this._descending||this.isLeftToRight())?dojo.keys.RIGHT_ARROW:dojo.keys.LEFT_ARROW):
case (this._descending===false?dojo.keys.DOWN_ARROW:dojo.keys.UP_ARROW):
case (this._descending===false?dojo.keys.PAGE_DOWN:dojo.keys.PAGE_UP):
this.increment(e);
break;
case ((this._descending||this.isLeftToRight())?dojo.keys.LEFT_ARROW:dojo.keys.RIGHT_ARROW):
case (this._descending===false?dojo.keys.UP_ARROW:dojo.keys.DOWN_ARROW):
case (this._descending===false?dojo.keys.PAGE_UP:dojo.keys.PAGE_DOWN):
this.decrement(e);
break;
default:
this.inherited(arguments);
return;
}
dojo.stopEvent(e);
},_onHandleClick:function(e){
if(this.disabled||this.readOnly){
return;
}
if(!dojo.isIE){
dijit.focus(this.sliderHandle);
}
dojo.stopEvent(e);
},_isReversed:function(){
return !this.isLeftToRight();
},_onBarClick:function(e){
if(this.disabled||this.readOnly||!this.clickSelect){
return;
}
dijit.focus(this.sliderHandle);
dojo.stopEvent(e);
var _e6c=dojo.coords(this.sliderBarContainer,true);
var _e6d=e[this._mousePixelCoord]-_e6c[this._startingPixelCoord];
this._setPixelValue(this._isReversed()?(_e6c[this._pixelCount]-_e6d):_e6d,_e6c[this._pixelCount],true);
},_setPixelValue:function(_e6e,_e6f,_e70){
if(this.disabled||this.readOnly){
return;
}
_e6e=_e6e<0?0:_e6f<_e6e?_e6f:_e6e;
var _e71=this.discreteValues;
if(_e71<=1||_e71==Infinity){
_e71=_e6f;
}
_e71--;
var _e72=_e6f/_e71;
var _e73=Math.round(_e6e/_e72);
this._setValueAttr((this.maximum-this.minimum)*_e73/_e71+this.minimum,_e70);
},_setValueAttr:function(_e74,_e75){
this.valueNode.value=this.value=_e74;
dijit.setWaiState(this.focusNode,"valuenow",_e74);
this.inherited(arguments);
var _e76=(_e74-this.minimum)/(this.maximum-this.minimum);
var _e77=(this._descending===false)?this.remainingBar:this.progressBar;
var _e78=(this._descending===false)?this.progressBar:this.remainingBar;
if(this._inProgressAnim&&this._inProgressAnim.status!="stopped"){
this._inProgressAnim.stop(true);
}
if(_e75&&this.slideDuration>0&&_e77.style[this._progressPixelSize]){
var _e79=this;
var _e7a={};
var _e7b=parseFloat(_e77.style[this._progressPixelSize]);
var _e7c=this.slideDuration*(_e76-_e7b/100);
if(_e7c==0){
return;
}
if(_e7c<0){
_e7c=0-_e7c;
}
_e7a[this._progressPixelSize]={start:_e7b,end:_e76*100,units:"%"};
this._inProgressAnim=dojo.animateProperty({node:_e77,duration:_e7c,onAnimate:function(v){
_e78.style[_e79._progressPixelSize]=(100-parseFloat(v[_e79._progressPixelSize]))+"%";
},onEnd:function(){
delete _e79._inProgressAnim;
},properties:_e7a});
this._inProgressAnim.play();
}else{
_e77.style[this._progressPixelSize]=(_e76*100)+"%";
_e78.style[this._progressPixelSize]=((1-_e76)*100)+"%";
}
},_bumpValue:function(_e7e){
if(this.disabled||this.readOnly){
return;
}
var s=dojo.getComputedStyle(this.sliderBarContainer);
var c=dojo._getContentBox(this.sliderBarContainer,s);
var _e81=this.discreteValues;
if(_e81<=1||_e81==Infinity){
_e81=c[this._pixelCount];
}
_e81--;
var _e82=(this.value-this.minimum)*_e81/(this.maximum-this.minimum)+_e7e;
if(_e82<0){
_e82=0;
}
if(_e82>_e81){
_e82=_e81;
}
_e82=_e82*(this.maximum-this.minimum)/_e81+this.minimum;
this._setValueAttr(_e82,true);
},_onClkIncBumper:function(){
this._setValueAttr(this._descending===false?this.minimum:this.maximum,true);
},_onClkDecBumper:function(){
this._setValueAttr(this._descending===false?this.maximum:this.minimum,true);
},decrement:function(e){
this._bumpValue(e.charOrCode==dojo.keys.PAGE_DOWN?-this.pageIncrement:-1);
},increment:function(e){
this._bumpValue(e.charOrCode==dojo.keys.PAGE_UP?this.pageIncrement:1);
},_mouseWheeled:function(evt){
dojo.stopEvent(evt);
var _e86=!dojo.isMozilla;
var _e87=evt[(_e86?"wheelDelta":"detail")]*(_e86?1:-1);
this[(_e87<0?"decrement":"increment")](evt);
},startup:function(){
dojo.forEach(this.getChildren(),function(_e88){
if(this[_e88.container]!=this.containerNode){
this[_e88.container].appendChild(_e88.domNode);
}
},this);
},_typematicCallback:function(_e89,_e8a,e){
if(_e89==-1){
return;
}
this[(_e8a==(this._descending?this.incrementButton:this.decrementButton))?"decrement":"increment"](e);
},postCreate:function(){
if(this.showButtons){
this.incrementButton.style.display="";
this.decrementButton.style.display="";
this._connects.push(dijit.typematic.addMouseListener(this.decrementButton,this,"_typematicCallback",25,500));
this._connects.push(dijit.typematic.addMouseListener(this.incrementButton,this,"_typematicCallback",25,500));
}
this.connect(this.domNode,!dojo.isMozilla?"onmousewheel":"DOMMouseScroll","_mouseWheeled");
var _e8c=this;
var _e8d=function(){
dijit.form._SliderMover.apply(this,arguments);
this.widget=_e8c;
};
dojo.extend(_e8d,dijit.form._SliderMover.prototype);
this._movable=new dojo.dnd.Moveable(this.sliderHandle,{mover:_e8d});
var _e8e=dojo.query("label[for=\""+this.id+"\"]");
if(_e8e.length){
_e8e[0].id=(this.id+"_label");
dijit.setWaiState(this.focusNode,"labelledby",_e8e[0].id);
}
dijit.setWaiState(this.focusNode,"valuemin",this.minimum);
dijit.setWaiState(this.focusNode,"valuemax",this.maximum);
this.inherited(arguments);
},destroy:function(){
this._movable.destroy();
if(this._inProgressAnim&&this._inProgressAnim.status!="stopped"){
this._inProgressAnim.stop(true);
}
this.inherited(arguments);
}});
dojo.declare("dijit.form.VerticalSlider",dijit.form.HorizontalSlider,{templateString:"<table class=\"dijitReset dijitSlider\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" rules=\"none\" dojoAttachEvent=\"onkeypress:_onKeyPress\"\r\n><tbody class=\"dijitReset\"\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV\"\r\n\t\t\t><div class=\"dijitSliderIncrementIconV\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"decrementButton\"><span class=\"dijitSliderButtonInner\">+</span></div\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset\"\r\n\t\t\t><center><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderTopBumper dijitSliderTopBumper\" dojoAttachEvent=\"onclick:_onClkIncBumper\"></div></center\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td dojoAttachPoint=\"leftDecoration\" class=\"dijitReset\" style=\"text-align:center;height:100%;\"></td\r\n\t\t><td class=\"dijitReset\" style=\"height:100%;\"\r\n\t\t\t><input dojoAttachPoint=\"valueNode\" type=\"hidden\" name=\"${name}\"\r\n\t\t\t/><center class=\"dijitReset dijitSliderBarContainerV\" waiRole=\"presentation\" dojoAttachPoint=\"sliderBarContainer\"\r\n\t\t\t\t><div waiRole=\"presentation\" dojoAttachPoint=\"remainingBar\" class=\"dijitSliderBar dijitSliderBarV dijitSliderRemainingBar dijitSliderRemainingBarV\" dojoAttachEvent=\"onclick:_onBarClick\"><!--#5629--></div\r\n\t\t\t\t><div waiRole=\"presentation\" dojoAttachPoint=\"progressBar\" class=\"dijitSliderBar dijitSliderBarV dijitSliderProgressBar dijitSliderProgressBarV\" dojoAttachEvent=\"onclick:_onBarClick\"\r\n\t\t\t\t\t><div class=\"dijitSliderMoveable\" style=\"vertical-align:top;\" \r\n\t\t\t\t\t\t><div dojoAttachPoint=\"sliderHandle,focusNode\" class=\"dijitSliderImageHandle dijitSliderImageHandleV\" dojoAttachEvent=\"onmousedown:_onHandleClick\" waiRole=\"slider\" valuemin=\"${minimum}\" valuemax=\"${maximum}\"></div\r\n\t\t\t\t\t></div\r\n\t\t\t\t></div\r\n\t\t\t></center\r\n\t\t></td\r\n\t\t><td dojoAttachPoint=\"containerNode,rightDecoration\" class=\"dijitReset\" style=\"text-align:center;height:100%;\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset\"\r\n\t\t\t><center><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderBottomBumper dijitSliderBottomBumper\" dojoAttachEvent=\"onclick:_onClkDecBumper\"></div></center\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV\"\r\n\t\t\t><div class=\"dijitSliderDecrementIconV\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"incrementButton\"><span class=\"dijitSliderButtonInner\">-</span></div\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n></tbody></table>\r\n",_mousePixelCoord:"pageY",_pixelCount:"h",_startingPixelCoord:"y",_startingPixelCount:"t",_handleOffsetCoord:"top",_progressPixelSize:"height",_descending:true,startup:function(){
if(this._started){
return;
}
if(!this.isLeftToRight()&&dojo.isMoz){
if(this.leftDecoration){
this._rtlRectify(this.leftDecoration);
}
if(this.rightDecoration){
this._rtlRectify(this.rightDecoration);
}
}
this.inherited(arguments);
},_isReversed:function(){
return this._descending;
},_rtlRectify:function(_e8f){
var _e90=[];
while(_e8f.firstChild){
_e90.push(_e8f.firstChild);
_e8f.removeChild(_e8f.firstChild);
}
for(var i=_e90.length-1;i>=0;i--){
if(_e90[i]){
_e8f.appendChild(_e90[i]);
}
}
}});
dojo.declare("dijit.form._SliderMover",dojo.dnd.Mover,{onMouseMove:function(e){
var _e93=this.widget;
var _e94=_e93._abspos;
if(!_e94){
_e94=_e93._abspos=dojo.coords(_e93.sliderBarContainer,true);
_e93._setPixelValue_=dojo.hitch(_e93,"_setPixelValue");
_e93._isReversed_=_e93._isReversed();
}
var _e95=e[_e93._mousePixelCoord]-_e94[_e93._startingPixelCoord];
_e93._setPixelValue_(_e93._isReversed_?(_e94[_e93._pixelCount]-_e95):_e95,_e94[_e93._pixelCount],false);
},destroy:function(e){
dojo.dnd.Mover.prototype.destroy.apply(this,arguments);
var _e97=this.widget;
_e97._abspos=null;
_e97._setValueAttr(_e97.value,true);
}});
dojo.declare("dijit.form.HorizontalRule",[dijit._Widget,dijit._Templated],{templateString:"<div class=\"dijitRuleContainer dijitRuleContainerH\"></div>",count:3,container:"containerNode",ruleStyle:"",_positionPrefix:"<div class=\"dijitRuleMark dijitRuleMarkH\" style=\"left:",_positionSuffix:"%;",_suffix:"\"></div>",_genHTML:function(pos,ndx){
return this._positionPrefix+pos+this._positionSuffix+this.ruleStyle+this._suffix;
},_isHorizontal:true,postCreate:function(){
var _e9a;
if(this.count==1){
_e9a=this._genHTML(50,0);
}else{
var i;
var _e9c=100/(this.count-1);
if(!this._isHorizontal||this.isLeftToRight()){
_e9a=this._genHTML(0,0);
for(i=1;i<this.count-1;i++){
_e9a+=this._genHTML(_e9c*i,i);
}
_e9a+=this._genHTML(100,this.count-1);
}else{
_e9a=this._genHTML(100,0);
for(i=1;i<this.count-1;i++){
_e9a+=this._genHTML(100-_e9c*i,i);
}
_e9a+=this._genHTML(0,this.count-1);
}
}
this.domNode.innerHTML=_e9a;
}});
dojo.declare("dijit.form.VerticalRule",dijit.form.HorizontalRule,{templateString:"<div class=\"dijitRuleContainer dijitRuleContainerV\"></div>",_positionPrefix:"<div class=\"dijitRuleMark dijitRuleMarkV\" style=\"top:",_isHorizontal:false});
dojo.declare("dijit.form.HorizontalRuleLabels",dijit.form.HorizontalRule,{templateString:"<div class=\"dijitRuleContainer dijitRuleContainerH dijitRuleLabelsContainer dijitRuleLabelsContainerH\"></div>",labelStyle:"",labels:[],numericMargin:0,minimum:0,maximum:1,constraints:{pattern:"#%"},_positionPrefix:"<div class=\"dijitRuleLabelContainer dijitRuleLabelContainerH\" style=\"left:",_labelPrefix:"\"><span class=\"dijitRuleLabel dijitRuleLabelH\">",_suffix:"</span></div>",_calcPosition:function(pos){
return pos;
},_genHTML:function(pos,ndx){
return this._positionPrefix+this._calcPosition(pos)+this._positionSuffix+this.labelStyle+this._labelPrefix+this.labels[ndx]+this._suffix;
},getLabels:function(){
var _ea0=this.labels;
if(!_ea0.length){
_ea0=dojo.query("> li",this.srcNodeRef).map(function(node){
return String(node.innerHTML);
});
}
this.srcNodeRef.innerHTML="";
if(!_ea0.length&&this.count>1){
var _ea2=this.minimum;
var inc=(this.maximum-_ea2)/(this.count-1);
for(var i=0;i<this.count;i++){
_ea0.push((i<this.numericMargin||i>=(this.count-this.numericMargin))?"":dojo.number.format(_ea2,this.constraints));
_ea2+=inc;
}
}
return _ea0;
},postMixInProperties:function(){
this.inherited(arguments);
this.labels=this.getLabels();
this.count=this.labels.length;
}});
dojo.declare("dijit.form.VerticalRuleLabels",dijit.form.HorizontalRuleLabels,{templateString:"<div class=\"dijitRuleContainer dijitRuleContainerV dijitRuleLabelsContainer dijitRuleLabelsContainerV\"></div>",_positionPrefix:"<div class=\"dijitRuleLabelContainer dijitRuleLabelContainerV\" style=\"top:",_labelPrefix:"\"><span class=\"dijitRuleLabel dijitRuleLabelV\">",_calcPosition:function(pos){
return 100-pos;
},_isHorizontal:false});
}
if(!dojo._hasResource["dijit.Menu"]){
dojo._hasResource["dijit.Menu"]=true;
dojo.provide("dijit.Menu");
dojo.declare("dijit.Menu",[dijit._Widget,dijit._Templated,dijit._KeyNavContainer],{constructor:function(){
this._bindings=[];
},templateString:"<table class=\"dijit dijitMenu dijitReset dijitMenuTable\" waiRole=\"menu\" dojoAttachEvent=\"onkeypress:_onKeyPress\">"+"<tbody class=\"dijitReset\" dojoAttachPoint=\"containerNode\"></tbody>"+"</table>",targetNodeIds:[],contextMenuForWindow:false,leftClickToOpen:false,parentMenu:null,popupDelay:500,_contextMenuWithMouse:false,postCreate:function(){
if(this.contextMenuForWindow){
this.bindDomNode(dojo.body());
}else{
dojo.forEach(this.targetNodeIds,this.bindDomNode,this);
}
this.connectKeyNavHandlers([dojo.keys.UP_ARROW],[dojo.keys.DOWN_ARROW]);
},startup:function(){
if(this._started){
return;
}
dojo.forEach(this.getChildren(),function(_ea6){
_ea6.startup();
});
this.startupKeyNavChildren();
this.inherited(arguments);
},onExecute:function(){
},onCancel:function(_ea7){
},_moveToPopup:function(evt){
if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){
this.focusedChild._onClick(evt);
}
},_onKeyPress:function(evt){
if(evt.ctrlKey||evt.altKey){
return;
}
switch(evt.charOrCode){
case dojo.keys.RIGHT_ARROW:
this._moveToPopup(evt);
dojo.stopEvent(evt);
break;
case dojo.keys.LEFT_ARROW:
if(this.parentMenu){
this.onCancel(false);
}else{
dojo.stopEvent(evt);
}
break;
}
},onItemHover:function(item){
this.focusChild(item);
if(this.focusedChild.popup&&!this.focusedChild.disabled&&!this.hover_timer){
this.hover_timer=setTimeout(dojo.hitch(this,"_openPopup"),this.popupDelay);
}
},_onChildBlur:function(item){
dijit.popup.close(item.popup);
item._blur();
this._stopPopupTimer();
},onItemUnhover:function(item){
},_stopPopupTimer:function(){
if(this.hover_timer){
clearTimeout(this.hover_timer);
this.hover_timer=null;
}
},_getTopMenu:function(){
for(var top=this;top.parentMenu;top=top.parentMenu){
}
return top;
},onItemClick:function(item,evt){
if(item.disabled){
return false;
}
if(item.popup){
if(!this.is_open){
this._openPopup();
}
}else{
this.onExecute();
item.onClick(evt);
}
},_iframeContentWindow:function(_eb0){
var win=dijit.getDocumentWindow(dijit.Menu._iframeContentDocument(_eb0))||dijit.Menu._iframeContentDocument(_eb0)["__parent__"]||(_eb0.name&&dojo.doc.frames[_eb0.name])||null;
return win;
},_iframeContentDocument:function(_eb2){
var doc=_eb2.contentDocument||(_eb2.contentWindow&&_eb2.contentWindow.document)||(_eb2.name&&dojo.doc.frames[_eb2.name]&&dojo.doc.frames[_eb2.name].document)||null;
return doc;
},bindDomNode:function(node){
node=dojo.byId(node);
var win=dijit.getDocumentWindow(node.ownerDocument);
if(node.tagName.toLowerCase()=="iframe"){
win=this._iframeContentWindow(node);
node=dojo.withGlobal(win,dojo.body);
}
var cn=(node==dojo.body()?dojo.doc:node);
node[this.id]=this._bindings.push([dojo.connect(cn,(this.leftClickToOpen)?"onclick":"oncontextmenu",this,"_openMyself"),dojo.connect(cn,"onkeydown",this,"_contextKey"),dojo.connect(cn,"onmousedown",this,"_contextMouse")]);
},unBindDomNode:function(_eb7){
var node=dojo.byId(_eb7);
if(node){
var bid=node[this.id]-1,b=this._bindings[bid];
dojo.forEach(b,dojo.disconnect);
delete this._bindings[bid];
}
},_contextKey:function(e){
this._contextMenuWithMouse=false;
if(e.keyCode==dojo.keys.F10){
dojo.stopEvent(e);
if(e.shiftKey&&e.type=="keydown"){
var _e={target:e.target,pageX:e.pageX,pageY:e.pageY};
_e.preventDefault=_e.stopPropagation=function(){
};
window.setTimeout(dojo.hitch(this,function(){
this._openMyself(_e);
}),1);
}
}
},_contextMouse:function(e){
this._contextMenuWithMouse=true;
},_openMyself:function(e){
if(this.leftClickToOpen&&e.button>0){
return;
}
dojo.stopEvent(e);
var x,y;
if(dojo.isSafari||this._contextMenuWithMouse){
x=e.pageX;
y=e.pageY;
}else{
var _ec1=dojo.coords(e.target,true);
x=_ec1.x+10;
y=_ec1.y+10;
}
var self=this;
var _ec3=dijit.getFocus(this);
function closeAndRestoreFocus(){
dijit.focus(_ec3);
dijit.popup.close(self);
};
dijit.popup.open({popup:this,x:x,y:y,onExecute:closeAndRestoreFocus,onCancel:closeAndRestoreFocus,orient:this.isLeftToRight()?"L":"R"});
this.focus();
this._onBlur=function(){
this.inherited("_onBlur",arguments);
dijit.popup.close(this);
};
},onOpen:function(e){
this.isShowingNow=true;
},onClose:function(){
this._stopPopupTimer();
this.parentMenu=null;
this.isShowingNow=false;
this.currentPopup=null;
if(this.focusedChild){
this._onChildBlur(this.focusedChild);
this.focusedChild=null;
}
},_openPopup:function(){
this._stopPopupTimer();
var _ec5=this.focusedChild;
var _ec6=_ec5.popup;
if(_ec6.isShowingNow){
return;
}
_ec6.parentMenu=this;
var self=this;
dijit.popup.open({parent:this,popup:_ec6,around:_ec5.domNode,orient:this.isLeftToRight()?{"TR":"TL","TL":"TR"}:{"TL":"TR","TR":"TL"},onCancel:function(){
dijit.popup.close(_ec6);
_ec5.focus();
self.currentPopup=null;
}});
this.currentPopup=_ec6;
if(_ec6.focus){
_ec6.focus();
}
},uninitialize:function(){
dojo.forEach(this.targetNodeIds,this.unBindDomNode,this);
this.inherited(arguments);
}});
dojo.declare("dijit.MenuItem",[dijit._Widget,dijit._Templated,dijit._Contained],{templateString:"<tr class=\"dijitReset dijitMenuItem\" dojoAttachPoint=\"focusNode\" waiRole=\"menuitem\" tabIndex=\"-1\""+"dojoAttachEvent=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">"+"<td class=\"dijitReset\" waiRole=\"presentation\"><div class=\"dijitMenuItemIcon\" dojoAttachPoint=\"iconNode\"></div></td>"+"<td class=\"dijitReset dijitMenuItemLabel\" dojoAttachPoint=\"containerNode\"></td>"+"<td class=\"dijitReset dijitMenuArrowCell\" waiRole=\"presentation\">"+"<div dojoAttachPoint=\"arrowWrapper\" style=\"display: none\">"+"<div class=\"dijitMenuExpand\"></div>"+"<span class=\"dijitMenuExpandA11y\">+</span>"+"</div>"+"</td>"+"</tr>",attributeMap:dojo.mixin(dojo.clone(dijit._Widget.prototype.attributeMap),{label:{node:"containerNode",type:"innerHTML"},iconClass:{node:"iconNode",type:"class"}}),label:"",iconClass:"",disabled:false,_fillContent:function(_ec8){
if(_ec8&&!("label" in this.params)){
this.attr("label",_ec8.innerHTML);
}
},postCreate:function(){
dojo.setSelectable(this.domNode,false);
dojo.attr(this.containerNode,"id",this.id+"_text");
dijit.setWaiState(this.domNode,"labelledby",this.id+"_text");
},_onHover:function(){
this.getParent().onItemHover(this);
},_onUnhover:function(){
this.getParent().onItemUnhover(this);
},_onClick:function(evt){
this.getParent().onItemClick(this,evt);
dojo.stopEvent(evt);
},onClick:function(evt){
},focus:function(){
dojo.addClass(this.domNode,"dijitMenuItemHover");
try{
dijit.focus(this.focusNode);
}
catch(e){
}
},_blur:function(){
dojo.removeClass(this.domNode,"dijitMenuItemHover");
},setLabel:function(_ecb){
dojo.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use attr('label', ...) instead.","","2.0");
this.attr("label",_ecb);
},setDisabled:function(_ecc){
dojo.deprecated("dijit.Menu.setDisabled() is deprecated.  Use attr('disabled', bool) instead.","","2.0");
this.attr("disabled",_ecc);
},_setDisabledAttr:function(_ecd){
this.disabled=_ecd;
dojo[_ecd?"addClass":"removeClass"](this.domNode,"dijitMenuItemDisabled");
dijit.setWaiState(this.focusNode,"disabled",_ecd?"true":"false");
}});
dojo.declare("dijit.PopupMenuItem",dijit.MenuItem,{_fillContent:function(){
if(this.srcNodeRef){
var _ece=dojo.query("*",this.srcNodeRef);
dijit.PopupMenuItem.superclass._fillContent.call(this,_ece[0]);
this.dropDownContainer=this.srcNodeRef;
}
},startup:function(){
if(this._started){
return;
}
this.inherited(arguments);
if(!this.popup){
var node=dojo.query("[widgetId]",this.dropDownContainer)[0];
this.popup=dijit.byNode(node);
}
dojo.body().appendChild(this.popup.domNode);
this.popup.domNode.style.display="none";
dojo.style(this.arrowWrapper,"display","");
dijit.setWaiState(this.focusNode,"haspopup","true");
},destroyDescendants:function(){
if(this.popup){
this.popup.destroyRecursive();
delete this.popup;
}
this.inherited(arguments);
}});
dojo.declare("dijit.MenuSeparator",[dijit._Widget,dijit._Templated,dijit._Contained],{templateString:"<tr class=\"dijitMenuSeparator\"><td colspan=3>"+"<div class=\"dijitMenuSeparatorTop\"></div>"+"<div class=\"dijitMenuSeparatorBottom\"></div>"+"</td></tr>",postCreate:function(){
dojo.setSelectable(this.domNode,false);
},isFocusable:function(){
return false;
}});
dojo.declare("dijit.CheckedMenuItem",dijit.MenuItem,{templateString:"<tr class=\"dijitReset dijitMenuItem\" dojoAttachPoint=\"focusNode\" waiRole=\"menuitemcheckbox\" tabIndex=\"-1\""+"dojoAttachEvent=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">"+"<td class=\"dijitReset\" waiRole=\"presentation\"><div class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" dojoAttachPoint=\"iconNode\">"+"<div class=\"dijitCheckedMenuItemIconChar\">&#10003;</div>"+"</div></td>"+"<td class=\"dijitReset dijitMenuItemLabel\" dojoAttachPoint=\"containerNode,labelNode\"></td>"+"<td class=\"dijitReset dijitMenuArrowCell\" waiRole=\"presentation\">"+"<div dojoAttachPoint=\"arrowWrapper\" style=\"display: none\">"+"<div class=\"dijitMenuExpand\"></div>"+"<span class=\"dijitMenuExpandA11y\">+</span>"+"</div>"+"</td>"+"</tr>",checked:false,_setCheckedAttr:function(_ed0){
dojo.toggleClass(this.iconNode,"dijitCheckedMenuItemIconChecked",_ed0);
dijit.setWaiState(this.domNode,"checked",_ed0);
this.checked=_ed0;
},onChange:function(_ed1){
},_onClick:function(e){
if(!this.disabled){
this.attr("checked",!this.checked);
this.onChange(this.checked);
}
this.inherited(arguments);
}});
}
if(!dojo._hasResource["dojo.dnd.Container"]){
dojo._hasResource["dojo.dnd.Container"]=true;
dojo.provide("dojo.dnd.Container");
dojo.declare("dojo.dnd.Container",null,{skipForm:false,constructor:function(node,_ed4){
this.node=dojo.byId(node);
if(!_ed4){
_ed4={};
}
this.creator=_ed4.creator||null;
this.skipForm=_ed4.skipForm;
this.parent=_ed4.dropParent&&dojo.byId(_ed4.dropParent);
this.map={};
this.current=null;
this.containerState="";
dojo.addClass(this.node,"dojoDndContainer");
if(!(_ed4&&_ed4._skipStartup)){
this.startup();
}
this.events=[dojo.connect(this.node,"onmouseover",this,"onMouseOver"),dojo.connect(this.node,"onmouseout",this,"onMouseOut"),dojo.connect(this.node,"ondragstart",this,"onSelectStart"),dojo.connect(this.node,"onselectstart",this,"onSelectStart")];
},creator:function(){
},getItem:function(key){
return this.map[key];
},setItem:function(key,data){
this.map[key]=data;
},delItem:function(key){
delete this.map[key];
},forInItems:function(f,o){
o=o||dojo.global;
var m=this.map,e=dojo.dnd._empty;
for(var i in m){
if(i in e){
continue;
}
f.call(o,m[i],i,this);
}
return o;
},clearItems:function(){
this.map={};
},getAllNodes:function(){
return dojo.query("> .dojoDndItem",this.parent);
},sync:function(){
var map={};
this.getAllNodes().forEach(function(node){
if(node.id){
var item=this.getItem(node.id);
if(item){
map[node.id]=item;
return;
}
}else{
node.id=dojo.dnd.getUniqueId();
}
var type=node.getAttribute("dndType"),data=node.getAttribute("dndData");
map[node.id]={data:data||node.innerHTML,type:type?type.split(/\s*,\s*/):["text"]};
},this);
this.map=map;
return this;
},insertNodes:function(data,_ee4,_ee5){
if(!this.parent.firstChild){
_ee5=null;
}else{
if(_ee4){
if(!_ee5){
_ee5=this.parent.firstChild;
}
}else{
if(_ee5){
_ee5=_ee5.nextSibling;
}
}
}
if(_ee5){
for(var i=0;i<data.length;++i){
var t=this._normalizedCreator(data[i]);
this.setItem(t.node.id,{data:t.data,type:t.type});
this.parent.insertBefore(t.node,_ee5);
}
}else{
for(var i=0;i<data.length;++i){
var t=this._normalizedCreator(data[i]);
this.setItem(t.node.id,{data:t.data,type:t.type});
this.parent.appendChild(t.node);
}
}
return this;
},destroy:function(){
dojo.forEach(this.events,dojo.disconnect);
this.clearItems();
this.node=this.parent=this.current=null;
},markupFactory:function(_ee8,node){
_ee8._skipStartup=true;
return new dojo.dnd.Container(node,_ee8);
},startup:function(){
if(!this.parent){
this.parent=this.node;
if(this.parent.tagName.toLowerCase()=="table"){
var c=this.parent.getElementsByTagName("tbody");
if(c&&c.length){
this.parent=c[0];
}
}
}
this.defaultCreator=dojo.dnd._defaultCreator(this.parent);
this.sync();
},onMouseOver:function(e){
var n=e.relatedTarget;
while(n){
if(n==this.node){
break;
}
try{
n=n.parentNode;
}
catch(x){
n=null;
}
}
if(!n){
this._changeState("Container","Over");
this.onOverEvent();
}
n=this._getChildByEvent(e);
if(this.current==n){
return;
}
if(this.current){
this._removeItemClass(this.current,"Over");
}
if(n){
this._addItemClass(n,"Over");
}
this.current=n;
},onMouseOut:function(e){
for(var n=e.relatedTarget;n;){
if(n==this.node){
return;
}
try{
n=n.parentNode;
}
catch(x){
n=null;
}
}
if(this.current){
this._removeItemClass(this.current,"Over");
this.current=null;
}
this._changeState("Container","");
this.onOutEvent();
},onSelectStart:function(e){
if(!this.skipForm||!dojo.dnd.isFormElement(e)){
dojo.stopEvent(e);
}
},onOverEvent:function(){
},onOutEvent:function(){
},_changeState:function(type,_ef1){
var _ef2="dojoDnd"+type;
var _ef3=type.toLowerCase()+"State";
dojo.removeClass(this.node,_ef2+this[_ef3]);
dojo.addClass(this.node,_ef2+_ef1);
this[_ef3]=_ef1;
},_addItemClass:function(node,type){
dojo.addClass(node,"dojoDndItem"+type);
},_removeItemClass:function(node,type){
dojo.removeClass(node,"dojoDndItem"+type);
},_getChildByEvent:function(e){
var node=e.target;
if(node){
for(var _efa=node.parentNode;_efa;node=_efa,_efa=node.parentNode){
if(_efa==this.parent&&dojo.hasClass(node,"dojoDndItem")){
return node;
}
}
}
return null;
},_normalizedCreator:function(item,hint){
var t=(this.creator||this.defaultCreator).call(this,item,hint);
if(!dojo.isArray(t.type)){
t.type=["text"];
}
if(!t.node.id){
t.node.id=dojo.dnd.getUniqueId();
}
dojo.addClass(t.node,"dojoDndItem");
return t;
}});
dojo.dnd._createNode=function(tag){
if(!tag){
return dojo.dnd._createSpan;
}
return function(text){
var n=dojo.doc.createElement(tag);
n.innerHTML=text;
return n;
};
};
dojo.dnd._createTrTd=function(text){
var tr=dojo.doc.createElement("tr");
var td=dojo.doc.createElement("td");
td.innerHTML=text;
tr.appendChild(td);
return tr;
};
dojo.dnd._createSpan=function(text){
var n=dojo.doc.createElement("span");
n.innerHTML=text;
return n;
};
dojo.dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};
dojo.dnd._defaultCreator=function(node){
var tag=node.tagName.toLowerCase();
var c=tag=="tbody"||tag=="thead"?dojo.dnd._createTrTd:dojo.dnd._createNode(dojo.dnd._defaultCreatorNodes[tag]);
return function(item,hint){
var _f0b=item&&dojo.isObject(item),data,type,n;
if(_f0b&&item.tagName&&item.nodeType&&item.getAttribute){
data=item.getAttribute("dndData")||item.innerHTML;
type=item.getAttribute("dndType");
type=type?type.split(/\s*,\s*/):["text"];
n=item;
}else{
data=(_f0b&&item.data)?item.data:item;
type=(_f0b&&item.type)?item.type:["text"];
n=(hint=="avatar"?dojo.dnd._createSpan:c)(String(data));
}
n.id=dojo.dnd.getUniqueId();
return {node:n,data:data,type:type};
};
};
}
if(!dojo._hasResource["dojo.dnd.Selector"]){
dojo._hasResource["dojo.dnd.Selector"]=true;
dojo.provide("dojo.dnd.Selector");
dojo.declare("dojo.dnd.Selector",dojo.dnd.Container,{constructor:function(node,_f10){
if(!_f10){
_f10={};
}
this.singular=_f10.singular;
this.autoSync=_f10.autoSync;
this.selection={};
this.anchor=null;
this.simpleSelection=false;
this.events.push(dojo.connect(this.node,"onmousedown",this,"onMouseDown"),dojo.connect(this.node,"onmouseup",this,"onMouseUp"));
},singular:false,getSelectedNodes:function(){
var t=new dojo.NodeList();
var e=dojo.dnd._empty;
for(var i in this.selection){
if(i in e){
continue;
}
t.push(dojo.byId(i));
}
return t;
},selectNone:function(){
return this._removeSelection()._removeAnchor();
},selectAll:function(){
this.forInItems(function(data,id){
this._addItemClass(dojo.byId(id),"Selected");
this.selection[id]=1;
},this);
return this._removeAnchor();
},deleteSelectedNodes:function(){
var e=dojo.dnd._empty;
for(var i in this.selection){
if(i in e){
continue;
}
var n=dojo.byId(i);
this.delItem(i);
dojo._destroyElement(n);
}
this.anchor=null;
this.selection={};
return this;
},forInSelectedItems:function(f,o){
o=o||dojo.global;
var s=this.selection,e=dojo.dnd._empty;
for(var i in s){
if(i in e){
continue;
}
f.call(o,this.getItem(i),i,this);
}
},sync:function(){
dojo.dnd.Selector.superclass.sync.call(this);
if(this.anchor){
if(!this.getItem(this.anchor.id)){
this.anchor=null;
}
}
var t=[],e=dojo.dnd._empty;
for(var i in this.selection){
if(i in e){
continue;
}
if(!this.getItem(i)){
t.push(i);
}
}
dojo.forEach(t,function(i){
delete this.selection[i];
},this);
return this;
},insertNodes:function(_f22,data,_f24,_f25){
var _f26=this._normalizedCreator;
this._normalizedCreator=function(item,hint){
var t=_f26.call(this,item,hint);
if(_f22){
if(!this.anchor){
this.anchor=t.node;
this._removeItemClass(t.node,"Selected");
this._addItemClass(this.anchor,"Anchor");
}else{
if(this.anchor!=t.node){
this._removeItemClass(t.node,"Anchor");
this._addItemClass(t.node,"Selected");
}
}
this.selection[t.node.id]=1;
}else{
this._removeItemClass(t.node,"Selected");
this._removeItemClass(t.node,"Anchor");
}
return t;
};
dojo.dnd.Selector.superclass.insertNodes.call(this,data,_f24,_f25);
this._normalizedCreator=_f26;
return this;
},destroy:function(){
dojo.dnd.Selector.superclass.destroy.call(this);
this.selection=this.anchor=null;
},markupFactory:function(_f2a,node){
_f2a._skipStartup=true;
return new dojo.dnd.Selector(node,_f2a);
},onMouseDown:function(e){
if(this.autoSync){
this.sync();
}
if(!this.current){
return;
}
if(!this.singular&&!dojo.dnd.getCopyKeyState(e)&&!e.shiftKey&&(this.current.id in this.selection)){
this.simpleSelection=true;
dojo.stopEvent(e);
return;
}
if(!this.singular&&e.shiftKey){
if(!dojo.dnd.getCopyKeyState(e)){
this._removeSelection();
}
var c=this.getAllNodes();
if(c.length){
if(!this.anchor){
this.anchor=c[0];
this._addItemClass(this.anchor,"Anchor");
}
this.selection[this.anchor.id]=1;
if(this.anchor!=this.current){
var i=0;
for(;i<c.length;++i){
var node=c[i];
if(node==this.anchor||node==this.current){
break;
}
}
for(++i;i<c.length;++i){
var node=c[i];
if(node==this.anchor||node==this.current){
break;
}
this._addItemClass(node,"Selected");
this.selection[node.id]=1;
}
this._addItemClass(this.current,"Selected");
this.selection[this.current.id]=1;
}
}
}else{
if(this.singular){
if(this.anchor==this.current){
if(dojo.dnd.getCopyKeyState(e)){
this.selectNone();
}
}else{
this.selectNone();
this.anchor=this.current;
this._addItemClass(this.anchor,"Anchor");
this.selection[this.current.id]=1;
}
}else{
if(dojo.dnd.getCopyKeyState(e)){
if(this.anchor==this.current){
delete this.selection[this.anchor.id];
this._removeAnchor();
}else{
if(this.current.id in this.selection){
this._removeItemClass(this.current,"Selected");
delete this.selection[this.current.id];
}else{
if(this.anchor){
this._removeItemClass(this.anchor,"Anchor");
this._addItemClass(this.anchor,"Selected");
}
this.anchor=this.current;
this._addItemClass(this.current,"Anchor");
this.selection[this.current.id]=1;
}
}
}else{
if(!(this.current.id in this.selection)){
this.selectNone();
this.anchor=this.current;
this._addItemClass(this.current,"Anchor");
this.selection[this.current.id]=1;
}
}
}
}
dojo.stopEvent(e);
},onMouseUp:function(e){
if(!this.simpleSelection){
return;
}
this.simpleSelection=false;
this.selectNone();
if(this.current){
this.anchor=this.current;
this._addItemClass(this.anchor,"Anchor");
this.selection[this.current.id]=1;
}
},onMouseMove:function(e){
this.simpleSelection=false;
},onOverEvent:function(){
this.onmousemoveEvent=dojo.connect(this.node,"onmousemove",this,"onMouseMove");
},onOutEvent:function(){
dojo.disconnect(this.onmousemoveEvent);
delete this.onmousemoveEvent;
},_removeSelection:function(){
var e=dojo.dnd._empty;
for(var i in this.selection){
if(i in e){
continue;
}
var node=dojo.byId(i);
if(node){
this._removeItemClass(node,"Selected");
}
}
this.selection={};
return this;
},_removeAnchor:function(){
if(this.anchor){
this._removeItemClass(this.anchor,"Anchor");
this.anchor=null;
}
return this;
}});
}
if(!dojo._hasResource["dojo.dnd.Avatar"]){
dojo._hasResource["dojo.dnd.Avatar"]=true;
dojo.provide("dojo.dnd.Avatar");
dojo.declare("dojo.dnd.Avatar",null,{constructor:function(_f35){
this.manager=_f35;
this.construct();
},construct:function(){
this.isA11y=dojo.hasClass(dojo.body(),"dijit_a11y");
var _f36=this.manager.source,node;
var a=dojo.doc.createElement("table");
a.className="dojoDndAvatar";
a.style.position="absolute";
a.style.zIndex=1999;
a.style.margin="0px";
var b=dojo.doc.createElement("tbody");
var tr=dojo.doc.createElement("tr");
tr.className="dojoDndAvatarHeader";
var td=dojo.doc.createElement("td");
if(this.isA11y){
var span=dojo.doc.createElement("span");
span.id="a11yIcon";
innerHTML:
this.manager.copy?"+":"<";
td.appendChild(span);
}
var _f3d=dojo.doc.createElement("span");
_f3d.innerHTML=_f36.generateText?this._generateText():"";
td.appendChild(_f3d);
tr.appendChild(td);
dojo.style(tr,"opacity",0.9);
b.appendChild(tr);
var k=Math.min(5,this.manager.nodes.length);
for(var i=0;i<k;++i){
tr=dojo.doc.createElement("tr");
tr.className="dojoDndAvatarItem";
td=dojo.doc.createElement("td");
if(_f36.creator){
node=_f36._normalizedCreator(_f36.getItem(this.manager.nodes[i].id).data,"avatar").node;
}else{
node=this.manager.nodes[i].cloneNode(true);
if(node.tagName.toLowerCase()=="tr"){
var _f40=dojo.doc.createElement("table"),_f41=dojo.doc.createElement("tbody");
_f41.appendChild(node);
_f40.appendChild(_f41);
node=_f40;
}
}
node.id="";
td.appendChild(node);
tr.appendChild(td);
dojo.style(tr,"opacity",(9-i)/10);
b.appendChild(tr);
}
a.appendChild(b);
this.node=a;
},destroy:function(){
dojo._destroyElement(this.node);
this.node=false;
},update:function(){
dojo[(this.manager.canDropFlag?"add":"remove")+"Class"](this.node,"dojoDndAvatarCanDrop");
if(this.isA11y){
var icon=dojo.byId("a11yIcon");
var text="+";
if(this.manager.canDropFlag&&!this.manager.copy){
text="< ";
}else{
if(!this.manager.canDropFlag&&!this.manager.copy){
text="o";
}else{
if(!this.manager.canDropFlag){
text="x";
}
}
}
icon.innerHTML=text;
}
dojo.query(("tr.dojoDndAvatarHeader td span"+(this.isA11y?" span":"")),this.node).forEach(function(node){
node.innerHTML=this._generateText();
},this);
},_generateText:function(){
return this.manager.nodes.length.toString();
}});
}
if(!dojo._hasResource["dojo.dnd.Manager"]){
dojo._hasResource["dojo.dnd.Manager"]=true;
dojo.provide("dojo.dnd.Manager");
dojo.declare("dojo.dnd.Manager",null,{constructor:function(){
this.avatar=null;
this.source=null;
this.nodes=[];
this.copy=true;
this.target=null;
this.canDropFlag=false;
this.events=[];
},OFFSET_X:16,OFFSET_Y:16,overSource:function(_f45){
if(this.avatar){
this.target=(_f45&&_f45.targetState!="Disabled")?_f45:null;
this.canDropFlag=Boolean(this.target);
this.avatar.update();
}
dojo.publish("/dnd/source/over",[_f45]);
},outSource:function(_f46){
if(this.avatar){
if(this.target==_f46){
this.target=null;
this.canDropFlag=false;
this.avatar.update();
dojo.publish("/dnd/source/over",[null]);
}
}else{
dojo.publish("/dnd/source/over",[null]);
}
},startDrag:function(_f47,_f48,copy){
this.source=_f47;
this.nodes=_f48;
this.copy=Boolean(copy);
this.avatar=this.makeAvatar();
dojo.body().appendChild(this.avatar.node);
dojo.publish("/dnd/start",[_f47,_f48,this.copy]);
this.events=[dojo.connect(dojo.doc,"onmousemove",this,"onMouseMove"),dojo.connect(dojo.doc,"onmouseup",this,"onMouseUp"),dojo.connect(dojo.doc,"onkeydown",this,"onKeyDown"),dojo.connect(dojo.doc,"onkeyup",this,"onKeyUp"),dojo.connect(dojo.doc,"ondragstart",dojo.stopEvent),dojo.connect(dojo.body(),"onselectstart",dojo.stopEvent)];
var c="dojoDnd"+(copy?"Copy":"Move");
dojo.addClass(dojo.body(),c);
},canDrop:function(flag){
var _f4c=Boolean(this.target&&flag);
if(this.canDropFlag!=_f4c){
this.canDropFlag=_f4c;
this.avatar.update();
}
},stopDrag:function(){
dojo.removeClass(dojo.body(),"dojoDndCopy");
dojo.removeClass(dojo.body(),"dojoDndMove");
dojo.forEach(this.events,dojo.disconnect);
this.events=[];
this.avatar.destroy();
this.avatar=null;
this.source=this.target=null;
this.nodes=[];
},makeAvatar:function(){
return new dojo.dnd.Avatar(this);
},updateAvatar:function(){
this.avatar.update();
},onMouseMove:function(e){
var a=this.avatar;
if(a){
dojo.dnd.autoScrollNodes(e);
var s=a.node.style;
s.left=(e.pageX+this.OFFSET_X)+"px";
s.top=(e.pageY+this.OFFSET_Y)+"px";
var copy=Boolean(this.source.copyState(dojo.dnd.getCopyKeyState(e)));
if(this.copy!=copy){
this._setCopyStatus(copy);
}
}
},onMouseUp:function(e){
if(this.avatar&&(!("mouseButton" in this.source)||(dojo.isSafari&&dojo.dnd._isMac&&this.source.mouseButton==2?e.button==0:this.source.mouseButton==e.button))){
if(this.target&&this.canDropFlag){
var copy=Boolean(this.source.copyState(dojo.dnd.getCopyKeyState(e))),_f53=[this.source,this.nodes,copy,this.target];
dojo.publish("/dnd/drop/before",_f53);
dojo.publish("/dnd/drop",_f53);
}else{
dojo.publish("/dnd/cancel");
}
this.stopDrag();
}
},onKeyDown:function(e){
if(this.avatar){
switch(e.keyCode){
case dojo.keys.CTRL:
var copy=Boolean(this.source.copyState(true));
if(this.copy!=copy){
this._setCopyStatus(copy);
}
break;
case dojo.keys.ESCAPE:
dojo.publish("/dnd/cancel");
this.stopDrag();
break;
}
}
},onKeyUp:function(e){
if(this.avatar&&e.keyCode==dojo.keys.CTRL){
var copy=Boolean(this.source.copyState(false));
if(this.copy!=copy){
this._setCopyStatus(copy);
}
}
},_setCopyStatus:function(copy){
this.copy=copy;
this.source._markDndStatus(this.copy);
this.updateAvatar();
dojo.removeClass(dojo.body(),"dojoDnd"+(this.copy?"Move":"Copy"));
dojo.addClass(dojo.body(),"dojoDnd"+(this.copy?"Copy":"Move"));
}});
dojo.dnd._manager=null;
dojo.dnd.manager=function(){
if(!dojo.dnd._manager){
dojo.dnd._manager=new dojo.dnd.Manager();
}
return dojo.dnd._manager;
};
}
if(!dojo._hasResource["dojo.dnd.Source"]){
dojo._hasResource["dojo.dnd.Source"]=true;
dojo.provide("dojo.dnd.Source");
dojo.declare("dojo.dnd.Source",dojo.dnd.Selector,{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],generateText:true,constructor:function(node,_f5a){
dojo.mixin(this,dojo.mixin({},_f5a));
var type=this.accept;
if(type.length){
this.accept={};
for(var i=0;i<type.length;++i){
this.accept[type[i]]=1;
}
}
this.isDragging=false;
this.mouseDown=false;
this.targetAnchor=null;
this.targetBox=null;
this.before=true;
this._lastX=0;
this._lastY=0;
this.sourceState="";
if(this.isSource){
dojo.addClass(this.node,"dojoDndSource");
}
this.targetState="";
if(this.accept){
dojo.addClass(this.node,"dojoDndTarget");
}
if(this.horizontal){
dojo.addClass(this.node,"dojoDndHorizontal");
}
this.topics=[dojo.subscribe("/dnd/source/over",this,"onDndSourceOver"),dojo.subscribe("/dnd/start",this,"onDndStart"),dojo.subscribe("/dnd/drop",this,"onDndDrop"),dojo.subscribe("/dnd/cancel",this,"onDndCancel")];
},checkAcceptance:function(_f5d,_f5e){
if(this==_f5d){
return !this.copyOnly||this.selfAccept;
}
for(var i=0;i<_f5e.length;++i){
var type=_f5d.getItem(_f5e[i].id).type;
var flag=false;
for(var j=0;j<type.length;++j){
if(type[j] in this.accept){
flag=true;
break;
}
}
if(!flag){
return false;
}
}
return true;
},copyState:function(_f63,self){
if(_f63){
return true;
}
if(arguments.length<2){
self=this==dojo.dnd.manager().target;
}
if(self){
if(this.copyOnly){
return this.selfCopy;
}
}else{
return this.copyOnly;
}
return false;
},destroy:function(){
dojo.dnd.Source.superclass.destroy.call(this);
dojo.forEach(this.topics,dojo.unsubscribe);
this.targetAnchor=null;
},markupFactory:function(_f65,node){
_f65._skipStartup=true;
return new dojo.dnd.Source(node,_f65);
},onMouseMove:function(e){
if(this.isDragging&&this.targetState=="Disabled"){
return;
}
dojo.dnd.Source.superclass.onMouseMove.call(this,e);
var m=dojo.dnd.manager();
if(this.isDragging){
var _f69=false;
if(this.current){
if(!this.targetBox||this.targetAnchor!=this.current){
this.targetBox={xy:dojo.coords(this.current,true),w:this.current.offsetWidth,h:this.current.offsetHeight};
}
if(this.horizontal){
_f69=(e.pageX-this.targetBox.xy.x)<(this.targetBox.w/2);
}else{
_f69=(e.pageY-this.targetBox.xy.y)<(this.targetBox.h/2);
}
}
if(this.current!=this.targetAnchor||_f69!=this.before){
this._markTargetAnchor(_f69);
m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));
}
}else{
if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){
var _f6a=this.getSelectedNodes();
if(_f6a.length){
m.startDrag(this,_f6a,this.copyState(dojo.dnd.getCopyKeyState(e),true));
}
}
}
},onMouseDown:function(e){
if(this._legalMouseDown(e)&&(!this.skipForm||!dojo.dnd.isFormElement(e))){
this.mouseDown=true;
this.mouseButton=e.button;
this._lastX=e.pageX;
this._lastY=e.pageY;
dojo.dnd.Source.superclass.onMouseDown.call(this,e);
}
},onMouseUp:function(e){
if(this.mouseDown){
this.mouseDown=false;
dojo.dnd.Source.superclass.onMouseUp.call(this,e);
}
},onDndSourceOver:function(_f6d){
if(this!=_f6d){
this.mouseDown=false;
if(this.targetAnchor){
this._unmarkTargetAnchor();
}
}else{
if(this.isDragging){
var m=dojo.dnd.manager();
m.canDrop(this.targetState!="Disabled"&&(!this.current||m.source!=this||!(this.current.id in this.selection)));
}
}
},onDndStart:function(_f6f,_f70,copy){
if(this.autoSync){
this.sync();
}
if(this.isSource){
this._changeState("Source",this==_f6f?(copy?"Copied":"Moved"):"");
}
var _f72=this.accept&&this.checkAcceptance(_f6f,_f70);
this._changeState("Target",_f72?"":"Disabled");
if(this==_f6f){
dojo.dnd.manager().overSource(this);
}
this.isDragging=true;
},onDndDrop:function(_f73,_f74,copy,_f76){
if(this==_f76){
this.onDrop(_f73,_f74,copy);
}
this.onDndCancel();
},onDndCancel:function(){
if(this.targetAnchor){
this._unmarkTargetAnchor();
this.targetAnchor=null;
}
this.before=true;
this.isDragging=false;
this.mouseDown=false;
delete this.mouseButton;
this._changeState("Source","");
this._changeState("Target","");
},onDrop:function(_f77,_f78,copy){
if(this!=_f77){
this.onDropExternal(_f77,_f78,copy);
}else{
this.onDropInternal(_f78,copy);
}
},onDropExternal:function(_f7a,_f7b,copy){
var _f7d=this._normalizedCreator;
if(this.creator){
this._normalizedCreator=function(node,hint){
return _f7d.call(this,_f7a.getItem(node.id).data,hint);
};
}else{
if(copy){
this._normalizedCreator=function(node,hint){
var t=_f7a.getItem(node.id);
var n=node.cloneNode(true);
n.id=dojo.dnd.getUniqueId();
return {node:n,data:t.data,type:t.type};
};
}else{
this._normalizedCreator=function(node,hint){
var t=_f7a.getItem(node.id);
_f7a.delItem(node.id);
return {node:node,data:t.data,type:t.type};
};
}
}
this.selectNone();
if(!copy&&!this.creator){
_f7a.selectNone();
}
this.insertNodes(true,_f7b,this.before,this.current);
if(!copy&&this.creator){
_f7a.deleteSelectedNodes();
}
this._normalizedCreator=_f7d;
},onDropInternal:function(_f87,copy){
var _f89=this._normalizedCreator;
if(this.current&&this.current.id in this.selection){
return;
}
if(copy){
if(this.creator){
this._normalizedCreator=function(node,hint){
return _f89.call(this,this.getItem(node.id).data,hint);
};
}else{
this._normalizedCreator=function(node,hint){
var t=this.getItem(node.id);
var n=node.cloneNode(true);
n.id=dojo.dnd.getUniqueId();
return {node:n,data:t.data,type:t.type};
};
}
}else{
if(!this.current){
return;
}
this._normalizedCreator=function(node,hint){
var t=this.getItem(node.id);
return {node:node,data:t.data,type:t.type};
};
}
this._removeSelection();
this.insertNodes(true,_f87,this.before,this.current);
this._normalizedCreator=_f89;
},onDraggingOver:function(){
},onDraggingOut:function(){
},onOverEvent:function(){
dojo.dnd.Source.superclass.onOverEvent.call(this);
dojo.dnd.manager().overSource(this);
if(this.isDragging&&this.targetState!="Disabled"){
this.onDraggingOver();
}
},onOutEvent:function(){
dojo.dnd.Source.superclass.onOutEvent.call(this);
dojo.dnd.manager().outSource(this);
if(this.isDragging&&this.targetState!="Disabled"){
this.onDraggingOut();
}
},_markTargetAnchor:function(_f93){
if(this.current==this.targetAnchor&&this.before==_f93){
return;
}
if(this.targetAnchor){
this._removeItemClass(this.targetAnchor,this.before?"Before":"After");
}
this.targetAnchor=this.current;
this.targetBox=null;
this.before=_f93;
if(this.targetAnchor){
this._addItemClass(this.targetAnchor,this.before?"Before":"After");
}
},_unmarkTargetAnchor:function(){
if(!this.targetAnchor){
return;
}
this._removeItemClass(this.targetAnchor,this.before?"Before":"After");
this.targetAnchor=null;
this.targetBox=null;
this.before=true;
},_markDndStatus:function(copy){
this._changeState("Source",copy?"Copied":"Moved");
},_legalMouseDown:function(e){
if(!this.withHandles){
return true;
}
for(var node=e.target;node;node=node.parentNode){
if(dojo.hasClass(node,"dojoDndHandle")){
return true;
}
if(dojo.hasClass(node,"dojoDndItem")){
break;
}
}
return false;
}});
dojo.declare("dojo.dnd.Target",dojo.dnd.Source,{constructor:function(node,_f98){
this.isSource=false;
dojo.removeClass(this.node,"dojoDndSource");
},markupFactory:function(_f99,node){
_f99._skipStartup=true;
return new dojo.dnd.Target(node,_f99);
}});
dojo.declare("dojo.dnd.AutoSource",dojo.dnd.Source,{constructor:function(node,_f9c){
this.autoSync=true;
},markupFactory:function(_f9d,node){
_f9d._skipStartup=true;
return new dojo.dnd.AutoSource(node,_f9d);
}});
}
if(!dojo._hasResource["dojo.data.api.Request"]){
dojo._hasResource["dojo.data.api.Request"]=true;
dojo.provide("dojo.data.api.Request");
dojo.declare("dojo.data.api.Request",null,{abort:function(){
throw new Error("Unimplemented API: dojo.data.api.Request.abort");
}});
}
if(!dojo._hasResource["dijit.ProgressBar"]){
dojo._hasResource["dijit.ProgressBar"]=true;
dojo.provide("dijit.ProgressBar");
dojo.declare("dijit.ProgressBar",[dijit._Widget,dijit._Templated],{progress:"0",maximum:100,places:0,indeterminate:false,templateString:"<div class=\"dijitProgressBar dijitProgressBarEmpty\"\r\n\t><div waiRole=\"progressbar\" tabindex=\"0\" dojoAttachPoint=\"internalProgress\" class=\"dijitProgressBarFull\"\r\n\t\t><div class=\"dijitProgressBarTile\"></div\r\n\t\t><span style=\"visibility:hidden\">&nbsp;</span\r\n\t></div\r\n\t><div dojoAttachPoint=\"label\" class=\"dijitProgressBarLabel\" id=\"${id}_label\">&nbsp;</div\r\n\t><img dojoAttachPoint=\"inteterminateHighContrastImage\" class=\"dijitProgressBarIndeterminateHighContrastImage\" alt=\"\"\r\n\t></img\r\n></div>\r\n",_indeterminateHighContrastImagePath:dojo.moduleUrl("dijit","themes/a11y/indeterminate_progress.gif"),postCreate:function(){
this.inherited(arguments);
this.inteterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath);
this.update();
},update:function(_f9f){
dojo.mixin(this,_f9f||{});
var tip=this.internalProgress;
var _fa1=1,_fa2;
if(this.indeterminate){
_fa2="addClass";
dijit.removeWaiState(tip,"valuenow");
dijit.removeWaiState(tip,"valuemin");
dijit.removeWaiState(tip,"valuemax");
}else{
_fa2="removeClass";
if(String(this.progress).indexOf("%")!=-1){
_fa1=Math.min(parseFloat(this.progress)/100,1);
this.progress=_fa1*this.maximum;
}else{
this.progress=Math.min(this.progress,this.maximum);
_fa1=this.progress/this.maximum;
}
var text=this.report(_fa1);
this.label.firstChild.nodeValue=text;
dijit.setWaiState(tip,"describedby",this.label.id);
dijit.setWaiState(tip,"valuenow",this.progress);
dijit.setWaiState(tip,"valuemin",0);
dijit.setWaiState(tip,"valuemax",this.maximum);
}
dojo[_fa2](this.domNode,"dijitProgressBarIndeterminate");
tip.style.width=(_fa1*100)+"%";
this.onChange();
},report:function(_fa4){
return dojo.number.format(_fa4,{type:"percent",places:this.places,locale:this.lang});
},onChange:function(){
}});
}
if(!dojo._hasResource["dojox.date.posix"]){
dojo._hasResource["dojox.date.posix"]=true;
dojo.provide("dojox.date.posix");
dojox.date.posix.strftime=function(_fa5,_fa6,_fa7){
var _fa8=null;
var _=function(s,n){
return dojo.string.pad(s,n||2,_fa8||"0");
};
var _fac=dojo.date.locale._getGregorianBundle(_fa7);
var $=function(_fae){
switch(_fae){
case "a":
return dojo.date.locale.getNames("days","abbr","format",_fa7)[_fa5.getDay()];
case "A":
return dojo.date.locale.getNames("days","wide","format",_fa7)[_fa5.getDay()];
case "b":
case "h":
return dojo.date.locale.getNames("months","abbr","format",_fa7)[_fa5.getMonth()];
case "B":
return dojo.date.locale.getNames("months","wide","format",_fa7)[_fa5.getMonth()];
case "c":
return dojo.date.locale.format(_fa5,{formatLength:"full",locale:_fa7});
case "C":
return _(Math.floor(_fa5.getFullYear()/100));
case "d":
return _(_fa5.getDate());
case "D":
return $("m")+"/"+$("d")+"/"+$("y");
case "e":
if(_fa8==null){
_fa8=" ";
}
return _(_fa5.getDate());
case "f":
if(_fa8==null){
_fa8=" ";
}
return _(_fa5.getMonth()+1);
case "g":
break;
case "G":
dojo.unimplemented("unimplemented modifier 'G'");
break;
case "F":
return $("Y")+"-"+$("m")+"-"+$("d");
case "H":
return _(_fa5.getHours());
case "I":
return _(_fa5.getHours()%12||12);
case "j":
return _(dojo.date.locale._getDayOfYear(_fa5),3);
case "k":
if(_fa8==null){
_fa8=" ";
}
return _(_fa5.getHours());
case "l":
if(_fa8==null){
_fa8=" ";
}
return _(_fa5.getHours()%12||12);
case "m":
return _(_fa5.getMonth()+1);
case "M":
return _(_fa5.getMinutes());
case "n":
return "\n";
case "p":
return _fac[_fa5.getHours()<12?"am":"pm"];
case "r":
return $("I")+":"+$("M")+":"+$("S")+" "+$("p");
case "R":
return $("H")+":"+$("M");
case "S":
return _(_fa5.getSeconds());
case "t":
return "\t";
case "T":
return $("H")+":"+$("M")+":"+$("S");
case "u":
return String(_fa5.getDay()||7);
case "U":
return _(dojo.date.locale._getWeekOfYear(_fa5));
case "V":
return _(dojox.date.posix.getIsoWeekOfYear(_fa5));
case "W":
return _(dojo.date.locale._getWeekOfYear(_fa5,1));
case "w":
return String(_fa5.getDay());
case "x":
return dojo.date.locale.format(_fa5,{selector:"date",formatLength:"full",locale:_fa7});
case "X":
return dojo.date.locale.format(_fa5,{selector:"time",formatLength:"full",locale:_fa7});
case "y":
return _(_fa5.getFullYear()%100);
case "Y":
return String(_fa5.getFullYear());
case "z":
var _faf=_fa5.getTimezoneOffset();
return (_faf>0?"-":"+")+_(Math.floor(Math.abs(_faf)/60))+":"+_(Math.abs(_faf)%60);
case "Z":
return dojo.date.getTimezoneName(_fa5);
case "%":
return "%";
}
};
var _fb0="";
var i=0;
var _fb2=0;
var _fb3=null;
while((_fb2=_fa6.indexOf("%",i))!=-1){
_fb0+=_fa6.substring(i,_fb2++);
switch(_fa6.charAt(_fb2++)){
case "_":
_fa8=" ";
break;
case "-":
_fa8="";
break;
case "0":
_fa8="0";
break;
case "^":
_fb3="upper";
break;
case "*":
_fb3="lower";
break;
case "#":
_fb3="swap";
break;
default:
_fa8=null;
_fb2--;
break;
}
var _fb4=$(_fa6.charAt(_fb2++));
switch(_fb3){
case "upper":
_fb4=_fb4.toUpperCase();
break;
case "lower":
_fb4=_fb4.toLowerCase();
break;
case "swap":
var _fb5=_fb4.toLowerCase();
var _fb6="";
var ch="";
for(var j=0;j<_fb4.length;j++){
ch=_fb4.charAt(j);
_fb6+=(ch==_fb5.charAt(j))?ch.toUpperCase():ch.toLowerCase();
}
_fb4=_fb6;
break;
default:
break;
}
_fb3=null;
_fb0+=_fb4;
i=_fb2;
}
_fb0+=_fa6.substring(i);
return _fb0;
};
dojox.date.posix.getStartOfWeek=function(_fb9,_fba){
if(isNaN(_fba)){
_fba=dojo.cldr.supplemental.getFirstDayOfWeek?dojo.cldr.supplemental.getFirstDayOfWeek():0;
}
var _fbb=_fba;
if(_fb9.getDay()>=_fba){
_fbb-=_fb9.getDay();
}else{
_fbb-=(7-_fb9.getDay());
}
var date=new Date(_fb9);
date.setHours(0,0,0,0);
return dojo.date.add(date,"day",_fbb);
};
dojox.date.posix.setIsoWeekOfYear=function(_fbd,week){
if(!week){
return _fbd;
}
var _fbf=dojox.date.posix.getIsoWeekOfYear(_fbd);
var _fc0=week-_fbf;
if(week<0){
var _fc1=dojox.date.posix.getIsoWeeksInYear(_fbd);
_fc0=(_fc1+week+1)-_fbf;
}
return dojo.date.add(_fbd,"week",_fc0);
};
dojox.date.posix.getIsoWeekOfYear=function(_fc2){
var _fc3=dojox.date.posix.getStartOfWeek(_fc2,1);
var _fc4=new Date(_fc2.getFullYear(),0,4);
_fc4=dojox.date.posix.getStartOfWeek(_fc4,1);
var diff=_fc3.getTime()-_fc4.getTime();
if(diff<0){
return dojox.date.posix.getIsoWeeksInYear(_fc3);
}
return Math.ceil(diff/604800000)+1;
};
dojox.date.posix.getIsoWeeksInYear=function(_fc6){
function p(y){
return y+Math.floor(y/4)-Math.floor(y/100)+Math.floor(y/400);
};
var y=_fc6.getFullYear();
return (p(y)%7==4||p(y-1)%7==3)?53:52;
};
}
if(!dojo._hasResource["dojox.string.Builder"]){
dojo._hasResource["dojox.string.Builder"]=true;
dojo.provide("dojox.string.Builder");
dojox.string.Builder=function(str){
var b="";
this.length=0;
this.append=function(s){
if(arguments.length>1){
var tmp="",l=arguments.length;
switch(l){
case 9:
tmp=""+arguments[8]+tmp;
case 8:
tmp=""+arguments[7]+tmp;
case 7:
tmp=""+arguments[6]+tmp;
case 6:
tmp=""+arguments[5]+tmp;
case 5:
tmp=""+arguments[4]+tmp;
case 4:
tmp=""+arguments[3]+tmp;
case 3:
tmp=""+arguments[2]+tmp;
case 2:
b+=""+arguments[0]+arguments[1]+tmp;
break;
default:
var i=0;
while(i<arguments.length){
tmp+=arguments[i++];
}
b+=tmp;
}
}else{
b+=s;
}
this.length=b.length;
return this;
};
this.concat=function(s){
return this.append.apply(this,arguments);
};
this.appendArray=function(_fd0){
return this.append.apply(this,_fd0);
};
this.clear=function(){
b="";
this.length=0;
return this;
};
this.replace=function(_fd1,_fd2){
b=b.replace(_fd1,_fd2);
this.length=b.length;
return this;
};
this.remove=function(_fd3,len){
if(len===undefined){
len=b.length;
}
if(len==0){
return this;
}
b=b.substr(0,_fd3)+b.substr(_fd3+len);
this.length=b.length;
return this;
};
this.insert=function(_fd5,str){
if(_fd5==0){
b=str+b;
}else{
b=b.slice(0,_fd5)+str+b.slice(_fd5);
}
this.length=b.length;
return this;
};
this.toString=function(){
return b;
};
if(str){
this.append(str);
}
};
}
if(!dojo._hasResource["dojox.data.dom"]){
dojo._hasResource["dojox.data.dom"]=true;
dojo.provide("dojox.data.dom");
dojo.experimental("dojox.data.dom");
dojox.data.dom.createDocument=function(str,_fd8){
var _fd9=dojo.doc;
if(!_fd8){
_fd8="text/xml";
}
if(str&&dojo.trim(str)!==""&&(typeof dojo.global["DOMParser"])!=="undefined"){
var _fda=new DOMParser();
return _fda.parseFromString(str,_fd8);
}else{
if((typeof dojo.global["ActiveXObject"])!=="undefined"){
var _fdb=["MSXML2","Microsoft","MSXML","MSXML3"];
for(var i=0;i<_fdb.length;i++){
try{
var doc=new ActiveXObject(_fdb[i]+".XMLDOM");
if(str){
if(doc){
doc.async=false;
doc.loadXML(str);
return doc;
}else{
console.log("loadXML didn't work?");
}
}else{
if(doc){
return doc;
}
}
}
catch(e){
}
}
}else{
if((_fd9.implementation)&&(_fd9.implementation.createDocument)){
if(str&&dojo.trim(str)!==""){
if(_fd9.createElement){
var tmp=_fd9.createElement("xml");
tmp.innerHTML=str;
var _fdf=_fd9.implementation.createDocument("foo","",null);
for(var i=0;i<tmp.childNodes.length;i++){
_fdf.importNode(tmp.childNodes.item(i),true);
}
return _fdf;
}
}else{
return _fd9.implementation.createDocument("","",null);
}
}
}
}
return null;
};
dojox.data.dom.textContent=function(node,text){
if(arguments.length>1){
var _fe2=node.ownerDocument||dojo.doc;
dojox.data.dom.replaceChildren(node,_fe2.createTextNode(text));
return text;
}else{
if(node.textContent!==undefined){
return node.textContent;
}
var _fe3="";
if(node==null){
return _fe3;
}
for(var i=0;i<node.childNodes.length;i++){
switch(node.childNodes[i].nodeType){
case 1:
case 5:
_fe3+=dojox.data.dom.textContent(node.childNodes[i]);
break;
case 3:
case 2:
case 4:
_fe3+=node.childNodes[i].nodeValue;
break;
default:
break;
}
}
return _fe3;
}
};
dojox.data.dom.replaceChildren=function(node,_fe6){
var _fe7=[];
if(dojo.isIE){
for(var i=0;i<node.childNodes.length;i++){
_fe7.push(node.childNodes[i]);
}
}
dojox.data.dom.removeChildren(node);
for(var i=0;i<_fe7.length;i++){
dojo._destroyElement(_fe7[i]);
}
if(!dojo.isArray(_fe6)){
node.appendChild(_fe6);
}else{
for(var i=0;i<_fe6.length;i++){
node.appendChild(_fe6[i]);
}
}
};
dojox.data.dom.removeChildren=function(node){
var _fea=node.childNodes.length;
while(node.hasChildNodes()){
node.removeChild(node.firstChild);
}
return _fea;
};
dojox.data.dom.innerXML=function(node){
if(node.innerXML){
return node.innerXML;
}else{
if(node.xml){
return node.xml;
}else{
if(typeof XMLSerializer!="undefined"){
return (new XMLSerializer()).serializeToString(node);
}
}
}
};
}
if(!dojo._hasResource["dojo.fx.easing"]){
dojo._hasResource["dojo.fx.easing"]=true;
dojo.provide("dojo.fx.easing");
dojo.fx.easing={linear:function(n){
return n;
},quadIn:function(n){
return Math.pow(n,2);
},quadOut:function(n){
return n*(n-2)*-1;
},quadInOut:function(n){
n=n*2;
if(n<1){
return Math.pow(n,2)/2;
}
return -1*((--n)*(n-2)-1)/2;
},cubicIn:function(n){
return Math.pow(n,3);
},cubicOut:function(n){
return Math.pow(n-1,3)+1;
},cubicInOut:function(n){
n=n*2;
if(n<1){
return Math.pow(n,3)/2;
}
n-=2;
return (Math.pow(n,3)+2)/2;
},quartIn:function(n){
return Math.pow(n,4);
},quartOut:function(n){
return -1*(Math.pow(n-1,4)-1);
},quartInOut:function(n){
n=n*2;
if(n<1){
return Math.pow(n,4)/2;
}
n-=2;
return -1/2*(Math.pow(n,4)-2);
},quintIn:function(n){
return Math.pow(n,5);
},quintOut:function(n){
return Math.pow(n-1,5)+1;
},quintInOut:function(n){
n=n*2;
if(n<1){
return Math.pow(n,5)/2;
}
n-=2;
return (Math.pow(n,5)+2)/2;
},sineIn:function(n){
return -1*Math.cos(n*(Math.PI/2))+1;
},sineOut:function(n){
return Math.sin(n*(Math.PI/2));
},sineInOut:function(n){
return -1*(Math.cos(Math.PI*n)-1)/2;
},expoIn:function(n){
return (n==0)?0:Math.pow(2,10*(n-1));
},expoOut:function(n){
return (n==1)?1:(-1*Math.pow(2,-10*n)+1);
},expoInOut:function(n){
if(n==0){
return 0;
}
if(n==1){
return 1;
}
n=n*2;
if(n<1){
return Math.pow(2,10*(n-1))/2;
}
--n;
return (-1*Math.pow(2,-10*n)+2)/2;
},circIn:function(n){
return -1*(Math.sqrt(1-Math.pow(n,2))-1);
},circOut:function(n){
n=n-1;
return Math.sqrt(1-Math.pow(n,2));
},circInOut:function(n){
n=n*2;
if(n<1){
return -1/2*(Math.sqrt(1-Math.pow(n,2))-1);
}
n-=2;
return 1/2*(Math.sqrt(1-Math.pow(n,2))+1);
},backIn:function(n){
var s=1.70158;
return Math.pow(n,2)*((s+1)*n-s);
},backOut:function(n){
n=n-1;
var s=1.70158;
return Math.pow(n,2)*((s+1)*n+s)+1;
},backInOut:function(n){
var s=1.70158*1.525;
n=n*2;
if(n<1){
return (Math.pow(n,2)*((s+1)*n-s))/2;
}
n-=2;
return (Math.pow(n,2)*((s+1)*n+s)+2)/2;
},elasticIn:function(n){
if(n==0||n==1){
return n;
}
var p=0.3;
var s=p/4;
n=n-1;
return -1*Math.pow(2,10*n)*Math.sin((n-s)*(2*Math.PI)/p);
},elasticOut:function(n){
if(n==0||n==1){
return n;
}
var p=0.3;
var s=p/4;
return Math.pow(2,-10*n)*Math.sin((n-s)*(2*Math.PI)/p)+1;
},elasticInOut:function(n){
if(n==0){
return 0;
}
n=n*2;
if(n==2){
return 1;
}
var p=0.3*1.5;
var s=p/4;
if(n<1){
n-=1;
return -0.5*(Math.pow(2,10*n)*Math.sin((n-s)*(2*Math.PI)/p));
}
n-=1;
return 0.5*(Math.pow(2,-10*n)*Math.sin((n-s)*(2*Math.PI)/p))+1;
},bounceIn:function(n){
return (1-dojo.fx.easing.bounceOut(1-n));
},bounceOut:function(n){
var s=7.5625;
var p=2.75;
var l;
if(n<(1/p)){
l=s*Math.pow(n,2);
}else{
if(n<(2/p)){
n-=(1.5/p);
l=s*Math.pow(n,2)+0.75;
}else{
if(n<(2.5/p)){
n-=(2.25/p);
l=s*Math.pow(n,2)+0.9375;
}else{
n-=(2.625/p);
l=s*Math.pow(n,2)+0.984375;
}
}
}
return l;
},bounceInOut:function(n){
if(n<0.5){
return dojo.fx.easing.bounceIn(n*2)/2;
}
return (dojo.fx.easing.bounceOut(n*2-1)/2)+0.5;
}};
}
if(!dojo._hasResource["dojox.fx.easing"]){
dojo._hasResource["dojox.fx.easing"]=true;
dojo.provide("dojox.fx.easing");
dojo.deprecated("dojox.fx.easing","Upgraded to Core, use dojo.fx.easing instead","2.0");
dojox.fx.easing=dojo.fx.easing;
}
if(!dojo._hasResource["dojox.fx._core"]){
dojo._hasResource["dojox.fx._core"]=true;
dojo.provide("dojox.fx._core");
dojox.fx._Line=function(start,end){
this.start=start;
this.end=end;
var _1019=dojo.isArray(start),d=(_1019?[]:end-start);
if(_1019){
dojo.forEach(this.start,function(s,i){
d[i]=this.end[i]-s;
},this);
this.getValue=function(n){
var res=[];
dojo.forEach(this.start,function(s,i){
res[i]=(d[i]*n)+s;
},this);
return res;
};
}else{
this.getValue=function(n){
return (d*n)+this.start;
};
}
};
}
if(!dojo._hasResource["dojox.fx.scroll"]){
dojo._hasResource["dojox.fx.scroll"]=true;
dojo.provide("dojox.fx.scroll");
dojo.experimental("dojox.fx.scroll");
dojox.fx.smoothScroll=function(args){
if(!args.target){
args.target=dojo.coords(args.node,true);
}
var _1023=dojo[(dojo.isIE?"isObject":"isFunction")](args["win"].scrollTo);
var _anim=(_1023)?(function(val){
args.win.scrollTo(val[0],val[1]);
}):(function(val){
args.win.scrollLeft=val[0];
args.win.scrollTop=val[1];
});
var anim=new dojo._Animation(dojo.mixin({beforeBegin:function(){
if(this.curve){
delete this.curve;
}
var _1028=_1023?dojo._docScroll():{x:args.win.scrollLeft,y:args.win.scrollTop};
anim.curve=new dojox.fx._Line([_1028.x,_1028.y],[args.target.x,args.target.y]);
},onAnimate:_anim},args));
return anim;
};
}
if(!dojo._hasResource["dojox.timing._base"]){
dojo._hasResource["dojox.timing._base"]=true;
dojo.provide("dojox.timing._base");
dojo.experimental("dojox.timing");
dojox.timing.Timer=function(_1029){
this.timer=null;
this.isRunning=false;
this.interval=_1029;
this.onStart=null;
this.onStop=null;
};
dojo.extend(dojox.timing.Timer,{onTick:function(){
},setInterval:function(_102a){
if(this.isRunning){
window.clearInterval(this.timer);
}
this.interval=_102a;
if(this.isRunning){
this.timer=window.setInterval(dojo.hitch(this,"onTick"),this.interval);
}
},start:function(){
if(typeof this.onStart=="function"){
this.onStart();
}
this.isRunning=true;
this.timer=window.setInterval(dojo.hitch(this,"onTick"),this.interval);
},stop:function(){
if(typeof this.onStop=="function"){
this.onStop();
}
this.isRunning=false;
window.clearInterval(this.timer);
}});
}
if(!dojo._hasResource["dojox.timing"]){
dojo._hasResource["dojox.timing"]=true;
dojo.provide("dojox.timing");
}
dojo.i18n._preloadLocalizations("dojo.nls.dojo",["da","es","hu","de","pt-br","pl","pt","ca","sv","ar","pt-pt","fi","zh","ru","xx","fr","zh-tw","it","th","cs","he","nl","el","no","ko","tr","en","ROOT","ja"]);
if(dojo.config.afterOnLoad&&dojo.isBrowser){
window.setTimeout(dojo._fakeLoadInit,1000);
}
})();
/* ***************************************************************** */
/* Copyright IBM Corp. 2001, 2008  All Rights Reserved.              */
/* ***************************************************************** */
dojo.provide("com.ibm.mm.enabler.status");dojo.declare("com.ibm.mm.enabler.status.StatusType",null,{constructor:function(id,_2,_3,_4){this._id=id;this._styleClass=_2;this._iconPath=_3;this._color=_4;}});dojo.declare("com.ibm.mm.enabler.status.StatusMessage",null,{constructor:function(_5,_6,_7){this._type=_5;this._message=_6;this._details=_7;},render:function(_8){var _9=com.ibm.mm.enabler.status.statusTypesMap[this._type];var _a=document.createElement("div");_a.className=_9._styleClass;var _b=document.createElement("h5");var _c=document.createElement("div");_c.className="statusHeaderLHS";var _d=document.createElement("img");_d.src=_9._iconPath;_c.appendChild(_d);_c.appendChild(document.createTextNode(this._message));_b.appendChild(_c);_a.appendChild(_b);var _e=document.createElement("div");_e.className="details";_e.appendChild(document.createTextNode(this._details));_a.appendChild(_e);_8.appendChild(_a);}});dojo.declare("com.ibm.mm.enabler.status.StatusTypesMap",null,{constructor:function(){this._baseURL=new dojo.moduleUrl("com.ibm.mm.enabler","iw/");this.error=new com.ibm.mm.enabler.status.StatusType(0,"error",this._baseURL+"error.gif","#FF0000");this.warn=new com.ibm.mm.enabler.status.StatusType(1,"warning",this._baseURL+"warning.gif","FFFF00");this.info=new com.ibm.mm.enabler.status.StatusType(2,"info",this._baseURL+"info.gif","#0077FF");this.constants={"ERROR":"error","WARN":"warn","INFO":"info"};}});com.ibm.mm.enabler.status.statusTypesMap=new com.ibm.mm.enabler.status.StatusTypesMap();dojo.provide("com.ibm.mm.enabler.debug");dojo.require("com.ibm.mm.enabler.status");com.ibm.mm.enabler.debug.Constants={MMLogging:"/mm/logging",MMStatusMsg:"/mm/statusMsg",MMTracing:"/mm/tracing",LOG:"log",INFO:"info",WARN:"warn",ERROR:"error"};com.ibm.mm.enabler.debug.log=function(_f){if(com.ibm.mm.enabler.debug.isLogging){if(arguments.length>1){arguments[0]=_f+" --> ";}com.ibm.mm.enabler.debug._log(com.ibm.mm.enabler.debug.Constants.LOG,arguments);com.ibm.mm.enabler.debug._publishTracing(com.ibm.mm.enabler.debug.Constants.LOG,arguments);}};com.ibm.mm.enabler.debug.entry=function(_10){if(com.ibm.mm.enabler.debug.isLogging){if(arguments.length>1){arguments[0]=_10+" --> Entry ";}com.ibm.mm.enabler.debug._log(com.ibm.mm.enabler.debug.Constants.LOG,arguments);com.ibm.mm.enabler.debug._publishTracing(com.ibm.mm.enabler.debug.Constants.LOG,arguments);}};com.ibm.mm.enabler.debug.exit=function(_11){if(com.ibm.mm.enabler.debug.isLogging){if(arguments.length>1){arguments[0]=_11+" --> Exit ";}com.ibm.mm.enabler.debug._log(com.ibm.mm.enabler.debug.Constants.LOG,arguments);com.ibm.mm.enabler.debug._publishTracing(com.ibm.mm.enabler.debug.Constants.LOG,arguments);}};com.ibm.mm.enabler.debug.escapeXmlForHTMLDisplay=function(_12){_12=_12.replace(/</g,"&lt;");_12=_12.replace(/>/g,"&gt;");return _12;};com.ibm.mm.enabler.debug.info=function(_13){try{if(arguments.length>1){arguments[0]=_13+" --> ";}com.ibm.mm.enabler.debug._log(com.ibm.mm.enabler.debug.Constants.INFO,arguments);com.ibm.mm.enabler.debug._publishLogging(com.ibm.mm.enabler.debug.Constants.INFO,arguments);}catch(e){}};com.ibm.mm.enabler.debug.warn=function(_14){if(arguments.length>1){arguments[0]=_14+" --> ";}com.ibm.mm.enabler.debug._log(com.ibm.mm.enabler.debug.Constants.WARN,arguments);com.ibm.mm.enabler.debug._publishLogging(com.ibm.mm.enabler.debug.Constants.WARN,arguments);};com.ibm.mm.enabler.debug.error=function(_15){if(arguments.length>1){arguments[0]=_15+" --> ";}com.ibm.mm.enabler.debug._log(com.ibm.mm.enabler.debug.Constants.ERROR,arguments);com.ibm.mm.enabler.debug._publishLogging(com.ibm.mm.enabler.debug.Constants.ERROR,arguments);};com.ibm.mm.enabler.debug._log=function(_16,_17){if(com.ibm.mm.enabler.debug.isLogging){if(_17.length>=2&&dojo.isString(_17[1])){var arr=[];arr.push(_17[0]+_17[1]);for(var i=2;i<_17.length;i++){arr.push(_17[i]);}console[_16].apply(window.console,arr);}else{console[_16].apply(window.console,_17);}}};com.ibm.mm.enabler.debug._publishTracing=function(_1a,_1b){if(typeof ibmConfig!="undefined"&&ibmConfig!==null&&ibmConfig.allowPublishTracing===true){var _1c={};_1c.type=_1a;_1c.args=_1b;var _1d=[];_1d[0]=_1c;dojo.publish(com.ibm.mm.enabler.debug.Constants.MMTracing,_1d);}};com.ibm.mm.enabler.debug._publishLogging=function(_1e,_1f){if(typeof ibmConfig!="undefined"&&ibmConfig!==null&&ibmConfig.allowPublishLogging===true){var _20={};_20.type=_1e;_20.args=_1f;var _21=[];_21[0]=_20;dojo.publish(com.ibm.mm.enabler.debug.Constants.MMLogging,_21);}};if(typeof ibmConfig!="undefined"&&ibmConfig!==null&&ibmConfig.isDebug===true){com.ibm.mm.enabler.debug.isLogging=true;}else{com.ibm.mm.enabler.debug.isLogging=false;}com.ibm.mm.enabler.debug.logInlineMessage=function(_22,_23,_24,_25,_26){var _27=new com.ibm.mm.enabler.status.StatusMessage(_23,_24,_25);if(_22){_27.render(_22);}com.ibm.mm.enabler.debug._publishStatusMsg(_23,_24,_25,_26);};com.ibm.mm.enabler.debug._publishStatusMsg=function(_28,_29,_2a,_2b,_2c){if(typeof ibmConfig!="undefined"&&ibmConfig!==null&&ibmConfig.allowPublishStatusMsg===true){var _2d={};_2d.type=_28;_2d.args=_2b;_2d.message=_29;_2d.details=_2a;_2d.component=_2c;var _2e=[];_2e[0]=_2d;dojo.publish(com.ibm.mm.enabler.debug.Constants.MMStatusMsg,_2e);}};dojo.provide("com.ibm.mm.enabler.services.ConfigService");dojo.declare("com.ibm.mm.enabler.services.ConfigService",null,{PROXY_URL:"com.ibm.mashups.proxy.url",HUB_URL:"com.ibm.mashups.hub.url",CONTEXT_ROOT_MAIN:"com.ibm.mashups.contextroot",CONTEXT_ROOT_THEME_TEMP:"com.ibm.mashups.contextroot.theme.temp",CONTEXT_ROOT_BUILDER:"com.ibm.mashups.contextroot.builder",CONTEXT_ROOT_ENABLER:"com.ibm.mashups.contextroot.enabler",CONTENTHANDLER_PUBLIC:"com.ibm.mashups.contenthandler.public",CONTENTHANDLER_PRIVATE:"com.ibm.mashups.contenthandler.private",THEMES_FEEDS_EXPIRATION:"themes.feed.expiration",AVAILABLE_LOCALES:"available.locales",TUNNEL_MODE:"tunnel.mode",CLIENT_IS_DEBUG:"isDebug",CLIENT_ALLOW_PUBLISH_LOGGING:"allowPublishLogging",CLIENT_ALLOW_PUBLISH_TRACING:"allowPublishTracing",CLIENT_LOAD_SERVICES:"loadServices",CLIENT_POPUP_CONSOLE:"popupConsole",CLIENT_DEFAULT_THEME_ID:"com.ibm.mashups.theme.defaultThemeId",CLIENT_PAGE_SOURCE_READ_ONLY:"pageSourceReadOnly",CLIENT_AUTO_ACCEPT_SHARED_GROUPNAME:"autoAcceptSharedGroupName",CLIENT_USER_ID_KEY:"userIdKey",CLIENT_GROUP_CN_KEY:"groupCNKey",getPreferenceValue:function(_2f){return this.getValue(_2f);},getValue:function(_30){com.ibm.mm.enabler.debug.entry("ConfigService.getValue",_30);var _31=ibmConfig[_30];com.ibm.mm.enabler.debug.exit("ConfigService.getValue",_31);return _31;}});com.ibm.mm.enabler.services.CONFIG_SERVICE=new com.ibm.mm.enabler.services.ConfigService();dojo.provide("com.ibm.mm.enabler.aggregation.javascript");function com_ibm_enabler_aggregation_javascript_globalEvalNonIE(_32){eval.call(self,_32);};dojo.declare("com.ibm.mm.enabler.aggregation.javascript.Filter",null,{doFilter:function(_33){},evalGlobal:function(_34){if(window.execScript){window.execScript(this._stripHTMLComments(_34),"JavaScript");}else{com_ibm_enabler_aggregation_javascript_globalEvalNonIE(_34);}},_stripHTMLComments:function(str){com.ibm.mm.enabler.debug.entry("com.ibm.mm.enabler.aggregation.javascript.Filter._stripHTMLComments",str);var _36="";var _37=str.indexOf("<!--");if(_37!=-1){_36=str.substring(0,_37);}else{_36=str;}while(_37>=0){var _38=str.indexOf("-->");if(_38<0){throw new Error("Unclosed HTML comment found!!");}_36+=str.substring(_38+3);com.ibm.mm.enabler.debug.log("com.ibm.mm.enabler.aggregation.javascript.Filter._stripHTMLComments","result str = "+_36);_37=str.indexOf("<!--",_38+3);}com.ibm.mm.enabler.debug.exit("com.ibm.mm.enabler.aggregation.javascript.Filter._stripHTMLComments",_36);return _36;},prepareDocumentWrite:function(_39){com.ibm.mm.enabler.debug.entry("com.ibm.mm.enabler.aggregation.javascript.Filter.prepareDocumentWrite");var me=this;document.write=function(){me._documentWrite(_39,document.write.arguments);};document.writeln=function(str){me._documentWrite(_39,document.writeln.arguments);};com.ibm.mm.enabler.debug.exit("com.ibm.mm.enabler.aggregation.javascript.Filter.prepareDocumentWrite");},_documentWrite:function(_3c,_3d){for(var i=0;i<_3d.length;i++){_3c.content+=_3d[i];}},applyDocumentWrite:function(_3f,_40){com.ibm.mm.enabler.debug.entry("com.ibm.mm.enabler.aggregation.javascript.Filter.applyDocumentWrite",_3f,_40.content);var _41=_40.content;var id=_3f.getAttribute("id");var _43=document.getElementById(id);if(_41!=null&&_41.length>0){var div=document.createElement("DIV");div.innerHTML=_41;var _45=div.childNodes;if(_45!=null&&_45.length>0){var _46=_43;for(var i=0;i<_45.length;){var _48=_45[_45.length-1];dojo.dom.insertBefore(_48,_46);_46=_48;}}dojo.dom.destroyNode(div);}com.ibm.mm.enabler.debug.exit("com.ibm.mm.enabler.aggregation.javascript.Filter.applyDocumentWrite");}});dojo.declare("com.ibm.mm.enabler.aggregation.javascript.ExternalScriptFilter",com.ibm.mm.enabler.aggregation.javascript.Filter,{doFilter:function(_49){var url=this._getScriptUrl(_49);var _4b=false;if(url){var _4c=com.ibm.mm.enabler.services.CONFIG_SERVICE.getValue(com.ibm.mm.enabler.services.CONFIG_SERVICE.PROXY_URL);if(_4c!=null){_4c+="/";url=this._rewriteURL(url,_4c);}var _4d={content:""};this.prepareDocumentWrite(_4d);this._loadExternalScript(url);this.applyDocumentWrite(_49,_4d);_4b=true;}return _4b;},_getScriptUrl:function(_4e){var url=null;if(_4e.getAttribute){url=_4e.getAttribute("src");}else{var _50=_4e.toLowerCase().indexOf("<script");var end=_4e.toLowerCase().indexOf(">");var _52=_4e.substring(_50,end);var _53=_52.toLowerCase().indexOf("src");if(_53!=-1){var _54=_52.indexOf("'",_53);var _55=_52.indexOf("\"",_53);var _56="\"";var _57=_55;if(_55==-1||(_54!=-1&&_54<_55)){_56="'";_57=_54;}var _58=_52.indexOf(_56,_57+1);url=_52.substring(_57+1,_58);}}return url;},_loadExternalScript:function(url){var me=this;dojo.xhrGet({url:url,load:function(_5b,_5c){com.ibm.mm.enabler.debug.log("com.ibm.mm.enabler.aggregation.javascript.Filter._loadExternalScript","Retrieved JS file: ",_5b);me.evalGlobal(_5b);},sync:true,handleAs:"text"});},_rewriteURL:function(_5d,_5e){var _5f=_5e;var _60=window.location.host;var _61=window.location.protocol;if(_5d.indexOf("://")<0||_5d.indexOf(_61)==0&&_5d.indexOf(_60)==_61.length+2){return _5d;}if(_5d.indexOf("https")==0){_5f+="https/";}else{_5f+="http/";}_5f+=_5d.substr(_5d.indexOf("://")+3);return _5f;}});dojo.declare("com.ibm.mm.enabler.aggregation.javascript.InlineScriptFilter",com.ibm.mm.enabler.aggregation.javascript.Filter,{doFilter:function(_62){var _63=false,_64="";if(!dojo.isString(_62)){_64=_62.innerHTML;}else{var _65=_66.indexOf(">");var _67=_66.lastIndexOf("<");var _66=_62;_64=_66.substring(_65+1,_67);}com.ibm.mm.enabler.debug.log("com.ibm.mm.enabler.aggregation.javascript.InlineScriptFilter.doFilter","Stripped HTML tags out: "+_64,"processScriptArray");if(_64){var _68={content:""};this.prepareDocumentWrite(_68);this.evalGlobal(_64);_63=true;this.applyDocumentWrite(_62,_68);}return _63;}});dojo.declare("com.ibm.mm.enabler.aggregation.javascript.FilterChain",null,{constructor:function(){this._filters=new Array();},addFilter:function(_69){if(!this._filters){this._filters=new Array();}this._filters.push(_69);},applyFilters:function(_6a){var i=0;var _6c=false;while(i<this._filters.length&&!_6c){_6c=this._filters[i].doFilter(_6a);i=i+1;}return _6c;}});dojo.declare("com.ibm.mm.enabler.aggregation.javascript.WidgetJavascriptHandler",null,{constructor:function(){this.filterChain=new com.ibm.mm.enabler.aggregation.javascript.FilterChain();},handle:function(_6d){com.ibm.mm.enabler.debug.entry("WidgetJavascriptHandler.handle",_6d);var val=this.filterChain.applyFilters(_6d);com.ibm.mm.enabler.debug.exit("WidgetJavascriptHandler.handle");}});com.ibm.mm.enabler.aggregation.javascript.JAVASCRIPT_HANDLER=new com.ibm.mm.enabler.aggregation.javascript.WidgetJavascriptHandler();com.ibm.mm.enabler.aggregation.javascript.JAVASCRIPT_HANDLER.filterChain.addFilter(new com.ibm.mm.enabler.aggregation.javascript.ExternalScriptFilter());com.ibm.mm.enabler.aggregation.javascript.JAVASCRIPT_HANDLER.filterChain.addFilter(new com.ibm.mm.enabler.aggregation.javascript.InlineScriptFilter());if(!dojo._hasResource["com.ibm.mm.enabler.utilities"]){dojo._hasResource["com.ibm.mm.enabler.utilities"]=true;dojo.provide("com.ibm.mm.enabler.utilities");dojo.provide("com.ibm.mm.enabler.ArrayMap");com.ibm.mm.enabler.utilities={rewriteURL:function(_6f){var _70=new com.ibm.mm.enabler.utilities.HttpUrl(_6f);return _70.toProxifiedString();},inStringArray:function(str,_72){var rc=false;for(var i in _72){var _75=_72[i];if(_75==str){rc=true;break;}}return rc;},getLocale:function(_76,_77,_78){if(typeof _76=="undefined"||_76===null){return null;}var _79=_76.getLocales();if(typeof _79=="undefined"||_79===null||!dojo.isArray(_79)){return null;}if(_79.length===0){return null;}var _7a=null;if(_79.length===1){_7a=_79[0];}var arr={};for(var i in _79){var _7d=_79[i];arr[_7d]=_7d;}if(_7a===null){if(typeof _77!="undefined"&&_77!==null){_7a=this.findMatchLocale(arr,_77);if(_7a===null){var _7e=_77.split(/-|_/);if(_7e.length==2){var _7f=_7e[0];if(typeof arr[_7f]!="undefined"&&arr[_7f]!==null){_7a=_7f;}}}}}if(_7a===null){var _80=(dojo.isIE?navigator.userLanguage:navigator.language).toLowerCase();if(typeof ibmConfig!="undefined"&&ibmConfig!=null&&typeof (ibmConfig.locale)!="undefined"&&ibmConfig.locale!=null){_80=ibmConfig.locale;}if(_80!==null){_7a=this.findMatchLocale(arr,_80);if(_7a===null){var _7e=_80.split(/-|_/);if(_7e.length==2){var _81=_7e[0];if(typeof arr[_81]!="undefined"&&arr[_81]!==null){_7a=_81;}}}}}if(_7a===null){if(typeof _78!="undefined"&&_78!=null){_7a=_78;}}if(_7a===null){if(typeof arr["en"]!="undefined"&&arr["en"]!==null){_7a="en";}}if(_7a===null){_7a=_79[0];}return _7a;},findMatchLocale:function(arr,_83){var _84=null;if(typeof arr[_83]!="undefined"&&arr[_83]!=null){_84=_83;}var _85=this.toServerLocale(_83);if(_84===null&&(typeof arr[_85]!="undefined"&&arr[_85]!=null)){_84=_85;}var _86=_85.toLowerCase();if(_84===null&&(typeof arr[_86]!="undefined"&&arr[_86]!=null)){_84=_86;}return _84;},toServerLocale:function(_87){if(typeof _87=="undefined"||_87==null){return null;}if(_87.indexOf("-")<0){return _87;}_87=_87.replace(/-/,"_");var _88=_87.split("_");var _89=_88[0];var _8a=_88[1].toUpperCase();var _8b=_89+"_"+_8a;return _8b;},encodeModelID4Uri:function(uri){var pos=uri.indexOf(":");if(pos!=-1){var _8e=uri.slice(0,pos+1);var end=uri.slice(pos+1);uri=_8e+encodeURIComponent(end);}return encodeURIComponent(uri);},preloadImage:function(_90,_91,_92){var _93;if(_91&&_92){_93=new Image(_91,_92);}else{_93=new Image();}_93.src=_90;return _93;}};com.ibm.mm.enabler.dom={textContent:function(_94,_95){if(_94==null){return "";}if(arguments.length>1){var doc=_94.ownerDocument;var _97=doc.createTextNode(_95);this.replaceChildren(_94,_97);return;}else{if(_94.textContent!="undefined"&&_94.textContent!=null){return _94.textContent;}var _98="";for(var i=0;i<_94.childNodes.length;i++){switch(_94.childNodes[i].nodeType){case 1:case 3:_98+=_94.childNodes[i].nodeValue;break;case 2:case 4:_98+=_94.childNodes[i].nodeValue;break;default:break;}}return _98;}},createElement:function(dom,_9b,ns){var _9d;if(dojo.isIE){if(typeof ns!="undefined"&&ns!=null){_9d=dom.createNode(1,_9b,ns);}else{_9d=dom.createElement(_9b);}}else{_9d=dom.createElementNS(ns,_9b);}return _9d;},destroyNode:function(_9e){if(_9e&&_9e.parentNode){return _9e.parentNode.removeChild(_9e);}if(_9e.nodeType!=3){if(dojo.isIE){_9e.outerHTML="";}}},createDocument:function(str,_a0){return dojox.data.dom.createDocument(str,_a0);},replaceChildren:function(_a1,_a2){return dojox.data.dom.replaceChildren(_a1,_a2);},innerXML:function(_a3){return dojox.data.dom.innerXML(_a3);},removeChildren:function(_a4){return dojox.data.dom.removeChildren(_a4);},copyChildren:function(_a5,_a6,_a7){var _a8=_a5.cloneNode(true);return this.moveChildren(_a8,_a6,_a7);},moveChildren:function(_a9,_aa,_ab){var _ac=0;if(_ab){while(_a9.hasChildNodes()&&_a9.firstChild.nodeType==3){_a9.removeChild(_a9.firstChild);}while(_a9.hasChildNodes()&&_a9.lastChild.nodeType==3){_a9.removeChild(_a9.lastChild);}}while(_a9.hasChildNodes()){_aa.appendChild(_a9.firstChild);_ac++;}return _ac;}};dojo.declare("com.ibm.mm.enabler.utilities.HttpUrl",null,{constructor:function(_ad){this.scheme=this._extractScheme(_ad);this.server=this._extractServer(_ad);this.port=this._extractPort(_ad);this.path=this._extractPath(_ad);this.query=this._extractQuery(_ad);this.anchor=this._extractAnchor(_ad);},addParameter:function(_ae,_af){this.query+=((this.query!=null&&this.query!="")?"&":"")+_ae+"="+_af;},toProxifiedString:function(){if(typeof ibmConfig=="undefined"){return this.toString();}var _b0=com.ibm.mm.enabler.services.CONFIG_SERVICE.getValue(com.ibm.mm.enabler.services.CONFIG_SERVICE.PROXY_URL);if(_b0==null){return this.toString();}_b0+="/";if(window.location.protocol==this.scheme&&window.location.hostname==this.server){if(window.location.port==this.port||this.port==""){return this.toString();}else{if(this.scheme=="http:"&&window.location.port==""&&this.port=="80"){return this.toString();}else{if(this.scheme=="https:"&&window.location.port==""&&this.port=="443"){return this.toString();}}}}if(this.scheme=="https:"){_b0+="https/"+this.server+((this.port!="443"&&this.port!="")?"%3A"+this.port:"");}else{_b0+="http/"+this.server+((this.port!="80"&&this.port!="")?"%3A"+this.port:"");}if(this.path!=""){_b0+="/"+this.path;}if(this.query!=""){_b0+="?"+this.query;}if(this.anchor!=""){_b0+="#"+this.anchor;}return _b0;},toString:function(){var str="";if(this.server!=""){str+=this.scheme+"//"+this.server;if(this.port!=""){if(this.scheme=="http:"&&this.port=="80"){str+="";}else{if(this.scheme=="https:"&&this.port=="443"){str+="";}else{str+=":"+this.port;}}}}if(this.path!=""){str+="/"+this.path;}if(this.query!=""){str+="?"+this.query;}if(this.anchor!=""){str+="#"+this.anchor;}return str;},_extractScheme:function(_b2){var _b3=_b2.indexOf("://");if(_b3==-1){return window.location.protocol;}return _b2.substring(0,_b3+1);},_extractServer:function(_b4){var _b5=_b4.indexOf(this.scheme);var _b6="";if(_b5==0){var _b7=_b4.indexOf("/",_b5+this.scheme.length+2);if(_b7!=-1){var _b8=_b4.substring(_b5+this.scheme.length+2,_b7);}else{var _b8=_b4.substring(_b5+this.scheme.length+2);}_b6=_b8.split(":")[0];}else{_b6=window.location.hostname;}return _b6;},_extractPort:function(_b9){var _ba=_b9.indexOf(this.server);var _bb="";if(_ba>=0){var _bc=_b9.indexOf("/",_ba);if(_bc!=-1){var _bd=_b9.substring(_ba,_bc);}else{var _bd=_b9.substring(_ba);}var _be=_bd.split(":");if(_be.length>1){_bb=_be[1];}}if(_bb==""){if(_b9.indexOf("/")==0){_bb=window.location.port;}else{_bb="";}}return _bb;},_extractPath:function(_bf){var _c0=_bf.indexOf(this.scheme);var _c1=0;if(_c0==0){_c1=this.scheme.length+2;}var _c2="";var _c3=_bf.indexOf("/",_c1);var _c4=_bf.indexOf("?");var _c5=_bf.lastIndexOf("#");if(_c4>=0){_c2=_bf.substring(_c3+1,_c4);}else{if(_c5>=0&&_c3!=-1){_c2=_bf.substring(_c3+1,_c5);}else{if(_c3!=-1){_c2=_bf.substring(_c3+1);}}}return _c2;},_extractQuery:function(_c6){var _c7="";var _c8=_c6.split("?");if(_c8.length>1){_c7=_c8[1].split("#")[0];}return _c7;},_extractAnchor:function(_c9){var _ca="";var _cb=_c9.split("#");if(_cb.length>1){_ca=_cb[_cb.length-1];}return _ca;}});dojo.declare("com.ibm.mm.enabler.ArrayMap",null,{constructor:function(){this.entries=[];this.keys={};},values:function(){return this.entries;},put:function(key,_cd){var _ce=this.keys[key];if(typeof _ce!="undefined"&&_ce!=null){this.entries[_ce]=_cd;}else{_ce=this.entries.length;this.entries.push(_cd);this.keys[key]=_ce;}},getKey:function(_cf){if(_cf<this.entries.length){for(var key in this.keys){var _d1=this.keys[key];if(_d1!=null&&_d1==_cf){return _d1;}}}else{return null;}},getValue:function(_d2){if(_d2<this.entries.length){return this.entries[_d2];}else{return null;}},get:function(key){var _d4=this.keys[key];if(typeof _d4!="undefined"&&_d4!=null){var _d5=this.entries[_d4];return _d5;}return null;},remove:function(key){var _d7=this.keys[key];if(typeof _d7!="undefined"&&_d7!=null){this.entries.splice(_d7,1);this.keys[key]=null;}return _d7;},size:function(){return this.entries.length;},keySet:function(){var arr=[];for(var key in this.keys){arr.push(key);}return arr;}});}if(!dojo._hasResource["com.ibm.mm.enabler.iw.ItemSet"]){dojo._hasResource["com.ibm.mm.enabler.iw.ItemSet"]=true;dojo.provide("com.ibm.mm.enabler.iw.ItemSet");dojo.declare("com.ibm.mm.enabler.iw.ItemSet",null,{constructor:function(){},setItemValue:function(_da,_db,_dc){return this;},getItemValue:function(_dd){return null;},getAllNames:function(){return null;},removeItem:function(_de){return null;},clone:function(){return null;},isReadOnly:function(_df){return null;},getItemSetDescription:function(){return null;}});dojo.declare("com.ibm.mm.enabler.iw.ManagedItemSet",com.ibm.mm.enabler.iw.ItemSet,{constructor:function(){},save:function(_e0){}});}if(!dojo._hasResource["com.ibm.mm.enabler.iw.payloadDef"]){dojo._hasResource["com.ibm.mm.enabler.iw.payloadDef"]=true;dojo.provide("com.ibm.mm.enabler.iw.payloadDef");dojo.declare("com.ibm.mm.enabler.iw.payloadDef",null,{constructor:function(_e1,_e2,_e3,_e4,_e5){this.name=_e1;this.attributes=_e5;if(typeof (this.attributes)=="undefined"||this.attributes==null){this.attributes={};}if(typeof _e2!="undefined"&&_e2!=null){this.attributes["type"]=_e2;}if(typeof _e3!="undefined"&&_e3!=null){this.attributes["defaultValue"]=_e3;}if(typeof _e4!="undefined"&&_e4!=null){this.attributes["description"]=_e4;}this.attributeNames=[];this.attributeNames.push("type");this.attributeNames.push("defaultValue");this.attributeNames.push("description");var _e6;for(_e6 in _e5){this.attributeNames.push(_e6);}this.children=new com.ibm.mm.enabler.ArrayMap();},setAttribute:function(_e7,_e8){this.attributes[_e7]=_e8;if(typeof (this.attributeNames[_e7])!="undefined"){this.attributeNames.push(_e7);}},getAttribute:function(_e9){var _ea=this.attributes[_e9];if(typeof _ea=="undefined"){_ea=null;}return _ea;},getAttributeNames:function(){this.attributeNames;},getChildren:function(){return this.children.values();},getChild:function(_eb){return this.children.get(_eb);},setChild:function(_ec,_ed){this.children.put(_ec,_ed);},getChildrenNames:function(){this.children.keySet();},getName:function(){return this.name;},getType:function(){return this.attributes["type"];},getDefaultValue:function(){return this.attributes["defaultValue"];},getDescription:function(){return this.attributes["description"];}});}if(!dojo._hasResource["com.ibm.mm.enabler.iw.utils"]){dojo._hasResource["com.ibm.mm.enabler.iw.utils"]=true;dojo.provide("com.ibm.mm.enabler.iw.utils");dojo.declare("com.ibm.mm.enabler.iw.utils",null,{widgetClassRE:new RegExp("(mm:|mm_|iw-)iWidget"),findElementByAttribute:function(att,_ef,_f0,_f1,_f2){var _f3=_f0;if(!_f0.childNodes||_f0.childNodes==null){return false;}var _f4=_f3.childNodes;for(var i=0;i<_f4.length;i++){var _f6=_f4[i];if(_f6.nodeType==1){var _f7=_f6.className;if(_f7.match(this.widgetClassRE)){return false;}var _f8=_f6.getAttribute(att);if(att=="class"){_f8=_f6.className;}if(_ef==_f8){_f1.push(_f6);if(!_f2){return true;}}var rc=this.findElementByAttribute(att,_ef,_f6,_f1,_f2);if(!_f2&&rc){return rc;}}}if(_f1.length!=0){return true;}return false;},getClass:function(_fa){var _fb=_fa.getAttribute("class");_fb=_fb?_fb:_fa.getAttribute("className");return _fb;},checkParentElement:function(_fc,_fd){if(_fc){var _fe=_fc.parentNode;if(_fe){if(_fe.className){if(_fe.className.match(_fd)){return _fe.id;}}return this.checkParentElement(_fe,_fd);}}return null;},getWidgetParent:function(id,_100){if(id==null){return null;}if(!_100){_100=this.widgetClassRE;}return this.checkParentElement(dojo.byId(id),_100);},getParents:function(_101,arr){var _103=_101.getParent();if(typeof _103!="undefined"&&_103!=null){arr.push(_103);this.getParents(_103,arr);}return;},getPayloadDef:function(_104){var name=_104.getAttribute("name");var _106=new com.ibm.mm.enabler.iw.payloadDef(name);var _107=_104.attributes;for(var i=0;i<_107.length;i++){var _109=_107[i];if(_109.name!="name"){_106.setAttribute(_109.name,_109.value);}}var _10a=_104.childNodes;for(var j=0;j<_10a.length;j++){var _10c=_10a[j];if(_10c.nodeType==1){var _10d=this.getPayloadDef(_10c);_106.setChild(_10d.name,_10d);}}return _106;}});com.ibm.mm.enabler.iw.utils=new com.ibm.mm.enabler.iw.utils();}if(!dojo._hasResource["com.ibm.mm.enabler.iw.event"]){dojo._hasResource["com.ibm.mm.enabler.iw.event"]=true;dojo.provide("com.ibm.mm.enabler.iw.event");dojo.declare("com.ibm.mm.enabler.iw.iEvent",null,{constructor:function(){},name:"",type:"",payload:null,source:""});dojo.declare("com.ibm.mm.enabler.iw.iEventDescription",null,{constructor:function(){},name:"",type:"",aliases:null,handlingFn:"",getDescription:function(_10e){return null;},setOnRemoveWire:function(_10f){},getOnRemoveWire:function(){return null;},setOnNewWire:function(_110){},getOnNewWire:function(){return null;}});dojo.declare("com.ibm.mm.enabler.iw.iEvents",null,{constructor:function(){},publishEvent:function(_111,_112,_113){},fireEvent:function(_114,_115,_116){}});dojo.declare("com.ibm.mm.enabler.iw.iEventsConstants",null,{constructor:function(){},onLoad:"onLoad",onUnLoad:"onUnload",onModeChanged:"onModeChanged",onItemSetChanged:"onItemSetChanged",unloadWidget:"/enabler/unloadWidget",unSubscribeWire:"/enabler/unSubscribeWire",modeChanged:"modeChanged"});}if(!dojo._hasResource["com.ibm.mm.enabler.iw.io"]){dojo._hasResource["com.ibm.mm.enabler.iw.io"]=true;dojo.provide("com.ibm.mm.enabler.iw.io");dojo.require("com.ibm.mm.enabler.utilities");dojo.declare("com.ibm.mm.enabler.iw.io",null,{constructor:function(id){this.id=id;var _118=iWidgetContainer.getWidgetById(this.id);var _119=_118.getWidgetInstance().widgetXMLUrl;this.widgetBaseUri=_119.substring(0,_119.lastIndexOf("/")+1);this.widgetBaseUriXhr=com.ibm.mm.enabler.utilities.rewriteURL(this.widgetBaseUri);if(this.widgetBaseUri.indexOf("://")!=-1){var _11a=this.widgetBaseUri.indexOf("://");var _11b=this.widgetBaseUri.indexOf("/",_11a+3);this.serverRoot=this.widgetBaseUri.substring(0,_11b);this.serverRootXhr=com.ibm.mm.enabler.utilities.rewriteURL(this.serverRoot);}},rewriteURI:function(uri,_11d){com.ibm.mm.enabler.debug.entry("com.ibm.mm.enabler.iw.io.rewriteURI",uri+" isXhr:"+_11d);if(typeof _11d=="undefined"){_11d=true;}var _11e=uri;if(_11d){if(uri.indexOf("://")!=-1){_11e=com.ibm.mm.enabler.utilities.rewriteURL(uri);}else{if(uri.indexOf("/")==0){if(typeof (this.serverRootXhr)!="undefined"){_11e=this.serverRootXhr+uri;}}else{if(typeof (this.widgetBaseUriXhr)!="undefined"){_11e=this.widgetBaseUriXhr+uri;}}}}else{if(uri.indexOf("://")==-1){if(uri.indexOf("/")==0){if(typeof (this.serverRootXhr)!="undefined"){_11e=this.serverRoot+uri;}}else{if(typeof (this.widgetBaseUri)!="undefined"){_11e=this.widgetBaseUri+uri;}}}}com.ibm.mm.enabler.debug.exit("com.ibm.mm.enabler.iw.io.rewriteURI",_11e);return _11e;},getWebAppRootPath:function(){var _11f="/";if(typeof (this.widgetBaseUri)!="undefined"){_11f=this.widgetBaseUri;if(_11f.length>0){if(_11f.indexOf("://")>0){var _120=_11f.split("/");if(_120.length>=4){_11f=_120[0]+"//"+_120[2]+"/"+_120[3]+"/";}else{_11f="/";}}}}return _11f;},request:function(_121,uri,_123,_124,_125){var xhr=dojo._xhrObj();var _127=this.rewriteURI(uri);var _128=false;if(_123){xhr.onreadystatechange=_123;_128=true;}var _129=_121;if(typeof _121=="undefined"||_121==null){_129=this.httpmethods.GET;}if(typeof _121!="undefined"&&_121!=null){if(!this.httpmethods[_121]){_129=this.httpmethods.GET;}}xhr.open(_129,_127,_128);console.debug(_129+" "+_127);var _12a="application/x-www-form-urlencoded";if(_125){for(var i=0;i<_125.length;i++){var _12c=_125[i];var _12d=_12c[_12d];var _12e=_12c[_12e];if(_12d=="Content-Type"){var _12f=_12e;}else{xhr.setRequestHeader(_12d,_12e);}}}xhr.setRequestHeader("Content-Type",(_12f||_12a));if(_129==this.httpmethods.PUT||_129==this.httpmethods.POST){if(_124){xhr.send(_124);}}else{xhr.send(null);}return xhr;},httpmethods:{GET:"GET",PUT:"PUT",POST:"POST",DELETE:"DELETE",HEAD:"HEAD",OPTIONS:"OPTIONS"}});}if(!dojo._hasResource["com.ibm.mm.enabler.iw.iContext"]){dojo._hasResource["com.ibm.mm.enabler.iw.iContext"]=true;dojo.provide("com.ibm.mm.enabler.iw.iContext");dojo.declare("com.ibm.mm.enabler.iw.iContext",null,{constructor:function(){},constants:{mode:{VIEW:"view",EDIT:"edit",HELP:"help"},ATTRIBUTES:"attributes",IDESCRIPTOR:"idescriptor",USERPROFILE:"userprofile",keys:{SHIFT:1,ALT:2,CTRL:4,META:8,CAPSLOCK:16}},getRootElement:function(){return null;},getElementById:function(id,root){return null;},getiWidgetAttributes:function(){return {};},getItemSet:function(name,_133){return null;},requires:function(_134,_135,uri,cb,_138){},iScope:function(){return null;},processMarkup:function(_139){return null;},processiWidgets:function(root){},getElementByClass:function(_13b,root){return null;},getUserProfile:function(){return null;},getiDescriptor:function(){return null;}});}if(!dojo._hasResource["com.ibm.mm.enabler.iw.iContextImpl"]){dojo._hasResource["com.ibm.mm.enabler.iw.iContextImpl"]=true;dojo.provide("com.ibm.mm.enabler.iw.iContextImpl");dojo.declare("com.ibm.mm.enabler.iw.iContextImpl",com.ibm.mm.enabler.iw.iContext,{constructor:function(id){this.widgetId=id;this.scope={};this.iEvents=new com.ibm.mm.enabler.iw.iEventsImpl(this.widgetId);this.io=new com.ibm.mm.enabler.iw.io(this.widgetId);this.rootElement=document.getElementById(id);this.ns=this.rootElement.className.substr(0,3);this._mm=new com.ibm.mm.enabler.iw.iContextImpl.mmExtension(this.widgetId);},getRootElement:function(){return this.rootElement;},getElementById:function(id,root){com.ibm.mm.enabler.debug.entry("iContext.getElementById ","id:"+id+" root:"+root);if(!root){root=this._getContentRoot();}var _140=[];var rc=com.ibm.mm.enabler.iw.utils.findElementByAttribute("id",id,root,_140,false);com.ibm.mm.enabler.debug.log("iContext.getElementById","found:"+rc);if(rc){return _140[0];}else{return null;}},getiWidgetAttributes:function(){var _142=iWidgetContainer.getWidgetById(this.widgetId);var _143=_142.getWidgetAttributes();return _143;},getItemSet:function(name){com.ibm.mm.enabler.debug.entry("iContext.getItemSet","name:"+name);if(typeof name=="undefined"||name==null){return null;}if(name==iwConstants.ATTRIBUTES){return this.getiWidgetAttributes();}if(name==iwConstants.USERPROFILE){return this.getUserProfile();}if(name==iwConstants.IDESCRIPTOR){return this.getiDescriptor();}var _145=iWidgetContainer.getWidgetById(this.widgetId);var _146=_145.getWidgetItemSet(name);if(typeof _146=="undefined"||_146==null){_146=new com.ibm.mm.enabler.iw.DefaultItemSetImpl();}com.ibm.mm.enabler.debug.exit("iContext.getItemSet","object:"+_146);return _146;},requires:function(_147,_148,uri,cb,_14b){if(typeof _14b=="undefined"||_14b==null){_14b="text/plain";}if(typeof uri!="undefined"&&uri!=null){serviceManager.getService("loadService").loadResource(this.widgetId,_147,uri,cb,_14b);}},iScope:function(){return this.scope;},processMarkup:function(_14c){var _14d=_14c.replace(/_IWID_/g,"_"+this.widgetId+"_");var _14e=_14d.replace(/iContext(?=\.|\s|\(|\))/g,"_"+this.widgetId+"_iContext");return _14e;},processiWidgets:function(root){dojo.publish("/com/ibm/mashups/livetext/livetextchanged",[root,true]);},getElementByClass:function(_150,root){if(!root){root=this._getContentRoot();}var _152=[];var rc=com.ibm.mm.enabler.iw.utils.findElementByAttribute("class",_150,root,_152,true);com.ibm.mm.enabler.debug.log("iContext.getElementByClass","found:"+rc);if(rc){return _152;}else{return null;}},_getWidgetBaseUri:function(){var _154=iWidgetContainer.getWidgetById(this.widgetId);var _155=_154.getWidgetInstance().widgetXMLUrl;return _155.substring(0,_155.lastIndexOf("/")+1);},_getContentRoot:function(){var _156=this.rootElement;var _157=iWidgetContainer.getWidgetById(this.widgetId);if(_157){var _158=_157.currentMode;}if(!_158){_158="view";}var _159=_157.windowManager[_158];if(typeof _159!="undefined"&&_159!=null){var temp=_159.root;if(typeof temp!="undefined"||temp!=null){_156=temp;}}com.ibm.mm.enabler.debug.exit("iContext._getContentRoot",_156);return _156;},getUserProfile:function(){var _15b=com.ibm.mashups.enabler.model.Factory.getUserModel();var user=_15b.findCurrentUser();var _15d=null;if(typeof user!="undefined"&&user!=null){_15d=new com.ibm.mm.enabler.iw.UserProfile(this.widgetId,user);}return _15d;},getiDescriptor:function(){var _15e=iWidgetContainer.getWidgetById(this.widgetId);var _15f=_15e.getIDescriptor();return _15f;}});dojo.declare("com.ibm.mm.enabler.iw.iContextImpl.mmExtension",null,{constructor:function(id){this.widgetId=id;},getSupportedModes:function(){var _161=iWidgetContainer.getWidgetById(this.widgetId);var _162=_161.widgetDef.getSupportedModes();return _162;},getPayloadDef:function(name){if(typeof this.widget=="undefined"||this.widget==null){this.widget=iWidgetContainer.getWidgetById(this.widgetId);}var _164=this.widget.widgetDef.payloadDefs;var _165=_164[name];if(typeof _165=="undefined"){return null;}return _165;},getPayloadDefNames:function(){if(typeof this.widget=="undefined"||this.widget==null){this.widget=iWidgetContainer.getWidgetById(this.widgetId);}var _166=this.widget.widgetDef.payloadDefs;var arr=[];var a;for(a in _166){arr.push(a);}return arr;}});}if(!dojo._hasResource["com.ibm.mm.enabler.iw.ItemSetImpl"]){dojo._hasResource["com.ibm.mm.enabler.iw.ItemSetImpl"]=true;dojo.provide("com.ibm.mm.enabler.iw.ItemSetImpl");dojo.declare("com.ibm.mm.enabler.iw.Item",null,{constructor:function(name,_16a,_16b,_16c){this.name=name;this.value=_16a;this.descriptionId=_16c;if(typeof _16b=="undefined"||_16b==null){this.isReadOnly=false;}else{this.isReadOnly=_16b;}}});dojo.declare("com.ibm.mm.enabler.iw.DefaultItemSetImpl",com.ibm.mm.enabler.iw.ItemSet,{constructor:function(_16d,name,_16f,_170,_171){if(_16d){this.parent=_16d.id;this.scope=_16d.iScope;}this.name=name;this.onItemSetChanged=_16f;this.description=_170;this.isPrivate=_171;this.items={};this.listeners={};if(_16f){this.listeners[_16f]=_16f;}this._debug=com.ibm.mm.enabler.debug;},addListener:function(fn){this.listeners[fn.toString()]=fn;},removeListener:function(fn){if(this.listeners[fn.toString()]){this.listeners[fn.toString()]=null;}},setItemValue:function(_174,_175,_176){this._debug.log("ItemSet.setItemValue ","itemName:"+_174,"value:"+_175,"readOnly:"+_176);if(typeof _175=="undefined"){return null;}var _177=false;if(!(typeof _176=="undefined"||_176==null)){_177=_176;}this._debug.log("ManagedItemSet.setItemValue","creating new Item ("+"itemName:"+_174+" value:"+_175+" readOnly:"+_176+")");var item=new com.ibm.mm.enabler.iw.Item(_174,_175,_177);if(this.items[_174]){this._debug.log("ManagedItemSet.setItemValue","Itemset readOnly is "+this.items[_174].isReadOnly);if(this.items[_174].isReadOnly=="true"){return null;}else{var _179={itemSetName:this.name,changeType:"changedValue"};_179.old=this.items[_174].value;_179["new"]=_175;var _17a=new com.ibm.mm.enabler.iw.iEventImpl("onItemSetChanged",null,_179);this.items[_174]=item;this._handleOnItemSetChanged(_17a);}}else{var _179={itemSetName:this.name,changeType:"newItem"};_179["new"]=_175;var _17a=new com.ibm.mm.enabler.iw.iEventImpl("onItemSetChanged",null,_179);this.items[_174]=item;this._handleOnItemSetChanged(_17a);}return this;},getItemValue:function(_17b){var _17c=this.items[_17b];if(typeof _17c=="undefined"||_17c==null){return null;}var _17d=this.items[_17b].value;if(typeof _17d=="undefined"||_17d==null){return null;}return _17d;},getAllNames:function(){if(typeof this.items=="undefined"||this.items==null){return null;}var _17e=new Array();var _17f;var i=0;for(_17f in this.items){_17e.push(_17f);i=i+1;}if(i==0){return null;}return _17e;},removeItem:function(_181){if(this.items[_181]){if(this.items[_181].isReadOnly&&this.items[_181].isReadOnly=="true"){return null;}else{if(this.items[_181]==null){return null;}}}var _182={itemSetName:this.name,changeType:"removedItem"};_182.old=this.items[_181].value;var _183=new com.ibm.mm.enabler.iw.iEventImpl("onItemSetChanged",null,_182);this.items[_181]=null;this._handleOnItemSetChanged(_183);return this;},clone:function(){var _184=new com.ibm.mm.enabler.iw.DefaultItemSetImpl(null,this.name);var arr=this.items;var _186;for(_186 in arr){var _187=new com.ibm.mm.enabler.iw.Item();_187=dojo.mixin(_187,this.items[_186]);_184.items[_187.name]=_187;}return _184;},isReadOnly:function(_188){this._debug.entry("ManagedItemSet.isReadOnly","itemName:"+_188);var _189=this.items[_188];if(typeof _189=="undefined"||_189==null){return false;}return _189.isReadOnly;},getItemSetDescription:function(){return null;},_handleOnItemSetChanged:function(_18a){for(var i=0;i<this.listeners;i++){var fn=this.listeners[i];if(fn!=null&&this.scope){dojo.hitch(this.scope,fn)(_18a);}}}});dojo.declare("com.ibm.mm.enabler.iw.iDescriptor",com.ibm.mm.enabler.iw.ManagedItemSet,{constructor:function(_18d,_18e,_18f){this.widgetId=_18d;this.defiDescriptorItems=_18e;this.instanceiDescriptorItems=_18f;},getItemValue:function(name){var _191=null;if(typeof name!="undefined"&&name!=null&&name==iwConstants.iDescriptorItems.mode){var _192=this._getWidgetWrapper();if(_192!=null){_191=_192.currentMode;}}else{_191=this._getItemValue(name);}return _191;},_getItemValue:function(_193){if(this.defiDescriptorItems!=null){var _194=this.defiDescriptorItems[_193];}if(this.instanceiDescriptorItems!=null){var _195=this.instanceiDescriptorItems[_193].defaultValue;}if(typeof _195!="undefined"||_195!=null){return _195;}if(typeof _194=="undefined"){_194=null;}return _194;},setItemValue:function(name,_197,_198){return null;},isReadOnly:function(name){return true;},_getWidgetWrapper:function(){if(this.widgetId){var _19a=iWidgetContainer.widgetArr[this.widgetId];if(_19a&&_19a!=null){return _19a;}}return null;},removeItem:function(name){return null;},getAllNames:function(){var arr={};if(this.defiDescriptorItems!=null){for(var i in this.defiDescriptorItems){arr[i]=true;}}if(this.instanceiDescriptorItems!=null){for(var j in this.instanceiDescriptorItems){arr[j]=true;}}var _19f=[];for(var name in arr){_19f.push(name);}return _19f;},save:function(cb){return null;},getItemSetDescription:function(){return null;}});dojo.declare("com.ibm.mm.enabler.iw.InternalPersistentAttributesToPreferenceModelAdapter",com.ibm.mm.enabler.iw.ManagedItemSet,{constructor:function(_1a2,_1a3){this.xmlItems={};this.microformatItems={};this.serverless=(_1a3==true);this.modes=com.ibm.mm.enabler.iw.ItemSet._internalIbmModes;this.widget=_1a2;},setItemValue:function(_1a4,_1a5,_1a6,_1a7){_1a5=_1a5?_1a5:"";_1a5=""+_1a5;if(typeof _1a6=="string"){_1a6=(_1a6.toLowerCase()=="true");}else{_1a6=(_1a6==true);}if(this.serverless){var mode=this._getMode(_1a7);if(mode!=this.modes.xml&&mode!=this.modes.microformat){return null;}var _1a9=this.xmlItems[_1a4];if(_1a9&&_1a9.readOnly){return null;}if(mode==this.modes.xml){this.xmlItems[_1a4]={value:_1a5,readOnly:_1a6};return this;}var _1aa=this.microformatItems[_1a4];if(_1aa&&_1aa.readOnly){return null;}this.microformatItems[_1a4]={value:_1a5,readOnly:_1a6};return (this);}return null;},getItemValue:function(_1ab,_1ac,_1ad){if(this.serverless){var mode=this._getMode(_1ac);if(mode!=this.modes.xml&&mode!=this.modes.microformat){return null;}if(_1ad==undefined){_1ad=true;}var _1af=this.xmlItems[_1ab];var _1b0=this.microformatItems[_1ab];if(mode==this.modes.xml){if(!_1af){return null;}return _1af.value;}if(_1ad&&_1af&&(_1af.readOnly||(!_1b0))){return _1af.value;}if(!_1b0){return null;}var _1b1=_1b0.value;return _1b1;}return null;},getAllNames:function(_1b2,_1b3){if(this.serverless){var mode=this._getMode(_1b2);if(mode!=this.modes.xml&&mode!=this.modes.microformat){return null;}if(_1b3==undefined){_1b3=true;}if(!_1b3){if(mode==this.modes.xml){return this._getNamesArray(this.xmlItems);}return this._getNamesArray(this.microformatItems);}var _1b5={};var name;for(name in this.xmlItems){_1b5[name]=true;}for(name in this.microformatItems){_1b5[name]=true;}return this._getNamesArray(_1b5);}return null;},removeItem:function(_1b7,_1b8){if(this.serverless){var mode=this._getMode(_1b8);if(mode!=this.modes.microformat){return null;}if(this.microformatItems[_1b7]){delete this.microformatItems[_1b7];}return this;}return null;},clone:function(){return null;},isReadOnly:function(_1ba,_1bb,_1bc){if(this.serverless){var mode=this._getMode(_1bb);if(mode!=this.modes.xml&&mode!=this.modes.microformat){return false;}if(_1bc==undefined){_1bc=true;}var _1be=this.xmlItems[_1ba];var _1bf=this.microformatItems[_1ba];if(mode==this.mode.xml){if(!_1be){return false;}return _1be.readOnly;}if(_1bc&&_1be&&(_1be.readOnly||(!_1bf))){return _1be.readOnly;}if(!_1bf){return false;}return _1bf.readOnly;}return null;},save:function(_1c0){if(this.serverless){this._saveMicroformat();}else{return null;}this.reload();if(_1c0){_1c0();}return (this);},reload:function(){if(this.serverless){return this;}return null;},_getNamesArray:function(_1c1){var i=0;var _1c3=new Array();var name;for(name in _1c1){_1c3.push(name);i++;}if(i==0){return null;}return _1c3;},_saveMicroformat:function(){var _1c5;var i;var ns=this.widget.ns;var root=this.widget.rootElement;_1c5=dojo.query("span."+ns+"ItemSet[title=\""+iwConstants.ATTRIBUTES+"\"]",root);for(i=0;i<_1c5.length;i++){var _1c9=_1c5[i];if(root==_1c9.parentNode){root.removeChild(_1c9);}}var _1ca=document.createElement("span");_1ca.className=ns+"ItemSet";_1ca.title=iwConstants.ATTRIBUTES;_1ca.style.display="none";_1ca.style.visibility="hidden";root.appendChild(_1ca);var _1cb=this.getAllNames(this.modes.microformat,false);if(!_1cb){return;}for(i=0;i<_1cb.length;i++){var _1cc=_1cb[i];var _1cd=this.getItemValue(_1cc,this.modes.microformat,false);var _1ce=document.createElement("a");_1ce.className=ns+"Item";_1ce.style.visibility="hidden";_1ce.style.display="none";_1ce.href="#"+_1cc;_1ce.appendChild(document.createTextNode(_1cd));_1ca.appendChild(_1ce);}},_setMode:function(mode){this._mode=mode;},_getMode:function(_1d0){if(_1d0){return _1d0;}if(!this._mode){this._mode=this.modes.microformat;}return this._mode;}});dojo.declare("com.ibm.mm.enabler.iw.PersistentAttributes",com.ibm.mm.enabler.iw.ManagedItemSet,{constructor:function(_1d1,_1d2,_1d3){this._internalPersistentAttributesToPreferenceModelAdapter=new com.ibm.mm.enabler.iw.InternalPersistentAttributesToPreferenceModelAdapter(_1d1,_1d2,_1d3);},setItemValue:function(_1d4,_1d5,_1d6){return this._internal().setItemValue(_1d4,_1d5,_1d6);},getItemValue:function(_1d7){return this._internal().getItemValue(_1d7);},getAllNames:function(){return this._internal().getAllNames();},removeItem:function(_1d8){return this._internal().removeItem(_1d8);},clone:function(){return this._internal().clone();},isReadOnly:function(_1d9,_1da,_1db){return this._internal().isReadOnly(_1d9);},save:function(_1dc){return this._internal().save(_1dc);},_internal:function(){return this._internalPersistentAttributesToPreferenceModelAdapter;}});com.ibm.mm.enabler.iw.ItemSet._internalIbmModes={view:"view",edit:"edit",edit_default:"edit_default",microformat:"com.ibm.microformat",configure:"configure",xml:"com.ibm.xml",help:"help"};dojo.declare("com.ibm.mm.enabler.iw.UserProfile",com.ibm.mm.enabler.iw.ManagedItemSet,{constructor:function(_1dd,user){this.widgetId=_1dd;this.user=user;},getItemValue:function(name){var _1e0=this.user.getAttribute(name);if(typeof _1e0=="undefined"){_1e0=null;}return _1e0;},setItemValue:function(name,_1e2,_1e3){return null;},isReadOnly:function(name){return true;},removeItem:function(name){return null;},getAllNames:function(){return this.user.getAttributeNames();},save:function(cb){return null;},getItemSetDescription:function(){return null;}});}if(!dojo._hasResource["com.ibm.mm.enabler.iw.eventImpl"]){dojo._hasResource["com.ibm.mm.enabler.iw.eventImpl"]=true;dojo.provide("com.ibm.mm.enabler.iw.eventImpl");dojo.declare("com.ibm.mm.enabler.iw.iEventImpl",com.ibm.mm.enabler.iw.iEvent,{constructor:function(name,type,_1e9,_1ea){this.name=name;if(typeof type!="undefined"){this.type=type;}else{this.type=null;}if(typeof _1e9!="undefined"){this.payload=_1e9;}else{this.payload=null;}if(typeof _1ea!="undefined"){this.source=_1ea;}else{this.source=null;}this.source=_1ea;}});dojo.declare("com.ibm.mm.enabler.iw.iEventDescriptionImpl",com.ibm.mm.enabler.iw.iEventDescription,{constructor:function(name,_1ec,type,_1ee,_1ef,_1f0,_1f1){this.name=name;if(typeof type!="undefined"){this.type=type;}else{this.type=null;}if(typeof _1ee!="undefined"){this.description=_1ee;}else{this.description=null;}if(typeof _1ef!="undefined"){this.aliases=_1ef;}else{this.aliases=null;}if(typeof _1ec!="undefined"){this.handlingFn=_1ec;}else{this.handlingFn=null;}this.lang=_1f0;this.descriptions=_1f1;},getDescription:function(_1f2){return this._getLocalizedAttribute("description",_1f2);},getTitle:function(_1f3){return this._getLocalizedAttribute("title",_1f3);},_getLocalizedAttribute:function(_1f4,_1f5){var _1f6=null,_1f7=null;var _1f8=com.ibm.mm.enabler.utilities.getLocale(this,_1f5,this.lang);if(typeof this.descriptions!="undefined"&&this.descriptions!=null){_1f7=this.descriptions[_1f8];if(typeof _1f7!="undefined"&&_1f7!=null){_1f6=_1f7[_1f4];}}if(typeof _1f6=="undefined"||_1f6==null){_1f6=this[_1f4];}if(typeof _1f6=="undefined"){_1f6=null;}return _1f6;},setOnRemoveWire:function(_1f9){if(typeof _1f9=="undefined"||_1f9===null){_1f9="onRemoveWire";}this.onRemoveWire=_1f9;},getOnRemoveWire:function(){if(this.onRemoveWire){return this.onRemoveWire;}return null;},setOnNewWire:function(_1fa){if(typeof _1fa=="undefined"||_1fa===null){_1fa="onNewWire";}this.onNewWire=_1fa;},getOnNewWire:function(){if(this.onNewWire){return this.onNewWire;}return null;},getLocales:function(){var _1fb=[];if(typeof this.descriptions!="undefined"&&this.descriptions!=null){for(var i in this.descriptions){_1fb.push(i);}}return _1fb;}});dojo.declare("com.ibm.mm.enabler.iw.iEventsImpl",com.ibm.mm.enabler.iw.iEvents,{constructor:function(id){this.id=id;},publishEvent:function(_1fe,_1ff,_200){var _201=iWidgetContainer.getWidgetById(this.id);var _202=new com.ibm.mm.enabler.iw.iEventImpl(_1fe,_200,_1ff,null);var _203=_201.handleEvent(_1fe,_202);if(!_203){iWidgetContainer.eventService.publishWire(this.id,_1fe,_1ff,_200);}},fireEvent:function(_204,_205,_206){var _207=iWidgetContainer.getWidgetById(this.id);var _208=new com.ibm.mm.enabler.iw.iEventImpl(_204,_205,_206,null);var _209=_207.handleEvent(_204,_208);if(!_209){serviceManager.getService("eventService").publishWire(this.id,_204,_206,_205);}},addWire:function(_20a,_20b,_20c){iWidgetContainer.eventService.addWire(this.id,_20a,_20b,_20c);}});dojo.declare("com.ibm.mm.enabler.iw.eventHolder",null,{constructor:function(id,data){this.targetId=id;this.data=data;},handleLoaded:function(){if(this.handler){dojo.unsubscribe(this.handler);}dojo.publish("/enabler/eventService/"+this.targetId,this.data);}});com.ibm.mm.enabler.iw.iEvents.Constants=new com.ibm.mm.enabler.iw.iEventsConstants();}if(!dojo._hasResource["com.ibm.mm.enabler.iw.widget"]){dojo._hasResource["com.ibm.mm.enabler.iw.widget"]=true;dojo.provide("com.ibm.mm.enabler.iw.widget");dojo.declare("com.ibm.mm.enabler.iw.iWidgetWrapper",null,{constructor:function(id){},getiWidgetMetadata:function(){},getInstanceAttributes:function(){}});dojo.declare("com.ibm.mm.enabler.iw.iWidgetMetadata",null,{CONSTANTS:{"title":"title","icon":"icon"},constructor:function(id){},getItemValue:function(_211){},setItemValue:function(_212,_213){},save:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.iw.widgetImpl"]){dojo._hasResource["com.ibm.mm.enabler.iw.widgetImpl"]=true;dojo.provide("com.ibm.mm.enabler.iw.widgetImpl");dojo.declare("com.ibm.mm.enabler.iw.iWidgetWrapperImpl",com.ibm.mm.enabler.iw.iWidgetWrapper,{constructor:function(id){this.id=id;},getiWidgetMetadata:function(){return new com.ibm.mm.enabler.iw.iWidgetMetadataImpl(this.id);},getInstanceAttributes:function(){var _215=iWidgetContainer.getWidgetById(this.id);if(typeof _215=="undefined"||_215===null){return null;}_215.getWidgetInstance().loadItemSets();var _216=_215.getWidgetInstance().getWidgetAttributes();var _217=new com.ibm.mm.enabler.iw.DefaultItemSetImpl();for(var j in _216){var _219=j;var _21a=_216[_219]["defaultValue"];_217.setItemValue(_219,_21a,false);}return _217;}});dojo.declare("com.ibm.mm.enabler.iw.iWidgetMetadataImpl",com.ibm.mm.enabler.iw.iWidgetMetadata,{constructor:function(id){this._id=id;this._items={};this._debug=com.ibm.mm.enabler.debug;},getItemValue:function(_21c){if(typeof _21c=="undefined"||_21c===null){return null;}if(!this.CONSTANTS[_21c]){return null;}var _21d=this._getInternalIWidgetWrapper();if(_21d===null){return null;}var data=this._items[_21c];if(typeof data=="undefined"||data===null){if(!this._loadData(_21c)){return null;}data=this._items[_21c];}if(data["detail"]!="undefined"&&data["detail"]!=null&&data["detail"]["defaultValue"]!="undefined"&&data["detail"]["defaultValue"]!=null){return data.detail.defaultValue;}else{return null;}},setItemValue:function(_21f,_220){if(typeof _21f=="undefined"||_21f==null||typeof _220=="undefined"||_220===null){return null;}if(!this.CONSTANTS[_21f]){return null;}var data=this._items[_21f];if(typeof data=="undefined"||data===null){this._loadData(_21f);}this._items[_21f].isDirty=true;this._items[_21f].detail.defaultValue=_220;},save:function(){var _222=this._getInternalIWidgetWrapper().getWidgetInstance().getiDescriptor();for(var item in this._items){var _224=this._items[item];if(_224.isDirty||_224.isDirty==true){_224.isDirty=false;this._updateMarkup(_224.detail);}}},_getInternalIWidgetWrapper:function(){if(typeof (this._internalWidgetWrapper)=="undefined"||this._internalWidgetWrapper===null){var _225=iWidgetContainer.getWidgetById(this._id);if(typeof _225=="undefined"||_225===null){return null;}this._internalWidgetWrapper=_225;}return this._internalWidgetWrapper;},_loadData:function(_226){var rc=false;var _228={};var _229=this._getInternalIWidgetWrapper().getWidgetInstance().getiDescriptor();if(_229!=null&&typeof (_229[_226])!="undefined"&&_229[_226]!=null){var _22a=dojo.toJson(_229[_226]);_228.isDirty=true;_228.detail=dojo.fromJson(_22a);rc=true;}else{_228.detail={};_228.detail.itemName=_226;_228.isDirty=false;}this._items[_226]=_228;return rc;},_updateMarkup:function(_22b){var _22c=_22b.itemName;var _22d=_22b.defaultValue;var _22e=serviceManager.getService("iWidgetFragmentService");var _22f=_22e.getItemSet(this._id,iwConstants.IDESCRIPTOR);if(_22f==null){var node=_22e.createItemSet(iwConstants.IDESCRIPTOR);var _231=dojo.byId(this._id);_231.insertBefore(node,_231.firstChild.nextSibling);_22f=_22e.getItemSet(this._id,iwConstants.IDESCRIPTOR);}var _232=_22e.getItem(_22f,_22c);if(_232==null){var node=_22e.createItem(_22c,_22d);_22f.appendChild(node);}else{_232.innerHTML=_22d;}this._getInternalIWidgetWrapper().getWidgetInstance().loadItemSets();}});dojo.declare("com.ibm.mm.enabler.iw.WidgetStub",null,{constructor:function(_233){this.id=_233.id;this.wires=_233.getWires();this.publishedEvents=_233.getPublishedEvents();this.handledEvents=_233.getHandledEvents();this.payloadDefs=_233.widgetDef.getPayloadDefs();this.supportedModes=_233.widgetDef.getSupportedModes();},getPublishedEventsNames:function(){if(!this.publishedEvents){return null;}var _234=[];var _235;for(_235 in this.publishedEvents){_234.push(_235);}if(_234.length==0){return null;}return _234;},getHandledEventsNames:function(){if(!this.handledEvents){return null;}var _236=[];var _237;for(_237 in this.handledEvents){_236.push(_237);}if(_236.length==0){return null;}return _236;},getPublishedEvent:function(_238){if(!this.publishedEvents){return null;}return this.publishedEvents[_238];},getHandledEvent:function(_239){if(!this.handledEvents){return null;}return this.handledEvents[_239];},getPayloadDefs:function(){return this.payloadDefs;},getPayloadDef:function(name){var _23b=this.payloadDefs[name];if(typeof _23b=="undefined"){return null;}return _23b;},getPayloadDefNames:function(){var arr=[];var a;for(a in this.payloadDefs){arr.push(a);}if(arr.length==0){return null;}return arr;},getWires:function(){var arr=this.wires;if(typeof arr=="undefined"){arr=null;}else{if(arr.length&&arr.length==0){arr=null;}}return arr;},getSupportedModes:function(){return this.supportedModes;}});dojo.declare("com.ibm.mm.enabler.iw.WidgetDefinition",null,{constructor:function(name,_240,_241,_242,_243,uri,_245,_246,_247,_248,_249,_24a){var arg1=name;if(dojo.isString(arg1)){this.name=name;this.markup=_240;this.iScope=_241;this.itemSetsArr=_242;this.uri=uri;this.widgetEvents=_243;this.publishedEvents=_246;this.handledEvents=_247;this.supportedModes=_245;this.resources=_248;this.payloadDefs=_249;this.iDescriptor=_24a;}else{this.name=arg1["name"];this.markup=arg1["markup"];this.metaData=arg1["metaData"];this.events=arg1["events"];this.itemSets=arg1["itemSets"];this.resources=arg1["resources"];this.payloadDefs=arg1["payloadDefs"];this.iScope=this.metaData["iScope"];this.supportedModes=this.metaData["supportedModes"];this.uri=this.metaData["contentURI"];var _24c;this.widgetEvents={};for(_24c in this.metaData){if(_24c.indexOf("on")==0){this.widgetEvents[_24c]=this.metaData[_24c];}}var _24d=arg1["events"]["publishedEvents"];this.publishedEvents={};this.handledEvents={};var _24e;for(_24e in _24d){var _24c=_24d[_24e];var _24f=new com.ibm.mm.enabler.iw.iEventDescriptionImpl(_24c.eventName,_24c.payloadType,_24c.description,_24c.onEvent);if(!this.publishedEvents[_24e]){this.publishedEvents[_24e]=[];}this.publishedEvents[_24e].push(_24f);}var _250=arg1["events"]["handledEvents"];for(_24e in _250){var _24c=_250[_24e];var _24f=new com.ibm.mm.enabler.iw.iEventDescriptionImpl(_24c.eventName,_24c.payloadType,_24c.description,_24c.onEvent);if(!this.handledEvents[_24e]){this.handledEvents[_24e]=[];}this.handledEvents[_24e].push(_24f);}var _251;this.itemSetsArr={};for(_251 in arg1["itemSets"]){var _252=arg1["itemSets"][_251];if(_251=="attributes"){var _253=new com.ibm.mm.enabler.iw.DefaultItemSetImpl(_252.name,_252.onItemSetChanged);}else{var _253=new com.ibm.mm.enabler.iw.DefaultItemSetImpl(_252.name,_252.onItemSetChanged);}_253["itemLists"]["items"]=_252["itemLists"];this.itemSetsArr[_251]=_253;}}},getPublishedEvents:function(){return this.publishedEvents;},getHandledEvents:function(){return this.handledEvents;},getAttributes:function(){var _254=this.itemSetsArr["attributes"];if(typeof _254=="undefined"||_254==null){_254={name:"attributes",items:{}};}if(typeof (this.uri)!="undefined"&&_254!=null){_254.items["contentURI"]={id:"contentURI",value:this.uri,readOnly:false};}if(typeof (this.supportedModes)!="undefined"&&_254!=null){_254.items["supportedModes"]={id:"supportedModes",value:this.uri,readOnly:false};}return _254;},getAllItemSetNames:function(){var _255=new Array();if(typeof (this.itemSetsArr)=="undefined"||this.itemSetsArr==null){return _255;}var i=0;for(itemName in this.itemSetsArr){var _257=this.itemSetsArr[itemName];if(typeof (_257)!="undefined"){_255[i]=_257.name;}i++;}return _255;},getItemSet:function(name){if(name=="attributes"){return this.getAttributes();}var _259=this.itemSetsArr[name];if(typeof (_259)!="undefined"){return _259;}return null;},getPublishedEventsNames:function(){if(!this.publishedEvents){return null;}var _25a=[];var _25b;for(_25b in this.publishedEvents){_25a.push(_25b);}return _25a;},getHandledEventsNames:function(){if(!this.handledEvents){return null;}var _25c=[];var _25d;for(_25d in this.handledEvents){_25c.push(_25d);}return _25c;},getPublishedEvent:function(_25e){if(!this.publishedEvents){return null;}return this.publishedEvents[_25e];},getHandledEvent:function(_25f){if(!this.handledEvents){return null;}return this.handledEvents[_25f];},getWidgetName:function(){return this.name;},getPayloadDefs:function(){return this.payloadDefs;},getPayloadDef:function(name){var _261=this.payloadDefs[name];if(typeof _261=="undefined"){return null;}return _261;},getPayloadDefNames:function(){var arr=[];var a;for(a in this.payloadDefs){arr.push(a);}return arr;},getSupportedModes:function(){var temp=this.supportedModes;if(typeof temp=="undefined"||temp==null){return null;}var arr=temp.split(" ");return arr;},getiDescriptor:function(){return null;},getMarkupByMode:function(mode){return this.markup;},getWidgetEvents:function(){return this.widgetEvents;},getIScope:function(){return this.iScope;},getResources:function(){return this.resources;},getDefaultLanguage:function(){return "en";},getMarkup:function(){return this.markup;},getAllowInstanceContent:function(){return false;}});dojo.declare("com.ibm.mm.enabler.iw.standardWidgetDefinition",null,{constructor:function(_267){this.widgetDef=_267;},getAllowInstanceContent:function(){return this.widgetDef.allowInstanceContent;},getResources:function(){return this.widgetDef.resources;},getIScope:function(){return this.widgetDef.iScope;},getWidgetEvents:function(){return this.widgetDef.widgetEvents;},getMarkupByMode:function(mode){if(typeof this.widgetDef.markup!="undefined"&&this.widgetDef.markup!=null){if(!mode){mode="view";}var temp=this.widgetDef.markup[mode];return temp;}else{return null;}},getAttributes:function(){var _26a=this.widgetDef.itemSetsArr[iwConstants.ATTRIBUTES];if(typeof _26a=="undefined"||_26a==null){_26a={name:iwConstants.ATTRIBUTES};_26a.items={};}_26a.isPrivate=true;var _26b=this.widgetDef.simpleAttributes;if(typeof _26b!="undefined"&&_26b!=null){for(var i in _26b){var _26d=_26b[i];if(typeof _26d!="undefined"&&_26d!=null){if(!_26a.items[i]){_26a.items[i]={id:i,value:_26d,readOnly:false};}}}}return _26a;},getAllItemSetNames:function(){var _26e=new Array();if(typeof (this.widgetDef.itemSetsArr)=="undefined"||this.widgetDef.itemSetsArr==null){return _26e;}var i=0;for(itemName in this.widgetDef.itemSetsArr){var _270=this.widgetDef.itemSetsArr[itemName];if(typeof (_270)!="undefined"&&itemName!=iwConstants.ATTRIBUTES){_26e[i]=_270.name;i++;}}return _26e;},getItemSet:function(name){if(name=="attributes"){return this.getAttributes();}var _272=this.widgetDef.itemSetsArr[name];if(typeof _272=="undefined"||_272==null){return null;}return _272;},getPublishedEventsNames:function(){if(!this.widgetDef.publishedEvents){return [];}var _273=[];var _274;for(_274 in this.widgetDef.publishedEvents){_273.push(_274);}return _273;},getHandledEventsNames:function(){if(!this.widgetDef.handledEvents){return [];}var _275=[];var _276;for(_276 in this.widgetDef.handledEvents){_275.push(_276);}return _275;},getPublishedEvent:function(_277){if(!this.widgetDef.publishedEvents){return null;}var data=this.widgetDef.publishedEvents[_277];var _279=null;if(typeof data!="undefined"||data!=null){var _27a=data.description;var _27b=null;if(typeof _27a!="undefined"&&_27a!=null){_27b=this._getEventDescription(_27a);if(_27b!=null){var _27c=_27b.lang;if(typeof _27c=="undefined"||_27c==null){_27c=this.getDefaultLanguage();if(typeof _27c=="undefined"||_27c==null){_27c="en";}}}}if(_27b!=null){_279=new com.ibm.mm.enabler.iw.iEventDescriptionImpl(_277,data.onEvent,_27b.payloadType,_27b.description,_27b.aliases,_27c,_27b.descriptions);}else{_279=new com.ibm.mm.enabler.iw.iEventDescriptionImpl(_277,data.onEvent);}if(data.onRemoveWire){_279.setOnRemoveWire(data.onRemoveWire);}if(data.onNewWire){_279.setOnNewWire(data.onNewWire);}}return _279;},getHandledEvent:function(_27d){if(!this.widgetDef.handledEvents){return null;}var data=this.widgetDef.handledEvents[_27d];var _27f=null;if(typeof data!="undefined"||data!=null){var _280=data.description;var _281=null;if(typeof _280!="undefined"&&_280!=null){_281=this._getEventDescription(_280);if(_281!=null){var _282=_281.lang;if(typeof _282=="undefined"||_282==null){_282=this.getDefaultLanguage();if(typeof _282=="undefined"||_282==null){_282="en";}}}}if(_281!=null){_27f=new com.ibm.mm.enabler.iw.iEventDescriptionImpl(_27d,data.onEvent,_281.payloadType,_281.description,_281.aliases,_282,_281.descriptions);}else{_27f=new com.ibm.mm.enabler.iw.iEventDescriptionImpl(_27d,data.onEvent);}if(data.onRemoveWire){_27f.setOnRemoveWire(data.onRemoveWire);}if(data.onNewWire){_27f.setOnNewWire(data.onNewWire);}}return _27f;},getWidgetId:function(){return this.widgetDef.id;},getWidgetName:function(){return this.widgetDef.id;},getPayloadDefs:function(){return this.widgetDef.payloadDefs;},getPayloadDef:function(name){var _284=this.widgetDef.payloadDefs[name];if(typeof _284=="undefined"){return null;}return _284;},getPayloadDefNames:function(){var arr=[];var a;for(a in this.widgetDef.payloadDefs){arr.push(a);}return arr;},getSupportedModes:function(){var temp=this.widgetDef.supportedModes;if(typeof temp=="undefined"||temp==null){return null;}var arr=temp.split(" ");return arr;},getiDescriptor:function(){return this.widgetDef.iDescriptor;},_getEventDescription:function(id){var _28a=null;if(typeof this.widgetDef.eventDescriptions!="undefined"||this.widgetDef.eventDescriptions!=null){_28a=this.widgetDef.eventDescriptions[id];}return _28a;},getPublishedEvents:function(){var _28b={};var _28c=this.getPublishedEventsNames();for(var i=0;i<_28c.length;i++){var _28e=_28c[i];var _28f=this.getPublishedEvent(_28e);if(_28f!=null){_28b[_28e]=[_28f];}}return _28b;},getHandledEvents:function(){var _290={};var _291=this.getHandledEventsNames();for(var i=0;i<_291.length;i++){var _293=_291[i];var _294=this.getHandledEvent(_293);if(_294!=null){_290[_293]=[_294];}}return _290;},getDefaultLanguage:function(){return this.widgetDef.lang;},getMarkup:function(){return this.widgetDef.markup;}});}if(!dojo._hasResource["com.ibm.mm.enabler.xpath.safari"]){dojo._hasResource["com.ibm.mm.enabler.xpath.safari"]=true;dojo.provide("com.ibm.mm.enabler.xpath");com.ibm.mm.enabler.xpath.evaluateXPath=function(_295,doc,_297){if(navigator.userAgent.toLowerCase().indexOf("safari")!=-1){return com.ibm.mm.enabler.xpath.safari.evaluateXPath(_295,doc,_297);}else{if(typeof ActiveXObject!="undefined"){return com.ibm.mm.enabler.xpath.ie.evaluateXPath(_295,doc,_297);}else{return com.ibm.mm.enabler.xpath.gecko.evaluateXPath(_295,doc,_297);}}};dojo.provide("com.ibm.mm.enabler.xpath.safari");com.ibm.mm.enabler.xpath.safari.evaluateXPath=function(_298,doc,_29a){var _29b;if(typeof XPathResult!="undefined"){var _29c=document.evaluate(_298,doc,function(_29d){return _29a[_29d]||null;},XPathResult.ANY_TYPE,null);var _29e;_29b=[];var len=0;do{_29e=_29c.iterateNext();if(_29e){_29b[len]=_29e;len++;}}while(_29e);}else{if(doc.selectNodes){_29b=doc.selectNodes(_298);}}return _29b;};dojo.provide("com.ibm.mm.enabler.xpath.ie");com.ibm.mm.enabler.xpath.ie.evaluateXPath=function(_2a0,doc,_2a2){if(_2a2){var ns="";for(var prop in _2a2){if(prop!="xml"){ns+="xmlns:"+prop+"='"+_2a2[prop]+"' ";}}if(doc.ownerDocument){doc.ownerDocument.setProperty("SelectionNamespaces",ns);doc.ownerDocument.setProperty("SelectionLanguage","XPath");}else{doc.setProperty("SelectionNamespaces",ns);doc.setProperty("SelectionLanguage","XPath");}}var _2a5=doc.selectNodes(_2a0);var _2a6;var _2a7=[];var len=0;for(var i=0;i<_2a5.length;i++){_2a6=_2a5[i];if(_2a6){_2a7[len]=_2a6;len++;}}return _2a7;};dojo.provide("com.ibm.mm.enabler.xpath.gecko");com.ibm.mm.enabler.xpath.gecko.evaluateXPath=function(_2aa,doc,_2ac){var _2ad;try{var _2ae=doc;if(doc.nodeType!=9){_2ae=doc.ownerDocument;}_2ad=_2ae.evaluate(_2aa,doc,function(_2af){return _2ac[_2af]||null;},XPathResult.ANY_TYPE,null);}catch(exc){throw new Error("Error with xpath expression"+exc);}var _2b0;var _2b1=[];var len=0;do{_2b0=_2ad.iterateNext();if(_2b0){_2b1[len]=_2b0;len++;}}while(_2b0);return _2b1;};}dojo.provide("com.ibm.mm.enabler.xslt");com.ibm.mm.enabler.xslt.ie={};com.ibm.mm.enabler.xslt.gecko={};com.ibm.mm.enabler.xslt.getXmlHttpRequest=function(){var oXml=null;if(typeof ActiveXObject!="undefined"){oXml=new ActiveXObject("Microsoft.XMLHTTP");}else{oXml=new XMLHttpRequest();}return oXml;};com.ibm.mm.enabler.xslt.loadXml=function(sUrl){if(typeof ActiveXObject!="undefined"){return com.ibm.mm.enabler.xslt.ie.loadXml(sUrl);}else{return com.ibm.mm.enabler.xslt.gecko.loadXml(sUrl);}};com.ibm.mm.enabler.xslt.loadXmlString=function(sXml){if(typeof ActiveXObject!="undefined"){return com.ibm.mm.enabler.xslt.ie.loadXmlString(sXml);}else{var _2b6=new DOMParser();return com.ibm.mm.enabler.xslt.gecko.loadXmlString(sXml);}};com.ibm.mm.enabler.xslt.loadXsl=function(sUrl){if(typeof ActiveXObject!="undefined"){return com.ibm.mm.enabler.xslt.ie.loadXsl(sUrl);}else{return com.ibm.mm.enabler.xslt.gecko.loadXsl(sUrl);}};com.ibm.mm.enabler.xslt.transform=function(xml,xsl,_2ba,_2bb,_2bc){com.ibm.mm.enabler.debug.entry("xslt.transform",xml,xsl,_2ba,_2bb,_2bc);if(typeof ActiveXObject!="undefined"){return com.ibm.mm.enabler.xslt.ie.transform(xml,xsl,_2ba,_2bb,_2bc);}else{return com.ibm.mm.enabler.xslt.gecko.transform(xml,xsl,_2ba,_2bb,_2bc);}};com.ibm.mm.enabler.xslt.transformAndUpdate=function(_2bd,xml,xsl,_2c0,_2c1){com.ibm.mm.enabler.debug.entry("xslt.transformAndUpdate",_2bd,xml,xsl,_2c0,_2c1);if(typeof ActiveXObject!="undefined"){var _2c2=com.ibm.mm.enabler.xslt.ie.transform(xml,xsl,_2c0,_2c1,true);com.ibm.mm.enabler.debug.log("xslt.transformAndUpdate","XSLT result: "+_2c2);_2bd.innerHTML+=_2c2;}else{_2c2=com.ibm.mm.enabler.xslt.gecko.transform(xml,xsl,_2c0,_2c1,false);com.ibm.mm.enabler.debug.log("xslt.transformAndUpdate","XSLT result: "+(new XMLSerializer()).serializeToString(_2c2),"com.ibm.mm.enabler.xslt.transformAndUpdate");var _2c3=_2c2.documentElement;if(_2c2.documentElement.tagName=="transformiix:result"){_2c3=_2c2.documentElement.childNodes;com.ibm.mm.enabler.dom.copyChildren(_2c2.documentElement,_2bd,true);}else{com.ibm.mm.enabler.debug.log("xslt.transformAndUpdate","Appending2: "+(new XMLSerializer()).serializeToString(_2c3),"com.ibm.mm.enabler.xslt.transformAndUpdate");_2bd.appendChild(_2c3);}}com.ibm.mm.enabler.debug.exit("xslt.transformAndUpdate");};com.ibm.mm.enabler.xslt.ie.loadXml=function(sUrl){var _2c5=new ActiveXObject("MSXML2.DOMDocument");_2c5.async=0;_2c5.resolveExternals=0;if(!_2c5.load(sUrl)){throw new Error("Error loading xml file "+sUrl);}return _2c5;};com.ibm.mm.enabler.xslt.ie.loadXmlString=function(sXml){var _2c7=new ActiveXObject("MSXML2.DOMDocument");_2c7.async=0;_2c7.resolveExternals=0;if(!_2c7.loadXML(sXml)){throw new Error("Error loading xml string "+sXml);}return _2c7;};com.ibm.mm.enabler.xslt.ie.loadXsl=function(sUrl){var _2c9=new ActiveXObject("MSXML2.FreeThreadedDOMDocument");_2c9.async=0;_2c9.resolveExternals=0;if(!_2c9.load(sUrl)){throw new Error("Error loading xsl file "+sUrl);}return _2c9;};com.ibm.mm.enabler.xslt.ie.transform=function(_2ca,xsl,_2cc,_2cd,_2ce){var oXml=_2ca;var oXsl=xsl;try{if(!oXsl.documentElement){oXsl=this.loadXsl(xsl);}}catch(e){var sMsg=e.message;throw new Error(""+sMsg,""+sMsg);}var _2d2=new ActiveXObject("Msxml2.XSLTemplate");_2d2.stylesheet=oXsl;var _2d3=_2d2.createProcessor();_2d3.input=oXml;if(_2cd){for(var p in _2cd){_2d3.addParameter(p,_2cd[p]);}}if(_2cc){_2d3.addParameter("mode",_2cc);}if(_2ce){if(!_2d3.transform()){throw new Error("Error transforming xml doc "+oXml);}return _2d3.output;}else{var _2d5=new ActiveXObject("MSXML2.DOMDocument");_2d5.async=0;_2d5.validateOnParse=1;oXml.transformNodeToObject(oXsl,_2d5);return _2d5;}};com.ibm.mm.enabler.xslt.gecko.loadXml=function(sUrl){};com.ibm.mm.enabler.xslt.gecko.loadXmlString=function(sXml){var _2d8=new DOMParser();try{oXmlDoc=_2d8.parseFromString(sXml,"text/xml");}catch(exc){throw new Error("Error loading xml string "+sXml);}return oXmlDoc;};com.ibm.mm.enabler.xslt.gecko.loadXsl=function(sUrl){var _2da=document.implementation.createDocument("","",null);_2da.async=0;_2da.load(sUrl);return _2da;};com.ibm.mm.enabler.xslt.gecko.transform=function(_2db,xsl,_2dd,_2de,_2df){try{var _2e0=xsl;if(!_2e0.documentElement){_2e0=this.loadXsl(xsl);}var proc=new XSLTProcessor();proc.importStylesheet(_2e0);if(_2de){for(var p in _2de){proc.setParameter(null,p,_2de[p]);}}if(_2dd){proc.setParameter(null,"mode",_2dd);}var _2e3=proc.transformToDocument(_2db);if(!_2df){return _2e3;}resultStr=_2e3.documentElement.childNodes[0].textContent;}catch(exc){throw new Error("Error transforming xml doc "+exc);}return resultStr;};com.ibm.mm.enabler.xslt.setLayerContentByXml=function(_2e4,xml,xsl,_2e7,_2e8){var _2e9=com.ibm.mm.enabler.xslt.transform(xml,xsl,null,_2e7,_2e8);if(_2e4.innerHTML){_2e4.innerHTML=_2e9;}else{var obj=document.getElementById(_2e4);obj.innerHTML=_2e9;}};if(!dojo._hasResource["com.ibm.mm.enabler.iw.parserImpl"]){dojo._hasResource["com.ibm.mm.enabler.iw.parserImpl"]=true;dojo.provide("com.ibm.mm.enabler.iw.parserImpl");dojo.declare("com.ibm.mm.enabler.iw.parser.WidgetParser",null,{parseWidgetDefinition:function(){return null;}});dojo.declare("com.ibm.mm.enabler.iw.parser.legacyXMLParser",com.ibm.mm.enabler.iw.parser.WidgetParser,{constructor:function(_2eb){this.xmlStr=_2eb;},namespaces:{"iw":"http://www.ibm.com/iWidget"},parseWidgetDefinition:function(){var _2ec=com.ibm.mm.enabler.xslt.loadXmlString(this.xmlStr);var _2ed=this.readMarkup(_2ec);var _2ee=this.readItemSets(_2ec);var uri=this.readContentURI(_2ec);var _2f0=this.readWidgetEvents(_2ec);var name=this.readName(_2ec);var _2f2=this.readiScope(_2ec);var _2f3=this.readSupportedModes(_2ec);var _2f4=this.readPublicEvents(_2ec,"iw:handledEvents");var _2f5=this.readPublicEvents(_2ec,"iw:publishedEvents");var _2f6=this.readResources(_2ec);var _2f7=this.readPayloadDefs(_2ec);var _2f8=this.readIDescriptor(_2ec);return new com.ibm.mm.enabler.iw.WidgetDefinition(name,_2ed,_2f2,_2ee,_2f0,uri,_2f3,_2f5,_2f4,_2f6,_2f7,_2f8);},readMarkup:function(_2f9){com.ibm.mm.enabler.debug.entry("legacyXMLParser.readMarkup",_2f9.text);var _2fa="/iw:iwidget/iw:content";var _2fb=com.ibm.mm.enabler.xpath.evaluateXPath(_2fa,_2f9,this.namespaces);var _2fc="";if(_2fb!=null&&_2fb.length>0){var _2fd=_2fb[0];var _2fe=_2fd.childNodes;for(var j=0;j<_2fe.length;j++){var _300=_2fe[j];if(_300.nodeType==4){_2fc=_2fc.concat(_300.nodeValue);}else{if(_300.nodeType==3){_2fc=_2fc.concat(_300.nodeValue);}}}}com.ibm.mm.enabler.debug.exit("legacyXMLParser.readMarkup",_2fc);return _2fc;},readSupportedModes:function(_301){var root=_301.documentElement;var _303=root.getAttribute("supportedModes");if(typeof _303=="undefined"||_303==null){return null;}return _303;},readItemSets:function(_304){com.ibm.mm.enabler.debug.entry("legacyXMLParser.readItemSets");var _305={};var _306="/iw:iwidget/iw:itemSet";var _307=com.ibm.mm.enabler.xpath.evaluateXPath(_306,_304,this.namespaces);for(var i=0;i<_307.length;i++){var _309=_307[i];var name=_309.getAttribute("name");var _30b=_309.getAttribute("onItemSetChanged");var _30c={name:name,onItemSetChanged:_30b};_30c.items={};var _30d=_309.childNodes;for(var j=0;j<_30d.length;j++){var _30f=_30d[j];if(_30f.nodeType==1){var _310=_30f.getAttribute("readOnly");com.ibm.mm.enabler.debug.entry("legacyXMLParser.readItemSets found attribute name:"+_30f.getAttribute("name")+" value:"+_30f.getAttribute("value"));var _311={id:_30f.getAttribute("name"),value:_30f.getAttribute("value"),readOnly:_310};_30c.items[_311.id]=_311;}}_305[name]=_30c;}com.ibm.mm.enabler.debug.exit("legacyXMLParser.readItemSets");return _305;},readPayloadDefs:function(_312){com.ibm.mm.enabler.debug.entry("legacyXMLParser.readPayloadDefs");var _313={};var _314="/iw:iwidget/iw:payloadDef";var _315=com.ibm.mm.enabler.xpath.evaluateXPath(_314,_312,this.namespaces);for(var i=0;i<_315.length;i++){var _317=_315[i];var _318=com.ibm.mm.enabler.iw.utils.getPayloadDef(_317);_313[_318.name]=_318;}com.ibm.mm.enabler.debug.exit("legacyXMLParser.readPayloadDef ",_315.length+" payloadDefs are saved ");return _313;},readName:function(_319){var root=_319.documentElement;var name=root.getAttribute("name");if(typeof name=="undefined"||name==null){return null;}return name;},readContentURI:function(_31c){var root=_31c.documentElement;var uri=root.getAttribute("contentURI");if(typeof uri=="undefined"||uri==null){return null;}return uri;},readiScope:function(_31f){var root=_31f.documentElement;var _321=root.getAttribute("iScope");if(typeof _321=="undefined"||_321==null){return null;}return _321;},readWidgetEvents:function(_322){var root=_322.documentElement;var _324={};var _325=root.attributes;for(var i=0;i<_325.length;i++){var _327=_325[i];if(_327.name.indexOf("on")==0){var _328=_327.value;if(typeof _328!="undefined"&&_328!=null){_324[_327.name]=_328;}}}return _324;},readPublicEvents:function(_329,_32a){var _32b="/iw:iwidget/"+_32a;var _32c=com.ibm.mm.enabler.xpath.evaluateXPath(_32b,_329,this.namespaces);if(typeof _32c!="undefined"&&_32c!=null&&_32c.length!=0){var _32d={};var node=_32c[0];var _32f=node.childNodes;for(var j=0;j<_32f.length;j++){var _331=_32f[j];if(_331.nodeType==1){var _332=new com.ibm.mm.enabler.iw.iEventDescriptionImpl(_331.getAttribute("eventName"),_331.getAttribute("onEvent"),_331.getAttribute("payloadType"),_331.getAttribute("description"));if(!_32d[_331.getAttribute("eventName")]){_32d[_331.getAttribute("eventName")]=[];}_32d[_331.getAttribute("eventName")].push(_332);}}}if(!_32d){return null;}return _32d;},readResources:function(_333){var _334="/iw:iwidget/iw:resource";var _335=[];var _336=com.ibm.mm.enabler.xpath.evaluateXPath(_334,_333,this.namespaces);if(typeof _336!="undefined"&&_336!=null&&_336.length!=0){for(var i=0;i<_336.length;i++){var node=_336[i];var _339={};_339["name"]=node.getAttribute("resourceName");_339["src"]=node.getAttribute("uri");_339["version"]=node.getAttribute("version");_339["callback"]=node.getAttribute("callback");_339["mimetype"]=node.getAttribute("mimetype");_335[i]=_339;}}return _335;},readIDescriptor:function(_33a){return null;}});dojo.declare("com.ibm.mm.enabler.iw.parser.standardXMLParser",com.ibm.mm.enabler.iw.parser.WidgetParser,{constructor:function(_33b){this.xmlStr=_33b;},namespaces:{"iw":"http://www.ibm.com/xmlns/prod/iWidget"},reservedAttributes:{iScope:"iScope",supportedModes:"supportedModes",id:"id",allowInstanceContent:"allowInstanceContent",lang:"language","xmlns:iw":"xmlns:iw"},parseWidgetDefinition:function(){var _33c=com.ibm.mm.enabler.xslt.loadXmlString(this.xmlStr);var _33d=this.readRootElement(_33c);_33d.markup=this.readMarkup(_33c);_33d.itemSetsArr=this.readItemSets(_33c);_33d.handledEvents=this.readPublicEvents(_33c,"handled");_33d.publishedEvents=this.readPublicEvents(_33c,"published");_33d.resources=this.readResources(_33c);_33d.payloadDefs=this.readPayloadDefs(_33c);_33d.eventDescriptions=this.readEventDescriptions(_33c);return new com.ibm.mm.enabler.iw.standardWidgetDefinition(_33d);},readRootElement:function(_33e){var _33f={};var root=_33e.documentElement;var _341=root.getAttribute("supportedModes");if(typeof _341=="undefined"||_341==null){_341="view";}_33f.supportedModes=_341;var name=root.getAttribute("id");if(typeof name=="undefined"||name==null){name=null;}_33f.id=name;_33f.name=name;var temp=root.getAttribute("allowInstanceContent");var _344=false;if(typeof temp!="undefined"&&temp!=null&&temp=="true"){_344=true;}_33f.allowInstanceContent=_344;var lang=root.getAttribute("language");if(typeof lang=="undefined"||lang==null){lang="en";}_33f.lang=lang;var _346={};var _347=root.attributes;for(var i=0;i<_347.length;i++){var _349=_347[i];if(_349.name.indexOf("on")==0){var _34a=_349.value;if(typeof _34a!="undefined"&&_34a!=null){_346[_349.name]=_34a;}}}_33f.widgetEvents=_346;var _34b=root.getAttribute("iScope");if(typeof _34b=="undefined"||_34b==null){_34b=null;}_33f.iScope=_34b;var _34c=iwConstants.iDescriptorItems;var _34d={};for(var i in _34c){var name=_34c[i];var _34e=root.getAttribute(name);_34d[name]=_34e;}_33f.iDescriptor=_34d;var _34f={};var _347=root.attributes;for(var i=0;i<_347.length;i++){var att=_347[i];if(att.name.indexOf("on")!=0&&!iwConstants.iDescriptorItems[att.name]&&!this.reservedAttributes[att.name]){var _34e=att.value;if(typeof _34e!="undefined"&&_34e!=null){_34f[att.name]=_34e;}}}_33f.simpleAttributes=_34f;return _33f;},readMarkup:function(_351){com.ibm.mm.enabler.debug.entry("standardXMLParser.readMarkup",_351.text);var _352="/iw:iwidget/iw:content";var _353=com.ibm.mm.enabler.xpath.evaluateXPath(_352,_351,this.namespaces);var _354={};var _355="";var mode=null;if(_353!=null&&_353.length>0){for(var i=0;i<_353.length;i++){var _358=_353[i];var _359=_358.childNodes;for(var j=0;j<_359.length;j++){var _35b=_359[j];if(_35b.nodeType==4){_355=_355.concat(_35b.nodeValue);}else{if(_35b.nodeType==3){_355=_355.concat(_35b.nodeValue);}}}mode=_358.getAttribute("mode");if(typeof mode=="undefined"||mode==null){mode="view";break;}_354[mode]=_355;_355="";}}com.ibm.mm.enabler.debug.exit("standardXMLParser.readMarkup",_354);return _354;},readItemSets:function(_35c){com.ibm.mm.enabler.debug.entry("standardXMLParser.readItemSets");var _35d={};var _35e="/iw:iwidget/iw:itemSet";var _35f=com.ibm.mm.enabler.xpath.evaluateXPath(_35e,_35c,this.namespaces);for(var i=0;i<_35f.length;i++){var _361=_35f[i];var name=_361.getAttribute("id");var _363=_361.getAttribute("onItemSetChanged");var temp=_361.getAttribute("private");var _365=false;if(typeof temp!="undefined"&&temp!=null&&temp=="true"){_365=true;}var _366=_361.getAttribute("description");var _367={name:name,onItemSetChanged:_363,isPrivate:_365};_367.items={};var _368=_361.childNodes;for(var j=0;j<_368.length;j++){var _36a=_368[j];if(_36a.nodeType==1){var _36b=_36a.getAttribute("readOnly");com.ibm.mm.enabler.debug.entry("standardXMLParser.readItemSets found attribute name:"+_36a.getAttribute("name")+" value:"+_36a.getAttribute("value"));if(typeof _36b!="undefined"&&_36b!=null&&_36b=="true"){_36b=true;}else{_36b=false;}var id=_36a.getAttribute("id");var _36d=_36a.getAttribute("value");var _36e={id:id,value:_36d,readOnly:_36b};_367.items[id]=_36e;}}_35d[name]=_367;}com.ibm.mm.enabler.debug.exit("standardXMLParser.readItemSets");return _35d;},readPayloadDefs:function(_36f){com.ibm.mm.enabler.debug.entry("standardXMLParser.readPayloadDefs");var _370={};var _371="/iw:iwidget/iw:payloadDef";var _372=com.ibm.mm.enabler.xpath.evaluateXPath(_371,_36f,this.namespaces);for(var i=0;i<_372.length;i++){var _374=_372[i];var _375=com.ibm.mm.enabler.iw.utils.getPayloadDef(_374);_370[_375.name]=_375;}com.ibm.mm.enabler.debug.exit("standardXMLParser.readPayloadDef ",_372.length+" payloadDefs are saved ");return _370;},readPublicEvents:function(_376,_377){var _378="/iw:iwidget/iw:event[@"+_377+"]";var _379=com.ibm.mm.enabler.xpath.evaluateXPath(_378,_376,this.namespaces);if(typeof _379!="undefined"&&_379!=null&&_379.length!=0){var _37a={};for(var j=0;j<_379.length;j++){var _37c=_379[j];if(_37c.nodeType==1){var _37d={};_37d.id=_37c.getAttribute("id");var _37e=_37c.getAttribute("eventDescName");if(typeof _37e=="undefined"||_37e==null){_37e=_37c.getAttribute("description");}_37d.description=_37e;_37d.onEvent=_37c.getAttribute("onEvent");_37d.onNewWire=_37c.getAttribute("onNewWire");_37d.onRemoveWire=_37c.getAttribute("onRemoveWire");_37a[_37d.id]=_37d;}}}if(!_37a){return {};}return _37a;},readResources:function(_37f){var _380="/iw:iwidget/iw:resource";var _381=[];var _382=com.ibm.mm.enabler.xpath.evaluateXPath(_380,_37f,this.namespaces);if(typeof _382!="undefined"&&_382!=null&&_382.length!=0){for(var i=0;i<_382.length;i++){var node=_382[i];var _385={};_385[iwConstants.RESOURCE.id]=node.getAttribute("id");var src=node.getAttribute("src");if(typeof src=="undefined"||src==null){src=node.getAttribute("uri");}_385[iwConstants.RESOURCE.src]=src;_385[iwConstants.RESOURCE.version]=node.getAttribute("version");_385[iwConstants.RESOURCE.callback]=node.getAttribute("callback");_385[iwConstants.RESOURCE.mimetype]=node.getAttribute("mimeType");_381[i]=_385;}}return _381;},readEventDescriptions:function(_387){var _388="iw:iwidget/iw:eventDescription";var _389={};var _38a=com.ibm.mm.enabler.xpath.evaluateXPath(_388,_387,this.namespaces);if(typeof _38a!="undefined"&&_38a!=null&&_38a.length!=0){for(var i=0;i<_38a.length;i++){var node=_38a[i];var _38d={};var id=node.getAttribute("id");_38d["id"]=id;_38d["payloadType"]=node.getAttribute("payloadType");_38d["description"]=node.getAttribute("description");_38d["descriptionURI"]=node.getAttribute("descriptionURI");_38d["lang"]=node.getAttribute("lang");_38d["aliases"]=node.getAttribute("aliases");_38d["descriptions"]={};var _38f=node.childNodes;for(var j=0;j<_38f.length;j++){var _391=_38f[j];if(_391.nodeType==1){var temp={};temp["lang"]=_391.getAttribute("lang");temp["description"]=_391.getAttribute("description");temp["title"]=_391.getAttribute("title");temp["descriptionURI"]=_391.getAttribute("descriptionURI");_38d["descriptions"][_391.getAttribute("lang")]=temp;}}_389[id]=_38d;}}return _389;}});}if(!dojo._hasResource["com.ibm.mm.enabler.iw.parser"]){dojo._hasResource["com.ibm.mm.enabler.iw.parser"]=true;dojo.provide("com.ibm.mm.enabler.iw.parser");dojo.declare("com.ibm.mm.enabler.iw.parser.WidgetParserFactory",null,{getWidgetParser:function(_393){var _394=_393.replace(/^\s+/,"").replace(/\s+$/,"");var _395=this._isXML(_394);var _396=this._isLegacy(_394);if(_395&&_396){return new com.ibm.mm.enabler.iw.parser.legacyXMLParser(_394);}else{if(_395&&!_396){return new com.ibm.mm.enabler.iw.parser.standardXMLParser(_394);}}return null;},_isXML:function(_397){var _398=true;var _399=_397.indexOf("=\"http://www.w3.org/1999/xhtml\"");if(_399!=-1){_398=false;}com.ibm.mm.enabler.debug.log("parser._isXML",_398);return _398;},_isLegacy:function(_39a){var _39b=true;var _39c=_39a.indexOf("=\"http://www.ibm.com/xmlns/prod/iWidget\"");if(_39c!=-1){_39b=false;}com.ibm.mm.enabler.debug.log("parser._isLegacy",_39b);return _39b;}});com.ibm.mm.enabler.iw.parser.WidgetParserFactory=new com.ibm.mm.enabler.iw.parser.WidgetParserFactory();}if(!dojo._hasResource["dojo.string"]){dojo._hasResource["dojo.string"]=true;dojo.provide("dojo.string");dojo.string.pad=function(text,size,ch,end){var out=String(text);if(!ch){ch="0";}while(out.length<size){if(end){out+=ch;}else{out=ch+out;}}return out;};dojo.string.substitute=function(_3a2,map,_3a4,_3a5){return _3a2.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(_3a6,key,_3a8){var _3a9=dojo.getObject(key,false,map);if(_3a8){_3a9=dojo.getObject(_3a8,false,_3a5)(_3a9);}if(_3a4){_3a9=_3a4(_3a9,key);}return _3a9.toString();});};dojo.string.trim=function(str){str=str.replace(/^\s+/,"");for(var i=str.length-1;i>0;i--){if(/\S/.test(str.charAt(i))){str=str.substring(0,i+1);break;}}return str;};}if(!dojo._hasResource["com.ibm.mm.enabler.iw.services"]){dojo._hasResource["com.ibm.mm.enabler.iw.services"]=true;dojo.provide("com.ibm.mm.enabler.iw.services");dojo.declare("com.ibm.mm.enabler.iw.services.iWidgetFragmentService",null,{createItem:function(_3ac,_3ad,_3ae,ns){if(typeof ns=="undefined"||ns==null){ns="mm_";}var item=document.createElement("a");dojo.addClass(item,ns+iwConstants.CSSCLASS_INSTANCE.iwItem);dojo.style(item,"visibility","hidden");dojo.style(item,"display","none");item.setAttribute("href","#"+_3ac);if(_3ae){item.setAttribute("lang",_3ae);}if(_3ad&&!_3ae){item.innerHTML=_3ad;}return item;},createItemSet:function(_3b1,ns){if(typeof ns=="undefined"||ns==null){ns="mm_";}var _3b3=document.createElement("span");dojo.addClass(_3b3,ns+iwConstants.CSSCLASS_INSTANCE.iwItemSet);_3b3.setAttribute("title",_3b1);dojo.style(_3b3,"visibility","hidden");dojo.style(_3b3,"display","none");return _3b3;},createWidgetDefRef:function(_3b4,ns){if(typeof ns=="undefined"||ns==null){ns="mm_";}var aTag=document.createElement("a");dojo.addClass(aTag,ns+iwConstants.CSSCLASS_INSTANCE.iwDefinition);aTag.setAttribute("href",_3b4);dojo.style(aTag,"visibility","hidden");dojo.style(aTag,"display","none");return aTag;},getItemSet:function(_3b7,name,ns){if(typeof ns=="undefined"||ns==null){ns="mm_";}var rc=null;var _3bb=dojo.byId(_3b7);var _3bc=dojo.query("."+ns+iwConstants.CSSCLASS_INSTANCE.iwItemSet,_3bb);for(var i=0;i<_3bc.length;i++){var _3be=_3bc[i];var _3bf=_3be.getAttribute("title");if(name==_3bf){rc=_3be;break;}}return rc;},getItem:function(_3c0,name,ns){if(typeof ns=="undefined"||ns==null){ns="mm_";}var rc=null;var _3c4=dojo.query("."+ns+iwConstants.CSSCLASS_INSTANCE.iwItem,_3c0);for(var i=0;i<_3c4.length;i++){var _3c6=_3c4[i];var _3c7=this.getKeyFromHref(_3c6);if(_3c7!=null&&_3c7==name){rc=_3c6;break;}}return rc;},getItems:function(_3c8,ns){if(typeof ns=="undefined"||ns==null){ns="mm_";}var _3ca=dojo.query("."+ns+iwConstants.CSSCLASS_INSTANCE.iwItem,_3c8);if(typeof _3ca=="undefined"||_3ca==null||_3ca.length==0){_3ca=null;}return _3ca;},getWidgetDefRef:function(_3cb,ns){if(typeof ns=="undefined"||ns==null){ns="mm_";}var rc=null;var _3ce=dojo.byId(_3cb);var def=dojo.query("."+ns+iwConstants.CSSCLASS_INSTANCE.iwDefinition,_3ce)[0];var ref=def.getAttribute("href");if(typeof ref!="undefined"&&ref!=null){rc=ref;}return rc;},getKeyFromHref:function(node){var _3d2=node.getAttribute("href");if(_3d2==null){return null;}var pos=_3d2.indexOf("#");if(pos<0){return null;}return _3d2.substring(pos+1);}});dojo.declare("com.ibm.mm.enabler.iw.services.persistentAttributesFactoryService",null,{createPersistentAttributes:function(_3d4){return new com.ibm.mm.enabler.iw.PersistentAttributes(_3d4,true);}});dojo.declare("com.ibm.mm.enabler.iw.services.eventService",null,{constructor:function(){this.wires={};},subscribeWire:function(_3d5,_3d6,_3d7,_3d8){com.ibm.mm.enabler.debug.entry("eventService.subscribeWire","source:"+_3d5+" sourceEvent:"+_3d6+" targetWidget:"+_3d7+" targetEvent:"+_3d8);if(typeof _3d5=="undefined"||_3d5===null){return false;}if(typeof _3d6=="undefined"||_3d6===null){return false;}if(typeof _3d7=="undefined"||_3d7===null){return false;}if(typeof _3d8=="undefined"||_3d8===null){return false;}var rc=true;if(typeof (this.wires[_3d5])=="undefined"||this.wires[_3d5]===null){this.wires[_3d5]={};}if(typeof (this.wires[_3d5][_3d6])=="undefined"||this.wires[_3d5][_3d6]===null){this.wires[_3d5][_3d6]={};}var _3da=this.wires[_3d5][_3d6][_3d7];if(typeof _3da=="undefined"||_3da===null){this.wires[_3d5][_3d6][_3d7]=[];}else{if(com.ibm.mm.enabler.utilities.inStringArray(_3d8,_3da)){rc=false;}}if(rc){this.wires[_3d5][_3d6][_3d7].push(_3d8);}var _3db={};_3db.targetWidget=_3d7;_3db.sourceEvent=_3d6;_3db.sourceWidget=_3d5;_3db.targetEvent=_3d8;serviceManager.getService("eventService").fireEvent(_3d5,"onNewWire",_3db);com.ibm.mm.enabler.debug.exit("eventService.subscribeWire","wire is added "+this.wires[_3d5][_3d6][_3d7].length);return rc;},publishWire:function(_3dc,_3dd,_3de,_3df){com.ibm.mm.enabler.debug.entry("eventService.publishWire","source:"+_3dc+" sourceEvent:"+_3dd+" payload:"+_3de+" payloadType:"+_3df);if(typeof _3dc=="undefined"||_3dc===null){return false;}if(typeof _3dd=="undefined"||_3dd===null){return false;}var _3e0=this.wires[_3dc];if(typeof (_3e0)=="undefined"||_3e0===null){return false;}var _3e1=_3e0[_3dd];if(typeof (_3e1)=="undefined"||_3e1===null){return false;}var _3e2;for(_3e2 in _3e1){com.ibm.mm.enabler.debug.log("eventService.publishWire targetWidget:"+_3e2);var _3e3=_3e1[_3e2];for(var i=0;i<_3e3.length;i++){this.fireEvent(_3e2,_3e3[i],_3de,_3df,_3dc);}}return true;},unSubscribeWidgetWires:function(_3e5){if(typeof this.wires[_3e5]!="undefined"){var _3e6=this.wires[_3e5];}if(typeof (_3e6)=="undefined"||_3e6===null){return false;}var arr=[];for(var _3e8 in _3e6){var _3e9=_3e6[_3e8];if(typeof _3e9!="undefined"&&_3e9!==null){for(var _3ea in _3e9){var _3eb=_3e9[_3ea];if(typeof _3eb!="undefined"&&_3eb!==null){for(var i in _3eb){var _3ed={sourceWidget:_3e5,sourceEvent:_3e8,targetWidget:_3ea,targetEvent:_3eb[i]};arr.push(_3ed);serviceManager.getService("eventService").fireEvent(_3ea,"onRemoveWire",_3ed);}}}}}if(arr.length!==0){this.publishEvent(com.ibm.mm.enabler.iw.iEvents.Constants.unSubscribeWire,{wires:arr});}this.wires[_3e5]=null;},unSubscribeWire:function(_3ee,_3ef,_3f0,_3f1){if(typeof _3ee=="undefined"||_3ee===null){return false;}if(typeof _3ef=="undefined"||_3ef===null){return false;}if(typeof _3f0=="undefined"||_3f0===null){return false;}if(typeof _3f1=="undefined"||_3f1===null){return false;}var _3f2=this.wires[_3ee];if(typeof (_3f2)=="undefined"||_3f2===null){return false;}if(_3f2[_3ef]){var _3f3=_3f2[_3ef];}else{return false;}var _3f4=this.wires[_3ee][_3ef][_3f0];if(typeof _3f4!="undefined"&&_3f4!==null){for(var i=0;i<_3f4.length;i++){if(_3f1==_3f4[i]){_3f4.splice(i,1);var _3f6={};_3f6.targetWidget=_3f0;_3f6.targetEvent=_3f1;_3f6.sourceWidget=_3ee;_3f6.sourceEvent=_3ef;serviceManager.getService("eventService").fireEvent(_3f0,"onRemoveWire",_3f6);this.publishEvent(com.ibm.mm.enabler.iw.iEvents.Constants.unSubscribeWire,{wires:[_3f6]});}}return true;}else{return false;}},addWire:function(_3f7,_3f8,_3f9,_3fa){com.ibm.mm.enabler.debug.entry("eventService.addWire","source:"+_3f7+" sourceEvent:"+_3f8+" targetWidget:"+_3f9+" targetEvent:"+_3fa);if(typeof _3f7=="undefined"||_3f7===null){return false;}if(typeof _3f8=="undefined"||_3f8===null){return false;}if(typeof _3f9=="undefined"||_3f9===null){return false;}if(typeof _3fa=="undefined"||_3fa===null){return false;}var rc=this.subscribeWire(_3f7,_3f8,_3f9,_3fa);if(rc){var _3fc=iWidgetContainer.getWidgetById(_3f9);if(typeof _3fc!="undefined"&&_3fc!==null){var _3fd={};_3fd.SourceWidget=_3f7;_3fd.SourceEvent=_3f8;_3fd.TargetEvent=_3fa;if(typeof _3fc.wires=="undefined"){_3fc.wires=[];}_3fc.wires.push(_3fd);}}return rc;},removeWire:function(_3fe,_3ff,_400,_401){com.ibm.mm.enabler.debug.entry("eventService.removeWire","source:"+_3fe+" sourceEvent:"+_3ff+" targetWidget:"+_400+" targetEvent:"+_401);if(typeof _3fe=="undefined"||_3fe===null){return false;}if(typeof _3ff=="undefined"||_3ff===null){return false;}if(typeof _400=="undefined"||_400===null){return false;}if(typeof _401=="undefined"||_401===null){return false;}var rc=this.unSubscribeWire(_3fe,_3ff,_400,_401);if(rc){var _403=iWidgetContainer.getWidgetById(_400);if(typeof _403!="undefined"&&_403!==null){var arr=_403.wires;if(typeof arr!="undefined"&&arr!==null){for(var i=0;i<arr.length;i++){var _406=arr[i];if(_406.SourceWidget==_3fe&&_406.SourceEvent==_3ff&&_406.TargetEvent==_401){arr.splice(i,1);rc=true;break;}}}}}return rc;},fireEvent:function(_407,_408,_409,_40a,_40b){com.ibm.mm.enabler.debug.entry("eventService.fireEvent","sourceWidget:"+_40b+" targetWidget:"+_407+" targetEvent:"+_408+" payload:"+_409+" payloadType:"+_40a);var _40c=new com.ibm.mm.enabler.iw.iEventImpl(_408,_40a,_409,_40b);var data=[];data[0]=_408;data[1]=_40c;var _40e=iWidgetContainer.getWidgetById(_407);if(typeof _40e!="undefined"&&_40e!==null&&typeof _40e.loaded!="undefined"&&_40e.loaded==true){com.ibm.mm.enabler.debug.log("eventService.fireEvent","targetWidget is loaded");dojo.publish("/enabler/eventService/"+_407,data);}else{com.ibm.mm.enabler.debug.log("eventService.fireEvent","targetWidget is not loaded");var _40f=new com.ibm.mm.enabler.iw.eventHolder(_407,data);_40f.handler=dojo.subscribe("/enabler/widgetLoaded/"+_407,_40f,"handleLoaded");}},publishEvent:function(_410,_411){com.ibm.mm.enabler.debug.entry("eventService.publishEvent"," sourceEvent:"+_410);if(typeof _410=="undefined"||_410===null){return;}if(typeof _411=="undefined"||_411===null){dojo.publish(_410);}var args=[];if(dojo.isArray(_411)){args=_411;}else{args.push(_411);}dojo.publish(_410,args);},subscribeEvent:function(_413,_414,_415){dojo.subscribe(_413,_414,_415);}});dojo.declare("com.ibm.mm.enabler.iw.services.queryService",null,{getiWidgetWrapperById:function(id){var _417=iWidgetContainer.getWidgetById(id);if(typeof _417=="undefined"||_417===null){return null;}return new com.ibm.mm.enabler.iw.iWidgetWrapperImpl(id);},getWidgetById:function(id,obj,cb){com.ibm.mm.enabler.debug.entry("queryService.getWidgetById","id:",id,"obj:",obj,"cb",cb);var _41b=iWidgetContainer.getWidgetById(id);if(typeof _41b=="undefined"||_41b===null){return null;}if(_41b.loaded){com.ibm.mm.enabler.debug.log("queryService.getWidgetById","widget is loaded");if(typeof obj!="undefined"&&typeof cb!="undefined"){obj[cb](new com.ibm.mm.enabler.iw.WidgetStub(_41b));}else{return new com.ibm.mm.enabler.iw.WidgetStub(_41b);}}else{com.ibm.mm.enabler.debug.log("queryService.getWidgetById","widget is  not loaded");if(typeof obj!="undefined"&&typeof cb!="undefined"){var _41c={};_41c.widget=_41b;_41c.obj=obj;_41c.cb=cb;_41c.handleLoaded=function(){this.obj[this.cb](new com.ibm.mm.enabler.iw.WidgetStub(this.widget));};dojo.subscribe("/enabler/widgetLoaded/"+id,_41c,"handleLoaded");}else{return null;}}},getWidgetsByDefUrl:function(url){com.ibm.mm.enabler.debug.entry("queryService.getWidgetsByDefUrl","url:",url);var arr=[];for(id in iWidgetContainer.widgetArr){var _41f=iWidgetContainer.widgetArr[id];if(_41f&&_41f!==null){var _420=_41f.getWidgetInstance().widgetXMLUrl;if(typeof _420!="undefined"&&_420!==null&&url==_420){arr.push(id);}}}com.ibm.mm.enabler.debug.exit("queryService.getWidgetsByDefUrl",arr);return arr;}});dojo.declare("com.ibm.mm.enabler.iw.services.ServiceManager",null,{constructor:function(){this.serviceEntries={};this.services={};var aUrl;if(com.ibm.mm.enabler.services.CONFIG_SERVICE){aUrl=com.ibm.mm.enabler.services.CONFIG_SERVICE.getPreferenceValue(com.ibm.mm.enabler.services.CONFIG_SERVICE.CONTEXT_ROOT_ENABLER);}if(typeof aUrl=="undefined"||aUrl===null){aUrl="/mashupmaker";}this.serviceEntries["eventService"]=aUrl+"/js/com/ibm/enabler/iw/services.js";this.serviceEntries["queryService"]=aUrl+"/js/com/ibm/enabler/iw/services.js";this.serviceEntries["persistentAttributesFactoryService"]=aUrl+"/js/com/ibm/enabler/iw/services.js";this.serviceEntries["iwidgetFragmentService"]=aUrl+"/js/com/ibm/enabler/iw/services.js";if(typeof ibmConfig!="undefined"&&ibmConfig!=null&&typeof ibmConfig.loadServices!="undefined"&&ibmConfig.loadServices!=null&&ibmConfig.loadServices==true){aUrl=aUrl+this.serviceEntriesConfig;var me=this;var _423={url:aUrl,load:function(data,_425){var _426=dojo.fromJson(data);var _427;var i=0;for(_427 in _426){me.serviceEntries[_427]=_426[_427];i++;}},error:function(data,_42a){com.ibm.mm.enabler.debug.error("com.ibm.mm.enabler.iw.services.ServiceManager","error loading data",data);}};dojo.xhrGet(_423);}},serviceEntriesConfig:"/js/com/ibm/enabler/iw/serviceEntries.json",serviceNS:"com.ibm.mm.enabler.iw.services.",setService:function(_42b,_42c){this.serviceEntries[_42b]=_42c;},removeService:function(_42d){var _42e=this.services[_42d];var _42f=this.serviceEntries[_42d];if(typeof _42e!="undefined"||_42e!==null){this.services[_42d]=null;}if(typeof _42f!="undefined"||_42f!==null){this.serviceEntries[_42d]=null;}},getService:function(_430){var _431=this.services[_430];var _432=this.serviceEntries[_430];if(typeof _431=="undefined"||_431===null){_431=this._createService(_430);if(typeof _431=="undefined"||_431===null){if(typeof _432!="undefined"&&_432!==null){this._loadScript(_432);_431=this._createService(_430);if(typeof _431!="undefined"&&_431!==null){this.services[_430]=_431;}}}else{this.services[_430]=_431;}}return this.services[_430];},_loadScript:function(_433){var _434=document.createElement("script");_434.src=_433;document.body.insertBefore(_434,document.body.firstChild);},_createService:function(_435){var _436;try{_436=eval("new "+this.serviceNS+_435+"();");}catch(err){com.ibm.mm.enabler.debug.log("services.getService"," failed to create service error detail: "+err.description);}return _436;}});window.serviceManager=new com.ibm.mm.enabler.iw.services.ServiceManager();}if(!dojo._hasResource["com.ibm.mm.enabler.iw.internalservices"]){dojo._hasResource["com.ibm.mm.enabler.iw.internalservices"]=true;dojo.provide("com.ibm.mm.enabler.iw.internalservices");dojo.declare("com.ibm.mm.enabler.iw.services.loadService",null,{constructor:function(){this.modules={};},loadResource:function(_437,name,uri,cb,_43b){com.ibm.mm.enabler.debug.entry("loadService.loadResource","uri:"+uri+" mimetype:"+_43b+" widgetId:"+_437);var _43c;if(typeof name=="undefined"||name===null){name=uri;}if(typeof name!="undefined"&&name!==null){var _43d=this.modules[name];if(typeof _43d!="undefined"&&_43d!==null){_43c=true;}}if(_43c){return;}_43d={};_43d.id=name;_43d.src=uri;_43d.callback=cb;_43d.mimetype=_43b;path=this._rewriteUrl(uri,_437);var _43e=this._getExtension(uri);if(_43e!==null&&_43e=="css"){return this._loadCSS(path);}var http=dojo._xhrObj();var me=this;http.open("GET",path,false);try{http.send(null);if(http.status==200){var _441=http.responseText;var _442=_441.replace(/_IWID_/g,"_"+_437+"_");if(cb){}}}catch(e){return false;}if(!_442){return false;}if(_43e==="js"||_43b=="text/javascript"){var _443=dojo.eval(_442);}this.modules[name]=_43d;return true;},_rewriteUrl:function(uri,id){var _446=iWidgetContainer.getWidgetById(id);var _447=_446.getWidgetInstance().widgetXMLUrl;var _448=_447.substring(0,_447.lastIndexOf("/")+1);if(_448.indexOf("://")!=-1){var _449=uri.indexOf("://");var _44a=uri.indexOf("/",_449+1);var _44b=uri.substring(0,_44a);}var path=uri;if(uri.indexOf("://")==-1){if(uri.indexOf("/")===0){if(typeof (_44b)!="undefined"){path=_44b+uri;}}else{if(typeof (_448)!="undefined"){path=_448+uri;}}}if(path.indexOf("http")===0){path=com.ibm.mm.enabler.utilities.rewriteURL(path);}return path;},_getExtension:function(uri){return uri.substring(uri.lastIndexOf(".")+1,uri.length);},_loadCSS:function(path){var link=document.createElement("link");link.setAttribute("rel","stylesheet");link.setAttribute("type","text/css");link.setAttribute("href",path);document.getElementsByTagName("head")[0].appendChild(link);}});dojo.declare("com.ibm.mm.enabler.iw.services.widgetLoadService",null,{getWidgetXML:function(_450,_451){com.ibm.mm.enabler.debug.entry("widgetLoadService.getWidgetXML","widgetUrl:"+_450+" widgetId:"+_451);this.widgetId=_451;var me=this;var _453=_450;if(_453.indexOf("http")===0){_453=com.ibm.mm.enabler.utilities.rewriteURL(_453);}var args={url:_453,load:function(data,_456){me.handleLoad(data,_456.xhr);},error:function(data,_458){com.ibm.mm.enabler.debug.error("widgetLoadService.getWidgetXML","Error widgetLoadService.getWidgetXML error loading!"+data);var args=[];args.push("error");var _45a=dojo.i18n.getLocalization("com.ibm.mm.enabler","iwMessages");args.push(dojo.string.substitute(_45a.E_IWIDGETDEF_NOTAVAILABLE_1,[_453]));args.push(data.message);dojo.publish("/enabler/inlineMessage/"+me.widgetId,args);},handleAs:"text"};dojo.xhrGet(args);},handleLoad:function(data,xhr){var _45d=com.ibm.mm.enabler.iw.parser.WidgetParserFactory.getWidgetParser(xhr.responseText);var _45e=_45d.parseWidgetDefinition();this._fireEvents(_45e);},_fireEvents:function(_45f){this._fireIndividualWidgetStateChange(_45f);},_fireIndividualWidgetStateChange:function(_460){var args=[];args.push(_460);dojo.publish("/enabler/widgetXmlRetrieved/"+this.widgetId,args);}});}if(!dojo._hasResource["com.ibm.mm.enabler.iw"]){dojo._hasResource["com.ibm.mm.enabler.iw"]=true;dojo.provide("com.ibm.mm.enabler.iw");dojo.declare("com.ibm.mm.enabler.iWidgetWrapperDefaultImpl",null,{constructor:function(_462,id){this._internalIbmModes=com.ibm.mm.enabler.iw.ItemSet._internalIbmModes;this.rootElement=_462;if(typeof (id)!="undefined"&&id!=null){this.id=id;}else{this.id=_462.getAttribute("id");}this.simpleWidgetEvents={};this.loaded=false;this.widgetAttributes=null;this.widgetItemSets=null;this.xmlRetrievedHandler=dojo.subscribe("/enabler/widgetXmlRetrieved/"+this.id,this,"handleWidgetInfoRetrieved");this.eventServiceHandler=dojo.subscribe("/enabler/eventService/"+this.id,this,"handleEvent");this.ns=_462.className.substr(0,3);this.inlineMessageHandler=dojo.subscribe("/enabler/inlineMessage/"+this.id,this,"_handleInlineMessage");this.windowManager={};this.iwStr=dojo.i18n.getLocalization("com.ibm.mm.enabler","iwStr");this.iwMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","iwMessages");},getWidgetInstance:function(){if(typeof this.widgetInstance!="undefined"||this.widgetInstance!=null){return this.widgetInstance;}this.widgetInstance=new com.ibm.mm.enabler.iWidgetInstanceStandard(this.rootElement,this.id);return this.widgetInstance;},_resourceBaseURL:new dojo.moduleUrl("com.ibm.mm.enabler","iw/"),_jsHandler:com.ibm.mm.enabler.aggregation.javascript.JAVASCRIPT_HANDLER,_setLoading:function(){var _464=document.createElement("div");_464.className=this.ns+"content";if(ibmConfig&&ibmConfig.loadingHTML){_464.innerHTML=ibmConfig.loadingHTML;}else{_464.innerHTML="<img src='"+this._resourceBaseURL+"progress-anim.gif' />&nbsp;"+this.iwStr.LOAD;}this.rootElement.appendChild(_464);},_handleInlineMessage:function(type,_466,_467){var _468=[];com.ibm.mm.enabler.iw.utils.findElementByAttribute("class",this.ns+"content",this.rootElement,_468,false);var _469=_468[0];_469.innerHTML="";com.ibm.mm.enabler.debug.logInlineMessage(_469,type,_466,_467);},loadWidgetDefinition:function(){com.ibm.mm.enabler.debug.entry("iWidget.loadWidgetDefinition");var _46a=this.rootElement;if(this.loaded){return false;}this._setLoading();if(this.getWidgetInstance().widgetXMLUrl!==null){var _46b=new com.ibm.mm.enabler.iw.services.widgetLoadService();_46b.getWidgetXML(this.getWidgetInstance().widgetXMLUrl,this.id);}else{return false;}com.ibm.mm.enabler.debug.entry("iWidget.loadWidgetDefinition",true);return true;},render:function(){com.ibm.mm.enabler.debug.entry("iWidget.render");this.prepare();this.loadWidgetDefinition();com.ibm.mm.enabler.debug.exit("iWidget.render");},prepare:function(){com.ibm.mm.enabler.debug.entry("iWidget.prepare");variableName="_"+this.id+"_"+"iContext";dojo.global[variableName]=new com.ibm.mm.enabler.iw.iContextImpl(this.id,this.ns);com.ibm.mm.enabler.debug.exit("iWidget.prepare");},_updateMarkup:function(mode,_46d){com.ibm.mm.enabler.debug.entry("iWidget._updateMarkup");var _46e=this.widgetDef;var _46f=_46e.getMarkupByMode(mode);if(mode==iwConstants.mode_view){if(this.widgetDef.getAllowInstanceContent()){var temp=this.getWidgetInstance().getDefaultViewContent();if(temp&&temp!==null){_46f=temp;}}}if(typeof _46f=="undefined"||_46f===null){var _471=dojo.string.substitute(this.iwMessages.E_IWIDGETDEF_CONTENTNOTAVAILABLE_1,[mode]);com.ibm.mm.enabler.debug.info("iWidget._updateMarkup",_471);return false;}var _472=this._prepareMarkup(_46f);var _473=document.createElement("DIV");_473.innerHTML=_472;var _474=_473.getElementsByTagName("script");if(_474!==null){for(var i=0;i<_474.length;i++){var _476=_474[i];var id=_476.getAttribute("id");if(id===null||id==""){_476.setAttribute("id","_scr#"+i);}}}dojo.addClass(_46d,mode);_46d.innerHTML=_473.innerHTML;com.ibm.mm.enabler.dom.destroyNode(_473);com.ibm.mm.enabler.debug.exit("iWidget._updateMarkup");return true;},_prepareMarkup:function(_478){com.ibm.mm.enabler.debug.entry("iWidget._prepareMarkup");var _479=_478.replace(/_IWID_/g,"_"+this.id+"_");var _47a=_479.replace(/iContext(?=\.|\s|\(|\))/g,"_"+this.id+"_iContext");com.ibm.mm.enabler.debug.exit("iWidget._updateMarkup",_47a);return _47a;},destroy:function(){dojo.unsubscribe(this.xmlRetrievedHandler);dojo.unsubscribe(this.eventServiceHandler);dojo.unsubscribe(this.inlineMessageHandler);dojo.global["_"+this.id+"_"+"iContext"]=null;var arr=this.wires;var _47c=serviceManager.getService("eventService");if(typeof arr!="undefined"&&arr!=null){for(var i=0;i<arr.length;i++){var _47e=arr[i];_47c.unSubscribeWire(_47e["SourceWidget"],_47e["SourceEvent"],this.id,_47e["TargetEvent"]);}}_47c.unSubscribeWidgetWires(this.id);},handleWidgetInfoRetrieved:function(_47f){com.ibm.mm.enabler.debug.entry("iWidget.handleWidgetInfoRetrieved");this.widgetDef=_47f;this.update();this.onLoad();com.ibm.mm.enabler.debug.exit("iWidget.handleWidgetInfoRetrieved",this.id);},update:function(){this._initialize();var _480=this.rootElement.lastChild;this._updateMarkup(this.currentMode,_480);this._loadWidgetSharedResource();this._createiScope();this._evalScripts(_480);this.windowManager[this.currentMode]={id:this.currentMode,root:_480,active:true,external:false};},_initialize:function(){com.ibm.mm.enabler.debug.entry("iWidget._initialize");var lang=this.widgetDef.getDefaultLanguage();if(typeof lang!="undefined"&&lang!=null){this.defaultLanguage=lang;}else{this.defaultLanguage="en";}var _482=this._getDefaultMode();if(_482==null){_482=iwConstants.mode_view;}this.currentMode=_482;this.getPublishedEvents();this.getHandledEvents();this.getWires();com.ibm.mm.enabler.debug.exit("iWidget._initialize");},_evalScripts:function(_483){var _484=_483.getElementsByTagName("script");for(var i=0;i<_484.length;i++){this._jsHandler.handle(_484[i]);}},onLoad:function(){this._handleEventInternal(com.ibm.mm.enabler.iw.iEvents.Constants.onLoad);this._handleEventInternal("on"+this.currentMode);this.loaded=true;dojo.publish("/enabler/widgetLoaded/"+this.id);},_getSimpleEventHandler:function(_486){com.ibm.mm.enabler.debug.entry("iWidget._getSimpleEventHandler",_486);if(this.simpleWidgetEvents&&this.simpleWidgetEvents[_486]){return this.simpleWidgetEvents[_486];}var _487=this.widgetDef.getWidgetEvents()[_486];if(_487==null){_487=_486;}var _488=this._getHandlerScope(_487);var _489=null;if(_488!=null){_489=dojo.hitch(_488,_487);this.simpleWidgetEvents[_486]=_489;}else{if(_487.indexOf("on")==0){var _48a="on"+_487.substr(2,1).toUpperCase()+_487.substr(3);if(_48a!=_487){_488=this._getHandlerScope(_48a);if(_488!=null){_489=dojo.hitch(_488,_48a);this.simpleWidgetEvents[_486]=_489;}}}}com.ibm.mm.enabler.debug.exit("iWidget._getSimpleEventHandler",_489);return _489;},_getHandlerScope:function(_48b){com.ibm.mm.enabler.debug.entry("iWidget._getHandlerScope",_48b);var fn=dojo.global["_"+this.id+"_"+_48b];if(typeof (fn)=="undefined"){widgetScope=dojo.global["_"+this.id+"_iContext"].iScope();if(widgetScope&&widgetScope[_48b]){fn=widgetScope;}}if(typeof fn=="undefined"||fn==null){fn=dojo.global[_48b];}if(typeof fn=="undefined"||fn==null){return null;}else{com.ibm.mm.enabler.debug.exit("iWidget._getHandlerScope",fn);return fn;}},handleEvent:function(_48d,_48e){if(typeof _48d=="undefined"||_48d==null){return false;}if(_48d==com.ibm.mm.enabler.iw.iEvents.Constants.onModeChanged){return this._handleModeChange(_48e);}if(_48d=="onNewWire"){return this._handleNewWire(_48e);}if(_48d=="onRemoveWire"){return this._handleRemoveWire(_48e);}return this._handleEventInternal(_48d,_48e);},_handleNewWire:function(_48f){var _490=_48f.payload;var _491=_490.sourceEvent;var _492=this.publishedEvents[_491];if(typeof _492!="undefined"&&_492!=null){var _493=_492[0].getOnNewWire();if(_493!=null){var _494=this._getHandlerScope(_493);if(_494!=null&&dojo.isFunction(_494)){_494(_48f);}else{if(_494!=null&&dojo.isObject(_494)){_494[_493](_48f);}}return true;}}return false;},_handleRemoveWire:function(_495){var _496=_495.payload;var _497=_496.targetEvent;var _498=this.handledEvents[_497];if(typeof _498!="undefined"&&_498!=null){var _499=_498[0].getOnRemoveWire();if(_499!=null){var _49a=this._getHandlerScope(_499);if(_49a!=null&&dojo.isFunction(_49a)){_49a(_495);}else{if(_49a!=null&&dojo.isObject(_49a)){_49a[_499](_495);}}return true;}}return false;},_handleModeChange:function(_49b){var _49c=false;var _49d=this.currentMode;var _49e=_49b.payload;if(typeof _49e=="undefined"||_49e==null){return false;}if(dojo.isString(_49e)){_49e=dojo.fromJson(_49e);}if(typeof _49e=="undefined"||_49e==null){return false;}var _49f=_49e.newMode;if(typeof _49f=="undefined"){_49f=null;}var _4a0=_49e.rootElementId;if(typeof _4a0=="undefined"){_4a0=null;}if(_49f!=null&&_49f==this.currentMode){return false;}if(_49f==null){return false;}var _4a1=false;if(_4a0!=null){_4a1=true;}var _4a2=_4a0;var _4a3=this.windowManager[_49f];var _4a4=false;if(typeof _4a3!="undefined"&&_4a3!==null){var _4a5=_4a3.root;if(!_4a3.external&&_4a5!=null&&_4a0===null){_4a2=_4a5;_4a4=true;_49c=true;dojo.style(_4a5,"display","");}}if(!_4a4){if(_4a2===null){var _4a6=document.createElement("div");_4a6.className=this.ns+"content";this.rootElement.appendChild(_4a6);_4a2=this.rootElement.lastChild;}_49c=this._updateMarkup(_49f,_4a2);}if(_49c){var _4a7=this.windowManager[this.currentMode];var _4a8=_4a7.root;if(_4a7.external){dojo.style(_4a8,"display","none");this.windowManager[this.currentMode]=null;}else{if(_4a0!=null){_4a7.active=false;}else{_4a7.active=false;dojo.style(_4a8,"display","none");}}this.currentMode=_49f;this.windowManager[_49f]={id:_49f,root:_4a2,active:true,external:_4a1};if(!_4a4){this._evalScripts(_4a2);}this._handleOnModeEvent(_49f);}if(_49c){serviceManager.getService("eventService").publishEvent(com.ibm.mm.enabler.iw.iEvents.Constants.modeChanged,[this.id,_49d,_49f]);}return _49c;},_handleOnModeEvent:function(mode){var _4aa=false;var _4ab="on"+mode;var _4ac=this._getSimpleEventHandler(_4ab);if(_4ac!==null){_4ac();_4aa=true;}return _4aa;},_handleEventInternal:function(_4ad,_4ae){com.ibm.mm.enabler.debug.entry("iWidget._handleEventInternal",_4ad,_4ae);if(typeof _4ad=="undefined"||_4ad===null){return false;}var _4af=false;var _4b0=null;if(_4ad.indexOf("on")===0){var _4b1=this._getSimpleEventHandler(_4ad);if(_4b1!==null){_4b0=_4b1;}}if(_4b0===null){_4b0=this.getPublicEventHandler(_4ad);}if(_4b0!==null){com.ibm.mm.enabler.debug.log("iWidget._handleEventInternal","handlerFn:",_4b0);if(_4ae!="undefined"&&_4ae!==null){_4b0(_4ae);}else{_4b0();}_4af=true;}com.ibm.mm.enabler.debug.exit("iWidget._handleEventInternal",_4af);return _4af;},getPublicEventHandler:function(_4b2){com.ibm.mm.enabler.debug.entry("iWidget.getPublicEventHandler",_4b2);if(this.getHandledEvents()==null){return null;}var _4b3=this.getHandledEvents()[_4b2];if(!_4b3){return null;}var _4b4=_4b3[0].handlingFn;if(_4b4!=null){var _4b5=this._getHandlerScope(_4b4);var _4b6=null;if(_4b5!=null){_4b6=dojo.hitch(_4b5,_4b4);}}com.ibm.mm.enabler.debug.exit("iWidget._getPublicEventHandler",_4b6);return _4b6;},getParent:function(){if(!this.parent){this.parent=com.ibm.mm.enabler.iw.utils.getWidgetParent(this.id);}return this.parent;},getWidgetAttributes:function(){if(typeof (this.widgetAttributes)=="undefined"||this.widgetAttributes==null){var _4b7=serviceManager.getService("persistentAttributesFactoryService");this.widgetAttributes=_4b7.createPersistentAttributes(this);this._loadWidgetAttributes();}return this.widgetAttributes;},_loadDefWidgetAttributes:function(){com.ibm.mm.enabler.debug.entry("iWidget:_loadDefWidgetAttributes");if(typeof (this.widgetDef)!="undefined"){var _4b8=this.widgetDef.getAttributes();if(typeof _4b8!="undefined"&&_4b8!=null){var _4b9=_4b8.items;if(typeof _4b9!="undefined"&&_4b9!=null){for(var i in _4b9){var _4bb=_4b9[i];if(typeof _4bb!="undefined"&&_4bb!=null){var _4bc=_4bb.id;var _4bd=_4bb.value;var _4be=_4bb.readOnly;this.widgetAttributes._internal().setItemValue(_4bc,_4bd,_4be,this._internalIbmModes.xml);}}}}}com.ibm.mm.enabler.debug.exit("iWidget:_loadDefWidgetAttributes");},_loadWidgetInstanceAttributesFromRootElement:function(){com.ibm.mm.enabler.debug.entry("iWidget._loadWidgetInstanceAttributesFromRootElement");var _4bf=this.rootElement.attributes;for(var i=0;i<_4bf.length;i++){var att=_4bf[i];var _4c2=this.rootElement.getAttribute(att.name);if(typeof _4c2!="undefined"&&_4c2!=null&&_4c2!=""){this.widgetAttributes._internal().setItemValue(att.name,_4c2,false,this._internalIbmModes.microformat);com.ibm.mm.enabler.debug.log("iWidget._loadWidgetInstanceAttributesFromRootElement","name:"+att.name+" value:"+_4c2);}}com.ibm.mm.enabler.debug.exit("iWidget._loadWidgetInstanceAttributesFromRootElement");},getWidgetItemSet:function(name){if(typeof (this.widgetItemSets)=="undefined"||this.widgetItemSets==null){this._loadItemSets();}var _4c4=this.widgetItemSets[name];if(typeof _4c4=="undefined"){_4c4=new com.ibm.mm.enabler.iw.DefaultItemSetImpl(parent,name);this.widgetItemSets[name]=_4c4;}return _4c4;},_loadWidgetDefItemSets:function(){com.ibm.mm.enabler.debug.entry("iWidget._loadWidgetDefItemSets");if(typeof (this.widgetDef)!="undefined"){var _4c5=this.widgetDef.getAllItemSetNames();for(var i=0;i<_4c5.length;i++){var name=_4c5[i];var _4c8=this.widgetDef.getItemSet(name);var _4c9=new com.ibm.mm.enabler.iw.DefaultItemSetImpl(parent,_4c8.name,_4c8.onItemSetChanged,null,_4c8.isPrivate);var _4ca=_4c8.items;for(var j in _4ca){var _4cc=_4ca[j];_4c9.setItemValue(_4cc.id,_4cc.value,_4cc.isReadOnly);}this.widgetItemSets[name]=_4c9;}}com.ibm.mm.enabler.debug.exit("iWidget._loadWidgetDefItemSets");},_loadWidgetSharedResource:function(){var _4cd=this.widgetDef.getResources();com.ibm.mm.enabler.debug.entry("iWidget._loadWidgetSharedResource",_4cd);if(typeof _4cd!="undefined"&&_4cd!=null){for(var i in _4cd){var _4cf=_4cd[i];var name=_4cf[iwConstants.RESOURCE.id];var uri=_4cf[iwConstants.RESOURCE.src];var _4d2=_4cf[iwConstants.RESOURCE.mimetype];var _4d3=_4cf[iwConstants.RESOURCE.callback];if(typeof _4d2=="undefined"||_4d2==null){_4d2="text/plain";}if(typeof uri!="undefined"&&uri!=null){serviceManager.getService("loadService").loadResource(this.id,null,uri,_4d3,_4d2);}}}com.ibm.mm.enabler.debug.exit("iWidget._loadWidgetSharedResource");},_createiScope:function(){var _4d4=this.widgetDef.getIScope();com.ibm.mm.enabler.debug.entry("iWidget._createiScope",_4d4);if(typeof _4d4!=undefined&&_4d4!=null){try{this.iScope=eval("new "+_4d4+"();");}catch(err){com.ibm.mm.enabler.debug.log("iWidget._createiScope","iScope"+_4d4,"Error",err);}}if(typeof this.iScope=="undefined"||this.iScope==null){this.iScope={};}dojo.global["_"+this.id+"_iContext"].scope=this.iScope;this.iScope.iContext=dojo.global["_"+this.id+"_iContext"];},getIDescriptor:function(){if(this.iDescriptor){return this.iDescriptor;}this.iDescriptor=new com.ibm.mm.enabler.iw.iDescriptor(this.id,this.widgetDef.getiDescriptor(),this.getWidgetInstance().getiDescriptor());return this.iDescriptor;},getPublishedEvents:function(){com.ibm.mm.enabler.debug.entry("com.ibm.mm.enabler.iWidgetWrapperStandardImpl.getPublishedEvents");if(!this.publishedEvents){this.publishedEvents=this.widgetDef.getPublishedEvents();}com.ibm.mm.enabler.debug.exit("iWidget.getPublishedEvents",this.publishedEvents);return this.publishedEvents;},getHandledEvents:function(){com.ibm.mm.enabler.debug.entry("iWidget.getHandledEvents");if(!this.handledEvents){this.handledEvents=this.widgetDef.getHandledEvents();}com.ibm.mm.enabler.debug.exit("iWidget.getHandledEvents",this.handledEvents);return this.handledEvents;},_loadWidgetAttributes:function(){com.ibm.mm.enabler.debug.entry("iWidget:_loadWidgetAttributes");this._loadDefWidgetAttributes();var _4d5=this.getWidgetInstance().getWidgetAttributes();if(_4d5!=null){for(var i in _4d5){var name=i;var _4d8=_4d5[name].defaultValue;_4d8=_4d8.replace(/&lt;/gi,"<");_4d8=_4d8.replace(/&gt;/gi,">");_4d8=_4d8.replace(/&amp;/gi,"&");this.widgetAttributes._internal().setItemValue(name,_4d8,false,this._internalIbmModes.microformat);}}com.ibm.mm.enabler.debug.exit("iWidget:_loadWidgetAttributes");},_loadItemSets:function(){com.ibm.mm.enabler.debug.entry("iWidget._loadItemSets");this.widgetItemSets={};this._loadWidgetDefItemSets();var _4d9=this.getWidgetInstance().getItemSets();if(_4d9!=null){for(var i in _4d9){if(i==iwConstants.ATTRIBUTES||i==iwConstants.USERPROFILE||i==iwConstants.IDESCRIPTOR){continue;}var _4db=_4d9[i];var _4dc=this.widgetItemSets[i];if(typeof _4dc=="undefined"||_4dc==null){_4dc=new com.ibm.mm.enabler.iw.DefaultItemSetImpl(this,i);this.widgetItemSets[i]=_4dc;}for(var j in _4db){var _4de=j;var _4df=_4db[_4de]["defaultValue"];this.widgetItemSets[i].setItemValue(_4de,_4df,false);}}}com.ibm.mm.enabler.debug.exit("iWidget._loadItemSets");},_getDefaultMode:function(){var _4e0=this.getWidgetInstance().getiDescriptor();if(typeof _4e0!="undefined"&&_4e0!=null){var _4e1=_4e0[iwConstants.iDescriptorItems.mode];if(typeof _4e1!="undefined"||_4e1!=null){return _4e1.defaultValue;}}var _4e2=this.widgetDef.getiDescriptor();var _4e3=null;if(typeof _4e2!="undefined"&&_4e2!=null){_4e3=_4e2[iwConstants.iDescriptorItems.mode];if(typeof _4e3=="undefined"){_4e3=null;}}return _4e3;},getWires:function(){if(typeof (this.wires)=="undefined"||this.wires===null){this.wires=this.getWidgetInstance().getWires();for(var i=0;i<this.wires.length;i++){var _4e5=this.wires[i];serviceManager.getService("eventService").subscribeWire(_4e5.SourceWidget,_4e5.SourceEvent,this.id,_4e5.TargetEvent);}}return this.wires;}});dojo.declare("com.ibm.mm.enabler.iWidgetContainer",null,{constructor:function(){this.widgetArr={};this.eventService=serviceManager.getService("eventService");this.queryService=serviceManager.getService("queryService");dojo.subscribe("/enabler/pageChanged",this,"_unloadWidgets");dojo.subscribe("/enabler/widgetDeleted",this,"_unloadWidgets");dojo.subscribe("/enabler/unloadWidget",this,"_unloadWidgets");var url=new dojo.moduleUrl("com.ibm.mm.enabler","iw/"),url=url+"progress-anim.gif";this.processAnim=com.ibm.mm.enabler.utilities.preloadImage(url,20,20);},createWidget:function(_4e7){com.ibm.mm.enabler.debug.entry("iWidgetContainer.createWidget",_4e7);var id=_4e7.getAttribute("id");if(typeof (id)=="undefined"){return;}var _4e9=this.widgetArr[id];if(typeof _4e9!="undefined"&&_4e9!==null){var _4ea=_4e9.rootElement;if(_4ea==_4e7){return _4e9;}else{this._unloadWidget(id);}}var _4eb=new com.ibm.mm.enabler.iWidgetWrapperDefaultImpl(_4e7,id);this.widgetArr[id]=_4eb;com.ibm.mm.enabler.debug.exit("iWidgetContainer.createWidget",_4eb);return _4eb;},renderWidget:function(_4ec){if(typeof _4ec=="undefined"){return;}if(_4ec.loaded&&_4ec.loaded==true){return;}_4ec.render();},getWidgetById:function(id){com.ibm.mm.enabler.debug.entry("iWidgetContainer.getWidgetById",id);var _4ee=this.widgetArr[id];if(typeof _4ee!="undefined"){com.ibm.mm.enabler.debug.exit("iWidgetContainer.getWidgetById",_4ee);return _4ee;}return null;},_unloadWidgets:function(arr){com.ibm.mm.enabler.debug.entry("iWidgetContainer._unloadWidgets");var _4f0;if(typeof arr!="undefined"||arr!==null){if(dojo.isArray(arr)){for(var i in arr){_4f0=arr[i];this._unloadWidget(_4f0);}dojo.publish("/enabler/widgetsUnloaded");}else{if(dojo.isString(arr)){this._unloadWidget(arr);}}}},_unloadWidget:function(_4f2){if(typeof this.widgetArr[_4f2]!="undefined"&&this.widgetArr[_4f2]!==null){var _4f3=this.widgetArr[_4f2];if(_4f3.loaded){_4f3.handleEvent(com.ibm.mm.enabler.iw.iEvents.Constants.onUnLoad);_4f3.destroy();delete this.widgetArr[_4f2];}else{_4f3.destroy();delete this.widgetArr[_4f2];}}}});iWidgetContainer=new com.ibm.mm.enabler.iWidgetContainer();dojo.declare("com.ibm.mm.enabler.iWidgetInstanceStandard",null,{constructor:function(_4f4,id){this.rootElement=_4f4;this.id=id;this.ns=_4f4.className.substr(0,3);var _4f6=[];className=this.ns+"Definition";com.ibm.mm.enabler.iw.utils.findElementByAttribute("class",className,this.rootElement,_4f6,false);var node=_4f6[0];var url=node.getAttribute("href");if(typeof (url)!="undefined"&&url!==null){this.widgetXMLUrl=url;}},getDefaultViewContent:function(){if(this.defaultViewContent){return this.defaultViewContent;}var _4f9=this.ns+"Content";var _4fa=dojo.query("span."+_4f9,this.rootElement);if(typeof _4fa!="undefined"&&_4fa!==null){var node=_4fa[0];}if(node){this.defaultViewContent=node.innerHTML;return this.defaultViewContent;}else{return null;}},getWidgetEvents:function(){if(this.widgetEvents){return this.widgetEvents;}var _4fc={};var _4fd=this.rootElement.attributes;for(var i=0;i<_4fd.length;i++){var _4ff=_4fd[i];if(_4ff.name!==null&&_4ff.name.indexOf("on")===0){var _500=this.rootElement.getAttribute(_4ff.name);if(typeof _500!="undefined"&&_500!==null){_4fc[_4ff.name]=_500;com.ibm.mm.enabler.debug.log("iWidgetInstance.getWidgetEvents","eventName:"+_4ff.name+" handler:"+_4fc[_4ff.name]);}}}this.widgetEvents=_4fc;return this.widgetEvents;},getWires:function(){var _501=[];var ns=this.ns;var _503="ReceivedEvent";var _504=[];com.ibm.mm.enabler.iw.utils.findElementByAttribute("class",ns+_503,this.rootElement,_504,true);var _505=["SourceWidget","SourceEvent","TargetEvent"];var _506=["SourceEvent","TargetEvent"];for(var i=0;i<_504.length;i++){var _508=_504[i];var _509={};var _50a=true;for(var j=0;j<2;j++){var _50c=[];com.ibm.mm.enabler.iw.utils.findElementByAttribute("class",ns+_506[j],_508,_50c,false);if(_50c.length==0){_50a=false;}else{if(j==0){var temp=_50c[0].getAttribute("href");if(typeof temp!="undefined"||temp!=null){var _50e=temp.indexOf("#");if(_50e!=-1){temp=temp.substring(_50e+1);}_509[_505[0]]=temp;_509[_505[1]]=_50c[0].innerHTML;}}else{_509[_505[2]]=_50c[0].innerHTML;}}}if(_50a){_501.push(_509);}}return _501;},getWidgetAttributes:function(){var _50f=this.getItemSets()[iwConstants.ATTRIBUTES];if(typeof _50f=="undefined"){_50f=null;}return _50f;},getiDescriptor:function(){var _510=this.getItemSets()[iwConstants.IDESCRIPTOR];if(typeof _510=="undefined"){_510=null;}return _510;},getItemSets:function(){if(this.itemSets){return this.itemSets;}this.loadItemSets();return this.itemSets;},loadItemSets:function(){delete this.itemSets;this.itemSets={};var _511=[];com.ibm.mm.enabler.iw.utils.findElementByAttribute("class",this.ns+"ItemSet",this.rootElement,_511,true);if(_511.length>0){for(var i=0;i<_511.length;i++){var elem=_511[i];var _514=elem.getAttribute("title");if(typeof (_514)!="undefined"){aItemSet=this.itemSets[_514];if(typeof aItemSet=="undefined"||aItemSet===null){this.itemSets[_514]={};}var _515=[];com.ibm.mm.enabler.iw.utils.findElementByAttribute("class",this.ns+"Item",elem,_515,true);if(_515.length!=0){for(var j=0;j<_515.length;j++){var _517=_515[j];var _518=this._loadLocalizedItem(_517);var _519=_518.itemName;this.itemSets[_514][_519]=_518;}}}}}},_loadLocalizedItem:function(_51a){var item={};var _51c=_51a.getAttribute("href");var _51d=_51c.indexOf("#");if(_51d!=-1){_51c=_51c.substring(_51d+1);}item.itemName=_51c;var lang=_51a.getAttribute("lang");if(typeof lang=="undefined"){lang=null;}if(lang!=null){item.defaultLang=lang;}var _51f=_51a.innerHTML;if(typeof _51f!="undefined"||_51f!=null){item.defaultValue=_51f;}com.ibm.mm.enabler.debug.exit("com.ibm.mm.enabler.iWidgetInstanceStandard._loadLocalizedItem","item:"+item);return item;}});iwConstants={mode_view:"view",mode_edit:"edit",mode_help:"help",ATTRIBUTES:"attributes",IDESCRIPTOR:"idescriptor",USERPROFILE:"userprofile",iDescriptorItems:{title:"title",name:"name",description:"description",defaultHeight:"defaultHeight",defaultWidth:"defaultWidth",locales:"locales",mode:"mode",size:"size",author:"author",email:"email",website:"website",version:"version",globalAttributes:"globalAttributes",icon:"icon"},CSSCLASS_INSTANCE:{iwiWidget:"iWidget",iwDefinition:"Definition",iwHandler:"Handler",iwItemDescription:"ItemDescription",iwReadOnly:"ReadOnly",iwItemSet:"ItemSet",iwItemSetDescRef:"ItemSetDescRef",iwResource:"Resource",iwSrc:"iwSrc",iwmime:"mime",iwversion:"version",iwcallback:"callback",iwContent:"Content",iwAllowInstanceContent:"AllowInstanceContent",iwReceivedEvent:"ReceivedEvent",iwSourceEvent:"SourceEvent",iwTargetEvent:"TargetEvent",iwItem:"Item",iwValue:"Value"},RESOURCE:{src:"src",id:"id",mimetype:"mimetype",callback:"callback",version:"version"}};}if(!dojo._hasResource["com.ibm.mm.livetext.serviceImpl"]){dojo._hasResource["com.ibm.mm.livetext.serviceImpl"]=true;dojo.provide("com.ibm.mm.livetext.serviceImpl");dojo.declare("com.ibm.mm.livetext.serviceImpl",null,{_tagTypes:null,tagChanged:"/com/ibm/mashups/livetext/livetextchanged",tagStatusChange:"/com/ibm/mashups/livetext/livetextchanged",tagContentChanged:"/com/ibm/mashups/livetext/livetextcontentchanged",entryAdded:"/com/ibm/mashups/livetext/configentryadded",entryRemoved:"/com/ibm/mashups/livetext/configentryremoved",init:function(){this._loadTags();dojo.subscribe(this.tagChanged,this,"onTagChanged");dojo.subscribe(this.tagContentChanged,this,"onTagContentChanged");dojo.subscribe(this.entryAdded,this,"onAddConfigEntry");dojo.subscribe(this.entryRemoved,this,"onRemoveConfigEntry");dojo.publish(this.tagContentChanged,[document,true]);},_getNodes:function(node,_521){if(_521.processEnclosedTags){return dojo.query(_521.match,node);}else{var a=dojo.query(_521.match+" "+_521.match,node);var b=dojo.query(_521.match,node);var _524,_525;while(a.length>0){_524=a[0];_525=0;while(_525<b.length){if(_524==b[_525]){a.splice(0,1);b.splice(_525,1);break;}else{_525++;}}}return b;}},onTagChanged:function(node,_527,_528,_529){var tag=null,_52b=null,tags=null;for(var _52d=0;_52d<this._tagTypes.length;_52d++){tag=this._tagTypes[_52d];this._processTypeTag(node,tag,_527,_528,_529,true);}},onTagContentChanged:function(node,_52f,_530,_531){var tag=null,_533=null,tags=null;for(var _535=0;_535<this._tagTypes.length;_535++){tag=this._tagTypes[_535];this._processTypeTag(node,tag,_52f,_530,_531,false);}},_processTypeTag:function(node,tag,_538,_539,_53a,_53b){var tags=[];if(_53b&&this._checkRoot(node,tag)){tags[0]=node;}tags=tags.concat(this._getNodes(node,tag));var _53d=[];_53d=_53d.concat(tags);if(_53d.length>0){if(tag.loaded==null){this._loadTagHandler(tag);}var _53e=[];if(dojo.isFunction(_539)){try{_539(node,_53d);}catch(error){console.debug(error);}}for(var _53f=0;_53f<tags.length;_53f++){try{tag.tagHandler.processTag(tags[_53f]);}catch(error){_53e[_53e.length]=error;if(_538){break;}}}if(dojo.isFunction(_53a)){try{_53a(node,_53d,_53e);}catch(error){console.debug(error);}}}},_checkRoot:function(node,tag){var _542=false;if(node!=null&&node.nodeType){var _543=node.cloneNode(false);var _544=document.createElement("div");_544.appendChild(_543);var _545=this._getNodes(_544,tag);if(_545!=null&&_545.length>0){_542=true;}delete _543;delete _544;delete _545;}return _542;},_loadTags:function(){if(this._tagTypes==null){var _546=this;if(typeof livetextCfg!="undefined"){this._tagTypes=livetextCfg;}else{dojo.xhrGet({url:dojo.moduleUrl("com.ibm.mm.livetext","tagservice.entries.cfg"),handleAs:"text",sync:true,load:function(_547){_546._tagTypes=dojo.fromJson(_547);},error:function(data){console.dir(data);}});}}},onAddConfigEntry:function(_549){},onRemoveConfigEntry:function(_54a){},parseDom:function(_54b,node){dojo.publish(this.tagChanged,[node]);},_loadTagHandler:function(tag){dojo.registerModulePath(tag.module,tag.path);dojo.eval("dojo.r"+"equire('"+tag.baseClass+"')");var _54e="{create:function(){return new "+tag.baseClass+"()}}";var _54f=dojo.fromJson(_54e);tag.tagHandler=_54f.create();tag.loaded=true;}});}if(!dojo._hasResource["tagservices.widgets"]){dojo._hasResource["tagservices.widgets"]=true;dojo.provide("tagservices.widgets");dojo.declare("tagservices.widgets",null,{processTag:function(tag){com.ibm.mm.enabler.debug.entry("tagservices.widgets.processTag","Tag:"+tag);com.ibm.mm.enabler.debug.log("tagservices.widgets.processTag","widgets:process IWidget");var _551=iWidgetContainer.createWidget(tag);if(_551){iWidgetContainer.renderWidget(_551);}}});}dojo.i18n._preloadLocalizations("dojo.nls.mum_enabler_connections",["da","es","hu","de","pt-br","pl","pt","sv","ar","fi","zh","ru","xx","fr","zh-tw","it","cs","iw","nl","el","no","ko","tr","en","ROOT","ja"]);
/* ***************************************************************** */
/* Copyright IBM Corp. 2001, 2009  All Rights Reserved.              */
/* ***************************************************************** */
dojo.provide("lconn.communities");
if(!dojo._hasResource["com.ibm.ajax.auth"]){
dojo._hasResource["com.ibm.ajax.auth"]=true;
dojo.provide("com.ibm.ajax.auth");
com.ibm.ajax.auth={prepareSecure:function(_1,_2,_3){
if(_1["com.ibm.ajax.auth.prepareSecureCalled"]){
return _1;
}else{
_1["com.ibm.ajax.auth.prepareSecureCalled"]=true;
}
_1._handle=_1.handle;
_1.handle=dojo.partial(this.testAuthenticationHandler,this,_2,_3);
return _1;
},setAuthenticationHandler:function(_4){
this.authenticationHandler=_4;
},setTestAuthenticationHandler:function(_5){
this.testAuthenticationHandler=_5;
},setDefaultAuthenticationTests:function(_6,_7,_8){
this.checkFromCaller=_6;
this.checkByContentType=_7;
this.checkByStatusCode=_8;
},addAuthenticationCheck:function(_9){
if(_9){
this.authenticationChecks.push(_9);
}
},isAuthenticationRequired:function(_a,_b){
if(_b.xhr&&(!_a||dojo.indexOf(["cancel","timeout"],_a.dojoType)==-1)){
var _c;
try{
_c=_b.xhr.status;
}
catch(e){
}
var _d=_b.args.expectedContentType;
if(!_d){
_d=_b.args.handleAs;
}
var _e=dojo.indexOf(["xml","json","json-comment-optional"],_d)!=-1;
if(window.debugMode!=null){
console.log("auth::isAuthenticationRequired DEBUG expectedContentType: "+_d+" restContentExpected: "+_e+" for "+_b.args.url);
}
if(this.checkByContentType&&_e&&/^text\/html/.exec(_b.xhr.getResponseHeader("Content-Type"))&&_c>=200&&_c<300){
console.log("auth::isAuthenticationRequired DEBUG content type does not match request, assume logged out");
return true;
}
if(this.checkByStatusCode&&_e){
if(_c==302){
console.log("auth::isAuthenticationRequired DEBUG redirect received, assume login request");
return true;
}
if(_c==401){
console.log("auth::isAuthenticationRequired DEBUG 401 Unauthorized, assume login required");
return true;
}
if(dojo.isIE&&(_c==0||_c=="unknown")){
console.log("auth::isAuthenticationRequired DEBUG status code was 0 or 'unknown' in IE, assume login request");
return true;
}
}
}
for(var i=0;i<this.authenticationChecks.length;i++){
if(this.authenticationChecks[i](this,_a,_b)){
return true;
}
}
return false;
},testAuthenticationHandler:function(_10,_11,_12,_13,_14){
var _15=dojo._toArray(arguments).slice(3);
var _16=false;
if(!_13||dojo.indexOf(["cancel","timeout"],_13.dojoType)==-1){
if(_10.checkFromCaller&&typeof _11=="function"&&_11(_13,_14)){
console.log("auth::_testAuthentication DEBUG caller provided detection logic that indicated form login, assume logged out");
_16=true;
}else{
_16=_10.isAuthenticationRequired(_13,_14,_11);
}
}
if(_16){
var _17=_10._parseUri(_14.args.url).path;
dojo.cookie("WASPostParam",null,{expires:-1,path:_17});
dojo.cookie("WASReqURL",null,{expires:-1,path:"/"});
_10.authenticationHandler(_13,_14,_12);
_15[0]=new Error("xhr unauthenticated");
_15[0].dojoType="unauthenticated";
}
if(_14.args._handle){
return _14.args._handle.apply(this,_15);
}else{
return (_13);
}
},_parseUri:function(uri){
if(!uri){
return null;
}
uri=new dojo._Url(uri);
var _19=this._splitQuery(uri.query);
uri.queryParameters=_19;
return uri;
},_splitQuery:function(_1a){
var _1b={};
if(!_1a){
return _1b;
}
if(_1a.charAt(0)=="?"){
_1a=_1a.substring(1);
}
var _1c=_1a.split("&");
for(var i=0;i<_1c.length;i++){
if(_1c[i].length>0){
var _1e=_1c[i].indexOf("=");
if(_1e==-1){
var key=decodeURIComponent(_1c[i]);
var _20=_1b[key];
if(dojo.isArray(_20)){
_20.push("");
}else{
if(_20){
_1b[key]=[_20,""];
}else{
_1b[key]="";
}
}
}else{
if(_1e>0){
var key=decodeURIComponent(_1c[i].substring(0,_1e));
var _21=decodeURIComponent(_1c[i].substring(_1e+1));
var _20=_1b[key];
if(dojo.isArray(_20)){
_20.push(_21);
}else{
if(_20){
_1b[key]=[_20,_21];
}else{
_1b[key]=_21;
}
}
}
}
}
}
return _1b;
},checkFromCaller:true,checkByContentType:true,checkByStatusCode:true,authenticationChecks:[],authenticationHandler:function(){
console.log("auth::authenticationHandler DEBUG authentication was required");
}};
}
if(!dojo._hasResource["lconn.core.Res"]){
dojo._hasResource["lconn.core.Res"]=true;
dojo.provide("lconn.core.Res");
dojo.declare("lconn.core.Res",[],{bundleFor:"lconn.core",resBundle:null,loadDefaultBundle:function(){
this.resBundle=dojo.i18n.getLocalization(this.bundleFor,"strings");
},loadBundle:function(pkg){
this.resBundle=dojo.i18n.getLocalization(pkg,"strings");
},getDefaultBundle:function(){
return dojo.i18n.getLocalization(this.bundleFor,"strings");
},getBundle:function(pkg){
return dojo.i18n.getLocalization(pkg,"strings");
},getStringFrom:function(pkg,key,_26){
var _27=dojo.i18n.getLocalization(pkg,"strings")[key];
if(_26==undefined){
return _27;
}else{
return dojo.string.substitute(_27,_26);
}
},getString:function(key,_29){
var _2a=dojo.i18n.getLocalization(this.bundleFor,"strings")[key];
if(_29==undefined){
return _2a;
}else{
return dojo.string.substitute(_2a,_29);
}
}});
}
if(!dojo._hasResource["lconn.core.DateUtil"]){
dojo._hasResource["lconn.core.DateUtil"]=true;
dojo.provide("lconn.core.DateUtil");
var w={};
w.MILLS_IN_DAY=86400000;
w.inited=null;
w.Today="Error: not inited";
w.Yesterday="Error: not inited";
w.Tomorrow="Error: not inited";
w.initResStrings=function(){
var res=new lconn.core.Res();
res.loadDefaultBundle();
var b=res.resBundle;
this.Today=b.rs_today;
this.Yesterday=b.rs_yesterday;
this.Tomorrow=b.rs_tomorrow;
this.inited=true;
};
w.delta=function(_2d,_2e){
var _2f=_2d.getTime()-_2e;
var _30=Math.ceil(_2f/(this.MILLS_IN_DAY));
return _30;
};
w.toString=function(_31,_32){
var _33;
if(!_31||!(_33=Date.parse(_31))){
console.log("Invalid date passed to DateUtil.toString(): "+_31);
return;
}
var _34="";
_34=this.toStringForTimeinMs(_33,_32);
if(djConfig.locale=="ar"){
return "‏"+_34;
}
return _34;
};
w.toStringForTimeinMs=function(_35,_36){
if(this.Days==null){
this.Days=dojo.i18n.getLocalization("dojo.cldr","gregorian")["days-format-wide"];
}
if(this.Month==null){
this.Month=dojo.i18n.getLocalization("dojo.cldr","gregorian")["months-format-abbr"];
}
if(this.inited==null){
this.initResStrings();
}
var _37=new Date();
_37.setHours(0,0,0,0);
var _38=new Date();
_38.setTime(_35);
var _39=this.delta(_37,_35);
var _3a="";
if(_39<=2&&_39>=-2){
if(_39==2){
if(_36===undefined){
_3a=this.Days[_38.getDay()]+" "+this.getLocalizedTime(_38);
}else{
_3a=this.Days[_38.getDay()];
}
}else{
if(_39==1){
if(_36===undefined){
_3a=this.Yesterday+" "+this.getLocalizedTime(_38);
}else{
_3a=this.Yesterday;
}
}else{
if(_39==0){
if(_36===undefined){
_3a=this.Today+" "+this.getLocalizedTime(_38);
}else{
_3a=this.Today;
}
}else{
if(_39==-1){
_3a=this.Tomorrow;
}else{
if(_39==-2){
_3a=this.Days[_38.getDay()];
}
}
}
}
}
}else{
if(_37.getFullYear()==_38.getFullYear()){
var _3b=djConfig.locale.substring(0,2).toLowerCase();
var _3c="";
if(djConfig.locale.length>2){
_3c=djConfig.locale.substring(3,5).toLowerCase();
}
if(_3b=="en"&&(_3c==""||_3c=="us")){
_3a=this.Month[_38.getMonth()]+" "+_38.getDate();
}else{
_3a=this.getLocalizedDate(_38);
}
}else{
var _3b=djConfig.locale.substring(0,2).toLowerCase();
var _3c="";
if(djConfig.locale.length>2){
_3c=djConfig.locale.substring(3,5).toLowerCase();
}
if(_3b=="en"&&(_3c==""||_3c=="us")){
_3a=this.Month[_38.getMonth()]+" "+_38.getDate()+" "+_38.getFullYear();
}else{
_3a=this.getLocalizedDate(_38);
}
}
}
return _3a;
};
w.getLocalizedTime=function(_3d){
return dojo.date.locale.format(_3d,{selector:"time",formatLength:"short",locale:djConfig.locale});
};
w.getLocalizedDate=function(_3e){
return dojo.date.locale.format(_3e,{selector:"date",formatLength:"medium",locale:djConfig.locale});
};
w.getLocaleString=function(_3f){
var _40=new Date();
_40.setTime(_3f);
return _40.toLocaleString();
};
lconn.core.DateUtil=w;
lconn.core.DateUtil.AtomDateToString=function(_41){
var _42=_41;
var s=_41;
var _44=(s.charAt(s.length-1)=="Z");
var _45=s.indexOf("-");
if(s.length>="yyyy-mm-ddThh:mm".length){
s=s.substring(_45-4);
var y=parseInt(s.substr(0,4));
var m=parseInt(s.substr(5,2),10)-1;
var d=parseInt(s.substr(8,2),10);
var h=parseInt(s.substr(11,2),10);
var mi=parseInt(s.substr(14,2),10);
var utc=0;
if(_44){
var _4c=s.substring(17,s.length-1);
var _4d=parseFloat(_4c);
utc=Date.UTC(y,m,d,h,mi)+_4d*1000;
}else{
var zh=0;
var zm=0;
var _50=s.length-6;
var _51=s.charAt(_50);
if((_51=="+"||_51=="-")&&s.indexOf("T")<s.length-5){
var se=parseInt(s.substr(17,2),10);
var zh=parseInt(s.substr(_50,3),10);
var zm=parseInt(s.substr(_50+4,2),10);
}
utc=Date.UTC(y,m,d,h,mi,se)-(zh*60*60*1000+zm*60*1000);
}
var _53=new Date(utc);
_42=lconn.core.DateUtil.toString(_53);
}
return _42;
};
}
if(!dojo._hasResource["lconn.core.auth.whiteListHelper"]){
dojo._hasResource["lconn.core.auth.whiteListHelper"]=true;
dojo.provide("lconn.core.auth.whiteListHelper");
dojo.declare("lconn.core.auth.whiteListHelper",null,{_list:null,_serviceJson:null,_proxyUrl:null,constructor:function(_54,_55){
if(_54==null){
throw new Error("serviceJson or proxyUrl is null");
}
this._serviceJson=_54;
if(_55!=null){
this._proxyUrl=_55;
}
this._initList();
},_initList:function(){
if(this._list==null){
this._list=[];
try{
for(var key in this._serviceJson){
if((this._serviceJson[key].url!=null)&&(dojo.isString(this._serviceJson[key].url))){
var _57=this._serviceJson[key].url.replace("http://","");
var _57=_57.replace("https://","");
if(this._list.indexOf(_57)==-1){
this._list.push(_57);
}
}
if((this._serviceJson[key].secureUrl!=null)&&(dojo.isString(this._serviceJson[key].secureUrl))){
var _57=this._serviceJson[key].secureUrl.replace("http://","");
var _57=_57.replace("https://","");
if(this._list.indexOf(_57)==-1){
this._list.push(_57);
}
}
}
}
catch(e){
console.log("Error while creating the whitelisted urls");
console.log(e);
this._list=[];
}
}
},isWhiteListedURL:function(url){
var _59=false;
if((url.indexOf("http://")!=0)&&(url.indexOf("https://")!=0)&&((this._proxyUrl==null)||(this._proxyUrl!=null&&url.indexOf(this._proxyUrl)==-1))){
_59=true;
}else{
if((this._proxyUrl!=null)&&(url.indexOf(this._proxyUrl)==0)){
url=unescape(url);
url=url.replace(this._proxyUrl,"");
}
_59=!dojo.every(this._list,function(_5a){
return (url.indexOf(_5a)==-1);
});
}
return _59;
}});
}
if(!dojo._hasResource["lconn.core.TagSlider"]){
dojo._hasResource["lconn.core.TagSlider"]=true;
dojo.provide("lconn.core.TagSlider");
lconn.core.TagSlider.showTagVis=function(_5b,_5c){
if(!dojo.byId(_5c)){
return;
}
var _5d=dojo.byId(_5c).getElementsByTagName("li");
for(var i=0;i<_5d.length;i++){
var _5f=_5d[i];
var _60=_5f.className.match(/^f\d+-(\d+)/);
if(_60){
var _61=_60[1];
_5f.style.display=(_61>=_5b)?"inline":"none";
}
}
};
lconn.core.TagSlider.updateTagVis=function(_62,_63){
dojo.cookie("sliderVis_lconnTagSliderHandle",_62);
lconn.core.TagSlider.showTagVis(_62,_63);
};
lconn.core.TagSlider.sliderUtilGetPosition=function(_64){
var _65=dojo.cookie(_64);
if(_65==null||_65<0){
_65=0;
}else{
if(_65>100){
_65=100;
}
}
return _65;
};
}
if(!dojo._hasResource["lconn.core.TypeAhead"]){
dojo._hasResource["lconn.core.TypeAhead"]=true;
dojo.provide("lconn.core.TypeAhead");
dojo.declare("lconn.core.TypeAhead",[dijit.form.ComboBox],{formatItem:function(_66,_67){
if(!_67){
return _66;
}else{
return _66=_66.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");
}
},minChars:1,hasDownArrow:false,multipleValues:true,token:"",autoComplete:false,submitFormOnKey:false,_onKeyPress:function(evt){
var key=evt.charOrCode;
if(evt.altKey||(evt.ctrlKey&&(key!="x"&&key!="v"))||evt.key==dojo.keys.SHIFT){
return;
}
var _6a=false;
var pw=this._popupWidget;
var dk=dojo.keys;
if(this._isShowingNow){
pw.handleKey(key);
}
switch(key){
case dk.PAGE_DOWN:
case dk.DOWN_ARROW:
if(!this._isShowingNow||this._prev_key_esc){
this._arrowPressed();
_6a=true;
}else{
this._announceOption(pw.getHighlightedOption());
}
dojo.stopEvent(evt);
this._prev_key_backspace=false;
this._prev_key_esc=false;
break;
case dk.PAGE_UP:
case dk.UP_ARROW:
if(this._isShowingNow){
this._announceOption(pw.getHighlightedOption());
}
dojo.stopEvent(evt);
this._prev_key_backspace=false;
this._prev_key_esc=false;
break;
case dk.ENTER:
var _6d;
if(this._isShowingNow&&(_6d=pw.getHighlightedOption())){
if(_6d==pw.nextButton){
this._nextSearch(1);
dojo.stopEvent(evt);
break;
}else{
if(_6d==pw.previousButton){
this._nextSearch(-1);
dojo.stopEvent(evt);
break;
}
}
}else{
this._setDisplayedValueAttr(this.attr("displayedValue"),true);
}
if(!this.submitFormOnKey){
evt.preventDefault();
}
case dk.TAB:
var _6e=this.attr("displayedValue");
if(pw&&(_6e==pw._messages["previousMessage"]||_6e==pw._messages["nextMessage"])){
break;
}
if(this._isShowingNow){
this._prev_key_backspace=false;
this._prev_key_esc=false;
if(pw.getHighlightedOption()){
pw.attr("value",{target:pw.getHighlightedOption()});
}
this._lastQuery=null;
this._hideResultList();
}
break;
case dk.ESCAPE:
this._prev_key_backspace=false;
this._prev_key_esc=true;
if(this._isShowingNow){
dojo.stopEvent(evt);
this._hideResultList();
}
break;
case dk.DELETE:
case dk.BACKSPACE:
this._prev_key_esc=false;
this._prev_key_backspace=true;
_6a=true;
break;
case dk.RIGHT_ARROW:
case dk.LEFT_ARROW:
this._prev_key_backspace=false;
this._prev_key_esc=false;
break;
default:
this._prev_key_backspace=false;
this._prev_key_esc=false;
_6a=typeof key=="string"||key==229;
}
if(this.searchTimer){
clearTimeout(this.searchTimer);
}
if(_6a){
setTimeout(dojo.hitch(this,"_startSearchFromInput"),1);
}
},_numTokensPreceding:function(str,pos){
var i=-1,_72=0;
while(i<pos){
i=str.indexOf(this.token,i+1);
if(i==-1){
i=str.length;
}else{
if(i<pos){
_72++;
}
}
}
return _72;
},_autoCompleteText:function(_73){
var fn=this.focusNode;
var _75=this._getCaretPos(fn);
dijit.selectInputText(fn,fn.value.length);
var _76;
if(this.multipleValues){
_76=fn.value.split(this.token);
}else{
_76=[fn.value];
}
var _77=0;
if(this.multipleValues){
_77=this._numTokensPreceding(fn.value,_75);
}
if(this.multipleValues&&this.token!=" "&&_77>0){
_73=" "+_73;
}
var _78=this.ignoreCase?"toLowerCase":"substr";
if(dojo.string.trim(_73[_78](0)).indexOf(dojo.string.trim(_76[_77][_78](0)))==0){
if(_75+1>fn.value.length||fn.value.charAt(_75)==this.token){
var end=_75+_73.length-_76[_77].length;
_76[_77]=_73;
fn.value=_76.join(this.token);
dijit.selectInputText(fn,_75,end);
}
}else{
_76[_77]=_73;
fn.value=_76.join(this.token);
var _7a=0;
for(var i=0;i<_77;i++){
_7a+=_76[i].length;
}
_7a+=this.token.length*_77;
dijit.selectInputText(fn,_7a,_7a+_73.length);
}
},_openResultList:function(_7c,_7d){
if(this.disabled||this.readOnly||(_7d.query!=this._lastQuery)){
return;
}
this._popupWidget.clearResultList();
if(!_7c.length){
this._hideResultList();
return;
}
var _7e=new String(this.formatItem(_7c[0]));
if(_7e&&this.autoComplete&&!this._prev_key_backspace&&(_7d.query!="")){
this._autoCompleteText(_7e);
}
_7d._maxOptions=this._maxOptions;
this._popupWidget.createOptions(_7c,_7d,dojo.hitch(this,"_getMenuLabelFromItem"));
this._showResultList();
if(_7d.direction){
if(1==_7d.direction){
this._popupWidget.highlightFirstOption();
}else{
if(-1==_7d.direction){
this._popupWidget.highlightLastOption();
}
}
this._announceOption(this._popupWidget.getHighlightedOption());
}
},_announceOption:function(_7f){
if(_7f==null){
return;
}
var _80;
if(_7f==this._popupWidget.nextButton||_7f==this._popupWidget.previousButton||_7f==this._popupWidget.searchButton){
_80=_7f.innerHTML;
}else{
_80=this.formatItem(_7f.item);
}
if(this.multipleValues){
var _81=this._getCaretPos(this.focusNode);
var _82=this.focusNode.value.split(this.token);
var _83=this._numTokensPreceding(this.focusNode.value,_81);
var q=this._lastQuery;
if(this.multipleValues&&this.token!=" "&&_83>0){
q=" "+q;
}
_82[_83]=q;
this.focusNode.value=_82.join(this.token);
}else{
this.focusNode.value=this.focusNode.value.substring(0,this._getCaretPos(this.focusNode));
}
this._setCaretPos(this.focusNode,_81);
dijit.setWaiState(this.focusNode,"activedescendant",dojo.attr(_7f,"id"));
this._autoCompleteText(_80);
},_doSelect:function(tgt){
var _86=this.formatItem(tgt.item);
if(this.multipleValues){
var _87=this.keyArr[this.keyIdx];
this.keyArr[this.keyIdx]=(this.keyIdx!=0&&this.token!=" "?" ":"")+_86;
_86=this.keyArr.join(this.token);
var _88=this.token+(this.token!=" "?" ":"");
if(_86.length>=_88.length&&_86.substring(_86.length-_88.length)!=_88){
_86+=_88;
}
}else{
this.item=tgt.item;
}
this.attr("value",_86);
this._setCaretPos(this.focusNode,_86.length);
},_startSearchFromInput:function(){
var _89=this.focusNode.value;
var _8a=_89;
if(this.multipleValues){
this.keyArr=_89.split(this.token);
this.caretPos=this._getCaretPos(this.focusNode);
this.keyIdx=this._numTokensPreceding(_89,this.caretPos);
_8a=this.keyArr[this.keyIdx];
}
_8a=dojo.string.trim(_8a);
if(_8a.length>=this.minChars){
this._startSearch(_8a);
}else{
this._hideResultList();
}
},_startSearch:function(key){
if(!this._popupWidget){
var _8c=this.id+"_popup";
this._popupWidget=new dijit.form._ComboBoxMenu({onChange:dojo.hitch(this,this._selectOption),id:_8c});
dijit.removeWaiState(this.focusNode,"activedescendant");
dijit.setWaiState(this.textbox,"owns",_8c);
}
this.item=null;
var _8d=dojo.clone(this.query);
this._lastInput=key;
this._lastQuery=_8d=key;
this.searchTimer=setTimeout(dojo.hitch(this,function(_8e,_8f){
var _90={queryOptions:{ignoreCase:this.ignoreCase,deep:true},query:_8e,onComplete:dojo.hitch(this,"_openResultList"),onError:function(_91){
console.error("dijit.form.ComboBox: "+_91);
dojo.hitch(_8f,"_hideResultList")();
},start:0,count:this.pageSize};
dojo.mixin(_90,_8f.fetchProperties);
var _92=_8f.store.fetch(_90);
var _93=function(_94,_95){
_94.start+=_94.count*_95;
_94.direction=_95;
this.store.fetch(_94);
};
this._nextSearch=this._popupWidget.onPage=dojo.hitch(this,_93,_92);
},_8d,this),this.searchDelay);
},getAttribute:function(_96){
if(this.item&&this.item[_96]){
return this.item[_96];
}else{
return "";
}
},getTextBoxValue:function(){
return this.focusNode.value;
},_getMenuLabelFromItem:function(_97){
var _98=this.formatItem(_97,true);
var key="";
if(this.multipleValues){
key=dojo.string.trim(this.keyArr[this.keyIdx]);
}else{
key=dojo.string.trim(this.focusNode.value);
}
key=key.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");
var _9a=_98.toLowerCase();
var _9b=key.toLowerCase();
var _9c=0;
var _9d=null;
while(key&&-1<(_9d=_9a.indexOf(_9b,_9c))){
_98=_98.substr(0,_9d)+"<b>"+_98.substring(_9d,_9d+key.length)+"</b>"+_98.substring(_9d+key.length);
_9c=_9d+key.length+7;
_9a=_98.toLowerCase();
}
return {html:true,label:_98};
}});
}
if(!dojo._hasResource["lconn.core.TypeAheadDataStore"]){
dojo._hasResource["lconn.core.TypeAheadDataStore"]=true;
dojo.provide("lconn.core.TypeAheadDataStore");
dojo.declare("lconn.core.TypeAheadDataStore",null,{constructor:function(_9e,_9f){
this.queryParam=(_9e.queryParam?_9e.queryParam:_9f.getAttribute("queryParam"));
this.url=(_9e.url?_9e.url:_9f.getAttribute("url"));
},queryParam:"",cache:[],fetch:function(_a0){
var _a1={};
this.searchDirectory=(_a0.searchDirectory?true:false);
if(typeof this.cache[_a0.query.toLowerCase()]=="object"){
_a0.onComplete(this.cache[_a0.query.toLowerCase()],_a0);
return _a0;
}
if(this.queryParam){
_a1[this.queryParam]=_a0.query;
}
dojo.xhrPost({url:this.url,content:_a1,handleAs:"json-comment-optional",timeout:5000,contentType:"application/x-www-form-urlencoded;charset=UTF-8",load:dojo.hitch(this,function(_a2){
this.cache[_a0.query.toLowerCase()]=_a2;
if(_a0.onComplete){
_a0.onComplete(_a2,_a0);
}
}),error:function(){
console.log("There was an error");
}});
return _a0;
},getValue:function(_a3,_a4,_a5){
return _a3;
}});
}
if(!dojo._hasResource["lconn.core.HTMLUtil"]){
dojo._hasResource["lconn.core.HTMLUtil"]=true;
dojo.provide("lconn.core.HTMLUtil");
lconn.core.HTMLUtil.setInnerTextNode=function(_a6,_a7){
_a6.innerHTML="";
_a6.appendChild(document.createTextNode(_a7));
};
lconn.core.HTMLUtil.escapeInlineText=function(_a8){
return lconn.core.HTMLUtil.escapeText(_a8,true);
};
lconn.core.HTMLUtil.escapeText=function(_a9,_aa){
var _ab=document.getElementById("escapeBufferDiv");
if(!_ab){
var tmp=document.createElement("div");
tmp.id="escapeBufferDiv";
document.body.appendChild(tmp);
_ab=tmp;
}
_ab.appendChild(document.createTextNode(_a9));
var _ad=_ab.innerHTML;
_ab.innerHTML="";
if(_aa){
_ad=lconn.core.HTMLUtil.escape_q(_ad);
}
return _ad;
};
lconn.core.HTMLUtil.escape_q=function(s){
var t="";
for(var i=0;i<s.length;i++){
var c=s.charAt(i);
if(c=="\""){
t+="&#34;";
}else{
if(c=="'"){
t+="&#39;";
}else{
if(c=="\\"){
t+="&#92;&#92;";
}else{
t+=c;
}
}
}
}
return t;
};
}
if(!dojo._hasResource["lconn.core.NameUtil"]){
dojo._hasResource["lconn.core.NameUtil"]=true;
dojo.provide("lconn.core.NameUtil");
lconn.core.NameUtil={getHTML:function(_b2,_b3,_b4,id,_b6){
var _b7;
var _b8=lconn.core.HTMLUtil.escapeText(_b4);
if(_b3){
var _b9=lconn.core.HTMLUtil.escapeText(_b3);
if(_b2){
_b7=(_b6?_b2:lconn.core.HTMLUtil.escapeText(_b2));
}else{
_b7=_b9;
} 
return "<span"+(id?" id=\""+id+"\"":"")+"><span class=\"vcard\"><span class=\"fn person lotusPerson\">"+_b7+"</span><span class=\"email\" style=\"display: none;\">"+_b9+"</span><span class=\"x-lconn-userid\" style=\"display: none;\">"+_b8+"</span></span></span>";
}else{
var _b7;
var _ba=lconn.core.HTMLUtil.escapeInlineText(_b4);
if(_b2){
_b7=(_b6?_b2:lconn.core.HTMLUtil.escapeText(_b2));
}else{
_b7=_b8;
} 
return "<span"+(id?" id=\""+id+"\"":"")+"><span class=\"vcard\"><span class=\"fn person lotusPerson\">"+_b7+"</span><span class=\"x-lconn-userid\" style=\"display: none;\">"+_b8+"</span></span></span>";
}
}};
}
if(!dojo._hasResource["lconn.core.PeopleTypeAhead"]){
dojo._hasResource["lconn.core.PeopleTypeAhead"]=true;
dojo.provide("lconn.core.PeopleTypeAhead");
dojo.declare("lconn.core.PeopleTypeAhead",[lconn.core.TypeAhead],{getItem:function(){
return (this.item?this.item:null);
},formatItem:function(_bb,_bc){
var str="";
if(_bb.name.indexOf(",")!=-1&&_bb.name.length>1&&_bb.name[0]!="\""&&_bb.name[_bb.name.length-1]!="\""){
if(_bc){
str+="&quot;"+_bb.name.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;")+"&quot;";
}else{
str+="\""+_bb.name+"\"";
}
}else{
str+=_bb.name;
}
if(_bb.member){
if(_bc){
str+=" &lt;"+_bb.member.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;")+"&gt;&lrm;";
}else{
str+=" <"+_bb.member+">‎";
}
}
return str;
},_onKeyPress:function(evt){
var key=evt.charOrCode;
if(evt.altKey||(evt.ctrlKey&&(key!="x"&&key!="v"))||evt.key==dojo.keys.SHIFT){
return;
}
var _c0=false;
var pw=this._popupWidget;
var dk=dojo.keys;
if(this._isShowingNow){
pw.handleKey(key);
}
switch(key){
case dk.PAGE_DOWN:
case dk.DOWN_ARROW:
if(!this._isShowingNow||this._prev_key_esc){
this._arrowPressed();
_c0=true;
}else{
this._announceOption(pw.getHighlightedOption());
}
dojo.stopEvent(evt);
this._prev_key_backspace=false;
this._prev_key_esc=false;
break;
case dk.PAGE_UP:
case dk.UP_ARROW:
if(this._isShowingNow){
this._announceOption(pw.getHighlightedOption());
}
dojo.stopEvent(evt);
this._prev_key_backspace=false;
this._prev_key_esc=false;
break;
case dk.ENTER:
var _c3;
if(this._isShowingNow&&(_c3=pw.getHighlightedOption())){
if(_c3==pw.nextButton){
this._nextSearch(1);
dojo.stopEvent(evt);
break;
}else{
if(_c3==pw.previousButton){
this._nextSearch(-1);
dojo.stopEvent(evt);
break;
}else{
if(_c3==pw.searchButton){
pw.searchDirectory();
dojo.stopEvent(evt);
return;
}else{
if(_c3.item&&parseInt(_c3.item.type)<0){
dojo.stopEvent(evt);
break;
}
}
}
}
}else{
this._setDisplayedValueAttr(this.attr("displayedValue"),true);
}
evt.preventDefault();
case dk.TAB:
var _c4=this.attr("displayedValue");
if(pw&&(_c4==pw._messages["previousMessage"]||_c4==pw._messages["nextMessage"])){
break;
}
if(this._isShowingNow){
this._prev_key_backspace=false;
this._prev_key_esc=false;
if(pw.getHighlightedOption()){
pw.attr("value",{target:pw.getHighlightedOption()});
}
this._lastQuery=null;
this._hideResultList();
}
break;
case " ":
this._prev_key_backspace=false;
this._prev_key_esc=false;
if(this._isShowingNow&&pw.getHighlightedOption()){
dojo.stopEvent(evt);
this._selectOption();
this._hideResultList();
}else{
_c0=true;
}
break;
case dk.ESCAPE:
this._prev_key_backspace=false;
this._prev_key_esc=true;
if(this._isShowingNow){
dojo.stopEvent(evt);
this._hideResultList();
}
break;
case dk.DELETE:
case dk.BACKSPACE:
this._prev_key_esc=false;
this._prev_key_backspace=true;
_c0=true;
break;
case dk.RIGHT_ARROW:
case dk.LEFT_ARROW:
this._prev_key_backspace=false;
this._prev_key_esc=false;
break;
default:
this._prev_key_backspace=false;
this._prev_key_esc=false;
_c0=typeof key=="string"||key==229;
}
if(this.searchTimer){
clearTimeout(this.searchTimer);
}
if(_c0){
setTimeout(dojo.hitch(this,"_startSearchFromInput"),1);
}
},_openResultList:function(_c5,_c6){
if(this.disabled||this.readOnly||(_c6.query!=this._lastQuery)){
return;
}
this._popupWidget.clearResultList();
if(_c5.length){
var _c7=new String(this.formatItem(_c5[0]));
if(_c7&&this.autoComplete&&!this._prev_key_backspace&&(_c6.query!="")){
this._autoCompleteText(_c7);
}
}
_c6._maxOptions=this._maxOptions;
this._popupWidget.createOptions(_c5,_c6,dojo.hitch(this,"_getMenuLabelFromItem"));
this._showResultList();
if(_c6.direction){
if(1==_c6.direction){
this._popupWidget.highlightFirstOption();
}else{
if(-1==_c6.direction){
this._popupWidget.highlightLastOption();
}
}
this._announceOption(this._popupWidget.getHighlightedOption());
}
},_startSearchFromInput:function(_c8,_c9){
var _ca=this.focusNode.value;
var _cb=_ca;
if(this.multipleValues){
this.keyArr=_ca.split(this.token);
this.caretPos=this._getCaretPos(this.focusNode);
this.keyIdx=this._numTokensPreceding(_ca,this.caretPos);
_cb=this.keyArr[this.keyIdx];
}
_cb=dojo.string.trim(_cb);
if(_cb.length>=this.minChars){
this._startSearch(_cb,_c9);
}else{
this._hideResultList();
}
},_startSearch:function(key,_cd){
if(!this._popupWidget){
var _ce=this.id+"_popup";
this._popupWidget=new lconn.act.PeopleTypeAheadMenu({onChange:dojo.hitch(this,this._selectOption),id:_ce});
dijit.removeWaiState(this.focusNode,"activedescendant");
dijit.setWaiState(this.textbox,"owns",_ce);
}
if(_cd==undefined){
_cd=false;
}
this.item=null;
var _cf=dojo.clone(this.query);
this._lastInput=key;
this._lastQuery=_cf=key;
this.searchTimer=setTimeout(dojo.hitch(this,function(_d0,_d1){
var _d2={queryOptions:{ignoreCase:this.ignoreCase,deep:true},searchDirectory:_cd,query:_d0,onComplete:dojo.hitch(this,"_openResultList"),onError:function(_d3){
console.error("dijit.form.ComboBox: "+_d3);
dojo.hitch(_d1,"_hideResultList")();
},start:0,count:this.pageSize};
dojo.mixin(_d2,_d1.fetchProperties);
var _d4=_d1.store.fetch(_d2);
var _d5=function(_d6,_d7){
_d6.start+=_d6.count*_d7;
_d6.direction=_d7;
this.store.fetch(_d6);
};
this._nextSearch=this._popupWidget.onPage=dojo.hitch(this,_d5,_d4);
this._popupWidget.searchDirectory=dojo.hitch(this,dojo.hitch(this,function(){
this._startSearch(key,true);
}));
},_cf,this),this.searchDelay);
}});
dojo.declare("lconn.act.PeopleTypeAheadMenu",[dijit.form._ComboBoxMenu,lconn.core.Res],{rs_searchDirectory:"",templateString:"<ul class='dijitReset dijitMenu' dojoAttachEvent='onmousedown:_onMouseDown,onmouseup:_onMouseUp,onmouseover:_onMouseOver,onmouseout:_onMouseOut' waiRole='alert' role='waiRole:alert' tabIndex='-1' style='overflow:\"auto\";'>"+"<li class='dijitMenuItem dijitMenuPreviousButton' dojoAttachPoint='previousButton'></li>"+"<li class='dijitMenuItem searchDirectory' dojoAttachPoint='searchButton'>${rs_searchDirectory}</li>"+"<li class='dijitMenuItem dijitMenuNextButton' dojoAttachPoint='nextButton'></li>"+"</ul>",_messages:null,tooltipAroundNode:null,tooltipTimeout:null,tooltipDelay:600,tooltipId:0,popupClosed:true,postMixInProperties:function(){
this.loadDefaultBundle();
this.rs_searchDirectory=this.resBundle.rs_searchDirectory;
this.inherited("postMixInProperties",arguments);
},searchDirectory:function(){
},_setValueAttr:function(_d8){
if(_d8.target.item&&parseInt(_d8.target.item.type)>=0){
this.value=_d8;
this.onChange(_d8);
}
},_createOption:function(_d9,_da){
var _db=_da(_d9);
var _dc=document.createElement("li");
dijit.setWaiRole(_dc,"option");
if(_d9.userid){
dojo.attr(_dc,"exid",_d9.userid);
}
if(_db.html){
_dc.innerHTML=_db.label;
}else{
_dc.appendChild(document.createTextNode(_db.label));
}
if(_dc.innerHTML==""){
_dc.innerHTML="&nbsp;";
}
_dc.item=_d9;
return _dc;
},createOptions:function(_dd,_de,_df){
this.previousButton.style.display=(_de.start==0)?"none":"";
dojo.attr(this.previousButton,"id",this.id+"_prev");
dojo.forEach(_dd,function(_e0,i){
var _e2=this._createOption(_e0,_df);
_e2.className="dijitMenuItem";
dojo.attr(_e2,"id",this.id+i);
this.domNode.insertBefore(_e2,this.searchButton);
},this);
var _e3=false;
if(_de._maxOptions&&_de._maxOptions!=-1){
if((_de.start+_de.count)<_de._maxOptions){
_e3=true;
}else{
if((_de.start+_de.count)>(_de._maxOptions-1)){
if(_de.count==_dd.length){
_e3=true;
}
}
}
}else{
if(_de.count==_dd.length){
_e3=true;
}
}
this.nextButton.style.display=_e3?"":"none";
dojo.attr(this.nextButton,"id",this.id+"_next");
this.searchButton.style.display=(_de.searchDirectory?"none":"");
},_onMouseUp:function(evt){
if(evt.target==this.searchButton){
this.searchDirectory();
}else{
this.inherited("_onMouseUp",arguments);
}
},_onMouseOver:function(evt){
if(evt.target===this.domNode){
return;
}
var tgt=evt.target;
if(!(tgt==this.previousButton||tgt==this.nextButton||tgt==this.searchButton)){
while(!tgt.item){
tgt=tgt.parentNode;
}
}
this._focusOptionNode(tgt);
},_focusOptionNode:function(_e7){
if(this._highlighted_option!=_e7){
var _e8=dojo.attr(_e7,"exid");
this.closeTooltip();
this.tooltipId++;
this.popupClosed=false;
if(_e8&&window.lconn&&lconn.profiles&&lconn.profiles.bizCard.bizCard.renderMiniBizCard){
this.tooltipTimeout=setTimeout(dojo.hitch(this,"renderBizCard",_e8,dojo.hitch(this,"showTooltip",this.tooltipId,_e7)),this.tooltipDelay);
}
}
this.inherited("_focusOptionNode",arguments);
},renderBizCard:function(_e9,fn){
if(window.lconn&&lconn.profiles&&lconn.profiles.bizCard.bizCard.renderMiniBizCard){
lconn.profiles.bizCard.bizCard.renderMiniBizCard(_e9,fn);
}
},showTooltip:function(id,_ec,_ed){
if(id==this.tooltipId&&!this.popupClosed){
this.tooltipAroundNode=_ec;
dijit.showTooltip(_ed,_ec,["after","before"]);
}
},closeTooltip:function(){
if(this.tooltipAroundNode){
dijit.hideTooltip(this.tooltipAroundNode);
this.tooltipAroundNode=null;
}
if(this.tooltipTimeout){
clearTimeout(this.tooltipTimeout);
this.tooltipTimeout=null;
}
},onClose:function(){
this.popupClosed=true;
this.closeTooltip();
this._blurOptionNode();
},clearResultList:function(){
while(this.domNode.childNodes.length>3){
this.domNode.removeChild(this.domNode.childNodes[this.domNode.childNodes.length-3]);
}
},getListLength:function(){
return this.domNode.childNodes.length-3;
}});
}
if(!dojo._hasResource["lconn.core.PeopleDataStore"]){
dojo._hasResource["lconn.core.PeopleDataStore"]=true;
dojo.provide("lconn.core.PeopleDataStore");
dojo.declare("lconn.core.PeopleDataStore",null,{constructor:function(_ee,_ef){
this.queryParam=(_ee.queryParam?_ee.queryParam:_ef.getAttribute("queryParam"));
this.url=(_ee.url?_ee.url:_ef.getAttribute("url"));
},queryParam:"",searchDirectory:false,cache:[],dirCache:[],fetch:function(_f0){
var _f1={};
var _f2;
this.searchDirectory=(_f0.searchDirectory?true:false);
if(this.searchDirectory){
_f2=this.dirCache;
}else{
_f2=this.cache;
}
if(typeof _f2[_f0.query.toLowerCase()]=="object"){
_f0.onComplete(_f2[_f0.query.toLowerCase()],_f0);
return _f0;
}
if(this.queryParam){
_f1[this.queryParam]=_f0.query;
}
if(this.searchDirectory){
_f1.usedirectory="yes";
}
dojo.xhrPost({url:this.url,content:_f1,handleAs:"json-comment-optional",timeout:5000,contentType:"application/x-www-form-urlencoded;charset=UTF-8",load:dojo.hitch(this,function(_f3){
var _f4;
if(this.searchDirectory){
_f4=this.dirCache;
}else{
_f4=this.cache;
}
_f4[_f0.query.toLowerCase()]=_f3.items;
if(_f0.onComplete){
_f0.onComplete(_f3.items,_f0);
}
}),error:function(){
console.log("There was an error");
}});
return _f0;
},getValue:function(_f5,_f6,_f7){
if(_f5[_f6]){
return _f5[_f6];
}else{
return _f7;
}
}});
}
if(!dojo._hasResource["lconn.core.i18nOverrider"]){
dojo._hasResource["lconn.core.i18nOverrider"]=true;
dojo.provide("lconn.core.i18nOverrider");
if(lconn.core.i18nOverrider.originalFunction==null){
lconn.core.i18nOverrider.originalFunction=dojo.i18n.getLocalization;
}
dojo.i18n.getLocalization=function(_f8,_f9,_fa){
if(_f8=="dijit"||_f8=="dojo"){
return lconn.core.i18nOverrider.originalFunction(_f8,_f9,_fa);
}
var _fb=_f9;
if(window[_f8]!=null){
var _fc=window[_f8];
if(_fc!=null&&_fc!="undefined"){
return _fc;
}else{
return lconn.core.i18nOverrider.originalFunction(_f8,_f9,_fa);
}
}else{
return lconn.core.i18nOverrider.originalFunction(_f8,_f9,_fa);
}
};
lconn.core.i18nOverrider.getResourceString=function(_fd){
return dojo.i18n.getLocalization("lc_default",_fd);
};
lconn.core.i18nOverrider.loadResourceStringsInParams=function(_fe,_ff){
if(_fe==null){
_fe=new Array;
}
for(var i=0;_ff!=null&&i<_ff.length;i++){
var _101=dojo.i18n.getLocalization("default",_ff[i]);
var _102=_101.replace(/\'\'/g,"'");
if(_102==null||_102==""){
_fe.push([_ff[i],_ff[i]+" resourceKey not found"]);
}else{
_fe.push([_ff[i],_102]);
}
}
return _fe;
};
lconn.core.i18nOverrider.replaceParams=function(_103,_104){
var _105=_103.indexOf("{");
if(_105!=-1){
var _106=_103.indexOf("}");
if(_106==-1){
return _103;
}
var _107=_103.substring(_105+1,_106);
var _108=_104[_107];
return _103.substring(0,_105)+_108+lconn.core.i18nOverrider.replaceParams(_103.substring(_106+1),_104);
}else{
return _103;
}
};
}
if(!dojo._hasResource["lconn.core.utilities"]){
dojo._hasResource["lconn.core.utilities"]=true;
dojo.provide("lconn.core.utilities");
lconn.core.utilities.getURLParam=function(_109){
var _10a=decodeURIComponent(window.location);
if(_10a.indexOf(_109)==-1){
return null;
}else{
var _10b=_10a.substring(_10a.indexOf(_109+"=")+_109.length+1);
var _10c=_10b.indexOf("&");
if(_10c!=-1){
_10b=_10b.substring(0,_10c);
}
return _10b;
}
};
lconn.core.utilities.replacePlaceHolders=function(_10d,_10e){
var _10f=new Object();
for(var i=0;_10e!=null&&i<_10e.length;i++){
_10f["{"+i+"}"]=_10e[i];
}
return lconn.core.i18nOverrider.replaceParams(_10d,_10f);
};
lconn.core.utilities.processUntilElementIsFound=function(_111,_112,_113,_114){
var _115="";
var _116=0;
_115=window.setInterval(function(){
var _117=null;
if(_113!=null){
_117=_113.getElementById(_111);
}else{
_117=dojo.byId(_111);
}
_116++;
if(_117!=null){
window.clearInterval(_115);
_112(_117,_114);
}else{
if(_116==20){
window.clearInterval(_115);
}
}
},500);
};
lconn.core.utilities.processUntilAvailable=function(_118,test,_11a){
var _11b="";
var _11c=0;
_11b=window.setInterval(function(){
_11c++;
if(eval(test)){
window.clearInterval(_11b);
if(_11a!=null){
_118(_11a);
}else{
_118();
}
}else{
if(_11c==20){
window.clearInterval(_11b);
}
}
},500);
};
lconn.core.utilities.gotoURL=function(url,_11e){
if(_11e==null){
if(url.indexOf("?")!=-1){
url+="&ver="+profilesData.config.buildNumber+"&lastMod="+profilesData.config.profileLastMod;
}else{
url+="?ver="+profilesData.config.buildNumber+"&lastMod="+profilesData.config.profileLastMod;
}
}
if(dojo.isIE){
var _11f=url;
setTimeout("window.location.href = SideBar_RedirectUrl",0);
}else{
window.location.assign(url);
}
};
lconn.core.utilities.toggleVisibility=function(_120,_121){
var _122=null;
if((typeof _120)=="string"){
_122=dojo.byId(_120);
}else{
_122=_120;
}
if(_122){
if(_122.style.visibility=="hidden"){
lconn.core.utilities.show(_122,_121);
}else{
lconn.core.utilities.hide(_122,_121);
}
}
return false;
};
lconn.core.utilities.hide=function(_123,_124,nofx,_126){
var _127=null;
if((typeof _123)=="string"){
_127=dojo.byId(_123);
}else{
_127=_123;
}
if(_127!=null){
var _128=function(){
_127.style.visibility="hidden";
if(!_124){
_127.style.display="none";
}
if(_126!=null){
_126();
}
};
if(nofx==null||nofx==false){
var _129=dojo.fx.wipeOut({node:_127,duration:300,onEnd:_128});
_129.play();
}else{
_128();
}
}
return false;
};
lconn.core.utilities.show=function(_12a,_12b,_12c,nofx,_12e){
var _12f=0;
var _130=null;
if((typeof _12a)=="string"){
_130=dojo.byId(_12a);
}else{
_130=_12a;
}
if(_12c&&_130==null){
var _131="";
_131=window.setInterval(function(){
_12f++;
if((typeof _12a)=="string"){
_130=dojo.byId(_12a);
}else{
_130=_12a;
}
if(_130!=null){
window.clearInterval(_131);
lconn.core.utilities.show(_130,_12b,false,nofx,_12e);
}else{
if(_12f==20){
window.clearInterval(_131);
}
}
},300);
}else{
if(_130!=null){
var _132=function(){
_130.style.visibility="visible";
if(!_12b){
_130.style.display="block";
}
if(_12e!=null){
_12e();
}
};
if(nofx==null||nofx==false){
var _133=dojo.fx.wipeIn({node:_130,duration:300});
_133.play();
}else{
_132();
}
}
}
return false;
};
}
if(!dojo._hasResource["lconn.core.formutilities"]){
dojo._hasResource["lconn.core.formutilities"]=true;
dojo.provide("lconn.core.formutilities");
var findParentForm=function(_134){
if(_134!=null&&_134.nodeName!=null&&_134.nodeName.toLowerCase()=="form"){
return _134;
}
if(_134.form&&_134.form!=null){
return _134.form;
}
var _135=null;
if((_134.parentNode!=null)&&_134.parentNode.nodeName){
_135=_134.parentNode;
}else{
_135=_134.domNode;
}
if(_135==null){
return null;
}
if(_135.nodeName.toLowerCase()=="form"){
var _136=_135;
return _136;
}else{
return findParentForm(_135);
}
};
var setActionAndSubmit=function(form,_138){
form.action=_138;
form.submit();
};
var setActionAndConfirmAndSubmit=function(form,_13a,_13b){
var _13c=true;
_13c=window.confirm(_13b);
if(!_13c){
return;
}
document.forms[form].action=_13a;
document.forms[form].submit();
};
var checkRadionButton=function(form,_13e,_13f){
if(_13f!=null&&_13f!=""&&_13f!="null"){
for(var i=0;i<form.elements[_13e].length;i++){
if(form.elements[_13e][i].value==_13f){
form.elements[_13e][i].checked=true;
}
}
}
};
var getRadioGroupCheckedValue=function(form,_142){
for(var i=0;i<form.elements[_142].length;i++){
if(form.elements[_142][i].checked){
return form.elements[_142][i].value;
}
}
return null;
};
var selectAllCheckboxes=function(_144,_145){
changeAllCheckboxes(_144,_145,true);
};
var deselectAllCheckboxes=function(_146,_147){
changeAllCheckboxes(_146,_147,false);
};
var changeAllCheckboxes=function(_148,_149,_14a){
for(var i=0;i<_148.elements.length;i++){
if(_148.elements[i].type=="checkbox"){
if(_149==null||_149==""){
_148.elements[i].checked=_14a;
}else{
if(_148.elements[i].name==_149){
_148.elements[i].checked=_14a;
}
}
}
}
};
var getCheckedBoxes=function(_14c,_14d){
var _14e=new Array();
for(var i=0;i<_14c.elements.length;i++){
var _150=_14c.elements[i];
if(_150.type=="checkbox"&&_150.checked==true&&_150.name==_14d){
_14e.push(_150.value);
}
}
return _14e;
};
var setSelectionControlVal=function(_151,_152){
if(_151!=null&&_151.options!=null){
for(var x=0;x<_151.options.length;x++){
if(_151.options[x].value==_152){
_151.selectedIndex=x;
return;
}
}
}
};
var getSelectionControlVal=function(_154){
if(_154!=null&&_154.options!=null&&_154.options[_154.selectedIndex]!=null){
return _154.options[_154.selectedIndex].value;
}else{
return null;
}
};
var getMultipleSelectionControlValues=function(_155){
var _156=new Array();
for(var i=0;i<_155.options.length;i++){
if(_155.options[i].selected==true){
_156.push(_155.options[i].value);
}
}
return _156;
};
var getAllSelectionControlValues=function(_158){
var _159=new Array();
for(var i=0;i<_158.options.length;i++){
_159.push(_158.options[i].value);
}
return _159;
};
var getSelectionControlName=function(_15b){
return _15b.options[_15b.selectedIndex].text;
};
var removeSelectedSelectionControlOption=function(_15c){
_15c.options[_15c.selectedIndex]=null;
};
var removeSelectionControlOption=function(_15d,_15e){
for(var i=0;i<_15d.options.length;i++){
if(_15d.options[i].value==_15e){
_15d.options[i]=null;
}
}
};
var removeAllSelectionControlOption=function(_160){
for(var x=_160.options.length;x>=0;x--){
_160.options[x]=null;
}
};
var addSelectionControlVal=function(_162,text,_164){
_162.options[_162.options.length]=new Option(text,_164);
};
var getFormControl=function(form,_166){
return form.elements[_166];
};
var getTextBoxValue=function(form,_168){
return getFormControl(form,_168).value;
};
var getControlTagName=function(_169){
var _16a=null;
if(_169.nodeName){
_16a=_169.nodeName;
}else{
if(_169.tagName){
_16a=_169.tagName;
}else{
log("getValue","unable to get the formControl tag name; returning null");
return null;
}
}
return _16a;
};
var getValue=function(_16b){
var _16c=getControlTagName(_16b);
if(_16c.toLowerCase()=="input"||_16c.toLowerCase()=="textarea"){
if(_16b.type=="checkbox"){
if(_16b.checked){
return true;
}else{
return false;
}
}else{
return _16b.value;
}
}else{
if(_16c.toLowerCase()=="select"){
return getSelectionControlVal(_16b);
}else{
log("getValue","returning null");
return null;
}
}
};
var setValue=function(_16d,_16e){
var _16f=getControlTagName(_16d);
if(_16f.toLowerCase()=="input"||_16f.toLowerCase()=="textarea"){
_16d.value=_16e;
}else{
if(_16f.toLowerCase()=="select"){
setSelectionControlVal(_16d,_16e);
}else{
log("setValue",_16f.toLowerCase());
}
}
};
}
if(!dojo._hasResource["lconn.core.xpath"]){
dojo._hasResource["lconn.core.xpath"]=true;
dojo.provide("lconn.core.xpath");
lconn.core.xpath.debug=false;
lconn.core.xpath.selectNodes=function(_170,_171,_172,_173){
var _174=function(_175,_176){
for(var x=0;x<_175.length;x++){
if(_176==_175[x].prefix){
return _175[x].nameSpaceURI;
}
}
return null;
};
var _178=function(_179,_17a){
var _17b="";
for(var x=0;_17a!=null&&x<_17a.length;x++){
_17b+="xmlns:"+_17a[x].prefix+"='"+_17a[x].nameSpaceURI+"' ";
}
if(_17b!=""&&dojo.isIE){
_179.setProperty("SelectionNamespaces",_17b);
}
};
var _17d=function(_17e){
if(_17e!=null){
return function(_17f){
var _180=_174(_17e,_17f);
if(lconn.core.xpath.debug){
alert("getNameSpaceResolver: prefix: "+_17f+" URI: "+_180);
}
if(lconn.core.xpath.debug&&(_180==null||_180=="")){
alert("getNameSpaceResolver: no namespace was found for prefix: "+_17f);
}
return _180;
};
}else{
return null;
}
};
var _181=function(_182){
var _183=new Array;
_183=_184(_183,_182);
return _183;
};
var _184=function(_185,_186){
if(_186.documentElement){
for(var x=0;x<_186.documentElement.attributes.length;x++){
var att=_186.documentElement.attributes[x];
var _189=att.nodeName.indexOf(":");
if(_189!=-1){
if(att.nodeName.substring(0,_189).toLowerCase()=="xmlns"){
var _18a=att.nodeName.substring(_189+1);
var _18b=_174(_185,_18a);
if(lconn.core.xpath.debug){
alert("addNamesSpaceFromRootElement: current prefix: "+_18a+" nameSpaceURI: "+_18b);
}
if(_18b==null){
_18b=att.nodeValue;
if(lconn.core.xpath.debug){
alert("addNamesSpaceFromRootElement: adding prefix: "+_18a+" nameSpaceURI: "+_18b+" to the list");
}
_185.push({prefix:_18a,nameSpaceURI:_18b});
}
}
}
}
}
return _185;
};
if(_171==null){
throw Error("lconn.core.xpath.selectNodes : XMLDocument can not be null\n"+common_getStacktrace());
}
if(_172==null){
_172=_181(_171);
}else{
_172=_184(_172,_171);
}
for(var x=0;lconn.core.xpath.debug&&x<_172.length;x++){
alert(_172[x].prefix+":"+_172[x].nameSpaceURI);
}
if(_173==null&&(_171.documentElement!=null)){
_173=_171.documentElement;
}
if(dojo.isIE){
try{
_178(_171,_172);
return _173.selectNodes(_170);
}
catch(exception){
lconn.core.errorhandling.DefaultErrorHandler("IE: xpath.selectNodes",exception);
}
}else{
try{
var _18d=_17d(_172);
var _18e=0;
var _18f=null;
_18f=_171.evaluate(_170,_173,_18d,_18e,_18f);
if(_18f!=null){
var _190=new Array();
var $A=null;
while($A=_18f.iterateNext()){
_190.push($A);
}
return _190;
}
}
catch(exception){
lconn.core.errorhandling.DefaultErrorHandler("FF: xpath.selectNodes",exception);
}
}
};
lconn.core.xpath.selectSingleNode=function(_192,_193,_194,_195){
var _196=lconn.core.xpath.selectNodes(_192,_193,_194,_195);
if(_196==null){
return null;
}
return _196[0];
};
lconn.core.xpath.selectText=function(_197,_198,_199,_19a){
var _19b=lconn.core.xpath.selectSingleNode(_197,_198,_199,_19a);
if(_19b==null){
return null;
}
return _19b.nodeValue;
};
lconn.core.xpath.setNodeValue=function(_19c,_19d,_19e,_19f,_1a0){
var _1a1=lconn.core.xpath.selectSingleNode(_19c,_19d,_19f,_1a0);
if(_1a1!=null){
if(_1a1.nodeType==1){
if(_1a1.hasChildNodes()){
var _1a2=_1a1.firstChild;
_1a1.replaceChild(_19d.createTextNode(_19e),_1a2);
}else{
_1a1.appendChild(_19d.createTextNode(_19e));
}
}else{
if(_1a1.nodeType==2){
_1a1.nodeValue=_19e;
}else{
if(_1a1.nodeType==3){
_1a1.nodeValue=_19e;
}else{
alert("lconn.core.xpath.setNodeValue: nodeType: "+_1a1.nodeType);
}
}
}
}else{
var _1a3=_19c.lastIndexOf("/");
if(_1a3!=-1){
var _1a4=_19c.substring(_1a3+2);
var tmp=_19c.substring(_1a3+1);
if(tmp.indexOf("@")==0){
var _1a6=_19c.substring(0,_1a3);
var _1a7=lconn.core.xpath.selectSingleNode(_19d,_1a0,_1a6,_19f);
if(_1a7==null){
alert("lconn.core.xpath.setNodeValue: couldn't find parent node for: "+_1a6+" orig "+_19c);
return;
}
_1a7.setAttribute(_1a4,_19e);
return;
}
}
alert("lconn.core.xpath.setNodeValue: couldn't find node for: "+_19c);
}
};
}
if(!dojo._hasResource["lconn.core.xslt"]){
dojo._hasResource["lconn.core.xslt"]=true;
dojo.provide("lconn.core.xslt");
lconn.core.xslt.ie={};
lconn.core.xslt.gecko={};
lconn.core.xslt.getXmlHttpRequest=function(){
var oXml=null;
if(typeof ActiveXObject!="undefined"){
oXml=new ActiveXObject("Microsoft.XMLHTTP");
}else{
oXml=new XMLHttpRequest();
}
return oXml;
};
lconn.core.xslt.loadXml=function(sUrl){
if(typeof ActiveXObject!="undefined"){
return lconn.core.xslt.ie.loadXml(sUrl);
}else{
return lconn.core.xslt.gecko.loadXml(sUrl);
}
};
lconn.core.xslt.loadXmlString=function(sXml){
if(typeof ActiveXObject!="undefined"){
return lconn.core.xslt.ie.loadXmlString(sXml);
}else{
return lconn.core.xslt.gecko.loadXmlString(sXml);
}
};
lconn.core.xslt.loadXsl=function(sUrl){
if(typeof ActiveXObject!="undefined"){
return lconn.core.xslt.ie.loadXsl(sUrl);
}else{
return lconn.core.xslt.gecko.loadXsl(sUrl);
}
};
lconn.core.xslt.transform=function(xml,xsl,_1ae,_1af,_1b0){
if(typeof ActiveXObject!="undefined"){
return lconn.core.xslt.ie.transform(xml,xsl,_1ae,_1af,_1b0);
}else{
return lconn.core.xslt.gecko.transform(xml,xsl,_1ae,_1af,_1b0);
}
};
lconn.core.xslt.transformDocument=function(_1b1,_1b2,_1b3){
var _1b4=lconn.core.xslt.loadXsl(_1b2);
if(_1b4.documentElement==null){
return null;
}
var _1b5=lconn.core.xslt.transform(_1b1,_1b4,null,_1b3,true);
return _1b5;
};
lconn.core.xslt.transformAndUpdate=function(_1b6,xml,xsl,_1b9,_1ba){
if(typeof ActiveXObject!="undefined"){
var _1bb=lconn.core.xslt.ie.transform(xml,xsl,_1b9,_1ba,true);
_1b6.innerHTML+=_1bb;
}else{
_1bb=lconn.core.xslt.gecko.transform(xml,xsl,_1b9,_1ba,false);
var _1bc=_1bb.documentElement;
if(_1bb.documentElement.tagName=="transformiix:result"){
_1bc=_1bb.documentElement.childNodes;
dojomum.dom.copyChildren(_1bb.documentElement,_1b6,true);
}else{
_1b6.appendChild(_1bc);
}
}
};
lconn.core.xslt.ie.loadXml=function(sUrl){
var _1be=new ActiveXObject("MSXML2.DOMDocument");
_1be.async=0;
_1be.resolveExternals=0;
if(!_1be.load(sUrl)){
throw new Error("Error loading xml file "+sUrl);
}
return _1be;
};
lconn.core.xslt.ie.loadXmlString=function(sXml){
var _1c0=new ActiveXObject("MSXML2.DOMDocument");
_1c0.async=0;
_1c0.resolveExternals=0;
if(!_1c0.loadXML(sXml)){
throw new Error("Error loading xml string "+sXml);
}
return _1c0;
};
lconn.core.xslt.ie.loadXsl=function(sUrl){
var _1c2=new ActiveXObject("MSXML2.FreeThreadedDOMDocument");
_1c2.async=0;
dojo.xhrGet({sync:true,url:sUrl,handleAs:"text",expectedContentType:"xml",load:function(_1c3,_1c4){
_1c2.loadXML(_1c3);
}});
return _1c2;
};
lconn.core.xslt.ie.transform=function(_1c5,xsl,_1c7,_1c8,_1c9){
var oXml=_1c5;
var oXsl=xsl;
try{
if(!oXsl.documentElement){
oXsl=this.loadXsl(xsl);
}
}
catch(e){
var sMsg=e.message;
throw new Error(""+sMsg,""+sMsg);
}
var _1cd=new ActiveXObject("Msxml2.XSLTemplate");
_1cd.stylesheet=oXsl;
var _1ce=_1cd.createProcessor();
_1ce.input=oXml;
for(var i=0;_1c8!=null&&i<_1c8.length;i++){
var name=_1c8[i][0];
var _1d1=_1c8[i][1];
if(name==null||name==""){
continue;
}
_1ce.addParameter(name,_1d1);
}
if(_1c7){
_1ce.addParameter("mode",_1c7);
}
if(_1c9){
if(!_1ce.transform()){
throw new Error("Error transforming xml doc "+oXml);
}
return _1ce.output;
}else{
var _1d2=new ActiveXObject("MSXML2.DOMDocument");
_1d2.async=0;
_1d2.validateOnParse=1;
oXml.transformNodeToObject(oXsl,_1d2);
return _1d2;
}
};
lconn.core.xslt.gecko.loadXml=function(sUrl){
var _1d4=dojox.data.dom.createDocument();
_1d4.async=false;
if(dojo.isSafari){
_1d4.load=function(url){
var req=dojo.xhrGet({sync:true,url:url,handleAs:"xml",load:function(data,_1d8){
_1d4=data;
}});
};
}
_1d4.load(sUrl);
if(_1d4.documentElement&&_1d4.documentElement.nodeName=="parsererror"){
alert(dojox.data.dom.innerXML(_1d4.documentElement));
return null;
}
return _1d4;
};
lconn.core.xslt.gecko.loadXmlString=function(sXml){
var _1da=new DOMParser();
try{
oXmlDoc=_1da.parseFromString(sXml,"text/xml");
}
catch(exc){
alert("error loading xml");
throw new Error("Error loading xml string "+sXml);
}
return oXmlDoc;
};
lconn.core.xslt.gecko.loadXsl=function(sUrl){
var _1dc=document.implementation.createDocument("","",null);
_1dc.async=false;
if(dojo.isSafari){
_1dc.load=function(url){
var req=dojo.xhrGet({sync:true,url:url,handleAs:"xml",load:function(data,_1e0){
_1dc=data;
}});
};
}
_1dc.load(sUrl);
return _1dc;
};
lconn.core.xslt.gecko.transform=function(_1e1,xsl,_1e3,_1e4,_1e5){
try{
var _1e6=xsl;
if(!_1e6.documentElement){
console.log("xslDoc is not a Document, loading it...");
_1e6=this.loadXsl(xsl);
}
var proc=new XSLTProcessor();
proc.importStylesheet(_1e6);
for(var i=0;_1e4!=null&&i<_1e4.length;i++){
var name=_1e4[i][0];
var _1ea=_1e4[i][1];
proc.setParameter(null,name,_1ea);
}
if(_1e3){
proc.setParameter(null,"mode",_1e3);
}
var _1eb=proc.transformToFragment(_1e1,document);
if(!_1e5){
return _1eb;
}
var _1ec=new XMLSerializer();
resultStr=_1ec.serializeToString(_1eb);
}
catch(exc){
throw new Error("Error transforming xml doc "+exc);
}
return resultStr;
};
lconn.core.xslt.setLayerContentByXml=function(_1ed,xml,xsl,_1f0,_1f1){
var _1f2=lconn.core.xslt.transform(xml,xsl,null,_1f0,_1f1);
if(_1ed.innerHTML){
_1ed.innerHTML=_1f2;
}else{
var obj=document.getElementById(_1ed);
obj.innerHTML=_1f2;
}
};
lconn.core.xslt.transformAndRender=function(_1f4){
var _1f5=function(_1f6){
if(lconn.core.xslt.debug){
_1f7("before lconn.core.xslt.transformDocument for: "+_1f6.xmlDocUrl);
}
var _1f8=lconn.core.xslt.transformDocument(_1f6.xmlDoc,_1f6.xsltUrl,_1f6.aXslParams);
if(lconn.core.xslt.debug){
_1f7("after lconn.core.xslt.transformDocument for: "+_1f6.xmlDocUrl);
}
if(lconn.core.xslt.debug){
_1f7("transformDocAndRender: xslResult doc:\n"+_1f8+"<br/><br/><br/>");
}
if(_1f6.callback!=null){
_1f6.callback(_1f8);
}
if(typeof (_1f6.htmlContainerElemId)=="string"){
document.getElementById(_1f6.htmlContainerElemId).innerHTML=_1f8;
}else{
_1f6.htmlContainerElemId.innerHTML=_1f8;
}
};
var _1f9=function(_1fa,_1fb){
if(lconn.core.xslt.debug){
_1f7("dojoLoadCallback start");
}
try{
var _1fc=_1fb.args.xsltArgs;
if(dojo.isIE&&_1fa.documentElement==null){
if(lconn.core.xslt.debug){
_1f7("before dojox.data.dom.createDocument for: "+_1fc.xmlDocUrl);
}
_1fa=dojox.data.dom.createDocument(_1fa);
if(lconn.core.xslt.debug){
_1f7("after dojox.data.dom.createDocument for: "+_1fc.xmlDocUrl);
}
}
if(lconn.core.xslt.debug){
_1f7("transformUrlAndRender: xml doc:\n"+dojox.data.dom.innerXML(_1fa)+"<br/><br/><br/>");
}
_1fc.xmlDoc=_1fa;
_1f5(_1fc);
}
catch(exception){
_1fc.exceptionHandler("transformUrlAndRender",exception,_1fc);
}
try{
if(dojo.isIE==6){
if(lconn.core.xslt.queue!=null&&lconn.core.xslt.queue.length>0){
var _1fd=lconn.core.xslt.queue.pop();
if(_1fd!=null){
if(lconn.core.xslt.debug){
_1f7("next item: "+_1fd.args.xsltArgs.xmlDocUrl);
}
_1fd.error=function(_1fe,_1ff){
var _200=lconn.core.xslt.queue.pop();
if(_200!=null){
if(lconn.core.xslt.debug){
_1f7("next item: "+_200.args.xsltArgs.xmlDocUrl);
}
dojo.xhrGet(_200);
}
_1ff.args.xsltArgs.dojoErrorHandler(_1fe,_1ff);
};
dojo.xhrGet(_1fd);
}
}else{
if(lconn.core.xslt.debug){
_1f7("no more work in queue");
}
lconn.core.xslt.queueIsWorking=false;
}
}
}
catch(exception){
var _1fd=lconn.core.xslt.queue.pop();
if(_1fd!=null){
if(lconn.core.xslt.debug){
_1f7("next item: "+_1fd.args.xsltArgs.xmlDocUrl);
}
dojo.xhrGet(_1fd);
}
_1fc.exceptionHandler("transformUrlAndRender",exception,_1fc);
}
if(lconn.core.xslt.debug){
_1f7("dojoLoadCallback end");
}
};
var _1f7=function(_201){
console.log(_201);
};
if(_1f4.dojoErrorHandler==null){
_1f4.dojoErrorHandler=lconn.core.errorhandling.DefaultXHRErrorHandler;
}
if(_1f4.exceptionHandler==null){
_1f4.exceptionHandler=lconn.core.errorhandling.DefaultErrorHandler;
}
if(_1f4.xmlDoc!=null){
_1f5(_1f4);
}else{
var _202="xml";
if(dojo.isIE){
_202="text";
}
if(lconn.core.xslt.debug){
_1f7("using: handleAs: "+_202+" for: "+_1f4.xmlDocUrl);
}
var _203={xsltArgs:_1f4,url:_1f4.xmlDocUrl,sync:false,handleAs:_202,expectedContentType:"xml",load:_1f9};
if(_1f4.dojoErrorHandler!=null){
_203.error=_1f4.dojoErrorHandler;
}
if(dojo.isIE==6){
_203.timeout=15000;
if(lconn.core.xslt.queue==null){
lconn.core.xslt.queue=new Array;
lconn.core.xslt.queueIsWorking=true;
if(lconn.core.xslt.debug){
_1f7("queue starting with: "+_1f4.xmlDocUrl);
}
dojo.xhrGet(_203);
}else{
if(lconn.core.xslt.queueIsWorking==false){
if(lconn.core.xslt.debug){
_1f7("queue resuming work with: "+_1f4.xmlDocUrl);
}
lconn.core.xslt.queueIsWorking=true;
dojo.xhrGet(_203);
}else{
if(lconn.core.xslt.debug){
_1f7("pushing into queue: "+_1f4.xmlDocUrl);
}
lconn.core.xslt.queue.push(_203);
}
}
}else{
dojo.xhrGet(_203);
}
}
};
}
if(!dojo._hasResource["lconn.core.errorhandling"]){
dojo._hasResource["lconn.core.errorhandling"]=true;
dojo.provide("lconn.core.errorhandling");
lconn.core.errorhandling.DefaultXHRErrorHandler=function(_204,_205){
var temp=null;
var msg=null;
if(_204.status==404){
if(_205.args!=null&&_205.args.url!=null){
if(_205.args.url.indexOf("roller-ui/feed")!=-1||_205.args.url.indexOf("files/basic/anonymous/api/userlibrary")!=-1){
msg=dojo.i18n.getLocalization("lc_default")["multiFeedReaderNoFeeds"];
lconn.core.errorhandling.displayError(_205,msg,_204);
return;
}
}
}
if(_204.documentElement!=null){
if(_204.documentElement.nodeName=="error"||_204.documentElement.nodeName=="parsererror"){
var _208=(dojox.data.dom.innerXML(_204.documentElement));
msg=lconn.core.errorhandling.getErrorHTML(null,null,null,null,_208);
}
}else{
var _209=dojo.i18n.getLocalization("lc_default")["errorUnableToConnect"];
_209=lconn.core.utilities.replacePlaceHolders(_209,[_205.args.url]);
if(_204.message!=null&&_204.name!=null){
if(_205.args.xsltArgs!=null){
return lconn.core.errorhandling.DefaultErrorHandler(_209,_204,_205.args.xsltArgs);
}else{
return lconn.core.errorhandling.DefaultErrorHandler(_209,_204,_205.args.htmlContainerElemId);
}
}else{
msg=lconn.core.errorhandling.getErrorHTML(_209,null,null,null,_204);
}
}
if(msg==null){
msg=lconn.core.errorhandling.getErrorHTML(null,null,null,null,_204);
}
lconn.core.errorhandling.displayError(_205,msg,_204);
};
lconn.core.errorhandling.displayError=function(_20a,msg,_20c){
var _20d=null;
if(_20a.args.xsltArgs!=null&&_20a.args.xsltArgs.htmlContainerElemId!=null){
_20d=_20a.args.xsltArgs.htmlContainerElemId;
}else{
if(_20a.args.htmlContainerElemId!=null){
_20d=_20a.args.htmlContainerElemId;
}
}
if(_20d!=null){
if(typeof (_20d)=="string"){
dojo.byId(_20d).innerHTML=msg;
}else{
_20d.innerHTML=msg;
}
}else{
alert("htmlContainerElemId was not defined.\n"+msg+"\nArguments: "+_20a+"\nresponse: "+_20c);
}
};
lconn.core.errorhandling.DefaultErrorHandler=function(_20e,_20f,_210){
var log=function(_212,_213,_214){
var msg="";
if(_213 instanceof (Error)){
var line=null;
if(_213.lineNumber!=null){
line=_213.lineNumber;
}
if(line!=null){
msg+=dojo.i18n.getLocalization("lc_default")["errorLine"]+" "+line+"<br/>";
}
var _217=null;
msg=lconn.core.errorhandling.getErrorHTML(_212,_213.message,_213.name,line,_217);
}else{
var _217=null;
msg=lconn.core.errorhandling.getErrorHTML(_212,_213,null,null,_217);
}
var _218={args:{xsltArgs:{htmlContainerElemId:_214}}};
lconn.core.errorhandling.displayError(_218,msg);
};
if(typeof (_210)=="string"){
log(_20e,_20f,_210);
}else{
if(typeof (_210)=="undefined"){
var _219=document.createElement("span");
_219.id="errorContainer";
document.body.appendChild(_219);
log(_20e,_20f,"errorContainer");
}else{
if(_210.htmlContainerElemId!=null){
log(_20e,_20f,_210.htmlContainerElemId);
}else{
log(_20e,_20f,_210);
}
}
}
};
lconn.core.errorhandling.getErrorHTML=function(_21a,_21b,_21c,_21d,_21e){
var time=new Date().getTime();
var msg="";
msg+="<span style='font-size: x-small;vertical-align: top;'>";
msg+="\t<img src='"+WidgetPlacementConfig.applicationContext+"/nav/common/styles/images/iconError.gif'/><b>"+dojo.i18n.getLocalization("lc_default")["errorDefaultMsg"]+"</b><br/>";
msg+="\t"+dojo.i18n.getLocalization("lc_default")["errorDefaultMsg2"]+"<br/><br/>";
msg+="\t<a href='javascript:void(0);' onclick=\"lconn.core.utilities.toggleVisibility('trace_"+time+"');\">"+dojo.i18n.getLocalization("lc_default")["errorDefaultMsg3"]+"</a>";
msg+="\t<div id='trace_"+time+"' style='visibility: hidden; display: none;'>";
msg+="<br/>";
if(_21a!=null){
msg+=dojo.i18n.getLocalization("lc_default")["errorName"]+" "+_21a+"<br/>";
}
if(_21b!=null){
msg+=dojo.i18n.getLocalization("lc_default")["errorMsg"]+" "+_21b+"<br/>";
}
if(_21c!=null){
msg+=dojo.i18n.getLocalization("lc_default")["errorType"]+""+_21c+"<br/>";
}
if(_21d!=null){
msg+=dojo.i18n.getLocalization("lc_default")["errorLine"]+" "+_21d+"<br/>";
}
if(_21e!=null){
msg+=dojo.i18n.getLocalization("lc_default")["errorStackTrace"]+"<br/><pre>"+_21e+"</pre><br/>";
}
msg+="\t</div>";
msg+=" </span>";
return msg;
};
var common_getStacktrace=function(){
var _221=common_getStacktrace.caller;
var _222=new Error();
if(_222.stack!=null){
return _222.stack;
}else{
var _223="";
while(_221!=null){
_223+="\n"+common_getFunctionName(_221);
var _224=_221.caller;
if(_224==null&&_221.arguments!=null&&_221.arguments.caller!=null){
_224=_221.arguments.caller;
}
_221=_224;
}
return _223;
}
};
var common_getFunctionName=function(_225){
var name=_225.name;
if(_225.tempName!=null&&_225.tempName!=""){
name=_225.tempName;
}
if(name==null||name==""){
var _227=_225.toString();
var _228=_227.match(/function (\w*)/);
if(_228!=null){
name=_228[1];
}
if(name==null||name==""){
name="anonymous-function";
}
}
return name;
};
}
if(!dojo._hasResource["lconn.core.back"]){
dojo._hasResource["lconn.core.back"]=true;
dojo.provide("lconn.core.back");
function registerBackButtonSupport(){
var _229=window.location.hash;
var _22a=true;
var _22b=true;
var _22c=true;
var _22d="lc.iframeElement";
var _22e=null;
var _22f=null;
var _230=null;
var _231=function(){
_229=window.location.hash;
_22a=_230.search;
_22b=false;
_22c=null;
};
var _232=function(){
for(var i=0;lconn.core.WidgetPlacement.URLChangeCallBack!=null&&i<lconn.core.WidgetPlacement.URLChangeCallBack.length;i++){
lconn.core.WidgetPlacement.URLChangeCallBack[i](window.location.href);
}
return;
};
var _234=function(){
var _235=document.createElement("iframe");
var uri=new dojo._Url(location.href);
_235.id=_22d;
_235.src=(WidgetPlacementConfig.params.contextRoot+"/nav/Blank.html"+(uri.fragment?"?"+uri.fragment:""));
_235.style.display="none";
document.body.appendChild(_235);
return _235;
};
var _237=function(uri,_239){
_23a(uri,"uri");
_23a(_239,"queryString");
return _23b(uri,"?",_239);
};
var _23c=function(uri,_23e){
_23a(uri,"uri");
_23a(_23e,"fragmentString");
return _23b(uri,"#",_23e);
};
var _23a=function(_23f,_240){
if(_23f!=null){
return;
}
if(_240){
throw new Error(_240+" cannot be null");
}
throw new Error("value cannot be null");
};
var _241=function(_242,_243){
if(!(dojo.trim(_242).length==0)){
return;
}
if(_243){
throw new Error(_243+" must be a non-empty string.  Saw: "+_242);
}
throw new Error("value must be a non-empty string.  Saw: "+_242);
};
var _23b=function(_244,_245,_246){
_23a(_245,"token");
_23a(_244,"string");
_23a(_246,"replacement");
if(_244.indexOf(_245)==-1){
return _244+_245+_246;
}
return _244.slice(0,_244.indexOf(_245)+1)+_246;
};
if(dojo.isIE){
_234();
_22e=window[_22d];
_22f=dojo.byId(_22d);
_230=_22e.location;
_231();
var _247=function(){
if(_22b&&_229==window.location.hash){
if(_230.search==_22c){
_231();
}
return;
}
if(_229==window.location.hash&&_22a==_230.search){
return;
}
if(_229!=window.location.hash){
_229=window.location.hash;
var _248=new dojo._Url(window.location.href);
_22b=true;
_22c=_237(_230.search,_248.fragment||"");
_22f.src=_237(_22f.src,_248.fragment||"");
return _232();
}else{
var _249=new dojo._Url(_230.href);
window.location.href=_23c(window.location.href,_249.query||"");
_231();
return _232();
}
};
setInterval(_247,500);
}else{
var _247=function(){
if(window.location.hash==_229){
return;
}
_229=window.location.hash;
return _232();
};
setInterval(_247,500);
}
};
}
if(!dojo._hasResource["lconn.core.WidgetPlacement"]){
dojo._hasResource["lconn.core.WidgetPlacement"]=true;
dojo.provide("lconn.core.WidgetPlacement");
if(typeof (WidgetPlacementConfig)=="undefined"){
var WidgetPlacementConfig={debug:false,appStartupDate:""};
}
lconn.core.WidgetPlacement.debug=WidgetPlacementConfig.debug;
lconn.core.WidgetPlacement.uiLocations=new Object();
lconn.core.WidgetPlacement.dropZoneObjects=new Object();
var getDisplayedUserInfo=function(){
var _24a=null;
if(WidgetPlacementConfig.isProfilesEnv){
if(profilesData.displayedUser!=null){
if(profilesData.displayedUser.profileType==null||profilesData.displayedUser.profileType==""){
profilesData.displayedUser.profileType="default";
}
}
_24a=profilesData.displayedUser;
}
return _24a;
};
var getWidgetConfigAttrs=function(_24b,_24c,_24d,_24e){
if(_24b==null){
_24b=[];
}
var _24f=_24c.getAttribute("defId");
var exp3="/tns:widgets/tns:definitions/tns:widgetDef[@defId = '"+_24f+"']/tns:configData/tns:attr";
var _251=lconn.core.xpath.selectNodes(exp3,_24e);
for(var i=0;_251.length!=null&&i<_251.length;i++){
var _253=_251[i].getAttribute("value");
_253=lconn.core.i18nOverrider.replaceParams(_253,WidgetPlacementConfig.params);
_24b.push({entryName:_251[i].getAttribute("key"),entryValue:_253});
}
exp3="/tns:widgets/tns:definitions/tns:widgetDef[@defId = '"+_24f+"']/tns:itemSet/tns:item";
_251=lconn.core.xpath.selectNodes(exp3,_24e);
for(var i=0;_251.length!=null&&i<_251.length;i++){
var _253=_251[i].getAttribute("value");
_253=lconn.core.i18nOverrider.replaceParams(_253,WidgetPlacementConfig.params);
_24b.push({entryName:_251[i].getAttribute("name"),entryValue:_253});
}
if(_24d!=null){
var _254=_24d.getAttribute("instanceId");
var exp4="/tns:widgets/tns:layout/tns:page/tns:widgetInstance[@instanceId = '"+_254+"']/tns:itemSet/tns:item";
_251=lconn.core.xpath.selectNodes(exp4,_24e);
for(var i=0;_251.length!=null&&i<_251.length;i++){
var _253=_251[i].getAttribute("value");
_253=lconn.core.i18nOverrider.replaceParams(_253,WidgetPlacementConfig.params);
_24b.push({entryName:_251[i].getAttribute("name"),entryValue:_253});
}
}
return _24b;
};
lconn.core.WidgetPlacement.getWidgetDocAndRenderWidget=function(_256,_257,_258,_259,_25a,_25b,_25c,_25d,_25e){
var temp=function(_260,_261){
var _262=_260;
WidgetPlacementConfig.widgetConfigXMLDocument=_262;
var _263=null;
if(_256==null&&_257!=null){
_256=_257.getAttribute("defId");
}
if(_257==null){
var exp3="/tns:widgets/tns:definitions/tns:widgetDef[@defId = '"+_256+"']";
_257=lconn.core.xpath.selectSingleNode(exp3,_262);
if(_257==null){
console.log("Unable to find widget definition for: "+_256);
return;
}
_256=_257.getAttribute("defId");
}
if(_258==null){
_258=_256;
}
if(_263==null){
_263=_262.createElement("widgetInstance");
_263.setAttribute("uiLocation",_259);
_263.setAttribute("defIdRef",_256);
_263.setAttribute("instanceId",_258);
}
if(_25b==null){
_25b=_257.getAttribute("skinType");
}
var _265=null;
var _266=null;
var _267="widget-container-"+_259;
var _268=dojo.byId(_259+"DropZone");
if(_268==null){
_266=dojo.byId(_267);
}else{
_266=_268;
}
if(_25a=="fullpage"){
var _269=null;
var url=_257.getAttribute("url");
_25e=getWidgetConfigAttrs(_25e,_257,_263,_262);
_266.innerHTML+=AddiWidgetMicroformat(_258,url,getDisplayedUserInfo(),_25e,_25a);
renderSingleWidget(_258);
}else{
var _26b=document.createElement("div");
var _26c=GetCompleteWidgetHTMLContent(_257,_263,null,_262,true,_25b,_25a,_25c,_25e);
_26b.innerHTML=_26c;
_266.appendChild(_26b.firstChild);
var _26d=_259+"DropZone";
if(_25d==null){
if(_268==null){
lconn.core.utilities.processUntilElementIsFound(_26d,parseDojoWidgetsAndRegisterNewDNDDropZone,null,{uiLocation:_259,dropZoneDOMId:_26d});
}else{
lconn.core.utilities.processUntilElementIsFound(_258+"Section",parseDojoWidgetsAndAddDNDItem,null,{dropZoneDOMId:_26d,widgetInstanceId:_258});
}
}
renderSingleWidget(_258);
lconn.core.utilities.processUntilElementIsFound(_258+"Section",function(){
dojo.parser.parse(dojo.byId(_258+"Section"));
});
}
};
if(WidgetPlacementConfig.widgetConfigXMLDocument!=null){
temp(WidgetPlacementConfig.widgetConfigXMLDocument);
}else{
dojo.xhrGet({url:WidgetPlacementConfig.layoutInfoUrl+"&lastMod="+WidgetPlacementConfig.lastMod,error:lconn.core.errorhandling.DefaultXHRErrorHandler,handleAs:"xml",sync:true,load:temp});
}
};
var parseDojoWidgetsAndRegisterNewDNDDropZone=function(_26e,_26f){
dojo.parser.parse(_26e);
var _270=createDropZoneObject(_26f.uiLocation,_26e);
lconn.core.WidgetPlacement.dropZoneObjects[_26f.dropZoneDOMId]=_270;
};
var parseDojoWidgetsAndAddDNDItem=function(_271,_272){
dojo.parser.parse(_271);
var _273=lconn.core.WidgetPlacement.dropZoneObjects[_272.dropZoneDOMId];
_273.setItem(_271.id,{node:_271,id:_271.id,data:_272.widgetInstanceId,type:"widget"});
};
var createDropZoneObject=function(_274,_275){
var _276={jsId:_274,accept:"widget",withhandles:true,skipform:true};
var _277=new lconn.dboard.dnd.Source(_275,_276);
return _277;
};
var AddiWidgetMicroformat=function(_278,url,_27a,_27b,_27c){
url=lconn.core.i18nOverrider.replaceParams(url,WidgetPlacementConfig.params);
var _27d="<div id='"+_278+"' class='mm_iWidget'><a class='mm_Definition' style='display: none;visibility:hidden;' href='"+url+"' ></a>";
if(_27c!=null){
_27d+="<div class=\"mm_ItemSet\" title=\"idescriptor\" style=\"display: none;\">"+"<a class=\"mm_Item\" href=\"#mode\" style=\"visibility:hidden\">"+_27c+"</a>"+"</div>";
}
_27d+="<div class='mm_ItemSet' title='attributes' style='display: none;'>";
if(WidgetPlacementConfig.isProfilesEnv){
if(_27a.uid!=null){
_27d+="<a class='mm_Item' type='string' style='display: none;' href='#profileDisplayedUserUID'>"+_27a.uid+"</a>";
}
if(_27a.key!=null){
_27d+="<a class='mm_Item' type='string' style='display: none;' href='#profileDisplayedUserKey'>"+_27a.key+"</a>";
}
}
if(WidgetPlacementConfig.resourceId!=null){
_27d+="<a class='mm_Item' type='string' style='display: none;' href='#resourceId'>"+WidgetPlacementConfig.resourceId+"</a>";
}
if(WidgetPlacementConfig.resourceType!=null){
_27d+="<a class='mm_Item' type='string' style='display: none;' href='#resourceType'>"+WidgetPlacementConfig.resourceType+"</a>";
}
for(var i=0;_27b!=null&&i<_27b.length;i++){
_27d+="<a class='mm_Item' type='string' style='display: none;' href='#"+_27b[i].entryName+"'>"+_27b[i].entryValue+"</a>";
}
_27d+="</div>"+"</div>";
return _27d;
};
var getNavBar=function(){
var _27f=dojo.byId("lotusProfileNavBar");
if(_27f==null){
_27f=dojo.byId("lotusNavBar");
}
return _27f;
};
var registerCloseViewFunction=function(_280){
lconn.core.WidgetPlacement.registerCloseViewFunction=_280;
};
var closeOtherViews=function(){
if(lconn.core.WidgetPlacement.registerCloseViewFunction!=null){
lconn.core.WidgetPlacement.registerCloseViewFunction();
lconn.core.WidgetPlacement.registerCloseViewFunction=null;
}
};
lconn.core.WidgetPlacement.closeSwitchView=function(){
destroyWidgetContainer("fullpage");
if(lconn.core.WidgetPlacement.currentFullpageWidgetInstanceId!=null){
destroyWidget(lconn.core.WidgetPlacement.currentFullpageWidgetInstanceId,null,false);
}
lconn.core.utilities.hide("widget-container-fullpage",false,true);
};
var switchView=function(_281,_282,_283,_284,_285){
closeOtherViews();
registerCloseViewFunction(lconn.core.WidgetPlacement.closeSwitchView);
destroyWidgetContainer("fullpage");
destroyWidget(_282,null,false);
if(lconn.core.WidgetPlacement.currentFullpageWidgetInstanceId!=null){
destroyWidget(lconn.core.WidgetPlacement.currentFullpageWidgetInstanceId,null,false);
}
for(uiLocation in lconn.core.WidgetPlacement.uiLocations){
lconn.core.utilities.hide("widget-container-"+uiLocation,false,true);
}
if(WidgetPlacementConfig.hideElements!=null){
for(var i=0;WidgetPlacementConfig.hideElements!=null&&i<WidgetPlacementConfig.hideElements.length;i++){
lconn.core.utilities.hide(WidgetPlacementConfig.hideElements[i],false,true);
}
}
var _287=getNavBar();
if(_287!=null){
var _288=_287.getElementsByTagName("li");
for(var i=0;_288!=null&&i<_288.length;i++){
if(_288[i].className!=""){
dojo.removeClass(_288[i],"lotusSelected");
}
}
var _289=dojo.byId(_282+"_navItem");
dojo.addClass(_289,"lotusSelected");
}
lconn.core.utilities.show("widget-container-fullpage",false,false,true);
lconn.core.WidgetPlacement.getWidgetDocAndRenderWidget(null,_281,_282,"fullpage","fullpage","skinless",false);
lconn.core.WidgetPlacement.currentFullpageWidgetInstanceId=_282;
};
var getResourcedStringForItem=function(_28a,_28b){
var _28c=_28a.getAttribute("bundleRefId");
if(_28c==null||_28c==""){
_28c="lc_default";
}
var _28d=_28a.getAttribute(_28b);
var _28e=dojo.i18n.getLocalization(_28c);
if(_28e==null){
console.log("unable to find resource bundle for '"+_28c+"'");
return _28d;
}else{
var _28f=_28e[_28d];
if(_28f==null){
return _28d;
}else{
return _28f;
}
}
};
var addToNavBar=function(_290,_291,_292,_293,_294,_295){
var _296=getNavBar();
if(_296==null){
return;
}
var _297=_290.getAttribute("showFullPageViewLinkInNavBar");
var _298=_290.getAttribute("modes");
if((_297!=null&&_297=="true")||(_298!=null&&_298.indexOf("fullpage")!=-1)||(_294!=null&&_294!="")){
var _299=null;
var _29a=_290.getAttribute("navBarResourceBundleId");
_299=dojo.i18n.getLocalization("lc_default")[_29a];
if(_299==null||_299=="undefined"){
_299=_29a;
}
if(_299==_29a){
_299=getResourcedStringForItem(_290,"defId");
}
var _29b=_290.getAttribute("defId");
var _29c=_291.getAttribute("instanceId");
if(_29c==null){
_29c=_29b;
}
var li=document.createElement("li");
if(_293==true){
dojo.addClass(li,"lotusSelected");
}
li.id=_29c+"_navItem";
var _29e=document.createElement("a");
if(_294!=null&&_294!=""){
var _29f=lconn.core.i18nOverrider.replaceParams(_294,WidgetPlacementConfig.params);
_29e.href=_29f;
}else{
_29e.href="javascript:void(0);";
var _2a0=function(){
changeHash("fullpageWidgetId="+_29c);
return false;
};
dojo.connect(_29e,"onclick",_2a0);
}
var _2a1=document.createTextNode(_299);
_29e.appendChild(_2a1);
li.appendChild(_29e);
_296.appendChild(li);
}
};
var GetCompleteWidgetHTMLContent=function(_2a2,_2a3,_2a4,_2a5,_2a6,_2a7,_2a8,_2a9,_2aa){
if(typeof (_2a2)=="undefined"){
return "";
}
var url=_2a2.getAttribute("url");
var _2ac=_2a2.getAttribute("modes");
var _2ad=_2a3.getAttribute("instanceId");
var _2ae=_2a2.getAttribute("defId");
var _2af=_2a2.getAttribute("navBarLink");
var _2b0=_2a2.getAttribute("helpLink");
var _2b1=null;
if(_2b0!=null&&_2b0!=""){
_2b1=lconn.core.i18nOverrider.replaceParams(_2b0,WidgetPlacementConfig.params);
}
var _2b2=false;
var _2b3="";
if(_2ad!=null){
_2b2=true;
}
if(_2ad==null){
_2ad=_2ae;
}
if(_2a9==null||_2a9==true){
addToNavBar(_2a2,_2a3,_2a4,null,_2af,true);
}
var _2b4=null;
if(_2b2){
var _2b5="/tns:widgets/tns:layout/tns:page/tns:widgetInstance[@instanceId = '"+_2ad+"']/tns:itemSet/tns:item[@name = 'widgetTitle']/@value";
_2b4=lconn.core.xpath.selectText(_2b5,_2a5);
}
if(_2b4==null){
_2b4=getResourcedStringForItem(_2a2,"defId");
if(_2b4==null||_2b4=="undefined"){
_2b4=_2ae;
}
}
var _2b6=null;
var _2b7=_2ae+"-isMinimized";
var _2b8=dojo.cookie(_2b7);
if(_2a7==null||_2a7==""){
_2a7="use25OneUISkin";
}
if(_2a7=="use25OneUISkin"){
var _2b9="Open";
if(_2b8!="true"){
_2b9="Close";
}
var _2ba="";
var _2bb="";
if(_2a6&&_2b2){
_2ba=" dojoDndItem\" dndType=\"widget\" dndData=\""+_2ad;
}else{
_2bb="style=\"cursor: default\"";
}
_2b6="<div id=\""+_2ad+"Section\" class=\"lotusWidget2"+_2ba+"\" widgetId=\""+_2ad+"\"><h2 class=\"ibmDndDragHandle\" "+_2bb+">"+"<span class=\"lotusLeft\" style=\"cursor: default\">"+_2b4+"</span>";
_2b6+="<a  class=\"lotusIcon lotusActionMenu\" href=\"javascript:void(0);\" onclick=\"lconn.core.WidgetPlacement.openMenu(event, '"+_2ad+"');\" title=\""+dojo.i18n.getLocalization("lc_default")["actions"]+"\">"+"<img src=\""+WidgetPlacementConfig.applicationContext+"/nav/common/styles/images/blank.gif\" alt=\""+dojo.i18n.getLocalization("lc_default")["actions"]+"\"/>"+"<span class=\"lotusAltText\">"+"V"+"</span>"+"</a>";
_2b6+="</h2>";
_2b6+="<div dojoType=\"dijit.Menu\" id=\""+_2ad+"moreActions\" style=\"display: none;\">";
if(_2b8!="true"){
_2b6+="<div id=\""+_2ad+"_toggleAction\" dojoType=\"dijit.MenuItem\" label=\""+dojo.i18n.getLocalization("lc_default")["widgets_Min"]+"\" onclick=\"lconn.core.WidgetPlacement.minimizeWidget(this,'"+_2ad+"', '"+_2ae+"');\"></div>";
}else{
_2b6+="<div id=\""+_2ad+"_toggleAction\" dojoType=\"dijit.MenuItem\" label=\""+dojo.i18n.getLocalization("lc_default")["widgets_Max"]+"\" onclick=\"lconn.core.WidgetPlacement.minimizeWidget(this,'"+_2ad+"', '"+_2ae+"');\"></div>";
}
_2b6+="<div dojoType=\"dijit.MenuItem\" label=\""+dojo.i18n.getLocalization("lc_default")["refresh"]+"\" onclick=\"lconn.core.WidgetPlacement.refresh('"+_2ad+"');\"></div>";
if(_2ac!=null&&_2ac.indexOf("edit")!=-1&&_2a6){
_2b6+="<div dojoType=\"dijit.MenuItem\" label=\""+dojo.i18n.getLocalization("lc_default")["edit"]+"\" onclick=\"lconn.core.utilities.hide('"+_2ad+"moreActions"+"', false, true);_"+_2ad+"_iContext.iEvents.fireEvent('onModeChanged','','{\\'newMode\\':\\'edit\\'}');\"></div>";
}
if(_2b1!=null){
_2b6+="<div dojoType=\"dijit.MenuItem\" label=\""+dojo.i18n.getLocalization("lc_default")["help"]+"\" onclick=\"lconn.core.utilities.hide('"+_2ad+"moreActions"+"', false, true);lconn.core.WidgetPlacement.openHelpWindow('"+_2b1+"');\"></div>";
}
if(_2b2&&_2a6){
var _2bc=_2a3.getAttribute("uiLocation");
_2b6+="<div dojoType=\"dijit.MenuItem\" label=\""+dojo.i18n.getLocalization("lc_default")["widgets_MoveUp"]+"\" onclick=\"lconn.core.WidgetPlacement.moveUp('"+_2ad+"','"+_2bc+"');\"></div>";
_2b6+="<div dojoType=\"dijit.MenuItem\" label=\""+dojo.i18n.getLocalization("lc_default")["widgets_MoveDown"]+"\" onclick=\"lconn.core.WidgetPlacement.moveDown('"+_2ad+"','"+_2bc+"');\"></div>";
_2b6+="<div dojoType=\"dijit.MenuItem\" label=\""+dojo.i18n.getLocalization("lc_default")["hide"]+"\" onclick=\"lconn.core.WidgetPlacement.removeWidget('"+_2ad+"', false);\"></div>";
_2b6+="<div dojoType=\"dijit.MenuItem\" label=\""+dojo.i18n.getLocalization("lc_default")["link.remove"]+"\" onclick=\"lconn.core.WidgetPlacement.removeWidget('"+_2ad+"', true);\"></div>";
}
_2b6+="</div>";
if(_2b8!="true"){
_2b6+="<div id='"+_2ad+"SubArea' class='lotusWidgetBody' widgetloaded='true' >";
_2aa=getWidgetConfigAttrs(_2aa,_2a2,_2a3,_2a5);
_2b6+=AddiWidgetMicroformat(_2ad,url,_2a4,_2aa,_2a8);
}else{
_2b6+="<div id='"+_2ad+"SubArea' class='lotusWidgetBody' style=' visibility: hidden; display: none;' widgetloaded='false' >";
}
_2b6+="</div>"+"</div>";
}else{
if(_2a7=="skinless"){
_2b6="<div id='"+_2ad+"Section'>";
_2b6+="<div id='"+_2ad+"SubArea' widgetloaded='true' >";
_2aa=getWidgetConfigAttrs(_2aa,_2a2,_2a3,_2a5);
_2b6+=AddiWidgetMicroformat(_2ad,url,_2a4,_2aa,_2a8);
_2b6+="</div>"+"</div>";
}
}
return _2b6;
};
lconn.core.WidgetPlacement.openHelpWindow=function(url){
var h=window.screen.height/4;
if(h<800){
h=800;
}
var w=window.screen.width/4;
if(w<800){
w=800;
}
var _2c0="height="+h+",width="+w+",status=yes,toolbar=yes,menubar=no,location=yes,scrollbars=yes,resizable=yes";
var _2c1=window.open(url,"helpWindow",_2c0);
_2c1.focus();
};
lconn.core.WidgetPlacement.openMenu=function(_2c2,_2c3){
var _2c4=_2c3+"moreActions";
var _2c5=dijit.byId(_2c4);
if(_2c5==null){
if(WidgetPlacementConfig.debug){
console.log("dojoWidgetId: '"+_2c4+"' don't have a dojoWidget instance, creating one");
}
dojo.parser.parse(dojo.byId(_2c4));
}
menuUtility.openMenu(_2c2,_2c4);
};
var loadNavItemsOnly=function(_2c6,_2c7,_2c8){
var _2c9=function(_2ca,_2cb){
var data=_2ca;
WidgetPlacementConfig.widgetConfigXMLDocument=data;
var exp1=null;
exp1="/tns:widgets/tns:layout/tns:page[@pageId='"+WidgetPlacementConfig.defaultPageId+"']/tns:widgetInstance";
var _2ce=lconn.core.xpath.selectNodes(exp1,data);
if(typeof (_2ce)!="undefined"&&typeof (_2ce.length)!="undefined"){
for(var i=0;_2ce.length!=null&&i<_2ce.length;i++){
var _2d0=_2ce[i];
var _2d1=_2d0.getAttribute("defIdRef");
var exp3="/tns:widgets/tns:definitions/tns:widgetDef[@defId = '"+_2d1+"']";
var _2d3=lconn.core.xpath.selectSingleNode(exp3,data);
if(canAddWidget(_2d3,WidgetPlacementConfig,_2c7,_2d0)){
var _2d4=_2d3.getAttribute("navBarLink");
var _2d5=false;
if(WidgetPlacementConfig.NavBarSelectedMenuItem!=null&&WidgetPlacementConfig.NavBarSelectedMenuItem==_2d1){
_2d5=true;
}
addToNavBar(_2d3,_2d0,_2c8,_2d5,_2d4,false);
}
}
}
};
if(WidgetPlacementConfig.widgetConfigXMLDocument==null){
dojo.xhrGet({url:WidgetPlacementConfig.layoutInfoUrl+"&lastMod="+WidgetPlacementConfig.lastMod,error:lconn.core.errorhandling.DefaultXHRErrorHandler,handleAs:"xml",sync:true,load:_2c9});
}else{
_2c9(WidgetPlacementConfig.widgetConfigXMLDocument);
}
};
var canAddWidget=function(_2d6,_2d7,_2d8,_2d9){
if(_2d6==null){
return false;
}
var _2da=_2d6.getAttribute("loginRequired");
if(_2da=="true"&&!_2d7.userLoggedIn){
return false;
}
var _2db=_2d6.getAttribute("resourceOwnerWidget");
if(_2db=="true"&&!_2d8){
return false;
}
if(_2d9!=null){
var _2dc=_2d9.getAttribute("enabled");
if(_2dc=="false"){
return false;
}
}
var _2dd=_2d6.getAttribute("prerequisite");
if(_2dd!=null&&_2dd!=""&&_2d7.availableServices!=null){
var _2de=_2dd.split(" ");
for(var x=0;_2de.length!=null&&x<_2de.length;x++){
if(_2d7.availableServices[_2de[x]]==null||_2d7.availableServices[_2de[x]]==false){
return false;
}
}
}
return true;
};
lconn.core.WidgetPlacement.placeWidgetMetadata=function(_2e0){
lconn.core.WidgetPlacement.initialLoad=true;
var _2e1=function(_2e2,_2e3,data,_2e5,_2e6){
var _2e7=null;
var _2e8=new Object();
try{
var exp=null;
var exp1=null;
var exp2=null;
var _2ec=null;
if(WidgetPlacementConfig.isProfilesEnv){
exp="/tns:widgets/tns:layout[@resourceSubType='"+(_2e3?_2e3.profileType:"")+"']";
exp1="/tns:widgets/tns:layout[@resourceSubType='"+(_2e3?_2e3.profileType:"default")+"']/tns:page[@pageId='"+_2e2+"']/tns:widgetInstance";
exp2="/tns:widgets/tns:layout[@resourceSubType='default'               ]/tns:page[@pageId='"+_2e2+"']/tns:widgetInstance";
_2ec=lconn.core.xpath.selectNodes(exp,data);
}else{
exp1="/tns:widgets/tns:layout/tns:page[@pageId='"+_2e2+"']/tns:widgetInstance";
exp2=exp1;
}
var _2ed=lconn.core.xpath.selectNodes(exp1,data);
if((_2ec==null||_2ec.length==0)&&(_2ed==null||_2ed.length==0)){
_2ed=lconn.core.xpath.selectNodes(exp2,data);
}
var _2ee="";
if(typeof (_2ed)!="undefined"&&typeof (_2ed.length)!="undefined"){
for(var i=0;_2ed.length!=null&&i<_2ed.length;i++){
var _2f0=_2ed[i];
var _2f1=_2f0.getAttribute("defIdRef");
var exp3="/tns:widgets/tns:definitions/tns:widgetDef[@defId = '"+_2f1+"']";
var _2f3=lconn.core.xpath.selectSingleNode(exp3,data);
if(canAddWidget(_2f3,WidgetPlacementConfig,_2e5,_2f0)){
var _2f4=_2f3.getAttribute("skinType");
var _2f5=_2f0.getAttribute("uiLocation");
if(_2e8[_2f5]==null){
_2e8[_2f5]="";
}
var _2f6=_2f0.getAttribute("instanceId");
if(_2f6!=null&&_2e8[_2f5+"dnd"]==null&&_2e5){
_2e8[_2f5]+="<div style=\"display: inline\" id=\""+_2f5+"DropZone\" class=\"target\">";
_2e8[_2f5+"dnd"]=true;
}
if(_2f6==null){
_2f6=_2f1;
}
if(lconn.core.WidgetPlacement.loadOrder==null){
lconn.core.WidgetPlacement.loadOrder=new Array();
}
lconn.core.WidgetPlacement.loadOrder[lconn.core.WidgetPlacement.loadOrder.length]={instanceId:_2f6,uiLocation:_2f5};
_2e8[_2f5]+=GetCompleteWidgetHTMLContent(_2f3,_2f0,_2e3,data,_2e5,_2f4,null,_2e6);
lconn.core.WidgetPlacement.uiLocations[_2f5]=true;
}
}
}
for(_2f5 in _2e8){
var _2f7=dojo.byId("widget-container-"+_2f5);
if(_2f7!=null){
var temp="";
if(_2e8[_2f5+"dnd"]==true){
temp="</div>";
}
_2f7.innerHTML=_2e8[_2f5]+temp;
}else{
console.log("uiLocation: '"+_2f5+"' is not defined");
}
}
}
catch(exception){
lconn.core.errorhandling.DefaultErrorHandler("lconn.core.WidgetPlacement.addAllWidgets",exception);
}
};
var _2f9=function(_2fa,_2fb){
var _2fc=_2fa;
WidgetPlacementConfig.widgetConfigXMLDocument=_2fc;
if(WidgetPlacementConfig.pageId=="fullPageWidgetView"){
try{
var _2fd=_2fb.args.displayedUserInfo;
var _2fe=dojo.byId("widgetContainer");
if(_2fe==null){
_2fe=dojo.byId("widget-container-fullpage");
}
var _2ff=common_getParam("widgetId");
var _300=lconn.core.xpath.selectSingleNode("/tns:widgets/tns:definitions/tns:widgetDef[@defId = '"+_2ff+"']",_2fc);
var url=_300.getAttribute("url");
addToNavBar(_300,null,_2fd,null,null,true);
var _302=[{entryName:"state",entryValue:"maximize"}];
_302=getWidgetConfigAttrs(_302,_300,null,_2fc);
_2fe.innerHTML=AddiWidgetMicroformat(_2ff,url,_2fd,_302,"fullpage");
if(lconn.core.WidgetPlacement.loadOrder==null){
lconn.core.WidgetPlacement.loadOrder=new Array();
}
lconn.core.WidgetPlacement.loadOrder[lconn.core.WidgetPlacement.loadOrder.length]={instanceId:_2ff,uiLocation:"fullpage"};
}
catch(exception){
lconn.core.errorhandling.DefaultErrorHandler("WidgetMgmt.loadWidgets",exception,"widgetContainer");
}
}else{
var _2fd=_2fb.args.displayedUserInfo;
_2e1(WidgetPlacementConfig.pageId,_2fd,_2fc,_303,_2fb.args.addToNavBarBoolean);
}
};
var _304=null;
var _303=null;
if(WidgetPlacementConfig.pageId==null){
if(_2e0!=false){
if(_303==null){
_303=getUserProfileOverrideProperty("canPersonalize")=="true";
}
if(_304==null){
_304=getDisplayedUserInfo();
}
loadNavItemsOnly(_2e0,_303,_304);
}
return;
}
if(_303==null){
_303=getUserProfileOverrideProperty("canPersonalize")=="true";
}
if(_304==null){
_304=getDisplayedUserInfo();
}
if(WidgetPlacementConfig.debug){
console.info("Using URL:"+WidgetPlacementConfig.layoutInfoUrl+"&lastMod="+WidgetPlacementConfig.lastMod);
}
if(WidgetPlacementConfig.widgetConfigXMLDocument==null){
dojo.xhrGet({addToNavBarBoolean:_2e0,displayedUserInfo:_304,url:WidgetPlacementConfig.layoutInfoUrl+"&lastMod="+WidgetPlacementConfig.lastMod,error:lconn.core.errorhandling.DefaultXHRErrorHandler,handleAs:"xml",sync:true,load:_2f9});
}else{
_2f9(WidgetPlacementConfig.widgetConfigXMLDocument,{args:{addToNavBarBoolean:_2e0,displayedUserInfo:_304}});
}
if(dojo.dnd!=null){
var _305=dojo.dnd.manager();
_305.makeAvatar=function(){
return new lconn.dboard.dnd.avatar(this);
};
dojo.subscribe("/dnd/drop",lconn.core.WidgetPlacement.onDropHandler);
dojo.subscribe("/dnd/start",function(_306,_307,_308){
for(var i=0;i<_307.length;i++){
lconn.core.utilities.hide(_307[i],false,true);
lconn.core.WidgetPlacement.currentNode=_307[i];
}
});
dojo.subscribe("/dnd/cancel",function(){
if(lconn.core.WidgetPlacement.currentNode!=null){
lconn.core.utilities.show(lconn.core.WidgetPlacement.currentNode,false,false,true);
lconn.core.WidgetPlacement.currentNode=null;
}
});
}
setTimeout("dojo.parser.parse(document.body)",2000);
if(dojo.dnd!=null){
var _30a=function(){
for(uiLocation in lconn.core.WidgetPlacement.uiLocations){
var _30b=uiLocation+"DropZone";
var _30c=dojo.byId(_30b);
if(_30c!=null){
var _30d=createDropZoneObject(uiLocation,_30c);
lconn.core.WidgetPlacement.dropZoneObjects[_30b]=_30d;
}
}
};
setTimeout(_30a,2000);
}
lconn.core.WidgetPlacement.initialLoad=false;
};
lconn.core.WidgetPlacement.onDropHandler=function(_30e,_30f,_310){
var _311=dojo.dnd.manager().target;
var _312=null;
for(var i=0;i<_30f.length;i++){
_312=_30f[i];
lconn.core.utilities.show(_312,false,false,true);
break;
}
if(lconn.core.WidgetPlacement.currentNode!=null){
lconn.core.utilities.show(lconn.core.WidgetPlacement.currentNode,false,false,true);
lconn.core.WidgetPlacement.currentNode=null;
}
var _314=function(){
var _315=_311.getAllNodes();
for(var i=0;i<_315.length;i++){
var _317=_312.getAttribute("widgetId");
if(_315[i].getAttribute("widgetId")==_317){
var _318=null;
if(i==0){
_318=null;
}else{
_318=_315[i-1].getAttribute("widgetId");
}
moveWidgetTemp(_317,_311.jsId,_318,_311,_30e);
break;
}
}
};
setTimeout(_314,300);
};
var moveWidgetTemp=function(_319,_31a,_31b,_31c,_31d){
var _31e=WidgetPlacementConfig.applicationContext+"/moveWidget.do?resourceId="+WidgetPlacementConfig.resourceId+"&widgetInstanceId="+_319+"&newUiLocation="+_31a;
if(_31b!=null){
_31e+="&afterWidgetInstanceId="+_31b;
}
dojo.xhrPost({url:_31e,handleAs:"xml",load:function(resp,_320){
var _321=new Date().getTime();
WidgetPlacementConfig.lastMod=_321;
if(_31c!=null&&_31d!=null&&_31c!=_31d){
lconn.core.WidgetPlacement.refresh(_319);
}
},error:lconn.core.errorhandling.DefaultXHRErrorHandler});
};
var renderSingleWidget=function(_322){
if(lconn.core.WidgetPlacement.URLChangeCallBack==null){
lconn.core.WidgetPlacement.URLChangeCallBack=[lconn.core.WidgetPlacement.URLChange];
registerBackButtonSupport();
}
var _323=dojo.byId(_322);
if(_323!=null){
var _324=iWidgetContainer.createWidget(_323);
if(_324){
iWidgetContainer.renderWidget(_324);
}
}
};
lconn.core.WidgetPlacement.renderWidgets=function(){
if(lconn.core.WidgetPlacement.loadOrder!=null){
for(var i=0;i<lconn.core.WidgetPlacement.loadOrder.length;i++){
var _326=lconn.core.WidgetPlacement.loadOrder[i];
if(_326!=null){
renderSingleWidget(_326.instanceId);
}
}
}
};
var destroyWidgetContainer=function(_327){
for(var i=0;lconn.core.WidgetPlacement.loadOrder!=null&&i<lconn.core.WidgetPlacement.loadOrder.length;i++){
var _329=lconn.core.WidgetPlacement.loadOrder[i];
if(_329.uiLocation==_327){
destroyWidget(_329.instanceId,_329.uiLocation,false);
}
}
var _32a=dojo.byId("widget-container-"+_327);
_32a.innerHTML="";
};
var destroyWidget=function(_32b,_32c,_32d){
var _32e=dijit.byId(_32b+"moreActions");
if(_32e!=null&&(_32d==true)){
_32e.destroy();
}
var _32f=dijit.byId(_32b+"_toggleAction");
if(_32f!=null&&(_32d==true)){
_32f.destroy();
}
serviceManager.getService("eventService").publishEvent("/enabler/unloadWidget",[_32b]);
window["_"+_32b+"_iContext"]=null;
var _330=null;
_330=document.getElementById(_32b+"SubArea");
if(_330!=null){
_330.innerHTML="";
}
};
lconn.core.WidgetPlacement.loadWidgetFullPage=function(_331,_332){
lconn.core.WidgetPlacement.loadFullpageView(_331,_332,true,true);
};
lconn.core.WidgetPlacement.loadFullpageView=function(_333,_334,_335,_336,_337){
var exp4="/tns:widgets/tns:layout/tns:page/tns:widgetInstance[@instanceId = '"+_333+"']";
var _339=lconn.core.xpath.selectSingleNode(exp4,WidgetPlacementConfig.widgetConfigXMLDocument);
var _33a=null;
if(_339!=null){
_33a=_339.getAttribute("defIdRef");
}else{
_33a=_333;
}
var exp3="/tns:widgets/tns:definitions/tns:widgetDef[@defId = '"+_33a+"']";
var _33c=lconn.core.xpath.selectSingleNode(exp3,WidgetPlacementConfig.widgetConfigXMLDocument);
if(_334==null){
_334=[{name:"resourceId",value:WidgetPlacementConfig.resourceId}];
}else{
_334[_334.length]={name:"resourceId",value:WidgetPlacementConfig.resourceId};
}
switchView(_33c,_333,_334,_336,_335);
};
lconn.core.WidgetPlacement.reloadOverviewPage=function(){
closeOtherViews();
if(WidgetPlacementConfig.debug){
console.log("lconn.core.WidgetPlacement.reloadOverviewPage called");
}
if(lconn.core.WidgetPlacement.onlyFullPageWidgetLoaded){
lconn.core.WidgetPlacement.placeWidgetMetadata(false);
lconn.core.WidgetPlacement.renderWidgets();
lconn.core.WidgetPlacement.onlyFullPageWidgetLoaded=false;
}
if(WidgetPlacementConfig.hideElements!=null){
for(var i=0;WidgetPlacementConfig.hideElements!=null&&i<WidgetPlacementConfig.hideElements.length;i++){
lconn.core.utilities.show(WidgetPlacementConfig.hideElements[i],false,false,true);
}
}
destroyWidgetContainer("fullpage");
for(uiLocation in lconn.core.WidgetPlacement.uiLocations){
lconn.core.utilities.show("widget-container-"+uiLocation,false,false,true);
}
highlightOverviewLink();
for(var i=0;lconn.core.WidgetPlacement.loadOrder!=null&&i<lconn.core.WidgetPlacement.loadOrder.length;i++){
var _33e=lconn.core.WidgetPlacement.loadOrder[i];
lconn.core.WidgetPlacement.refresh(_33e.instanceId);
}
return false;
};
var highlightOverviewLink=function(){
var _33f=getNavBar();
if(_33f!=null){
var _340=_33f.getElementsByTagName("li");
for(var i=0;_340!=null&&i<_340.length;i++){
dojo.removeClass(_340[i],"lotusSelected");
}
}
if(WidgetPlacementConfig.navBarOverViewElementId!=null){
var _342=dojo.byId(WidgetPlacementConfig.navBarOverViewElementId);
if(_342!=null){
dojo.addClass(_342,"lotusSelected");
}
}
};
lconn.core.WidgetPlacement.refresh=function(_343,_344){
lconn.core.utilities.hide(_343+"moreActions",false,true);
destroyWidget(_343,null,false);
var _345=null;
if(_344==null){
_345=WidgetPlacementConfig.widgetConfigXMLDocument;
}else{
_345=_344;
}
var exp4="/tns:widgets/tns:layout/tns:page/tns:widgetInstance[@instanceId = '"+_343+"']";
var _347=lconn.core.xpath.selectSingleNode(exp4,_345);
var _348=null;
if(_347!=null){
_348=_347.getAttribute("defIdRef");
}else{
_348=_343;
}
var exp3="/tns:widgets/tns:definitions/tns:widgetDef[@defId = '"+_348+"']";
var _34a=lconn.core.xpath.selectSingleNode(exp3,WidgetPlacementConfig.widgetConfigXMLDocument);
var _34b=getWidgetConfigAttrs(null,_34a,_347,_345);
var _34c=dojo.byId(_343+"SubArea");
_34c.innerHTML=AddiWidgetMicroformat(_343,_34a.getAttribute("url"),getDisplayedUserInfo(),_34b,"view");
_34c.setAttribute("widgetloaded","true");
if(window.refreshInfoHolder==null){
window.refreshInfoHolder={};
}
window.refreshInfoHolder[_343]=true;
renderSingleWidget(_343);
setTimeout(function(){
window.refreshInfoHolder[_343]=null;
},2000);
};
lconn.core.WidgetPlacement.moveDown=function(_34d,_34e){
var _34f=dojo.byId(_34e+"DropZone");
var _350=_34f.childNodes;
for(var _351=0;_351<_350.length;_351++){
var _352=_350[_351].getAttribute("widgetid");
if(_352==_34d){
var _353=_351+1;
if(_353>_350.length){
_353=_350.length-1;
}
if(_353==_350.length){
break;
}
var _354=_350[_353].getAttribute("widgetid");
moveWidgetTemp(_34d,_34e,_354);
try{
_34f.insertBefore(_350[_351],_350[_353+1]);
}
catch(exception){
_34f.appendChild(_350[_351]);
}
break;
}
}
lconn.core.utilities.hide(_34d+"moreActions",false,true);
};
lconn.core.WidgetPlacement.moveUp=function(_355,_356){
var _357=dojo.byId(_356+"DropZone");
var _358=_357.childNodes;
for(var _359=0;_359<_358.length;_359++){
var _35a=_358[_359].getAttribute("widgetid");
if(_35a==_355){
if(_359==0){
break;
}
var _35b=_359-1;
var _35c=null;
if(_35b!=0&&_35b!=1){
_35c=_358[_35b-1].getAttribute("widgetid");
}
moveWidgetTemp(_355,_356,_35c);
_357.insertBefore(_358[_359],_358[_35b]);
break;
}
}
lconn.core.utilities.hide(_355+"moreActions",false,true);
};
var getDialog=function(){
if(window.dialog1==null){
var _35d=document.getElementById("dialog1Container");
if(_35d==null){
_35d=document.createElement("div");
_35d.id="dialog1Container";
dojo.byId("lotusContent").appendChild(_35d);
}
window.dialog1=new dijit.Dialog({id:"dialog1"},_35d);
}
return window.dialog1;
};
var displayDialog=function(_35e){
var _35f=getDialog();
_35f.setContent(_35e);
_35f.show();
var _360=dojo.byId("dialog1.button");
if(_360!=null){
_360.focus();
}
};
lconn.core.WidgetPlacement.removeWidget=function(_361,_362,_363){
if(_363==null){
var _364=null;
if(_362==true){
_364="<div class=\"lotusDialogBorder\"><form class=\"lotusDialog lotusForm\" onSubmit=\"return false;\">"+"<h1>"+dojo.i18n.getLocalization("lc_default")["deleteWidget"]+"</h1>"+"<div class=\"lotusDialogContent\">"+dojo.i18n.getLocalization("lc_default")["deleteWidgetMsg"]+"</div><!--end lotusDialogContent-->"+"<div class=\"lotusDialogFooter\">"+"\t<input id=\"dialog1.button\" value=\""+dojo.i18n.getLocalization("lc_default")["link.remove"]+"\" class=\"lotusFormButton\" type=\"button\" onclick=\"dijit.byId('dialog1').hide();lconn.core.WidgetPlacement.removeWidget('"+_361+"', "+_362+", false)\" />"+"\t<a href=\"javascript:;\" class=\"lotusAction\" onclick=\"dijit.byId('dialog1').hide();\">"+dojo.i18n.getLocalization("lc_default")["cancel"]+"</a>"+"</div>"+"</form></div>";
}else{
_364="<div class=\"lotusDialogBorder\"><form class=\"lotusDialog lotusForm\" onSubmit=\"return false;\">"+"<h1>"+dojo.i18n.getLocalization("lc_default")["hideWidget"]+"</h1>"+"<div class=\"lotusDialogContent\">"+dojo.i18n.getLocalization("lc_default")["hideWidgetMsg"]+"</div><!--end lotusDialogContent-->"+"<div class=\"lotusDialogFooter\">"+"\t<input id=\"dialog1.button\" value=\""+dojo.i18n.getLocalization("lc_default")["hide"]+"\" class=\"lotusFormButton\" type=\"button\" onclick=\"dijit.byId('dialog1').hide();lconn.core.WidgetPlacement.removeWidget('"+_361+"', "+_362+", false)\" />"+"\t<a href=\"javascript:;\" class=\"lotusAction\" onclick=\"dijit.byId('dialog1').hide();\">"+dojo.i18n.getLocalization("lc_default")["cancel"]+"</a>"+"</div>"+"</form></div>";
}
displayDialog(_364);
lconn.core.WidgetPlacement.removeWidgetInProgress=false;
}else{
if(lconn.core.WidgetPlacement.removeWidgetInProgress==false){
if(_362==true){
showRemoveWidgetDialog();
}
lconn.core.WidgetPlacement.removeWidgetInProgress=true;
var _365=WidgetPlacementConfig.applicationContext+"/removeWidget.do?resourceId="+WidgetPlacementConfig.resourceId+"&widgetInstanceId="+_361+"&removeWidgetData="+_362;
dojo.xhrPost({url:_365,handleAs:"xml",load:function(resp,_367){
lconn.core.WidgetPlacement.removeWidgetInProgress=false;
var _368=_361+"Section";
var _369=function(){
var _36a=dojo.byId(_368);
_36a.parentNode.removeChild(_36a);
var _36b=new Date().getTime();
WidgetPlacementConfig.lastMod=_36b;
var _36c=function(resp,_36e){
WidgetPlacementConfig.widgetConfigXMLDocument=resp;
if(lconn.core.applicationPalette.palette!=null){
lconn.core.applicationPalette.palette.setJsonData(lconn.core.applicationPalette.getjsonData());
lconn.core.applicationPalette.palette.populatePalette(false);
}
hideDialog();
};
dojo.xhrGet({url:WidgetPlacementConfig.layoutInfoUrl+"&lastMod="+_36b,handleAs:"xml",error:lconn.core.errorhandling.DefaultXHRErrorHandler,load:_36c});
};
var _36f=dojo.fx.wipeOut({node:_368,duration:300,onEnd:_369});
_36f.play();
try{
eval("if(_"+_361+"_iContext.iScope().onRemoveWidgetUIContent != null) _"+_361+"_iContext.iScope().onRemoveWidgetUIContent();");
removeFromNavBar(_361);
destroyWidget(_361,null,true);
}
catch(e){
console.log(e);
}
},error:lconn.core.WidgetPlacement.customAddWidgetErrorHandler});
}
}
};
var removeFromNavBar=function(_370){
var _371=dojo.byId(_370+"_navItem");
if(_371!=null){
_371.parentNode.removeChild(_371);
}
};
var showAddWidgetDialog=function(){
var _372="<div class=\"lotusDialogBorder\"><form class=\"lotusDialog lotusForm\">"+"<h1><img src=\""+WidgetPlacementConfig.applicationContext+"/nav/common/styles/images/loading.gif\" title=\""+dojo.i18n.getLocalization("lc_default")["widget_AddingWidget"]+"\"> "+dojo.i18n.getLocalization("lc_default")["widget_AddingWidget"]+"</h1>"+"</form></div>";
displayDialog(_372);
};
var showRemoveWidgetDialog=function(){
var _373="<div class=\"lotusDialogBorder\"><form class=\"lotusDialog lotusForm\">"+"<h1><img src=\""+WidgetPlacementConfig.applicationContext+"/nav/common/styles/images/loading.gif\"> "+dojo.i18n.getLocalization("lc_default")["widget_RemovingWidget"]+"</h1>"+"</form></div>";
displayDialog(_373);
};
var hideDialog=function(){
var temp=dijit.byId("dialog1");
if(temp!=null){
temp.hide();
}
};
lconn.core.WidgetPlacement.addWidgetToServerAndRender=function(_375,_376,_377){
if(_377==false||_377=="false"){
showAddWidgetDialog();
}
var _378=WidgetPlacementConfig.applicationContext+"/addWidget.do?resourceId="+WidgetPlacementConfig.resourceId+"&widgetDefId="+_375+"&uiLocation="+_376;
if(_377!=null){
_378+="&unhide="+_377;
}
dojo.xhrPost({url:_378,handleAs:"xml",load:function(resp,_37a){
lconn.core.WidgetPlacement.addWidgetInProgress=false;
var _37b=resp.documentElement.getAttribute("widgetInstanceId");
lconn.core.WidgetPlacement.getWidgetDocAndRenderWidget(_375,null,_37b,_376);
var _37c=new Date().getTime();
WidgetPlacementConfig.lastMod=_37c;
var _37d=function(resp,_37f){
WidgetPlacementConfig.widgetConfigXMLDocument=resp;
hideDialog();
if(lconn.core.applicationPalette.palette!=null){
dojo.publish(lconn.core.paletteOneUI.Palette.prototype.RECHECK_CAN_ADD_WIDGET_HANDLER_EVENT);
lconn.core.applicationPalette.palette.incCounter();
}
};
dojo.xhrGet({url:WidgetPlacementConfig.layoutInfoUrl+"&lastMod="+_37c,handleAs:"xml",sync:true,error:lconn.core.errorhandling.DefaultXHRErrorHandler,load:_37d});
},error:lconn.core.WidgetPlacement.customAddWidgetErrorHandler});
};
lconn.core.WidgetPlacement.customAddWidgetErrorHandler=function(_380){
hideDialog();
lconn.core.WidgetPlacement.removeWidgetInProgress=false;
lconn.core.WidgetPlacement.addWidgetInProgress=false;
var _381="";
if(_380!=null&&_380.responseText!=null){
_381=_380.responseText;
}else{
_381=_380;
}
var _382="<div class=\"lotusFormError lotusMessage\" >"+"<img class=\"lotusIcon\" src=\""+WidgetPlacementConfig.applicationContext+"/nav/common/styles/images/iconError.gif\" alt=\""+dojo.i18n.getLocalization("lc_default")["error.title.generic"]+"\" title=\""+dojo.i18n.getLocalization("lc_default")["error.title.generic"]+"\"/>"+"<span>"+dojo.i18n.getLocalization("lc_default")["error.title.generic"]+"  <a href=\"javascript:void(0);\" onclick=\"lconn.core.utilities.show('errorTextContainer');\" title=\""+dojo.i18n.getLocalization("lc_default")["info.feed.general.moreinfo"]+"\">"+dojo.i18n.getLocalization("lc_default")["info.feed.general.moreinfo"]+"</a><div id=\"errorTextContainer\" style=\"display:none\">"+_381+"</div></span>"+"</div>";
var temp=dojo.byId("headline");
temp.innerHTML=_382+temp.innerHTML;
};
lconn.core.WidgetPlacement.minimizeWidget=function(_384,_385,_386){
lconn.core.utilities.hide(_385+"moreActions",false,true);
var _387=dojo.byId(_385+"SubArea");
var _388=dijit.byId(_385+"_toggleAction");
if(_387.style.visibility=="hidden"){
dojo.cookie(_386+"-isMinimized","false");
var _389=_387.getAttribute("widgetloaded");
if(_389=="false"){
var temp=function(_38b,_38c){
var _38d=_38b;
lconn.core.WidgetPlacement.refresh(_385,_38d);
lconn.core.utilities.toggleVisibility(_387);
_388.setLabel(dojo.i18n.getLocalization("lc_default")["widgets_Min"]);
};
if(WidgetPlacementConfig.widgetConfigXMLDocument!=null){
temp(WidgetPlacementConfig.widgetConfigXMLDocument);
}else{
dojo.xhrGet({url:WidgetPlacementConfig.layoutInfoUrl+"&lastMod="+WidgetPlacementConfig.lastMod,error:lconn.core.errorhandling.DefaultXHRErrorHandler,handleAs:"xml",sync:true,load:temp,error:lconn.core.errorhandling.DefaultXHRErrorHandler});
}
}else{
lconn.core.utilities.toggleVisibility(_387);
_388.setLabel(dojo.i18n.getLocalization("lc_default")["widgets_Min"]);
}
}else{
dojo.cookie(_386+"-isMinimized","true");
lconn.core.utilities.toggleVisibility(_387);
_388.setLabel(dojo.i18n.getLocalization("lc_default")["widgets_Max"]);
}
};
lconn.core.WidgetPlacement.addEditTabsWithOnclickCalls=function(_38e,_38f,_390,_391,_392){
lconn.core.WidgetPlacement.addTabsWithOnclickCalls(_38e,_38f,_390,_391,_392,"edit");
};
lconn.core.WidgetPlacement.showFirstTab=function(_393,_394){
if(WidgetPlacementConfig.TabContainerDomId!=null){
var _395=document.getElementById(WidgetPlacementConfig.TabContainerDomId);
var _396=_395.childNodes;
for(var i=0;_396.length!=null&&i<_396.length;i++){
if(_396[i].id!=null&&_396[i].id.indexOf("_TabItem")!=-1&&_396[i].className!=""){
dojo.removeClass(_396[i],"lotusSelected");
}
}
}
if(WidgetPlacementConfig.TempWidgetContainerDomId!=null){
destroyWidgetContainer(WidgetPlacementConfig.TempWidgetContainerDomId);
}
if(_393!=null){
lconn.core.utilities.show(_393);
}
if(_394!=null){
dojo.addClass(document.getElementById(_394),"lotusSelected");
}
return false;
};
var activateTabbedWidget=function(_398,_399,_39a,_39b,_39c,_39d,_39e){
destroyWidgetContainer(WidgetPlacementConfig.TempWidgetContainerDomId,false);
lconn.core.WidgetPlacement.getWidgetDocAndRenderWidget(_398,_399,_39a,WidgetPlacementConfig.TempWidgetContainerDomId,_39b,"skinless",false,false,_39e);
if(_39c!=null){
lconn.core.utilities.hide(_39c,false,true);
}
var _39f=document.getElementById(_39d).getElementsByTagName("li");
for(var i=0;_39f!=null&&i<_39f.length;i++){
if(_39f[i].className!=""){
dojo.removeClass(_39f[i],"lotusSelected");
}
}
var _3a1=dojo.byId(_39a+"_TabItem");
dojo.addClass(_3a1,"lotusSelected");
};
lconn.core.WidgetPlacement.addTabsWithOnclickCalls=function(_3a2,_3a3,_3a4,_3a5,_3a6,_3a7,_3a8){
var _3a9=function(_3aa,_3ab,_3ac,_3ad,_3ae){
var _3af=null;
var _3b0=_3ab.getAttribute("defId");
_3af=getResourcedStringForItem(_3ab,"defId");
if(_3af==null||_3af=="undefined"){
_3af=_3b0;
}
var li=document.getElementById(_3ad+"_TabItem");
if(li!=null){
li.innerHTML="";
}else{
li=document.createElement("li");
li.id=_3ad+"_TabItem";
}
var _3b2=document.createElement("a");
_3b2.href="javascript:void(0);";
var _3b3=function(){
activateTabbedWidget(_3b0,_3ab,_3ad,_3a7,_3a4,_3aa,_3ae);
return false;
};
dojo.connect(_3b2,"onclick",_3b3);
var _3b4=document.createTextNode(_3af);
_3b2.appendChild(_3b4);
li.appendChild(_3b2);
document.getElementById(_3aa).appendChild(li);
if(_3a4!=null){
lconn.core.utilities.show(_3a4,false,false,true);
}
};
lconn.core.WidgetPlacement.showFirstTab(_3a4,_3a6);
for(uiLocation in lconn.core.WidgetPlacement.uiLocations){
lconn.core.utilities.hide("widget-container-"+uiLocation,false,true);
}
if(WidgetPlacementConfig.hideElements!=null){
for(var i=0;WidgetPlacementConfig.hideElements!=null&&i<WidgetPlacementConfig.hideElements.length;i++){
lconn.core.utilities.hide(WidgetPlacementConfig.hideElements[i],false,true);
}
}
if(_3a5!=null){
WidgetPlacementConfig.cancelCallBack=_3a5;
}
var data=WidgetPlacementConfig.widgetConfigXMLDocument;
var exp1=null;
exp1="/tns:widgets/tns:layout/tns:page[@pageId='"+WidgetPlacementConfig.defaultPageId+"']/tns:widgetInstance";
var _3b8=lconn.core.xpath.selectNodes(exp1,data);
if(typeof (_3b8)!="undefined"&&typeof (_3b8.length)!="undefined"){
for(var i=0;_3b8.length!=null&&i<_3b8.length;i++){
var _3b9=_3b8[i];
var _3ba=_3b9.getAttribute("defIdRef");
var exp3="/tns:widgets/tns:definitions/tns:widgetDef[@defId = '"+_3ba+"']";
var _3bc=lconn.core.xpath.selectSingleNode(exp3,data);
if(_3bc==null){
continue;
}else{
if(_3b9.getAttribute("enabled")=="false"){
continue;
}
}
var _3bd=_3bc.getAttribute("modes");
if(_3bd!=null&&_3bd.indexOf(_3a7)!=-1){
var _3be=(_3a8!=null&&_3a8[0]!=null&&_3a8[0].entryName=="tagCloudItemValue");
if((_3ba=="Forum"||_3ba=="Files")&&_3a7=="search"&&_3be){
continue;
}
var _3bf=_3b9.getAttribute("instanceId");
if(_3bf==null){
_3bf=_3ba;
}
if(WidgetPlacementConfig.firstWidget==null){
WidgetPlacementConfig.firstWidget={widgetDefId:_3ba,widgetDefinitionNode:_3bc,instanceId:_3bf};
}
_3a9(_3a2,_3bc,_3b9,_3bf,_3a8);
}
}
}
WidgetPlacementConfig.isTabbedFullPageWidgetRendering=true;
WidgetPlacementConfig.TempWidgetContainerDomId=_3a3;
WidgetPlacementConfig.TabContainerDomId=_3a2;
};
function changeHash(_3c0){
window.location.hash=_3c0;
};
lconn.core.WidgetPlacement.URLChange=function(URL){
if(WidgetPlacementConfig.debug){
console.log("lconn.core.WidgetPlacement.URLChange: value: "+URL);
}
var _3c2=URL.indexOf("#");
if(_3c2==-1||URL.substring(_3c2).length==1){
lconn.core.WidgetPlacement.reloadOverviewPage();
}else{
if(URL.indexOf("#fullpageWidgetId")!=-1&&URL.indexOf("file")==-1){
var _3c3=lconn.core.utilities.getURLParam("fullpageWidgetId");
lconn.core.WidgetPlacement.loadFullpageView(_3c3,null,false,true,true);
}
}
};
lconn.core.WidgetPlacement.init=function(){
if(lconn.core.WidgetPlacement.URLChangeCallBack==null){
lconn.core.WidgetPlacement.URLChangeCallBack=[lconn.core.WidgetPlacement.URLChange];
registerBackButtonSupport();
}
var _3c4=lconn.core.utilities.getURLParam("fullpageWidgetId");
if(_3c4==null||_3c4==""){
lconn.core.WidgetPlacement.placeWidgetMetadata();
lconn.core.WidgetPlacement.renderWidgets();
if(WidgetPlacementConfig.hideElements!=null){
for(var i=0;WidgetPlacementConfig.hideElements!=null&&i<WidgetPlacementConfig.hideElements.length;i++){
lconn.core.utilities.show(WidgetPlacementConfig.hideElements[i],false,false,true);
}
}
}else{
lconn.core.WidgetPlacement.onlyFullPageWidgetLoaded=true;
var temp=function(_3c7,_3c8){
var _3c9=_3c7;
WidgetPlacementConfig.widgetConfigXMLDocument=_3c9;
loadNavItemsOnly(true,(getUserProfileOverrideProperty("canPersonalize")=="true"),getDisplayedUserInfo());
var _3ca=false;
var _3cb="initial";
lconn.core.WidgetPlacement.loadFullpageView(_3c4,null,_3cb,_3ca);
};
dojo.xhrGet({url:WidgetPlacementConfig.layoutInfoUrl+"&lastMod="+WidgetPlacementConfig.lastMod,error:lconn.core.errorhandling.DefaultXHRErrorHandler,handleAs:"xml",sync:true,load:temp});
}
};
}
if(!dojo._hasResource["lconn.core.widgetUtils"]){
dojo._hasResource["lconn.core.widgetUtils"]=true;
dojo.provide("lconn.core.widgetUtils");
lconn.core.widgetUtils.handleRefresh=function(url,_3cd){
if(window.refreshInfoHolder==null){
window.refreshInfoHolder={};
}
var _3ce=_3cd.widgetId;
if(window.refreshInfoHolder[_3ce]==true){
url+="&preventCache="+new Date().getTime();
}
return url;
};
lconn.core.widgetUtils.addVersionNumber=function(url){
if(window.WidgetPlacementConfig!=null&&WidgetPlacementConfig.params["version"]!=null){
if(url.indexOf("?")!=-1){
url+="&ver="+WidgetPlacementConfig.params["version"];
}else{
url+="?ver="+WidgetPlacementConfig.params["version"];
}
}
return url;
};
lconn.core.widgetUtils.search=function(_3d0,_3d1,_3d2){
try{
var _3d3=_3d0.getiWidgetAttributes();
var _3d4=_3d3.getItemValue("searchKeywords");
var _3d5=_3d3.getItemValue("tagCloudItemValue");
var _3d6=_3d3.getItemValue("resourceId");
var _3d7=true;
var _3d8=_3d0.getUserProfile().getItemValue("userid");
if(_3d8!=null&&_3d8!=""){
_3d7=false;
}
var _3d9=WidgetPlacementConfig.params["searchSvcRef"];
if(window.debugWidgets!=null){
console.log("lconn.core.widgetUtils.search: searchSvcRef: "+_3d9);
}
if(_3d9!=null){
var url=_3d0.io.rewriteURI(_3d9);
if(window.debugWidgets!=null){
console.log("lconn.core.widgetUtils.search: url: "+url);
}
var _3db="?component="+_3d1;
if(_3d4){
_3db+="&query="+_3d4;
}
if(_3d5){
_3db+="&tag="+_3d5;
}
if(_3d6){
_3db+="&fieldvalue=community_id:"+_3d6;
}
var _3dc=encodeURI(_3db);
if(window.debugWidgets!=null){
console.log("lconn.core.widgetUtils.search: searchString: "+_3db);
}
if(window.debugWidgets!=null){
console.log("lconn.core.widgetUtils.search: encodedURISearchString: "+_3dc);
}
if(window.debugWidgets!=null){
console.log("lconn.core.widgetUtils.search: isPublic: "+_3d7);
}
if(window.debugWidgets!=null){
console.log("lconn.core.widgetUtils.search: resultContainerDomNode: "+_3d2);
}
var _3dd=new lconn.search.searchResults();
_3dd.setup(url,_3dc,_3d7,_3d2,null,null,null);
_3dd.updatePage();
}
}
catch(exception){
console.log("exception occurred while calling lconn.search.searchResults.setup()");
console.log(exception);
lconn.core.errorhandling.DefaultErrorHandler("lconn.search.searchResults.setup",exception,{htmlContainerElemId:_3d2});
}
};
}
if(!dojo._hasResource["lconn.core.MenuUtility"]){
dojo._hasResource["lconn.core.MenuUtility"]=true;
dojo.provide("lconn.core.MenuUtility");
dojo.declare("lconn.core.MenuUtility",null,{openedBy:null,openMenu:function(evt,_3df){
var menu=dijit.byId(_3df);
evt=dojo.fixEvent(evt);
var _3e1=evt.target;
function closeAndRestoreFocus(){
try{
dijit.focus(_3e1);
}
catch(exception){
}
dijit.popup.close(menu);
};
dijit.popup.open({popup:menu,around:evt.target,orient:dojo._isBodyLtr()?{"BL":"TL","BR":"TR","TL":"BL","TR":"BR"}:{"BR":"TR","BL":"TL","TR":"BR","TL":"BL"},onExecute:closeAndRestoreFocus,onCancel:closeAndRestoreFocus});
menu.focus();
dojo.connect(menu,"_onBlur",function(){
dijit.popup.close(menu);
});
dojo.stopEvent(evt);
},openMenuA11y:function(evt,_3e3){
if(evt.keyCode==dojo.keys.ENTER){
this.openMenu(evt,_3e3);
}
}});
menuUtility=new lconn.core.MenuUtility();
lconn.core.MenuUtility.open=function(_3e4,e){
menuUtility.openMenu(e,_3e4);
};
}
if(!dojo._hasResource["lconn.core.LanguageSelector"]){
dojo._hasResource["lconn.core.LanguageSelector"]=true;
dojo.provide("lconn.core.LanguageSelector");
dojo.declare("lconn.core.LanguageSelector",null,{_jsonString:null,_selectorNode:null,_menu:null,_cookieProperties:null,COOKIE_NAME:null,constructor:function(_3e6,_3e7,_3e8,_3e9){
this._selectorNode=_3e6;
this._jsonString=_3e7;
this._cookieProperties=_3e9;
this.COOKIE_NAME=_3e8;
this._setSelectorLabel();
dojo.connect(this._selectorNode,"onclick",dojo.hitch(this,"_openMenu"));
},_openMenu:function(evt){
try{
this._buildLanguageMenu();
menuUtility.openMenu(evt,this._menu.id);
dojo.stopEvent(evt);
}
catch(e){
console.log(e);
}
},_setSelectorLabel:function(){
var _3eb=dojo.cookie(this.COOKIE_NAME);
var res=new lconn.core.Res();
res.loadDefaultBundle();
this.strBundle=res.resBundle;
if(_3eb!=null){
for(var key in this._jsonString){
if(this._isCodeEqual(key,_3eb)){
this._selectorNode.innerHTML=this._jsonString[key]+" &#9660;";
break;
}
}
if(!this._isCodeEqual(key,_3eb)){
this._selectorNode.innerHTML=this.strBundle.rs_customLangaugeLinkLabel+" &#9660;";
}
}else{
this._selectorNode.innerHTML=this.strBundle.rs_customLangaugeLinkLabel+" &#9660;";
}
},_buildLanguageMenu:function(){
if(this._menu==null){
this._menu=new dijit.Menu();
for(var key in this._jsonString){
this._menu.addChild(this._buildMenuItem(this._jsonString[key],key));
}
var res=new lconn.core.Res();
res.loadDefaultBundle();
this.strBundle=res.resBundle;
//this._menu.addChild(this._buildMenuItem(this.strBundle.rs_browser_setting,"BD"));
this._menu.domNode.style.display="none";
dojo.body().appendChild(this._menu.domNode);
var that=this;
dojo.connect(this._menu,"onItemClick",function(item){
if((item!=null)&&(typeof item.language!="undefined")){
dojo.cookie(that.COOKIE_NAME,item.language,that._cookieProperties);
var _3f2=null;
var _3f3=document.getElementById("REFRESH_URL");
if(_3f3!=null){
_3f2=_3f3.getAttribute("href");
}else{
_3f2=window.location.href;
}
if(_3f2.indexOf("lang=")>0){
var _3f4=/([\&\?])(lang=)([^\&\#]*)/g;
var _3f5=null;
if(item.language&&item.language!=="BD"){
_3f5=_3f2.replace(_3f4,function(){
var _3f6=arguments[1]+arguments[2]+item.language;
return _3f6;
});
}else{
_3f5=_3f2.replace(_3f4,function(){
var _3f7=arguments[1];
return _3f7;
});
}
window.location=_3f5;
if(_3f5.indexOf("#")!==-1){
window.location.reload(false);
}
}else{
window.location=_3f2;
if(_3f2.indexOf("#")!==-1){
window.location.reload(false);
}
}
}
});
}
},_buildMenuItem:function(_3f8,_3f9){
var item=new dijit.MenuItem({label:_3f8});
item.language=_3f9;
return item;
},_isCodeEqual:function(_3fb,_3fc){
var str1=_3fb.toLowerCase().replace(/-/,"_");
var str2=_3fc.toLowerCase().replace(/-/,"_");
return str1===str2;
}});
}
if(!dojo._hasResource["lconn.core.mumOverride"]){
dojo._hasResource["lconn.core.mumOverride"]=true;
dojo.provide("lconn.core.mumOverride");
lconn.core.mumOverride.saveAttributes=function(_3ff,_400,_401){
var _402=_3ff.id;
if(_3ff.iScope.iContext.getUserProfile().getItemValue("canPersonalize")=="true"){
var _403="";
var _404=[];
var exp4="/tns:widgets/tns:layout/tns:page/tns:widgetInstance[@instanceId = '"+_402+"']";
var _406=lconn.core.xpath.selectSingleNode(exp4,WidgetPlacementConfig.widgetConfigXMLDocument);
var _407=null;
if(_406!=null){
_407=_406.getAttribute("defIdRef");
}else{
_407=instanceId;
}
var exp5="/tns:widgets/tns:definitions/tns:widgetDef[@defId = '"+_407+"']/tns:itemSet/tns:item";
var _409=lconn.core.xpath.selectNodes(exp5,WidgetPlacementConfig.widgetConfigXMLDocument);
for(var i=0;_409.length!=null&&i<_409.length;i++){
var _40b=_409[i].getAttribute("value");
_40b=lconn.core.i18nOverrider.replaceParams(_40b,WidgetPlacementConfig.params);
_404.push({entryName:_409[i].getAttribute("name"),entryValue:_40b});
}
for(name in _400){
var _40c=_400[name];
var _40d=true;
for(var i=0;_404.length!=null&&i<_404.length;i++){
var _40e=_404[i];
if((name==_40e.entryName&&_40c.value==_40e.entryValue)||(name=="resourceId"||name=="resourceType")){
_40d=false;
break;
}
}
if(_40d){
_403+=name+"=_="+_40c.value+",_,";
}
}
if(WidgetPlacementConfig.debug){
console.log("lconn.core.mumOverride.saveAttributes: putContent: "+_403);
}
var url=WidgetPlacementConfig.applicationContext+"/saveWidgetPreferences.do?resourceId="+WidgetPlacementConfig.resourceId;
url+="&widgetInstanceId="+_402;
dojo.rawXhrPut({url:url,putData:_403,load:_401,error:lconn.core.errorhandling.DefaultXHRErrorHandler});
var _410=new Date().getTime();
WidgetPlacementConfig.lastMod=_410;
}else{
throw new Error("user cannot edit preferences");
}
};
com.ibm.mm.enabler.iw.InternalPersistentAttributesToPreferenceModelAdapter.prototype.save=function(_411){
if(this.serverless){
this._saveMicroformat();
}else{
return null;
}
this.reload();
var _412=null;
if(_411){
_412=function(res,_414){
if(_411){
_411();
}
};
}
lconn.core.mumOverride.saveAttributes(this.widget,this.microformatItems,_412);
return (this);
};
com.ibm.mm.enabler.iw.iContextImpl.prototype.getUserProfile=function(){
var _415=new com.ibm.mm.enabler.iw.ManagedItemSetImpl();
if(window.widgetUserInfo!=null){
_415.setUserInfo(widgetUserInfo);
}else{
if(WidgetPlacementConfig.userInfoXML==null){
var _416=function(res,_418){
WidgetPlacementConfig.userInfoXML=res;
_415.setXmlDoc(res);
};
var _419={url:WidgetPlacementConfig.userInfoUrl,handleAs:"xml",load:_416,sync:true,error:lconn.core.errorhandling.DefaultXHRErrorHandler};
dojo.xhrGet(_419);
}else{
_415.setXmlDoc(WidgetPlacementConfig.userInfoXML);
}
}
return _415;
};
function getUserProfileOverrideProperty(_41a){
if(WidgetPlacementConfig.userLoggedIn==false||WidgetPlacementConfig.userLoggedIn==null){
return null;
}else{
var _41b=null;
if(window.widgetUserInfo!=null){
var temp=widgetUserInfo[_41a];
if(temp==undefined||temp=="undefined"||temp==null){
_41b=null;
}else{
_41b=temp;
}
}else{
if(WidgetPlacementConfig.userInfoXML==null){
var _41d=function(res,_41f){
WidgetPlacementConfig.userInfoXML=res;
var temp=res.documentElement.getAttribute(_41a);
if(temp==undefined||temp=="undefined"||temp==null){
_41b=null;
}else{
_41b=temp;
}
};
var _421={url:WidgetPlacementConfig.userInfoUrl,handleAs:"xml",load:_41d,sync:true,error:lconn.core.errorhandling.DefaultXHRErrorHandler};
dojo.xhrGet(_421);
}else{
_41b=WidgetPlacementConfig.userInfoXML.documentElement.getAttribute(_41a);
}
}
return _41b;
}
};
dojo.declare("com.ibm.mm.enabler.iw.ManagedItemSetImpl",com.ibm.mm.enabler.iw.ManagedItemSet,{constructor:function(){
},getItemValue:function(_422){
if(this.widgetUserInfo!=null){
return this.widgetUserInfo[_422];
}else{
if(this.xmlDoc!=null){
return this.xmlDoc.documentElement.getAttribute(_422);
}else{
return null;
}
}
},setXmlDoc:function(_423){
this.xmlDoc=_423;
},setUserInfo:function(_424){
this.widgetUserInfo=_424;
}});
com.ibm.mm.enabler.iWidgetWrapperDefaultImpl.prototype.handleEvent=function(_425,_426){
if(typeof _425=="undefined"||_425==null){
return false;
}
if(_425==com.ibm.mm.enabler.iw.iEvents.Constants.onModeChanged){
if(WidgetPlacementConfig.isTabbedFullPageWidgetRendering){
handleModeExit();
}else{
if(_426.payload!=null&&_426.payload.indexOf("fullpage")!=-1){
changeHash("fullpageWidgetId="+this.id);
}else{
return this._handleModeChange(_426);
}
}
}
if(_425=="onNewWire"){
return this._handleNewWire(_426);
}
if(_425=="onRemoveWire"){
return this._handleRemoveWire(_426);
}
return this._handleEventInternal(_425,_426);
};
com.ibm.mm.enabler.iWidgetWrapperDefaultImpl.prototype._handleInlineMessage=function(type,_428,_429){
var _42a=[];
com.ibm.mm.enabler.iw.utils.findElementByAttribute("class",this.ns+"content",this.rootElement,_42a,false);
var _42b=_42a[0];
if(_42b!=null){
_42b.innerHTML="";
_42b.style.padding="5px";
lconn.core.errorhandling.DefaultErrorHandler(_428,_429,{htmlContainerElemId:_42b});
}
};
var handleModeExit=function(_42c){
WidgetPlacementConfig.handleModeExitExe=true;
if(WidgetPlacementConfig.cancelCallBack!=null&&_42c!=true){
WidgetPlacementConfig.cancelCallBack();
}
if(WidgetPlacementConfig.hideElements!=null){
for(var i=0;WidgetPlacementConfig.hideElements!=null&&i<WidgetPlacementConfig.hideElements.length;i++){
lconn.core.utilities.show(WidgetPlacementConfig.hideElements[i],false,false,true);
}
}
if(WidgetPlacementConfig.TabContainerDomId!=null){
var _42e=document.getElementById(WidgetPlacementConfig.TabContainerDomId);
var _42f=_42e.childNodes;
var temp=new Array;
for(var i=0;_42f.length!=null&&i<_42f.length;i++){
var _431=_42f[i];
var _432=_431.id;
if(_432!=null&&_432.indexOf("_TabItem")!=-1){
temp.push(_432);
}
}
for(var i=0;temp.length!=null&&i<temp.length;i++){
var _432=temp[i];
var _431=dojo.byId(_432);
_431.parentNode.removeChild(_431);
}
}
if(WidgetPlacementConfig.TempWidgetContainerDomId!=null){
destroyWidgetContainer(WidgetPlacementConfig.TempWidgetContainerDomId);
}
for(var i=0;lconn.core.WidgetPlacement.loadOrder!=null&&i<lconn.core.WidgetPlacement.loadOrder.length;i++){
var _433=lconn.core.WidgetPlacement.loadOrder[i];
lconn.core.WidgetPlacement.refresh(_433.instanceId);
}
for(uiLocation in lconn.core.WidgetPlacement.uiLocations){
lconn.core.utilities.show("widget-container-"+uiLocation,false,false,true);
}
WidgetPlacementConfig.handleModeExitExe=null;
WidgetPlacementConfig.firstWidget=null;
WidgetPlacementConfig.isFullPageWidgetRendering=null;
WidgetPlacementConfig.TempWidgetContainerDomId=null;
WidgetPlacementConfig.TabContainerDomId=null;
WidgetPlacementConfig.isTabbedFullPageWidgetRendering=null;
highlightOverviewLink();
};
com.ibm.mm.enabler.iw.services.widgetLoadService.prototype.getWidgetXML=function(_434,_435){
com.ibm.mm.enabler.debug.entry("widgetLoadService.getWidgetXML","widgetUrl:"+_434+" widgetId:"+_435);
this.widgetId=_435;
var me=this;
var _437=_434;
if(_437.indexOf("http")===0){
_437=com.ibm.mm.enabler.utilities.rewriteURL(_437);
}
var args={url:_437,load:function(data,_43a){
me.handleLoad(data,_43a.xhr);
},error:function(data,_43c){
com.ibm.mm.enabler.debug.error("widgetLoadService.getWidgetXML","Error widgetLoadService.getWidgetXML error loading!"+data);
var args=[];
args.push("error");
var _43e=dojo.i18n.getLocalization("com.ibm.mm.enabler","iwMessages");
args.push(dojo.string.substitute(_43e.E_IWIDGETDEF_NOTAVAILABLE_1,[_437]));
args.push(data.message);
dojo.publish("/enabler/inlineMessage/"+me.widgetId,args);
},handleAs:"text",expectedContentType:"xml"};
dojo.xhrGet(args);
};
}
if(!dojo._hasResource["lconn.core.AdditionalInfo"]){
dojo._hasResource["lconn.core.AdditionalInfo"]=true;
dojo.provide("lconn.core.AdditionalInfo");
lconn.core.AdditionalInfo=function(){
this.onLoad=function(){
var _43f=this.iContext.getiWidgetAttributes();
this.resourceId=_43f.getItemValue("resourceId");
var _440=_43f.getItemValue("extensionIds");
var _441=WidgetPlacementConfig.applicationContext+"/atom2/extension?resourceId="+this.resourceId+"&extensionIds="+_440;
if(_440!=null){
var _442={xmlDocUrl:_441,xsltUrl:WidgetPlacementConfig.applicationContext+"/widgets/widgets/additionalInfo/additionalInfo.xsl",htmlContainerElemId:this.iContext.getElementById("additionalInfowidgetContainer"),aXslParams:null,dojoErrorHandler:lconn.core.errorhandling.DefaultXHRErrorHandler,exceptionHandler:lconn.core.errorhandling.DefaultErrorHandler};
lconn.core.xslt.transformAndRender(_442);
}else{
this.iContext.getElementById("additionalInfowidgetContainer").innerHTML="No information has been added.<br/>";
}
this.iContext.getElementById("lotusFeeds").href=_441;
};
this.addValue=function(_443){
var form=findParentForm(_443);
var _445=form.newItem.value;
addSelectionControlVal(form.listOfItems,_445,_445);
form.newItem.value=null;
};
this.removeAll=function(_446){
var _447=this.iContext.getiWidgetAttributes();
this.resourceId=_447.getItemValue("resourceId");
var _448=_447.getItemValue("extensionIds");
var URL=WidgetPlacementConfig.applicationContext+"/extension.do?resourceId="+this.resourceId+"&extensionIds="+_448;
var _44a=this;
dojo.xhrDelete({url:URL,handleAs:"text",load:function(data){
var _44c=_44a.iContext.getiWidgetAttributes();
_44c.removeItem("extensionIds");
_44c.save();
_44a.closeNewItemsUI(_446);
_44a.onLoad();
}});
};
this.showListOfItem=function(){
lconn.core.utilities.hide(this.iContext.getElementById("textItemUI"));
lconn.core.utilities.show(this.iContext.getElementById("listOfItemsUI"));
};
this.showTextBox=function(){
lconn.core.utilities.hide(this.iContext.getElementById("listOfItemsUI"));
lconn.core.utilities.show(this.iContext.getElementById("textItemUI"));
};
this.clearAllFields=function(_44d){
var form=findParentForm(_44d);
form.label.value=null;
form.textContent.value=null;
form.newItem.value=null;
removeAllSelectionControlOption(form.listOfItems);
};
this.showNewItemsUI=function(_44f){
lconn.core.utilities.show(this.iContext.getElementById("newItemsUI"));
};
this.closeNewItemsUI=function(_450){
this.clearAllFields(_450);
this.switchToMode(this.iContext.constants.mode.VIEW);
};
this.switchToMode=function(mode){
this.iContext.iEvents.fireEvent("onModeChanged","","{'newMode': '"+mode+"'}");
};
this.saveAttribute=function(_452){
var form=findParentForm(_452);
var _454=new Date();
var _455="attrId."+_454.getTime();
var _456=this.iContext.getUserProfile().getItemValue("userid");
var _457=getRadioGroupCheckedValue(form,"datatype");
var _458="<?xml version=\"1.0\" ?>";
_458+="<entry xmlns=\"http://www.w3.org/2005/Atom\" xmlns:atom=\"http://www.w3.org/2005/Atom\" xmlns:snx=\"http://www.ibm.com/prod/xmlns/snx/extensions\">";
_458+="<category scheme=\"http://www.ibm.com/prod/xmlns/snx/extensions/type\" term=\""+_457+"\"></category>";
_458+="<id>"+_455+"</id>";
_458+="<title>"+form.label.value+"</title>";
_458+="<contributor><snx:userid>"+_456+"</snx:userid></contributor>";
if(_457=="simple"){
_458+="<content type=\"text\">";
_458+=form.textContent.value;
_458+="</content>";
}else{
if(_457=="multivalue"){
var _459=getAllSelectionControlValues(form.listOfItems);
for(var i=0;i<_459.length;i++){
_458+="<snx:field position=\""+(i+1)+"\" type=\"text\" value=\""+_459[i]+"\"></snx:field>";
}
}
}
_458+="</entry>";
var _45b=new Object();
_45b["Content-Type"]="application/atom+xml";
var _45c=WidgetPlacementConfig.applicationContext+"/extension.do?resourceId="+this.resourceId;
var _45d=this;
var _45e=function(resp,_460){
var _461=_45d.iContext.getiWidgetAttributes();
var _462=_461.getItemValue("extensionIds");
if(_462==null){
_462=_455+",";
}else{
_462+=_455+",";
}
_461.setItemValue("extensionIds",_462);
_461.save();
_45d.closeNewItemsUI(_452);
_45d.onLoad();
};
dojo.rawXhrPost({url:_45c,postData:_458,load:_45e,headers:_45b});
};
};
}
if(!dojo._hasResource["lconn.core.paletteOneUI.PaletteList"]){
dojo._hasResource["lconn.core.paletteOneUI.PaletteList"]=true;
dojo.provide("lconn.core.paletteOneUI.PaletteList");
dojo.declare("lconn.core.paletteOneUI.PaletteList",[dijit._Widget,dijit._Templated,dijit._Container],{CATEGORY_SELECTED_EVENT:"/lconn/core/palette/categorySelected",WIDGET_CATEGORY:"widgetCategory",store:null,query:null,itemListNode:null,_currentSelectedNode:null,_lastSelectedCategoryId:null,templateString:"<div class=\"lotusMenu\">\r\n    <ul dojoAttachPoint=\"itemListNode\">\r\n    </ul>\r\n</div>\r\n<!--end menu-->\r\n",postCreate:function(){
this.inherited("postCreate",arguments);
this._fetchCategoryList();
},setStoreQuery:function(_463,_464){
this.story=_463;
this.query=_464;
this._fetchCategoryList();
},_fetchCategoryList:function(){
var that=this;
if((this.store!=null)&&(this.query!=null)){
var _466={query:that.query,onComplete:dojo.hitch(that,"_onFetchComplete")};
this.store.fetch(_466);
}
},_onFetchComplete:function(_467,_468){
var _469=true;
dojo.forEach(_467,function(item){
var _46b=this._buildItemMarkup(item,_469);
_469=false;
this.itemListNode.appendChild(_46b);
},this);
if(_467.length>1){
console.log(this._parent);
console.log(_467.length);
this._parent.showShelf();
}else{
this._parent.hideShelf();
}
},setParent:function(_46c){
this._parent=_46c;
},_buildItemMarkup:function(item,_46e){
var _46f=dojo.doc.createElement("li");
var _470=dojo.doc.createElement("a");
dojo.attr(_470,"href","javascript:;");
dojo.attr(_470,"categoryId",item.id);
_470.innerHTML=item.name[0];
dojo.connect(_470,"onclick",dojo.hitch(this,"_onClickCategoryItem",item));
_46f.appendChild(_470);
if(_46e==true){
this._selectCategoryItem(item,_46f);
}
return _46f;
},_onClickCategoryItem:function(_471,evt){
this._selectCategoryItem(_471,evt.currentTarget.parentNode);
dojo.stopEvent(evt);
},_selectCategoryItem:function(_473,node){
if(this._currentSelectedNode!=null){
dojo.removeClass(this._currentSelectedNode,"lotusSelected");
}
dojo.addClass(node,"lotusSelected");
this._currentSelectedNode=node;
this._lastSelectedCategoryId=_473.id[0];
dojo.publish(this.CATEGORY_SELECTED_EVENT,[_473]);
},getLastCategoryId:function(){
return this._lastSelectedCategoryId;
}});
}
if(!dojo._hasResource["dojo.data.ItemFileWriteStore"]){
dojo._hasResource["dojo.data.ItemFileWriteStore"]=true;
dojo.provide("dojo.data.ItemFileWriteStore");
dojo.declare("dojo.data.ItemFileWriteStore",dojo.data.ItemFileReadStore,{constructor:function(_475){
this._features["dojo.data.api.Write"]=true;
this._features["dojo.data.api.Notification"]=true;
this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};
if(!this._datatypeMap["Date"].serialize){
this._datatypeMap["Date"].serialize=function(obj){
return dojo.date.stamp.toISOString(obj,{zulu:true});
};
}
if(_475&&(_475.referenceIntegrity===false)){
this.referenceIntegrity=false;
}
this._saveInProgress=false;
},referenceIntegrity:true,_assert:function(_477){
if(!_477){
throw new Error("assertion failed in ItemFileWriteStore");
}
},_getIdentifierAttribute:function(){
var _478=this.getFeatures()["dojo.data.api.Identity"];
return _478;
},newItem:function(_479,_47a){
this._assert(!this._saveInProgress);
if(!this._loadFinished){
this._forceLoad();
}
if(typeof _479!="object"&&typeof _479!="undefined"){
throw new Error("newItem() was passed something other than an object");
}
var _47b=null;
var _47c=this._getIdentifierAttribute();
if(_47c===Number){
_47b=this._arrayOfAllItems.length;
}else{
_47b=_479[_47c];
if(typeof _47b==="undefined"){
throw new Error("newItem() was not passed an identity for the new item");
}
if(dojo.isArray(_47b)){
throw new Error("newItem() was not passed an single-valued identity");
}
}
if(this._itemsByIdentity){
this._assert(typeof this._itemsByIdentity[_47b]==="undefined");
}
this._assert(typeof this._pending._newItems[_47b]==="undefined");
this._assert(typeof this._pending._deletedItems[_47b]==="undefined");
var _47d={};
_47d[this._storeRefPropName]=this;
_47d[this._itemNumPropName]=this._arrayOfAllItems.length;
if(this._itemsByIdentity){
this._itemsByIdentity[_47b]=_47d;
_47d[_47c]=[_47b];
}
this._arrayOfAllItems.push(_47d);
var _47e=null;
if(_47a&&_47a.parent&&_47a.attribute){
_47e={item:_47a.parent,attribute:_47a.attribute,oldValue:undefined};
var _47f=this.getValues(_47a.parent,_47a.attribute);
if(_47f&&_47f.length>0){
var _480=_47f.slice(0,_47f.length);
if(_47f.length===1){
_47e.oldValue=_47f[0];
}else{
_47e.oldValue=_47f.slice(0,_47f.length);
}
_480.push(_47d);
this._setValueOrValues(_47a.parent,_47a.attribute,_480,false);
_47e.newValue=this.getValues(_47a.parent,_47a.attribute);
}else{
this._setValueOrValues(_47a.parent,_47a.attribute,_47d,false);
_47e.newValue=_47d;
}
}else{
_47d[this._rootItemPropName]=true;
this._arrayOfTopLevelItems.push(_47d);
}
this._pending._newItems[_47b]=_47d;
for(var key in _479){
if(key===this._storeRefPropName||key===this._itemNumPropName){
throw new Error("encountered bug in ItemFileWriteStore.newItem");
}
var _482=_479[key];
if(!dojo.isArray(_482)){
_482=[_482];
}
_47d[key]=_482;
if(this.referenceIntegrity){
for(var i=0;i<_482.length;i++){
var val=_482[i];
if(this.isItem(val)){
this._addReferenceToMap(val,_47d,key);
}
}
}
}
this.onNew(_47d,_47e);
return _47d;
},_removeArrayElement:function(_485,_486){
var _487=dojo.indexOf(_485,_486);
if(_487!=-1){
_485.splice(_487,1);
return true;
}
return false;
},deleteItem:function(item){
this._assert(!this._saveInProgress);
this._assertIsItem(item);
var _489=item[this._itemNumPropName];
var _48a=this.getIdentity(item);
if(this.referenceIntegrity){
var _48b=this.getAttributes(item);
if(item[this._reverseRefMap]){
item["backup_"+this._reverseRefMap]=dojo.clone(item[this._reverseRefMap]);
}
dojo.forEach(_48b,function(_48c){
dojo.forEach(this.getValues(item,_48c),function(_48d){
if(this.isItem(_48d)){
if(!item["backupRefs_"+this._reverseRefMap]){
item["backupRefs_"+this._reverseRefMap]=[];
}
item["backupRefs_"+this._reverseRefMap].push({id:this.getIdentity(_48d),attr:_48c});
this._removeReferenceFromMap(_48d,item,_48c);
}
},this);
},this);
var _48e=item[this._reverseRefMap];
if(_48e){
for(var _48f in _48e){
var _490=null;
if(this._itemsByIdentity){
_490=this._itemsByIdentity[_48f];
}else{
_490=this._arrayOfAllItems[_48f];
}
if(_490){
for(var _491 in _48e[_48f]){
var _492=this.getValues(_490,_491)||[];
var _493=dojo.filter(_492,function(_494){
return !(this.isItem(_494)&&this.getIdentity(_494)==_48a);
},this);
this._removeReferenceFromMap(item,_490,_491);
if(_493.length<_492.length){
this._setValueOrValues(_490,_491,_493,true);
}
}
}
}
}
}
this._arrayOfAllItems[_489]=null;
item[this._storeRefPropName]=null;
if(this._itemsByIdentity){
delete this._itemsByIdentity[_48a];
}
this._pending._deletedItems[_48a]=item;
if(item[this._rootItemPropName]){
this._removeArrayElement(this._arrayOfTopLevelItems,item);
}
this.onDelete(item);
return true;
},setValue:function(item,_496,_497){
return this._setValueOrValues(item,_496,_497,true);
},setValues:function(item,_499,_49a){
return this._setValueOrValues(item,_499,_49a,true);
},unsetAttribute:function(item,_49c){
return this._setValueOrValues(item,_49c,[],true);
},_setValueOrValues:function(item,_49e,_49f,_4a0){
this._assert(!this._saveInProgress);
this._assertIsItem(item);
this._assert(dojo.isString(_49e));
this._assert(typeof _49f!=="undefined");
var _4a1=this._getIdentifierAttribute();
if(_49e==_4a1){
throw new Error("ItemFileWriteStore does not have support for changing the value of an item's identifier.");
}
var _4a2=this._getValueOrValues(item,_49e);
var _4a3=this.getIdentity(item);
if(!this._pending._modifiedItems[_4a3]){
var _4a4={};
for(var key in item){
if((key===this._storeRefPropName)||(key===this._itemNumPropName)||(key===this._rootItemPropName)){
_4a4[key]=item[key];
}else{
if(key===this._reverseRefMap){
_4a4[key]=dojo.clone(item[key]);
}else{
_4a4[key]=item[key].slice(0,item[key].length);
}
}
}
this._pending._modifiedItems[_4a3]=_4a4;
}
var _4a6=false;
if(dojo.isArray(_49f)&&_49f.length===0){
_4a6=delete item[_49e];
_49f=undefined;
if(this.referenceIntegrity&&_4a2){
var _4a7=_4a2;
if(!dojo.isArray(_4a7)){
_4a7=[_4a7];
}
for(var i=0;i<_4a7.length;i++){
var _4a9=_4a7[i];
if(this.isItem(_4a9)){
this._removeReferenceFromMap(_4a9,item,_49e);
}
}
}
}else{
var _4aa;
if(dojo.isArray(_49f)){
var _4ab=_49f;
_4aa=_49f.slice(0,_49f.length);
}else{
_4aa=[_49f];
}
if(this.referenceIntegrity){
if(_4a2){
var _4a7=_4a2;
if(!dojo.isArray(_4a7)){
_4a7=[_4a7];
}
var map={};
dojo.forEach(_4a7,function(_4ad){
if(this.isItem(_4ad)){
var id=this.getIdentity(_4ad);
map[id.toString()]=true;
}
},this);
dojo.forEach(_4aa,function(_4af){
if(this.isItem(_4af)){
var id=this.getIdentity(_4af);
if(map[id.toString()]){
delete map[id.toString()];
}else{
this._addReferenceToMap(_4af,item,_49e);
}
}
},this);
for(var rId in map){
var _4b2;
if(this._itemsByIdentity){
_4b2=this._itemsByIdentity[rId];
}else{
_4b2=this._arrayOfAllItems[rId];
}
this._removeReferenceFromMap(_4b2,item,_49e);
}
}else{
for(var i=0;i<_4aa.length;i++){
var _4a9=_4aa[i];
if(this.isItem(_4a9)){
this._addReferenceToMap(_4a9,item,_49e);
}
}
}
}
item[_49e]=_4aa;
_4a6=true;
}
if(_4a0){
this.onSet(item,_49e,_4a2,_49f);
}
return _4a6;
},_addReferenceToMap:function(_4b3,_4b4,_4b5){
var _4b6=this.getIdentity(_4b4);
var _4b7=_4b3[this._reverseRefMap];
if(!_4b7){
_4b7=_4b3[this._reverseRefMap]={};
}
var _4b8=_4b7[_4b6];
if(!_4b8){
_4b8=_4b7[_4b6]={};
}
_4b8[_4b5]=true;
},_removeReferenceFromMap:function(_4b9,_4ba,_4bb){
var _4bc=this.getIdentity(_4ba);
var _4bd=_4b9[this._reverseRefMap];
var _4be;
if(_4bd){
for(_4be in _4bd){
if(_4be==_4bc){
delete _4bd[_4be][_4bb];
if(this._isEmpty(_4bd[_4be])){
delete _4bd[_4be];
}
}
}
if(this._isEmpty(_4bd)){
delete _4b9[this._reverseRefMap];
}
}
},_dumpReferenceMap:function(){
var i;
for(i=0;i<this._arrayOfAllItems.length;i++){
var item=this._arrayOfAllItems[i];
if(item&&item[this._reverseRefMap]){
console.log("Item: ["+this.getIdentity(item)+"] is referenced by: "+dojo.toJson(item[this._reverseRefMap]));
}
}
},_getValueOrValues:function(item,_4c2){
var _4c3=undefined;
if(this.hasAttribute(item,_4c2)){
var _4c4=this.getValues(item,_4c2);
if(_4c4.length==1){
_4c3=_4c4[0];
}else{
_4c3=_4c4;
}
}
return _4c3;
},_flatten:function(_4c5){
if(this.isItem(_4c5)){
var item=_4c5;
var _4c7=this.getIdentity(item);
var _4c8={_reference:_4c7};
return _4c8;
}else{
if(typeof _4c5==="object"){
for(var type in this._datatypeMap){
var _4ca=this._datatypeMap[type];
if(dojo.isObject(_4ca)&&!dojo.isFunction(_4ca)){
if(_4c5 instanceof _4ca.type){
if(!_4ca.serialize){
throw new Error("ItemFileWriteStore:  No serializer defined for type mapping: ["+type+"]");
}
return {_type:type,_value:_4ca.serialize(_4c5)};
}
}else{
if(_4c5 instanceof _4ca){
return {_type:type,_value:_4c5.toString()};
}
}
}
}
return _4c5;
}
},_getNewFileContentString:function(){
var _4cb={};
var _4cc=this._getIdentifierAttribute();
if(_4cc!==Number){
_4cb.identifier=_4cc;
}
if(this._labelAttr){
_4cb.label=this._labelAttr;
}
_4cb.items=[];
for(var i=0;i<this._arrayOfAllItems.length;++i){
var item=this._arrayOfAllItems[i];
if(item!==null){
var _4cf={};
for(var key in item){
if(key!==this._storeRefPropName&&key!==this._itemNumPropName){
var _4d1=key;
var _4d2=this.getValues(item,_4d1);
if(_4d2.length==1){
_4cf[_4d1]=this._flatten(_4d2[0]);
}else{
var _4d3=[];
for(var j=0;j<_4d2.length;++j){
_4d3.push(this._flatten(_4d2[j]));
_4cf[_4d1]=_4d3;
}
}
}
}
_4cb.items.push(_4cf);
}
}
var _4d5=true;
return dojo.toJson(_4cb,_4d5);
},_isEmpty:function(_4d6){
var _4d7=true;
if(dojo.isObject(_4d6)){
var i;
for(i in _4d6){
_4d7=false;
break;
}
}else{
if(dojo.isArray(_4d6)){
if(_4d6.length>0){
_4d7=false;
}
}
}
return _4d7;
},save:function(_4d9){
this._assert(!this._saveInProgress);
this._saveInProgress=true;
var self=this;
var _4db=function(){
self._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};
self._saveInProgress=false;
if(_4d9&&_4d9.onComplete){
var _4dc=_4d9.scope||dojo.global;
_4d9.onComplete.call(_4dc);
}
};
var _4dd=function(err){
self._saveInProgress=false;
if(_4d9&&_4d9.onError){
var _4df=_4d9.scope||dojo.global;
_4d9.onError.call(_4df,err);
}
};
if(this._saveEverything){
var _4e0=this._getNewFileContentString();
this._saveEverything(_4db,_4dd,_4e0);
}
if(this._saveCustom){
this._saveCustom(_4db,_4dd);
}
if(!this._saveEverything&&!this._saveCustom){
_4db();
}
},revert:function(){
this._assert(!this._saveInProgress);
var _4e1;
for(_4e1 in this._pending._modifiedItems){
var _4e2=this._pending._modifiedItems[_4e1];
var _4e3=null;
if(this._itemsByIdentity){
_4e3=this._itemsByIdentity[_4e1];
}else{
_4e3=this._arrayOfAllItems[_4e1];
}
_4e2[this._storeRefPropName]=this;
_4e3[this._storeRefPropName]=null;
var _4e4=_4e3[this._itemNumPropName];
this._arrayOfAllItems[_4e4]=_4e2;
if(_4e3[this._rootItemPropName]){
var i;
for(i=0;i<this._arrayOfTopLevelItems.length;i++){
var _4e6=this._arrayOfTopLevelItems[i];
if(this.getIdentity(_4e6)==_4e1){
this._arrayOfTopLevelItems[i]=_4e2;
break;
}
}
}
if(this._itemsByIdentity){
this._itemsByIdentity[_4e1]=_4e2;
}
}
var _4e7;
for(_4e1 in this._pending._deletedItems){
_4e7=this._pending._deletedItems[_4e1];
_4e7[this._storeRefPropName]=this;
var _4e8=_4e7[this._itemNumPropName];
if(_4e7["backup_"+this._reverseRefMap]){
_4e7[this._reverseRefMap]=_4e7["backup_"+this._reverseRefMap];
delete _4e7["backup_"+this._reverseRefMap];
}
this._arrayOfAllItems[_4e8]=_4e7;
if(this._itemsByIdentity){
this._itemsByIdentity[_4e1]=_4e7;
}
if(_4e7[this._rootItemPropName]){
this._arrayOfTopLevelItems.push(_4e7);
}
}
for(_4e1 in this._pending._deletedItems){
_4e7=this._pending._deletedItems[_4e1];
if(_4e7["backupRefs_"+this._reverseRefMap]){
dojo.forEach(_4e7["backupRefs_"+this._reverseRefMap],function(_4e9){
var _4ea;
if(this._itemsByIdentity){
_4ea=this._itemsByIdentity[_4e9.id];
}else{
_4ea=this._arrayOfAllItems[_4e9.id];
}
this._addReferenceToMap(_4ea,_4e7,_4e9.attr);
},this);
delete _4e7["backupRefs_"+this._reverseRefMap];
}
}
for(_4e1 in this._pending._newItems){
var _4eb=this._pending._newItems[_4e1];
_4eb[this._storeRefPropName]=null;
this._arrayOfAllItems[_4eb[this._itemNumPropName]]=null;
if(_4eb[this._rootItemPropName]){
this._removeArrayElement(this._arrayOfTopLevelItems,_4eb);
}
if(this._itemsByIdentity){
delete this._itemsByIdentity[_4e1];
}
}
this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};
return true;
},isDirty:function(item){
if(item){
var _4ed=this.getIdentity(item);
return new Boolean(this._pending._newItems[_4ed]||this._pending._modifiedItems[_4ed]||this._pending._deletedItems[_4ed]).valueOf();
}else{
if(!this._isEmpty(this._pending._newItems)||!this._isEmpty(this._pending._modifiedItems)||!this._isEmpty(this._pending._deletedItems)){
return true;
}
return false;
}
},onSet:function(item,_4ef,_4f0,_4f1){
},onNew:function(_4f2,_4f3){
},onDelete:function(_4f4){
},close:function(_4f5){
if(this.clearOnClose){
if(!this.isDirty()){
this.inherited(arguments);
}else{
if(this._jsonFileUrl!==""){
throw new Error("dojo.data.ItemFileWriteStore: There are unsaved changes present in the store.  Please save or revert the changes before invoking close.");
}
}
}
}});
}
if(!dojo._hasResource["lconn.core.paletteOneUI.PaletteDataStoreBuilder"]){
dojo._hasResource["lconn.core.paletteOneUI.PaletteDataStoreBuilder"]=true;
dojo.provide("lconn.core.paletteOneUI.PaletteDataStoreBuilder");
dojo.declare("lconn.core.paletteOneUI.PaletteDataStoreBuilder",null,{buildDataStore:function(_4f6,_4f7){
var _4f8=null;
var _4f9=new dojo.Deferred();
if(_4f6!=null){
var that=this;
var _4fb=function(json){
try{
json=dojo.isString(json)?dojo.fromJson(json):json;
var _4fd=that._connectionsFormat2DojoTreeFormat(json);
var _4fe=new dojo.data.ItemFileWriteStore({data:_4fd});
_4f9.callback(_4fe);
}
catch(e){
_4f9.errback(e);
}
};
if(_4f7){
this._fetchJsonString(_4f6).addCallback(_4fb);
}else{
_4fb(_4f6);
}
}else{
_4f9.errback(new Error("Invalid paletteJson argument supplied to buildDataStore",_4f6));
}
return _4f9;
},_connectionsFormat2DojoTreeFormat:function(_4ff){
var _500={label:"name",identifier:"id"};
var _501=[];
if((_4ff!=null)&&(_4ff.categories!=null)){
var _502=dojo.map(_4ff.categories,dojo.hitch(this,"_handleCategory"));
dojo.forEach(_502,function(_503){
dojo.forEach(_503,function(item){
_501.push(item);
});
});
}
_500.items=_501;
return _500;
},_handleCategory:function(_505){
var _506=[];
var _507=dojo.map(_505.widgets,dojo.hitch(this,"_buildWidgetItemFromWidgetObj"));
dojo.forEach(_507,function(item){
_506.push(item);
});
_506.push(this._buildCategoryItem(_505.id,_505.name,_505.css,_506));
return _506;
},_fetchJsonString:function(url){
return dojo.xhrGet({url:url,handleAs:"text"});
},_buildCategoryItem:function(id,name,css,_50d){
var _50e={id:id,name:name,type:"widgetCategory",css:css,children:[]};
dojo.forEach(_50d,function(_50f){
_50e.children.push({_reference:_50f.id});
});
return _50e;
},_buildWidgetItemFromWidgetObj:function(_510){
return this._buildWidgetItem(_510);
},_buildWidgetItem:function(_511){
var _512={};
for(var key in _511){
if(key.charAt(0)!="_"){
_512[key]=_511[key];
}
}
_512.type="widget";
return _512;
}});
}
if(!dojo._hasResource["lconn.core.paletteOneUI.WidgetButton"]){
dojo._hasResource["lconn.core.paletteOneUI.WidgetButton"]=true;
dojo.provide("lconn.core.paletteOneUI.WidgetButton");
dojo.declare("lconn.core.paletteOneUI.WidgetButton",[dijit._Widget,dijit._Templated,dijit._Contained],{widgetItem:null,widgetIconNode:null,addedWidgetLabelNode:null,ADD_WIDGET_EVENT:"/lconn/core/palette/addWidget",_onClickHandler:null,initialStatus:null,plusIconNode:null,titleNodeSpan:null,titleContainerNode:null,title:null,_addingWidget:false,_isEnabled:false,_resourceBundle:null,imageContextRoot:"",templateString:"<div dojoAttachPoint=\"widgetNode\" class=\"lotusPaletteWidget\">\r\n    <div class=\"lotusInner\">\r\n        <div class=\"lotusIcon\" dojoAttachPoint=\"widgetIconNode\">\r\n        </div>\r\n        <div class=\"lotusTitle\">\r\n            <h4 dojoAttachPoint=\"titleContainerNode\">\r\n            \t<a href=\"javascript:;\" dojoAttachPoint=\"titleNode\"></a>\r\n            \t<span dojoAttachPoint=\"titleNodeSpan\" class=\"lotusHidden\"></span>            \t\r\n            \t<br/>\r\n            \t<span dojoAttachPoint=\"addedWidgetLabelNode\" class=\"lotusAdded lotusHidden\">${_resourceBundle.ADDED_WIDGET}</span>            \t            \r\n            </h4>            \r\n        </div>\r\n        <a class=\"lotusIcon\" href=\"javascript:;\" title=\"${_resourceBundle.ADD_INFO}\" dojoAttachPoint=\"plusIconNode\"><img dojoAttachPoint=\"blankImageNode\" title=\"${_resourceBundle.ADD_INFO}\" width=\"16\" height=\"16\" alt=\"\"/><span class=\"lotusAltText\">+</span></a>\r\n    </div>\r\n</div>\r\n",postCreate:function(){
this.inherited("postCreate",arguments);
if((this.widgetItem!=null)&&(typeof this.widgetItem.iconUrl!="undefined")&&(typeof this.widgetItem.iconUrl[0]!="undefined")){
this._buildIconNode(this.widgetItem.iconUrl,this._resourceBundle.ICON_ALT);
}
this.blankImageNode.src=this.imageContextRoot+"/blank.gif";
this._updateTitle();
this._updateDescription();
this._isEnabled=!this.initialStatus;
if(this.initialStatus){
this.enableButton();
}else{
this.disableButton();
}
},postMixInProperties:function(){
this._resourceBundle=dojo.i18n.getLocalization("lconn.core.paletteOneUI","WidgetButton");
},disableButton:function(){
if(this._isEnabled){
dojo.disconnect(this._onClickHandler);
this._onClickHandler=null;
dojo.removeClass(this.addedWidgetLabelNode,"lotusHidden");
dojo.addClass(this.titleContainerNode,"lotusAdded");
this.plusIconNode.style.display="none";
dojo.addClass(this.titleNode,"lotusHidden");
dojo.removeClass(this.titleNodeSpan,"lotusHidden");
this.titleNodeSpan.innerHTML=this._cropTitle(this.title);
dojo.addClass(this.domNode,"lotusPaletteDisabledBtn");
this._isEnabled=false;
}
},enableButton:function(){
if(!this._isEnabled){
if(this._onClickHandler==null){
this._onClickHandler=dojo.connect(this.domNode,"onclick",this,"onClick");
}
this.plusIconNode.style.display="";
if (this.widgetNode.title.indexOf("comm") == 0) {
dojo.removeClass(this.widgetNode, "lotusPaletteWidget");
dojo.addClass(this.widgetNode, "dwPaletteWidget");
}
dojo.addClass(this.titleNodeSpan,"lotusHidden");
dojo.removeClass(this.titleNode,"lotusHidden");
this.titleNode.innerHTML=this._cropTitle(this.title);
dojo.removeClass(this.titleContainerNode,"lotusAdded");
dojo.addClass(this.addedWidgetLabelNode,"lotusHidden");
dojo.removeClass(this.domNode,"lotusPaletteDisabledBtn");
this._isEnabled=true;
}
},_buildIconNode:function(_514,_515){
var _516=dojo.doc.createElement("span");
var _517=dojo.doc.createElement("img");
dojo.attr(_517,"src",_514);
dojo.attr(_517,"alt",_515);
dojo.attr(_517,"title",_515);
_516.appendChild(_517);
this.widgetIconNode.appendChild(_516);
},_updateTitle:function(){
if(this.widgetItem!=null){
this.title=this.widgetItem.name[0];
var _518=this._cropTitle(this.title);
this.titleNode.innerHTML=_518;
dojo.attr(this.titleNode,"title",this.title);
dojo.attr(this.titleNode,"alt",this.title);
dojo.attr(this.titleNodeSpan,"title",this.title);
dojo.attr(this.titleNodeSpan,"alt",this.title);
}
},_cropTitle:function(_519){
var _51a="";
var _51b;
if((dojo.config!=null)&&(dojo.config.locale.indexOf("ja")!=-1)){
_51b=9;
}else{
_51b=20;
}
if(_519!=null&&_519.length>_51b){
_51a=_519.substr(0,_51b-2);
_51a+="...";
}else{
_51a=_519;
}
return _51a;
},_updateDescription:function(){
if((this.widgetItem!=null)&&(this.widgetItem.desc!=null)){
dojo.attr(this.domNode,"title",this.widgetItem.desc[0]);
dojo.attr(this.domNode,"alt",this.widgetItem.desc[0]);
}
},onClick:function(evt){
if(!this._addingWidget){
this._addingWidget=true;
try{
if(this.widgetItem!=null){
dojo.publish(this.ADD_WIDGET_EVENT,[this.widgetItem]);
dojo.removeClass(this.addedWidgetLabelNode,"lotusHidden");
dojo.addClass(this.titleContainerNode,"lotusAdded");
}
}
catch(e){
}
finally{
this._addingWidget=false;
}
}
}});
}
if(!dojo._hasResource["lconn.core.paletteOneUI.PaletteContentPanel"]){
dojo._hasResource["lconn.core.paletteOneUI.PaletteContentPanel"]=true;
dojo.provide("lconn.core.paletteOneUI.PaletteContentPanel");
dojo.declare("lconn.core.paletteOneUI.PaletteContentPanel",[dijit._Widget,dijit._Templated,dijit._Container],{templateString:"<div class=\"lotusPaletteContent\">\r\n<div class=\"lotusPaletteWidgets\">\r\n<div dojoAttachPoint=\"noWidgetNode\" class=\"lotusHidden lotusPaging\" style=\"width: auto; text-align: justify;\">\r\n${_resourceBundle.NO_WIDGET_NO_SHELF}</div>\r\n<div dojoAttachPoint=\"containerNode\"></div>\r\n</div>\r\n<div class=\"lotusPaging lotusHidden\"\r\n\tdojoAttachPoint=\"pagerContainerNode\">\r\n<div class=\"lotusLeft\" dojoAttachPoint=\"pagerNode\"></div>\r\n<ul class=\"lotusRight lotusInlinelist lotusHidden\" dojoAttachPoint=\"scrollControlNode\">\r\n\t<li class=\"lotusFirst\" dojoAttachEvent=\"onclick: onPrevious\"\r\n\t\tdojoAttachPoint=\"previousNode\">${_resourceBundle.PREVIOUS}</li>\r\n\t<li dojoAttachEvent=\"onclick: onNext\" dojoAttachPoint=\"nextNode\">\r\n\t<a href=\"javascript:;\">${_resourceBundle.NEXT}</a></li>\r\n</ul>\r\n</div>\r\n<!--end paging--></div>\r\n<!--end palette content-->\r\n",pagerNode:null,_items:null,_currentPageNumber:0,_resourceBundle:null,nextNode:null,previousNode:null,pagerContainerNode:null,noWidgetNode:null,scrollControlNode:null,AMOUNT_WIDGET_PER_PAGE:12,imageContextRoot:"",postMixInProperties:function(){
this._resourceBundle=dojo.i18n.getLocalization("lconn.core.paletteOneUI","PaletteContentPanel");
},postCreate:function(){
this.inherited("postCreate",arguments);
},_addPaletteButton:function(_51d,_51e){
var _51f=this.imageContextRoot;
var _520=new lconn.core.paletteOneUI.WidgetButton({widgetItem:_51d,imageContextRoot:_51f,initialStatus:_51e});
this.addChild(_520);
},_removeAllButtons:function(){
var _521=this.getChildren();
dojo.forEach(_521,function(_522){
this.removeChild(_522);
},this);
},_removeButtonNotInSet:function(ids){
var _524=this.getChildren();
dojo.forEach(_524,function(_525){
var _526=_525.widgetItem.id;
var _527=dojo.some(ids,function(id){
return id==_526;
});
if(!_527){
this.removeChild(_525);
}
},this);
},goToFirstPage:function(){
this._currentPageNumber=0;
},setItems:function(_529){
this._items=_529;
this._showWidgetButtons();
this._updatePaging();
this._togglePagingButtons();
},_updatePaletteButton:function(_52a,_52b){
if(_52b){
_52a.enableButton();
}else{
_52a.disableButton();
}
},_showWidgetButtons:function(){
var _52c=this._currentPageNumber;
if(this._getTotalNumberWidgets()==0){
this._removeAllButtons();
this._showNoWidgetMsg();
}else{
this._hideNoWidgetMsg();
if((_52c>=0)&&(this._items!=null)){
var _52d=this._getFirstWidgetIndex();
var end=this._getLastWidgetIndex();
var ids=[];
for(var i=_52d;i<=end;i++){
ids.push(this._items[i].item.id);
}
this._removeButtonNotInSet(ids);
var _531=this.getChildren();
for(var i=_52d;i<=end;i++){
var _532=this._items[i].item;
var _533=this._items[i].enabled;
var _534=false;
var j=0;
while(!_534&&(j<_531.length)){
if(_531[j].widgetItem.id==_532.id){
_534=true;
}else{
j++;
}
}
if(!_534){
this._addPaletteButton(_532,_533);
}else{
this._updatePaletteButton(_531[j],_533);
}
}
this._currentPageNumber=_52c;
}
}
},_showNoWidgetMsg:function(){
dojo.removeClass(this.noWidgetNode,"lotusHidden");
},_hideNoWidgetMsg:function(){
dojo.addClass(this.noWidgetNode,"lotusHidden");
},_updatePaging:function(){
var _536=this._items.length;
var end=this._getLastWidgetIndex()+1;
var _538=this._getTotalNumberWidgets();
var _539=Math.min(_538,this._getFirstWidgetIndex()+1);
var str=dojo.string.substitute(this._resourceBundle.PAGING_STATUS,{begin:_539,end:end,total:_538});
this.pagerNode.innerHTML=str;
dojo.removeClass(this.pagerContainerNode,"lotusHidden");
},onPrevious:function(evt){
if(!this._isFirstPage()){
this._currentPageNumber--;
this._showWidgetButtons(this._currentPageNumber);
this._updatePaging();
this._togglePagingButtons();
}
dojo.stopEvent(evt);
},onNext:function(evt){
if(!this._isLastPage()){
this._currentPageNumber++;
this._showWidgetButtons(this._currentPageNumber);
this._updatePaging();
this._togglePagingButtons();
}
dojo.stopEvent(evt);
},_togglePagingButtons:function(){
if(this._isFirstPage()&&this._isLastPage()){
dojo.addClass(this.scrollControlNode,"lotusHidden");
}else{
dojo.removeClass(this.scrollControlNode,"lotusHidden");
this._toggleNextButton();
this._togglePreviousButton();
}
},_toggleNextButton:function(){
if(this._isLastPage()){
this.nextNode.innerHTML=this._resourceBundle.NEXT;
}else{
this.nextNode.innerHTML="<a href='javascript:;'>"+this._resourceBundle.NEXT+"</a>";
}
},_togglePreviousButton:function(){
if(this._isFirstPage()){
this.previousNode.innerHTML=this._resourceBundle.PREVIOUS;
}else{
this.previousNode.innerHTML="<a href='javascript:;'>"+this._resourceBundle.PREVIOUS+"</a>";
}
},_getFirstWidgetIndex:function(){
return this.AMOUNT_WIDGET_PER_PAGE*this._currentPageNumber;
},_getLastWidgetIndex:function(){
return Math.min(this.AMOUNT_WIDGET_PER_PAGE*(this._currentPageNumber+1),this._getTotalNumberWidgets())-1;
},_getTotalNumberWidgets:function(){
var _53d=0;
if(this._items!=null){
_53d=this._items.length;
}
return _53d;
},_isLastPage:function(){
return (((this._currentPageNumber+1)*this.AMOUNT_WIDGET_PER_PAGE)>=this._items.length);
},_isFirstPage:function(){
return this._currentPageNumber==0;
}});
}
if(!dojo._hasResource["lconn.core.paletteOneUI.AddContentPane"]){
dojo._hasResource["lconn.core.paletteOneUI.AddContentPane"]=true;
dojo.provide("lconn.core.paletteOneUI.AddContentPane");
dojo.declare("lconn.core.paletteOneUI.AddContentPane",[dijit._Widget,dijit._Templated,dijit._Container,dijit._Contained],{PRIMARY_WIDGET:"primary",SECONDARY_WIDGET:"secondary",_WIDGET_TYPES:[],_topics:[],_jsonSourceUrl:null,_jsonData:null,_storeBuilder:null,_contentArea:null,listNode:null,contentAreaNode:null,_contentAreaItems:null,addWidgetButtonNode:null,shelfNode:null,_canAddWidgetHandler:null,_isVisibleWidgetHandler:null,_resourceBundle:null,_layoutImages:null,_currentStore:null,_listWidget:null,imageContextRoot:"",browseLabelNode:null,loadingNode:null,templateString:"<div class=\"lotusPaletteBody\">\r\n\t<div class=\"lotusPaletteNav\" dojoAttachPoint=\"shelfNode\">\r\n\t\t<div class=\"lotusHidden\" style=\"margin: 15px 10px 15px 10px\" dojoAttachPoint=\"loadingNode\"></div>\r\n\t\t<h3 class=\"lotusHidden\" dojoAttachPoint=\"browseLabelNode\">${_resourceBundle.BROWSE_CONTENT}</h3>\r\n\t\t<div dojoAttachPoint=\"listNode\"></div>\r\n\t</div>\r\n\t<div dojoAttachPoint=\"contentAreaNode\"></div>\r\n</div>\r\n",postMixInProperties:function(){
this._resourceBundle=dojo.i18n.getLocalization("lconn.core.paletteOneUI","AddContentPane");
},postCreate:function(){
this.inherited("postCreate",arguments);
this._createLoadingNode();
this._setLoading();
var _53e=this.imageContextRoot;
this._contentArea=new lconn.core.paletteOneUI.PaletteContentPanel({imageContextRoot:_53e});
this.contentAreaNode.appendChild(this._contentArea.domNode);
this._storeBuilder=new lconn.core.paletteOneUI.PaletteDataStoreBuilder();
this._registerDefaultCanAddWidgetFct();
this._registerDefaultIsVisibleWidgetFct();
},setJsonSourceUrl:function(url){
this._jsonSourceUrl=url;
},getJsonSourceUrl:function(){
return this._jsonSourceUrl;
},setJsonData:function(_540){
this._jsonData=dojo.isString(_540)?dojo.fromJson(_540):_540;
},getJsonData:function(){
return this._jsonData;
},populatePalette:function(_541){
this._setLoading();
var _542;
if(_541){
_542=this._storeBuilder.buildDataStore(this._jsonSourceUrl,true);
}else{
_542=this._storeBuilder.buildDataStore(this._jsonData,false);
}
var that=this;
_542.addCallback(dojo.hitch(this,"_setupList"));
_542.addErrback(dojo.hitch(this,"_handleError"));
_542.addErrback(function(){
that._hideLoading();
});
},_createLoadingNode:function(){
this.loadingNode.innerHTML="";
this.loadingNode.innerHTML="<div>"+this._resourceBundle.LOADING+"</div>";
dojo.addClass(this.loadingNode,"lotusMeta");
},_setLoading:function(){
dojo.removeClass(this.loadingNode,"lotusHidden");
},_removeLoading:function(){
dojo.addClass(this.loadingNode,"lotusHidden");
},_setupList:function(_544){
this._removeLoading();
this._currentStore=_544;
this._loadList();
},_loadList:function(){
if(this._currentStore!=null){
var _545=this._currentStore;
if(this._listWidget!=null){
this._listWidget.destroy();
}
this._listWidget=new lconn.core.paletteOneUI.PaletteList({store:_545,query:{type:"widgetCategory"},_parent:this});
this.listNode.innerHTML="";
this.listNode.appendChild(this._listWidget.domNode);
dojo.removeClass(this.browseLabelNode,"lotusHidden");
}
},showShelf:function(){
dojo.removeClass(this.shelfNode,"lotusHidden");
dojo.removeClass(this.shelfNode.parentNode,"lotusPaletteNoShelf");
},hideShelf:function(){
dojo.addClass(this.shelfNode,"lotusHidden");
dojo.addClass(this.shelfNode.parentNode,"lotusPaletteNoShelf");
},removeItem:function(_546){
var _547=this._currentStore;
var that=this;
if(_547!=null){
var dfd=_547.fetch({query:{id:_546},onComplete:function(_54a){
if(_54a.length==1){
_547.deleteItem(_54a[0]);
that._updateContentArea();
}else{
}
}});
}
},_updateContentArea:function(){
var _54b=this._listWidget.getLastCategoryId();
if(_54b!=null){
this._currentStore.fetch({query:{id:_54b},onComplete:function(_54c){
if(_54c.length==1){
dojo.publish("/lconn/core/palette/categorySelected",[_54c[0]]);
}else{
}
}});
}
},_initWidgetTypes:function(){
this._WIDGET_TYPES.push(this.PRIMARY_WIDGET);
this._WIDGET_TYPES.push(this.SECONDARY_WIDGET);
},_registerDefaultLayoutImages:function(){
var _54d=dojo.moduleUrl("lconn.core.paletteOneUI","images/primary_widget.png").toString();
this.setLayoutImage(this.PRIMARY_WIDGET,_54d);
this.setLayoutImage(this.SECONDARY_WIDGET,_54d);
},registerIsVisibleButton:function(_54e){
if(dojo.isFunction(_54e)){
this._isVisibleWidgetHandler=_54e;
}
},_handleError:function(){
console.log("error in palette");
console.log(arguments[0]);
},_populateContentArea:function(_54f){
if(this._contentAreaItems!=null){
var _550=[];
dojo.forEach(this._contentAreaItems,function(_551){
if(this._isVisibleWidgetHandler(_551)){
if(this._canAddWidgetHandler(_551)){
_550.push({enabled:true,item:_551});
}else{
_550.push({enabled:false,item:_551});
}
}
},this);
if((_54f!=null)&&(_54f==true)){
this._contentArea.goToFirstPage();
}
this._contentArea.setItems(_550);
}
},onCategorySelected:function(_552){
this._contentAreaItems=_552.children;
this._populateContentArea(true);
},_runCanAddWidgetHandler:function(item){
},setLayoutImage:function(_554,url){
dojo.deprecated("setLayoutImage");
},getLayoutImage:function(_556){
dojo.deprecated("getLayoutImage");
return null;
},_disableAddWidgetButton:function(){
this.addWidgetButtonNode.disabled=true;
dojo.addClass(this.addWidgetButtonNode,this.DISABLED_BUTTON_CSS);
},_enabledAddWidgetButton:function(){
this.addWidgetButtonNode.disabled=false;
dojo.removeClass(this.addWidgetButtonNode,this.DISABLED_BUTTON_CSS);
},registerCanAddWidgetFct:function(_557){
if(dojo.isFunction(_557)){
this._canAddWidgetHandler=_557;
}
},_registerDefaultCanAddWidgetFct:function(){
if(this._canAddWidgetHandler==null){
this._canAddWidgetHandler=function(_558){
return true;
};
}
},_registerDefaultIsVisibleWidgetFct:function(){
if(this._isVisibleWidgetHandler==null){
this._isVisibleWidgetHandler=function(_559){
return true;
};
}
},destroy:function(){
dojo.forEach(this._topics,function(_55a){
dojo.unsubscribe(_55a);
});
}});
}
if(!dojo._hasResource["lconn.core.paletteOneUI.Palette"]){
dojo._hasResource["lconn.core.paletteOneUI.Palette"]=true;
dojo.provide("lconn.core.paletteOneUI.Palette");
dojo.declare("lconn.core.paletteOneUI.Palette",[dijit._Widget,dijit._Templated,dijit._Container],{ADD_WIDGET_EVENT:"/lconn/core/palette/addWidget",CLOSE_PALETTE_EVENT:"/lconn/core/palette/closePalette",RESET_COUNTER_EVENT:"lconn/core/palette/resetCounter",RECHECK_CAN_ADD_WIDGET_HANDLER_EVENT:"/lconn/core/palette/recheck",PRIMARY_WIDGET:"primary",SECONDARY_WIDGET:"secondary",_WIDGET_TYPES:[],_topics:[],_addWidgetTopic:null,_contentArea:null,listNode:null,contentAreaNode:null,closeImageNode:null,addWidgetButtonNode:null,_canAddWidgetHandler:null,_resourceBundle:null,_itemAddedCount:null,itemAddedStr:null,imageContextRoot:"",_tabPanels:null,_currentTab:null,tabsContainerNode:null,templateString:"<div class=\"lotusPalette\">\r\n<div class=\"lotusPaletteHeader\">\r\n<ul class=\"lotusTabs\" dojoAttachPoint=\"tabsContainerNode\">\r\n</ul>\r\n<a href=\"javascript:;\" class=\"lotusRight lotusClose\"\r\n\tdojoAttachEvent=\"onclick: onClosePalette\"> <img title=\"${_resourceBundle.CLOSE_PALETTE}\" alt=\"${_resourceBundle.CLOSE_PALETTE}\" dojoAttachPoint=\"closeImageNode\" /></a>\r\n<span class=\"lotusRight lotusHidden\" dojoAttachPoint=\"itemAddedNode\">\r\n${itemAddedStr} </span></div>\r\n<div dojoAttachPoint=\"containerNode\"></div>\r\n</div>\r\n",postMixInProperties:function(){
this._resourceBundle=dojo.i18n.getLocalization("lconn.core.paletteOneUI","Palette");
this._itemAddedCount=0;
this.itemAddedStr=dojo.string.substitute(this._resourceBundle.ITEM_ADDED,[this._itemAddedCount]);
},postCreate:function(){
this.inherited("postCreate",arguments);
this._tabPanels=[];
this._registerDefaultPanel();
this.closeImageNode.src=dojo.moduleUrl("lconn.core.paletteOneUI","images/paletteClose.gif").toString();
this._topics.push(dojo.subscribe(lconn.core.paletteOneUI.PaletteList.prototype.CATEGORY_SELECTED_EVENT,dojo.hitch(this,"_handleEventsControler","category")));
this._topics.push(dojo.subscribe(this.RECHECK_CAN_ADD_WIDGET_HANDLER_EVENT,dojo.hitch(this,"_handleEventsControler","recheck")));
this._topics.push(dojo.subscribe(this.RESET_COUNTER_EVENT,dojo.hitch(this,"_resetItemCount")));
},_registerDefaultPanel:function(){
var _55b=this.imageContextRoot;
this._contentArea=new lconn.core.paletteOneUI.AddContentPane({imageContextRoot:_55b});
this.addTabPane("widgetAddId",this._resourceBundle.ADD_CONTENT,this._contentArea,true);
var _55c=this._tabPanels["widgetAddId"];
this.addChild(_55c);
},_handleEventsControler:function(type){
if(this._currentTab!=null){
var id=this._currentTab.id;
var _55f=this._tabPanels[id];
if(_55f instanceof lconn.core.paletteOneUI.AddContentPane){
if(type=="category"){
_55f.onCategorySelected(arguments[1]);
}else{
if(type=="recheck"){
_55f._populateContentArea();
}
}
}
}
},setJsonSourceUrl:function(url){
this._contentArea.setJsonSourceUrl(url);
},getJsonSourceUrl:function(){
return this._contentArea.getJsonSourceUrl();
},setJsonData:function(_561){
this._contentArea.setJsonData(_561);
},getJsonData:function(){
return this._contentArea.getJsonData();
},populatePalette:function(_562){
this._contentArea.populatePalette(_562);
},removeItem:function(_563){
this._contentArea.removeItem(_563);
},onClosePalette:function(evt){
dojo.publish(this.CLOSE_PALETTE_EVENT);
dojo.stopEvent(evt);
},setLayoutImage:function(_565,url){
this._contentArea.setLayoutImage(_565,url);
},getLayoutImage:function(_567){
return this._contentArea.getLayoutImage(_567);
},addTabPane:function(id,name,_56a,_56b){
var _56c=null;
if(typeof _56a.domNode!="undefined"){
_56c=this._buildTabHeaderNode(id,name);
this.tabsContainerNode.appendChild(_56c);
this._tabPanels[id]=_56a;
if((typeof _56b!="undefined")&&(_56b==true)){
dojo.addClass(_56c,"lotusSelected");
this._currentTab=_56c;
}
}
},_buildTabHeaderNode:function(id,name){
var _56f=dojo.doc.createElement("li");
_56f.id=id;
dojo.connect(_56f,"onclick",dojo.hitch(this,"_switchToTab",id));
_56f.innerHTML="<a href='javascript:;'><strong>"+name+"</strong></a>";
return _56f;
},_switchToTab:function(id,evt){
if(this._currentTab!=null){
dojo.removeClass(this._currentTab,"lotusSelected");
}
var _572=evt.currentTarget;
dojo.addClass(_572,"lotusSelected");
this._currentTab=_572;
var _573=this._tabPanels[id];
var _574=this.getChildren();
var that=this;
dojo.forEach(_574,function(_576){
that.removeChild(_576);
});
this.addChild(_573);
},registerCanAddWidgetFct:function(_577){
this._contentArea.registerCanAddWidgetFct(_577);
},registerIsVisibleButton:function(_578){
this._contentArea.registerIsVisibleButton(_578);
},enableItemCounter:function(){
dojo.removeClass(this.itemAddedNode,"lotusHidden");
},disableItemCounter:function(){
dojo.addClass(this.itemAddedNode,"lotusHidden");
},_incAddedItemCount:function(){
this._itemAddedCount++;
if(this._itemAddedCount>0){
dojo.addClass(this.itemAddedNode,"lotusAdded");
}else{
dojo.removeClass(this.itemAddedNode,"lotusAdded");
}
this.itemAddedNode.innerHTML=dojo.string.substitute(this._resourceBundle.ITEM_ADDED,[this._itemAddedCount]);
},_resetItemCount:function(){
this._itemAddedCount=0;
dojo.removeClass(this.itemAddedNode,"lotusAdded");
this.itemAddedNode.innerHTML=dojo.string.substitute(this._resourceBundle.ITEM_ADDED,[this._itemAddedCount]);
},incCounter:function(){
this._incAddedItemCount();
},enabledAutoCounter:function(){
this._addWidgetTopic=dojo.subscribe(this.ADD_WIDGET_EVENT,dojo.hitch(this,"_incAddedItemCount"));
},disabledAutoCounter:function(){
if(this._addWidgetTopic!=null){
dojo.unsubscribe(this._addWidgetTopic);
}
},destroy:function(){
dojo.forEach(this._topics,function(_579){
dojo.unsubscribe(_579);
});
this._contentArea.destroy();
this.inherited("destroy",arguments);
}});
}
if(!dojo._hasResource["lconn.core.applicationPalette"]){
dojo._hasResource["lconn.core.applicationPalette"]=true;
dojo.provide("lconn.core.applicationPalette");
lconn.core.applicationPalette=function(){
this.onLoad=function(){
var _57a=null;
_57a=this.iContext.getElementById("applicationPalettewidgetContainer");
lconn.core.applicationPalette.palette=new lconn.core.paletteOneUI.Palette({id:"communityPalette",imageContextRoot:WidgetPlacementConfig.applicationContext+"/nav/common/styles/images/"});
lconn.core.applicationPalette.palette.setLayoutImage("primary",WidgetPlacementConfig.applicationContext+"/nav/common/styles/images/3col_primary.jpg");
lconn.core.applicationPalette.palette.setLayoutImage("secondary",WidgetPlacementConfig.applicationContext+"/nav/common/styles/images/2secondary_cols.jpg");
lconn.core.applicationPalette.palette.setJsonData(lconn.core.applicationPalette.getjsonData());
lconn.core.applicationPalette.palette.populatePalette(false);
lconn.core.applicationPalette.palette.registerCanAddWidgetFct(lconn.core.applicationPalette.canAdd);
lconn.core.applicationPalette.palette.enableItemCounter();
dojo.subscribe(lconn.core.paletteOneUI.Palette.prototype.ADD_WIDGET_EVENT,lconn.core.applicationPalette.addWidget);
dojo.subscribe(lconn.core.paletteOneUI.Palette.prototype.CLOSE_PALETTE_EVENT,lconn.core.applicationPalette.hidePalette);
_57a.appendChild(lconn.core.applicationPalette.palette.domNode);
lconn.core.applicationPalette.contentLoaded=true;
};
};
lconn.core.applicationPalette.hidePalette=function(){
var _57b=function(){
var temp=dijit.byId("communityPalette");
if(temp!=null){
temp.destroy();
}
destroyWidget("widgetPalette");
lconn.core.applicationPalette.palette=null;
lconn.core.applicationPalette.contentLoaded=null;
dojo.byId("widget-container-palette").innerHTML="";
};
lconn.core.utilities.hide("communityPalette",false,false,_57b);
return false;
};
lconn.core.applicationPalette.showPalette=function(){
dojo.byId("widget-container-palette").style.display="none";
closeOtherViews();
registerCloseViewFunction(lconn.core.applicationPalette.hidePalette);
lconn.core.WidgetPlacement.addWidgetInProgress=false;
if(lconn.core.applicationPalette.contentLoaded==null){
lconn.core.WidgetPlacement.getWidgetDocAndRenderWidget("widgetPalette",null,null,"palette",null,"skinless",null,false);
}else{
lconn.core.applicationPalette.palette.setJsonData(lconn.core.applicationPalette.getjsonData());
lconn.core.applicationPalette.palette.populatePalette(false);
}
var _57d=function(){
lconn.core.utilities.show("widget-container-palette",false,true,false);
};
lconn.core.utilities.processUntilAvailable(_57d,"dojo.byId('communityPalette') != null");
return false;
};
lconn.core.applicationPalette.addWidget=function(item){
var _57f=lconn.core.applicationPalette.canAdd(item);
console.log("addWidget: canAdd="+_57f+" for: "+item.id);
if(_57f&&lconn.core.WidgetPlacement.addWidgetInProgress==false){
lconn.core.WidgetPlacement.addWidgetInProgress=true;
var _580=null;
if(item.widgetType=="primary"){
_580="col2";
}else{
_580="col3";
}
lconn.core.WidgetPlacement.addWidgetToServerAndRender(item.widgetId,_580,item.hidden);
if(item.category=="hidden"&&item.hidden=="true"){
item.hasAlreadyBeenUnhidden="true";
}
console.log("addWidget: completed for: "+item.id);
throw "Err1";
}
};
var createCatItem=function(_581,_582,_583){
if(_583==null){
_583="";
}
var _584=_581.getAttribute("iconUrl");
var _585=null;
if(_584!=null&&_584!=""){
_585=lconn.core.i18nOverrider.replaceParams(_584,WidgetPlacementConfig.params);
}
var _586={id:_583+"_"+_581.getAttribute("defId"),widgetId:_581.getAttribute("defId"),name:getResourcedStringForItem(_581,"defId"),desc:getResourcedStringForItem(_581,"description"),uniqueInstance:(_581.getAttribute("uniqueInstance")=="true").toString(),hidden:_582,widgetType:"primary"};
if(_581.getAttribute("primaryWidget")=="false"){
_586.widgetType="secondary";
}
if(_582=="true"){
_586.category="hidden";
}
if(_585!=null&&_585!=""){
_586.iconUrl=_585;
}
return _586;
};
var addToList=function(_587,_588,_589){
var _58a=_587.getAttribute("category");
if(_58a!=null&&_58a!=""){
var _58b=null;
for(var i=0;_589.categories!=null&&i<_589.categories.length;i++){
var _58d=_589.categories[i];
if(_58d.id==_58a){
_58b=_58d;
break;
}
}
if(_58b==null){
_58b={name:getResourcedStringForItem(_587,"category"),id:_58a,widgets:[]};
_589.categories.push(_58b);
}
_58b.widgets.push(createCatItem(_587,"false",_58a));
}
_588.push(_587);
};
lconn.core.applicationPalette.getjsonData=function(){
var _58e={categories:[{name:dojo.i18n.getLocalization("lc_default")["widgetCat_AllWidgets"],id:"allWidgetsCat",widgets:[]}]};
var _58f="/tns:widgets/tns:definitions/tns:widgetDef";
var _590=lconn.core.xpath.selectNodes(_58f,WidgetPlacementConfig.widgetConfigXMLDocument);
var _591=new Array;
var _592=new Array;
for(var i=0;_590.length!=null&&i<_590.length;i++){
var _594=_590[i];
if(_594.getAttribute("showInPalette")=="false"){
continue;
}
if(!canAddWidget(_594,WidgetPlacementConfig,true)){
continue;
}
var exp2="/tns:widgets/tns:layout/tns:page[@pageId='"+WidgetPlacementConfig.defaultPageId+"']/tns:widgetInstance[@defIdRef='"+_594.getAttribute("defId")+"']";
var _596=lconn.core.xpath.selectNodes(exp2,WidgetPlacementConfig.widgetConfigXMLDocument);
if(_596==null||_596.length==0){
addToList(_594,_591,_58e);
}else{
if(_596.length>0){
if(_596[0].getAttribute("enabled")=="false"){
_592.push(_594);
}else{
if(_594.getAttribute("uniqueInstance")==null||_594.getAttribute("uniqueInstance")=="false"){
addToList(_594,_591,_58e);
}
}
}
}
}
for(var i=0;_591.length!=null&&i<_591.length;i++){
var _594=_591[i];
_58e.categories[0].widgets.push(createCatItem(_594,"false","aval"));
}
if(_592.length>0){
var _597={name:dojo.i18n.getLocalization("lc_default")["widgetCat_hidden"],id:"hiddenCat",widgets:[]};
_58e.categories.push(_597);
for(var i=0;_592.length!=null&&i<_592.length;i++){
var _594=_592[i];
_597.widgets.push(createCatItem(_594,"true","hidden"));
}
}
return _58e;
};
lconn.core.applicationPalette.canAdd=function(_598){
var _599=false;
if(_598.hasAlreadyBeenUnhidden=="true"){
_599=false;
}else{
if(_598.category=="hidden"&&_598.hidden=="true"){
_599=true;
}else{
var exp2="/tns:widgets/tns:layout/tns:page[@pageId='"+WidgetPlacementConfig.defaultPageId+"']/tns:widgetInstance[@defIdRef='"+_598.widgetId+"']";
var _59b=lconn.core.xpath.selectNodes(exp2,WidgetPlacementConfig.widgetConfigXMLDocument);
if(_59b.length==0){
_599=true;
}else{
if(_59b[0].getAttribute("enabled")=="false"){
_599=false;
}else{
if(_598.uniqueInstance=="false"){
_599=true;
}else{
_599=false;
}
}
}
}
}
console.log("returnValue: "+_599+" for id: "+_598.id+" other: "+typeof (_598.uniqueInstance));
return _599;
};
}
if(!dojo._hasResource["lconn.core.dnd.Source"]){
dojo._hasResource["lconn.core.dnd.Source"]=true;
dojo.provide("lconn.core.dnd.Source");
dojo.declare("lconn.core.dnd.Source",dojo.dnd.Source,{isCursorNorthNode:function(node,evt){
var _59e=dojo.coords(node,true);
var absY=node.offsetHeight;
return ((evt.pageY-_59e.y)<(absY/2));
},_children:null,_changeState:function(type,_5a1){
var _5a2=type.toLowerCase()+"State";
this[_5a2]=_5a1;
},_addItemClass:function(node,type){
},_removeItemClass:function(node,type){
},getInsertPosition:function(e){
var pos=-1;
var _5a9=false;
var _5aa=[];
for(var i=0;i<this._children.length;i++){
if(this._children[i].style.display!="none"){
_5aa.push(this._children[i]);
}
}
var _5ac=_5aa.length-1;
if(_5aa.length>0){
if(this.isCursorNorthNode(_5aa[0],e)){
pos=0;
_5a9=true;
}else{
if(!this.isCursorNorthNode(_5aa[_5ac],e)){
pos=_5ac;
_5a9=false;
}else{
for(var i=0;i<_5ac;i++){
if(!this.isCursorNorthNode(_5aa[i],e)&&this.isCursorNorthNode(_5aa[i+1],e)){
pos=i;
_5a9=false;
break;
}
}
}
}
return [_5aa[pos],_5a9];
}else{
return [null,false];
}
},placeIndicator:function(node,_5ae){
if(this.dropIndicator&&this.dropIndicator.parentNode){
this.dropIndicator.parentNode.removeChild(this.dropIndicator);
}
if(node==null){
this.node.appendChild(this.dropIndicator);
}else{
if(_5ae){
node.parentNode.insertBefore(this.dropIndicator,node);
}else{
if(node.parentNode.lastChild==node){
this.node.appendChild(this.dropIndicator);
}else{
node.parentNode.insertBefore(this.dropIndicator,node.nextSibling);
}
}
}
},createDropIndicator:function(){
var _5af=7;
this.dropIndicator=document.createElement("div");
this.dropIndicator.style.borderWidth="2px";
this.dropIndicator.style.borderColor="gray";
this.dropIndicator.style.borderStyle="dashed";
this.dropIndicator.style.cursor="default";
this.dropIndicator.style.height=dojo.marginBox(dojo.dnd.manager().avatar.node).h+"px";
this.dropIndicator.style.width=dojo.marginBox(this.node).w-_5af+"px";
},onDndStart:function(_5b0,_5b1,copy){
dojo.body().onselectstart=function(){
return false;
};
dojo.body().unselectable="on";
lconn.core.dnd.Source.superclass.onDndStart.apply(this,arguments);
this._children=dojo.query("> .dojoDndItem",this.parent);
this.threshold=5;
_5b1[0].style.display="none";
},onMouseDown:function(e){
if(!this.current){
return;
}
var _5b4=dojo.query(".ibmDndDragHandle",this.current);
if(_5b4.length){
if(e.target!=_5b4[0]){
dojo.publish("/dnd/cancel");
return;
}
}
lconn.core.dnd.Source.superclass.onMouseDown.apply(this,arguments);
},onMouseOver:function(e){
lconn.core.dnd.Source.superclass.onMouseOver.apply(this,arguments);
if(!this.isDragging){
var _5b6=dojo.query(".ibmDndDragHandle",this.current);
if(_5b6.length){
if(e.target==_5b6[0]){
dojo.addClass(e.target,"ibmDndDragHandleOver");
}
}
}
},onMouseOut:function(e){
lconn.core.dnd.Source.superclass.onMouseOut.apply(this,arguments);
var _5b8=dojo.query(".ibmDndDragHandle",this.current);
if(_5b8.length){
if(e.target==_5b8[0]){
dojo.removeClass(e.target,"ibmDndDragHandleOver");
}
}
},onDndDrop:function(_5b9,_5ba,copy){
var _5bc=this.current;
this.current=this.dropIndicator;
lconn.core.dnd.Source.superclass.onDndDrop.apply(this,arguments);
this.current=_5bc;
if(this.containerState=="Over"){
dojo.publish("/lconn/core/dnd/drop",[_5b9.node,this.node,_5ba[0]]);
}
dojo.body().onselectstart=null;
dojo.body().unselectable="off";
dojo.dnd.manager().canDropFlag=false;
},insertNodes:function(_5bd,data,_5bf,_5c0){
if(data.length){
for(var i=0;i<data.length;i++){
data[i].style.display="";
}
}
lconn.core.dnd.Source.superclass.insertNodes.apply(this,arguments);
},deleteDropIndicator:function(){
if(this.dropIndicator&&this.dropIndicator.parentNode){
this.dropIndicator.parentNode.removeChild(this.dropIndicator);
this.dropIndicator=null;
}
this.pos=null;
},onDndCancel:function(){
this.deleteDropIndicator();
if(!this.flagNotHide){
var m=dojo.dnd.manager();
for(var i=0;i<m.nodes.length;i++){
m.nodes[i].style.display="block";
}
}
dojo.dnd.manager().canDropFlag=false;
lconn.core.dnd.Source.superclass.onDndCancel.call(this);
},onOutEvent:function(){
this.deleteDropIndicator();
this.flag=true;
lconn.core.dnd.Source.superclass.onOutEvent.call(this);
},pos:null,threshold:null,mutex:0,onMouseMove:function(e){
if(this.mutex!=0){
return;
}
if(this.isDragging&&this.targetState=="Disabled"){
return;
}
dojo.dnd.Source.superclass.onMouseMove.call(this,e);
var m=dojo.dnd.manager();
if(this.isDragging){
this.threshold++;
if(this.threshold>=5){
try{
this.mutex++;
var _5c6=false;
if(this.current){
if(!this.targetBox||this.targetAnchor!=this.current){
this.targetBox={xy:dojo.coords(this.current,true),w:this.current.offsetWidth,h:this.current.offsetHeight,id:this.current.id};
}
if(this.horizontal){
_5c6=(e.pageX-this.targetBox.xy.x)<(this.targetBox.w/2);
}else{
_5c6=(e.pageY-this.targetBox.xy.y)<(this.targetBox.h/2);
}
}
if((e.target!=this.dropIndicator)){
var pos=this.getInsertPosition(e);
if(!this.pos||pos[0]!=this.pos[0]||pos[1]!=this.pos[1]){
this.deleteDropIndicator();
this.createDropIndicator();
this.placeIndicator(pos[0],pos[1]);
this.pos=pos;
}
}
if(this.current!=this.targetAnchor||_5c6!=this.before){
this._markTargetAnchor(_5c6);
m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));
}
}
catch(e){
}
finally{
this.threshold=0;
this.mutex--;
}
}
}else{
if(this.mouseDown&&this.isSource){
var _5c8=this.getSelectedNodes();
if(_5c8.length){
m.startDrag(this,_5c8,this.copyState(dojo.dnd.getCopyKeyState(e)),e);
this.flag=true;
}
}
}
}});
}
if(!dojo._hasResource["lconn.dboard.dnd.Source"]){
dojo._hasResource["lconn.dboard.dnd.Source"]=true;
dojo.provide("lconn.dboard.dnd.Source");
dojo.declare("lconn.dboard.dnd.Source",lconn.core.dnd.Source,{flagNotHide:false,isPalette:false,checkAcceptance:function(_5c9,_5ca){
if(this.isPalette){
return false;
}else{
return lconn.dboard.dnd.Source.superclass.checkAcceptance.apply(this,arguments);
}
},onDndDrop:function(_5cb,_5cc,copy){
if(this.containerState=="Over"&&dojo.hasClass(_5cc[0],"paletteItem")){
dojo.publish("/lconn/dboard/dropPaletteItem",[_5cc[0],this.dropIndicator,this.node]);
this.deleteDropIndicator();
lconn.core.dnd.Source.superclass.onDndCancel.call(this);
}else{
if(dojo.hasClass(_5cc[0],"paletteItem")){
this.flagNotHide=true;
}
var _5ce=this.current;
this.current=this.dropIndicator;
lconn.dboard.dnd.Source.superclass.onDndDrop.apply(this,arguments);
this.flagNotHide=false;
this.current=_5ce;
if(this.containerState=="Over"){
dojo.publish("/lconn/dboard/dnd/drop",[_5cb.node,this.node,_5cc[0]]);
}
}
dojo.body().onselectstart=null;
dojo.body().unselectable="off";
dojo.dnd.manager().canDropFlag=false;
}});
}
if(!dojo._hasResource["lconn.dboard.dnd.avatar"]){
dojo._hasResource["lconn.dboard.dnd.avatar"]=true;
dojo.provide("lconn.dboard.dnd.avatar");
dojo.declare("lconn.dboard.dnd.avatar",dojo.dnd.Avatar,{_bodyNode:null,_titleNode:null,_draggedWidgetData:null,_isPaletteItem:null,_resourceBundle:null,construct:function(){
this._resourceBundle=dojo.i18n.getLocalization("lconn.dboard","dndAvatar");
if(this.manager.nodes.length){
this._isPaletteItem=dojo.hasClass(this.manager.nodes[0],"paletteItem");
var _5cf=this.manager.source;
this._draggedWidgetData=_5cf.getItem(this.manager.nodes[0].id).data;
this.node=dojo.doc.createElement("div");
dojo.addClass(this.node,"idbc");
this._titleNode=dojo.doc.createElement("div");
dojo.addClass(this._titleNode,"idbt");
if(this._isPaletteItem){
this._titleNode.innerHTML=dojo.string.substitute(this._resourceBundle.TITLE_CREATE_WIDGET,[this._draggedWidgetData]);
}else{
this._titleNode.innerHTML=dojo.string.substitute(this._resourceBundle.TITLE_MOVE_WIDGET,[this._draggedWidgetData]);
}
this._bodyNode=dojo.doc.createElement("div");
dojo.addClass(this._bodyNode,"idbi");
this.node.appendChild(this._titleNode);
this.node.appendChild(this._bodyNode);
this.node.style.position="absolute";
this.node.style.zIndex=1999;
this.update();
}
},update:function(){
var _5d0=dojo.moduleUrl("lconn.dboard.dnd","cannotDrop.gif").toString();
var _5d1=dojo.moduleUrl("lconn.dboard.dnd","okDrop.gif").toString();
if(this._isPaletteItem){
if(this.manager.canDropFlag){
var img="<img src='"+_5d1+"'></img>";
this._bodyNode.innerHTML=img+" "+dojo.string.substitute(this._resourceBundle.ADD_WIDGET,[this._draggedWidgetData]);
}else{
var img="<img src='"+_5d0+"'></img>";
this._bodyNode.innerHTML=img+" "+dojo.string.substitute(this._resourceBundle.CANNOT_ADD_WIDGET,[this._draggedWidgetData]);
}
}else{
if(this.manager.canDropFlag){
var img="<img src='"+_5d1+"'></img>";
this._bodyNode.innerHTML=img+" "+dojo.string.substitute(this._resourceBundle.MOVE_WIDGET,[this._draggedWidgetData]);
}else{
var img="<img src='"+_5d0+"'></img>";
this._bodyNode.innerHTML=img+" "+dojo.string.substitute(this._resourceBundle.CANNOT_DROP_WIDGET,[this._draggedWidgetData]);
}
}
}});
}
if(!dojo._hasResource["lconn.core.feedReader"]){
dojo._hasResource["lconn.core.feedReader"]=true;
dojo.provide("lconn.core.feedReader");
lconn.core.feedReader=function(){
var _5d3=1;
var _5d4=2;
var _5d5=3;
this.COMMUNITYUUID_PARAM="communityUuid";
this.PAGESIZE_PARAM="ps";
this.PAGESIZE_VALUE="5";
this.COMM_FEEDS_WITH_FORMS="/service/atom/forms/community/feeds";
this.COMM_BOOKMARKS_WITH_FORMS="/service/atom/forms/community/bookmarks";
this.applicationContext=null;
this.resourceId=null;
this.atomFeedUrl_forms=null;
this.onLoad=function(){
if(window.debugComm!=null){
if(window.console!=null){
console.log("feedReader.js: onLoad()");
}
}
var _5d6=this.iContext.getiWidgetAttributes();
var mode=this.iContext.getiDescriptor().getItemValue("mode");
this.resourceId=_5d6.getItemValue("resourceId");
this.applicationContext=WidgetPlacementConfig.applicationContext;
var _5d8=_5d6.getItemValue("feedUrl");
if(_5d8==null){
this.iContext.getElementById("feedReaderwidgetContainer").innerHTML=dojo.i18n.getLocalization("lc_default")["feedreader.nofeed"]+"<br/>";
}else{
if(window.debugComm!=null){
if(window.console!=null){
console.log("feedReader.js: onLoad(): 1, atomFeedUrl = "+_5d8);
}
}
var _5d9=_5d3;
if(_5d8.indexOf("community/bookmarks")!=-1){
_5d9=_5d4;
_5d8=this.applicationContext+this.COMM_BOOKMARKS_WITH_FORMS+"?"+this.COMMUNITYUUID_PARAM+"="+this.resourceId+"&"+this.PAGESIZE_PARAM+"="+this.PAGESIZE_VALUE;
this.atomFeedUrl_forms=_5d8;
}else{
if(_5d8.indexOf("community/feeds")!=-1){
_5d9=_5d5;
_5d8=this.applicationContext+this.COMM_FEEDS_WITH_FORMS+"?"+this.COMMUNITYUUID_PARAM+"="+this.resourceId+"&"+this.PAGESIZE_PARAM+"="+this.PAGESIZE_VALUE;
this.atomFeedUrl_forms=_5d8;
}
}
if(typeof lastMod!="undefined"){
var _5da="?";
if(_5d8.indexOf("?")!=-1){
_5da="&";
}
_5d8=_5d8+_5da+"lastMod="+lastMod;
}
if(window.debugComm!=null){
if(window.console!=null){
console.log("feedReader.js: onLoad(): 2, atomFeedUrl = "+_5d8);
console.log("feedReader.js: onLoad(): this.atomFeedUrl_forms = "+this.atomFeedUrl_forms);
}
}
if(mode=="search"){
if(_5d9==_5d4){
var _5db="communities:bookmark";
var _5dc=this.iContext.getElementById("resultContainer");
lconn.core.widgetUtils.search(this.iContext,_5db,_5dc);
return;
}else{
if(_5d9==_5d5){
var _5db="communities:feed";
var _5dc=this.iContext.getElementById("resultContainer");
lconn.core.widgetUtils.search(this.iContext,_5db,_5dc);
return;
}
}
}
if(_5d9==_5d4){
lconn.core.utilities.show(document.getElementById("importantBookmarksSection"));
}
_5d8=lconn.core.widgetUtils.handleRefresh(_5d8,this.iContext);
if(window.debugComm!=null){
if(window.console!=null){
console.log("feedReader.js: onLoad(): 3, atomFeedUrl = "+_5d8);
}
}
var _5dd=this.iContext.io.rewriteURI(_5d8);
if(window.debugComm!=null){
if(window.console!=null){
console.log("feedReader.js: onLoad(): rewrittenAtomFeedUrl = "+_5dd);
}
}
var _5de=new Array;
if(this.iContext.getUserProfile().getItemValue("canContribute")=="true"){
_5de.push(["pm_CanContribute","true"]);
}else{
_5de.push(["pm_CanContribute","false"]);
}
_5de.push(["rs_SeeAllFeeds",dojo.i18n.getLocalization("lc_default")["feedreader.viewall"]]);
_5de.push(["rs_UpdatedBy",dojo.i18n.getLocalization("lc_default")["feedreader.updatedby"]]);
_5de.push(["rs_CreatedBy",dojo.i18n.getLocalization("lc_default")["feedreader.createdby"]]);
_5de.push(["rs_Tags",dojo.i18n.getLocalization("lc_default")["feedreader.tags"]]);
_5de.push(["pm_Icon",WidgetPlacementConfig.applicationContext+"/nav/common/styles/images/blank.gif"]);
if(_5d9==_5d4){
_5de.push(["pm_IconClass","lconnSprite lconnSprite-iconDogear16"]);
_5de.push(["rs_IconAlt",dojo.i18n.getLocalization("lc_default")["feedreader.bookmarks.logo"]]);
_5de.push(["rs_MemberNoContent",dojo.i18n.getLocalization("lc_default")["feedreader.bookmarks.membernocontent"]]);
_5de.push(["rs_MemberCreate",dojo.i18n.getLocalization("lc_default")["feedreader.bookmarks.membercreatefirst"]]);
_5de.push(["rs_MemberCreateMore",dojo.i18n.getLocalization("lc_default")["feedreader.bookmarks.membercreate"]]);
_5de.push(["pm_MemberCreateUrl",WidgetPlacementConfig.applicationContext+"/service/html/community/bookmarks?communityUuid="+this.resourceId]);
_5de.push(["rs_NoContent",dojo.i18n.getLocalization("lc_default")["feedreader.bookmarks.nocontent"]]);
}else{
if(_5d9==_5d5){
_5de.push(["pm_IconClass","lconnSprite lconnSprite-iconFeed16"]);
_5de.push(["rs_IconAlt",dojo.i18n.getLocalization("lc_default")["feedreader.feeds.logo"]]);
_5de.push(["rs_MemberNoContent",dojo.i18n.getLocalization("lc_default")["feedreader.feeds.membernocontent"]]);
_5de.push(["rs_MemberCreate",dojo.i18n.getLocalization("lc_default")["feedreader.feeds.membercreatefirst"]]);
_5de.push(["rs_MemberCreateMore",dojo.i18n.getLocalization("lc_default")["feedreader.feeds.membercreate"]]);
_5de.push(["pm_MemberCreateUrl",WidgetPlacementConfig.applicationContext+"/service/html/community/feeds?communityUuid="+this.resourceId]);
_5de.push(["rs_NoContent",dojo.i18n.getLocalization("lc_default")["feedreader.feeds.nocontent"]]);
}
}
var _5df="feedreader.xsl";
_5df=lconn.core.widgetUtils.addVersionNumber(_5df);
_5df=this.iContext.io.rewriteURI(_5df);
if(window.debugComm!=null){
if(window.console!=null){
console.log("feedReader.js: onLoad(): xsltUrl = "+_5df);
}
}
var _5e0={xmlDocUrl:_5dd,xsltUrl:_5df,htmlContainerElemId:this.iContext.getElementById("feedReaderwidgetContainer"),aXslParams:_5de,dojoErrorHandler:lconn.core.errorhandling.DefaultXHRErrorHandler,exceptionHandler:lconn.core.errorhandling.DefaultErrorHandler};
lconn.core.xslt.transformAndRender(_5e0);
var _5e1=this.iContext;
var _5e2="FeedTableContainer";
var _5e3=function(_5e4){
var _5e5=_5e4.getElementsByTagName("span");
for(var i=0;_5e5!=null&&i<_5e5.length;i++){
var _5e7=_5e5[i];
if(_5e7.getAttribute("lcNodeType")=="AtomFeedDate"){
try{
var _5e8=lconn.core.DateUtil.AtomDateToString(_5e7.innerHTML);
_5e7.innerHTML=_5e8;
}
catch(exception){
lconn.core.errorhandling.DefaultErrorHandler("lconn.core.feedReader.onLoad",exception,_5e0);
}
}
}
if(window.SemTagSvc!=null){
SemTagSvc.parseDom(null,_5e4);
}
};
lconn.core.utilities.processUntilElementIsFound(_5e2,_5e3,this.iContext);
}
};
this.onRemoveWidgetUIContent=function(){
var _5e9=this.iContext.getiWidgetAttributes();
var _5ea=_5e9.getItemValue("feedUrl");
if(_5ea!=null&&_5ea.indexOf("community/bookmarks")!=-1){
lconn.core.utilities.hide(document.getElementById("importantBookmarksSection"));
}
};
this.closeNewItemsUI=function(_5eb){
this.clearAllFields(_5eb);
this.iContext.iEvents.fireEvent("onModeChanged","","{'newMode': '"+this.iContext.constants.mode.VIEW+"'}");
};
this.clearAllFields=function(_5ec){
var form=findParentForm(_5ec);
form.feedURL.value=null;
};
this.onedit=function(){
var _5ee=this.iContext.getiWidgetAttributes();
var _5ef=_5ee.getItemValue("widgetTitle");
var _5f0=_5ee.getItemValue("feedUrl");
if(_5ef!=null){
this.iContext.getElementById("widgetTitle").value=_5ef;
}
if(_5f0!=null){
this.iContext.getElementById("feedURL").value=_5f0;
}
};
this.saveAttribute=function(_5f1){
var form=findParentForm(_5f1);
var _5f3=this.iContext.getiWidgetAttributes();
_5f3.setItemValue("widgetTitle",form.widgetTitle.value);
_5f3.setItemValue("feedUrl",form.feedURL.value);
_5f3.save();
this.closeNewItemsUI(_5f1);
this.onLoad();
};
};
}
if(!dojo._hasResource["lconn.core.ActivityList"]){
dojo._hasResource["lconn.core.ActivityList"]=true;
dojo.provide("lconn.core.ActivityList");
lconn.core.ActivityList=function(){
this.activityBaseUrl=null;
this.stylesheets={};
this.feeds={};
this.showCompleted=false;
this.isFullpage=false;
this.defaultPaging=5;
this.defaultPagingFull=10;
this.defaultHistoryItems=5;
this.onLoad=function onLoad(){
var wa=this.iContext.getiWidgetAttributes();
this.activityBaseUrl=wa.getItemValue("activityBaseUrl");
this.communityUUID=wa.getItemValue("resourceId");
var up=this.iContext.getUserProfile();
this.isLoggedIn=up.getItemValue("userId");
this.isOwner=up.getItemValue("canPersonalize")=="true";
this.isContributor=up.getItemValue("canContribute")=="true";
var mode=this.iContext.getiDescriptor().getItemValue("mode");
this.isFullpage=(mode=="fullpage");
if(!this.activityBaseUrl){
throw ("lconn.core.ActivityList has been loaded without the required activityBaseUrl attribute");
}
this.cPath=wa.getItemValue("cPath");
if(mode=="search"){
var _5f7="communities:activities";
var _5f8=this.iContext.getElementById("resultContainer");
lconn.core.widgetUtils.search(this.iContext,_5f7,_5f8);
}else{
var res=new lconn.core.Res();
res.loadDefaultBundle();
this.strBundle=res.resBundle;
this.strBundle.cPath=this.cPath;
if(this.isFullpage){
this.pageSize=wa.getItemValue("activitiesPerPageFullpage")||this.defaultPagingFull;
}else{
this.pageSize=wa.getItemValue("activitiesPerPage")||this.defaultPaging;
}
this.numHistoryItems=wa.getItemValue("numHistoryItems")||this.defaultHistoryItems;
this.pageNum=1;
this.getFeed("activities");
}
};
this.getFeed=function getFeed(_5fa){
var xslt,_5fc,feed=this.activityBaseUrl+"/service/atom2/";
if(this.isLoggedIn){
feed+="forms/";
}
var _5fe=(window.WidgetPlacementConfig&&WidgetPlacementConfig.params)?WidgetPlacementConfig.params["version"]:null;
_5fe="?version="+_5fe;
switch(_5fa){
case "activities":
xslt="activitySummary.xsl"+_5fe;
feed+="activities?tunedout=yes&ps="+this.pageSize+"&page="+this.pageNum+"&isMember="+this.isContributor;
if(this.communityUUID){
feed+="&commUuid="+this.communityUUID;
}
_5fc="activityList";
break;
case "history":
xslt="activityHistory.xsl"+_5fe;
var uuid=arguments[1];
feed+="activity/history?ps="+this.numHistoryItems+"&activityUuid="+uuid;
_5fc=uuid+"-historyList";
break;
}
feed+="&public=yes";
if(!this.isLoggedIn){
feed+="&authenticate=no";
}
this.showLoading(_5fc,true);
this.stylesheets[feed]=null;
this.feeds[feed]=null;
var _600={url:this.iContext.io.rewriteURI(xslt),load:dojo.hitch(this,function loadStylesheetFunct(_601,_602){
this.stylesheets[feed]=_601;
if(this.feeds[feed]){
this.transform(this.feeds[feed],this.stylesheets[feed],_5fc,_5fa);
}
}),handleAs:"xml",error:dojo.hitch(this,"loadError"),htmlContainerElemId:_5fc};
dojo.xhrGet(_600);
var _603=dojo.hitch(this,function loadFeedFunct(_604,_605){
if(dojo.isIE&&!_604.xml){
try{
_604=new ActiveXObject("Microsoft.XMLDOM");
_604.async="false";
_604.loadXML(_605.xhr.responseText);
}
catch(err){
lconn.core.errorhandling.DefaultErrorHandler("",err,_5fc);
return;
}
}
this.feeds[feed]=_604;
if(this.stylesheets[feed]){
this.transform(this.feeds[feed],this.stylesheets[feed],_5fc,_5fa);
}
});
var _606={url:this.iContext.io.rewriteURI(feed),load:_603,handleAs:"xml",error:dojo.hitch(this,"loadError"),htmlContainerElemId:_5fc};
dojo.xhrGet(_606);
};
this.transform=function transform(xml,xsl,_609,_60a){
this.showLoading(_609,false);
var html;
try{
if(window.ActiveXObject){
html=xml.transformNode(xsl);
}else{
if(document.implementation&&document.implementation.createDocument){
var _60c=new XSLTProcessor();
_60c.importStylesheet(xsl);
var _60d=_60c.transformToFragment(xml,document);
var tmp=document.createElement("span");
tmp.appendChild(_60d);
html=tmp.innerHTML;
}
}
}
catch(err){
lconn.core.errorhandling.DefaultErrorHandler("",err,_609);
return;
}
html=dojo.string.substitute(html,this.strBundle);
this.iContext.getElementById(_609).innerHTML=this.iContext.processMarkup(html);
this.getElementsByClass("escapedMarkup").forEach(function(elt){
elt.innerHTML=elt.firstChild.textContent;
dojo.removeClass(elt,"escapedMarkup");
});
this.getElementsByClass("unconvertedNewline").forEach(function(elt){
elt.innerHTML=elt.innerHTML.replace(/\n/g,"<br>\n");
dojo.removeClass(elt,"unconvertedNewline");
});
this.getElementsByClass("atomDate").forEach(function(_611){
dojo.removeClass(_611,"atomDate");
var date=this.parseDate(_611.innerHTML);
var _613=_611.parentNode.className||"";
if(_613.indexOf("updatedSection")!=-1){
dojo.removeClass(_611.parentNode,"updatedSection");
var _614=_611.parentNode;
_614.removeChild(_611);
_614.innerHTML=dojo.string.substitute(this.strBundle.rs_actUpdatedBy,[_614.innerHTML,lconn.core.DateUtil.toString(date)]);
}else{
if(_611.className.indexOf("dueDate")!=-1){
_611.innerHTML=dojo.string.substitute(this.strBundle.rs_actDue,[lconn.core.DateUtil.toString(date,true)]);
var _615=new Date();
if(date<_615){
if(dojo.locale.indexOf("el")==0){
_611.className="dueDateLateNoTransform";
}else{
_611.className="dueDateLate";
}
}
}else{
_611.innerHTML=lconn.core.DateUtil.toString(date);
}
}
},this);
if(window.SemTagSvc&&SemTagSvc.parseDom){
SemTagSvc.parseDom(0,this.iContext.getRootElement());
}
dojo.query(".activityLink",this.iContext.getRootElement()).forEach(function(node){
node.href=this.activityBaseUrl+node.getAttribute("url");
},this).removeClass("activityLink");
dojo.query(".communityImage",this.iContext.getRootElement()).forEach(function(node){
node.src=this.cPath+node.getAttribute("url");
},this).removeClass("communityImage");
if(_60a=="activities"){
if(this.iContext.getElementById("totalResults")){
var _618=this.iContext.getElementById("totalResults").innerHTML*1;
var _619=this.iContext.getElementById("numEntries").innerHTML*1;
var _61a=((this.pageNum-1)*this.pageSize)+1;
var _61b=_61a+_619-1;
dojo.query(".pagePos",this.iContext.getRootElement()).addContent(dojo.string.substitute(this.strBundle.rs_pagepos,[_61a,_61b,_618]));
}
if(this.isFullpage){
this.iContext.getElementById("widgetHeadline").style.display="";
var prev=document.createElement("li");
prev.className="lotusFirst";
var link=document.createTextNode(this.strBundle.rs_navPrevLabel);
if(this.iContext.getElementById("hasPrevious")){
var text=link;
link=document.createElement("a");
link.className="prevLink";
link.href="javascript:;";
link.appendChild(text);
}
prev.appendChild(link);
var _61f=dojo.query(".pageNav",this.iContext.getRootElement());
_61f.addContent(prev);
var next=document.createElement("li");
link=document.createTextNode(this.strBundle.rs_navNextLabel);
if(this.iContext.getElementById("hasNext")){
var text=link;
link=document.createElement("a");
link.className="nextLink";
link.href="javascript:;";
link.appendChild(text);
}
next.appendChild(link);
_61f.addContent(next);
_61f.query(".prevLink").onclick(dojo.hitch(this,"prev"));
_61f.query(".nextLink").onclick(dojo.hitch(this,"next"));
if(_618){
this.iContext.getElementById("activityBottomPaging").style.display="";
this.iContext.getElementById("activityTopPaging").style.display="";
}else{
this.iContext.getElementById("noActivitiesTable").style.display="none";
}
this.iContext.getElementById("activityFeeds").style.display="";
var _621=this.iContext.getElementById("activityCompletedLink");
_621.href=this.activityBaseUrl+"/service/html/mainpage#dashboard,search,completed=only,public=yes,commUuid="+this.communityUUID;
}else{
if(_618>this.pageSize){
this.iContext.getElementById("viewAllActivities").style.display="";
}
}
if(this.isContributor){
var _622=this.iContext.getElementById("startActivity");
var link=document.createElement("a");
link.href=this.activityBaseUrl+"/service/html/mainpage#communityActivityForm,"+this.communityUUID;
link.innerHTML=_622.innerHTML;
var span=document.createElement("span");
span.className=link.className=this.isFullpage?"lotusBtn lotusBtnAction":"lotusAction";
span.appendChild(link);
_622.innerHTML="";
_622.appendChild(span);
_622.style.display="";
if(!_618&&!this.isFullpage){
this.iContext.getElementById("noActivities").style.display="none";
this.iContext.getElementById("noActivitiesCanCreate").style.display="";
}
}
}else{
dojo.query(".vcard .fn.person",_609).onclick(dojo.hitch(this,"handleEMailLink"));
}
};
this.handleEMailLink=function handleEMailLink(_624){
_624=dojo.fixEvent(_624);
var url=this.activityBaseUrl+"/service/html/mainpage#dashboard,search,"+_624.target.hash.substring(1);
window.location=url;
return false;
};
this.handleTagLink=function handleTagLink(_626){
_626=dojo.fixEvent(_626);
var url=this.activityBaseUrl+"/service/html/mainpage#dashboard,search,tag="+_626.target.innerHTML;
window.location=url;
return false;
};
this.handleMoreDescription=function handleMoreDescription(_628,url,type){
_628=dojo.fixEvent(_628);
var id=_628.target.parentNode.id;
dojo.xhrGet({url:this.iContext.io.rewriteURI(url),load:function loadDescr(_62c,_62d){
document.getElementById(id).innerHTML=_62c.replace(/\n/g,"<br>\n");
},handleAs:"text",error:dojo.hitch(this,"loadError"),htmlContainerElemId:id});
};
this.toggleDetails=function toggleDetails(id,_62f){
_62f=dojo.fixEvent(_62f);
var _630=this.iContext.getElementById(id+"-details");
var _631="none";
var _632=this.strBundle.rs_more;
var _633="lotusIconShow";
var _634="lotusIconHide";
if(_630.style.display==_631){
_631="";
_632=this.strBundle.rs_hide;
_634="lotusIconShow";
_633="lotusIconHide";
}
_630.style.display=_631;
var _635=dojo.query(".latestUpdate",this.iContext.getElementById(id+"-summary"));
_635[0].style.display=(_631?"":"none");
_62f.target.alt=_62f.target.parentNode.title=_632;
dojo.removeClass(_62f.target,_634);
dojo.addClass(_62f.target,_633);
dojo.query(".lotusAltText",_62f.target.parentNode)[0].innerHTML=_632;
var _636=this.iContext.getElementById(id+"-historyList");
_636.style.display=_631;
if(dojo.query(".historyNotLoaded",_636).length){
this.getFeed("history",id);
}
return false;
};
this.loadError=function loadError(_637,_638){
this.showLoading(_638.args.htmlContainerElemId,false);
_638.args.xsltArgs={htmlContainerElemId:_638.args.htmlContainerElemId};
lconn.core.errorhandling.DefaultXHRErrorHandler(_637,_638);
};
this.showLoading=function showLoading(_639,show){
var _63b=this.iContext.getElementById(_639+"-progressIndicator");
if(!_63b&&show){
var elt=this.iContext.getElementById(_639);
_63b=document.createElement("div");
_63b.id=_639+"-progressIndicator";
_63b.innerHTML=this.strBundle.rs_loading;
elt.appendChild(_63b);
}else{
if(!show&&_63b){
_63b.parentNode.removeChild(_63b);
}
}
};
this.next=function next(){
++this.pageNum;
this.getFeed("activities");
return false;
};
this.prev=function prev(){
--this.pageNum;
this.getFeed("activities");
return false;
};
this.showFullpage=function showFullPage(){
this.iContext.iEvents.fireEvent("onModeChanged","","{'newMode': 'fullpage'}");
return false;
};
this.parseDate=function parseDate(s){
var _63e=s.indexOf("-");
s=s.substring(_63e-4);
var y=parseInt(s.substr(0,4));
var m=parseInt(s.substr(5,2),10)-1;
var d=parseInt(s.substr(8,2),10);
var h=parseInt(s.substr(11,2),10);
var mi=parseInt(s.substr(14,2),10);
var se=parseInt(s.substr(17,2),10);
return new Date(Date.UTC(y,m,d,h,mi,se));
};
this.getElementsByClass=function getElementsByClass(name,node){
return dojo.query("."+name,node||this.iContext.getRootElement());
};
};
}
if(!dojo._hasResource["lconn.comm.ronin.AjaxRequestsHandler"]){
dojo._hasResource["lconn.comm.ronin.AjaxRequestsHandler"]=true;
dojo.provide("lconn.comm.ronin.AjaxRequestsHandler");
dojo.declare("lconn.comm.ronin.AjaxRequestsHandler",null,{constructor:function(){
},_needsProxy:function(url,_648){
if(!dojo.isString(url)){
return;
}
var _649=/https?:\/\/([^\/:]*)(:[0-9]+)?(?:\/.*)?/;
if(!_649.test(url)){
return false;
}
var _64a=url.replace(_649,"$2");
_64a=_64a==""?":80":_64a;
var _64b=_648.replace(_649,"$2");
_64b=_64b==""?":80":_64b;
if(_64a!=_64b){
return true;
}
var _64c=_648.replace(_649,"$1");
var _64d=url.replace(_649,"$1");
return (_64c!=_64d&&_64d!="");
},rewriteUrl:function(url,_64f){
_64f=_64f?_64f:proxyUrl;
if(!dojo.isString(url)){
return;
}
if(!this._needsProxy(url,_64f)){
return url;
}
var _650=/(https?):\/\/([^\/:]*)(:[0-9]+)?(\/.*)?/;
var _651=_64f+url.replace(_650,"$1/$2$3$4");
return _651;
},xhrGet:function(_652){
_652.url=this.rewriteUrl(_652.url);
var req=dojo.xhrGet(_652);
return req;
},xhrPost:function(_654){
_654.url=this.rewriteUrl(_654.url);
return dojo.xhrPost(_654);
}});
}
if(!dojo._hasResource["lconn.comm.ronin.extendedData"]){
dojo._hasResource["lconn.comm.ronin.extendedData"]=true;
dojo.provide("lconn.comm.ronin.extendedData");
dojo.declare("lconn.comm.ronin.extendedData",null,{constructor:function(type,_656,_657,_658){
this.type=type;
this.elemId=_656;
this.attrName=_657;
this.value=_658;
}});
}
if(!dojo._hasResource["lconn.comm.ronin.feedMapping"]){
dojo._hasResource["lconn.comm.ronin.feedMapping"]=true;
dojo.provide("lconn.comm.ronin.feedMapping");
dojo.declare("lconn.comm.ronin.feedMapping",null,{constructor:function(type,_65a,_65b,_65c){
this.prefPathIndex=0;
this.type=type;
this.elemId=_65a;
this.paths=_65b.split(",");
this.attrName=_65c;
}});
}
if(!dojo._hasResource["lconn.comm.ronin.feedType"]){
dojo._hasResource["lconn.comm.ronin.feedType"]=true;
dojo.provide("lconn.comm.ronin.feedType");
dojo.declare("lconn.comm.ronin.feedType",null,{constructor:function(type,_65e){
this.type=type;
this.version=_65e;
},getType:function(){
return this.type;
},getVersion:function(){
return this.version;
}});
}
if(!dojo._hasResource["lconn.comm.ronin.post"]){
dojo._hasResource["lconn.comm.ronin.post"]=true;
dojo.provide("lconn.comm.ronin.post");
dojo.declare("lconn.comm.ronin.post",null,{EXPANDED:1,COLLAPSED:2,EXPAND_LIMIT:10,REPLY_TEMPLATE_DIV:"reply_template_div",LOAD_POST_EVENT:"loadpost",FIELD_MAPPING:1,ATTRIBUTE_MAPPING:2,PROPERTY_MAPPING:3,DELETED_ENTRY:"[[D]]",constructor:function(_65f,_660,_661,_662){
this.thread=_65f;
this.postNum=_661;
this.postId=_65f.id+"_post_"+_661;
this.guid=null;
this.parentId=null;
this.subject=null;
this.author=null;
this.author_mail=null;
this.author_userid=null;
this.published=null;
this.updated=null;
this.published_modified=null;
this.delete_published=null;
this.delete_deleted=null;
this.duration=null;
this.updated=null;
this.summary=null;
this.subtitle=null;
this.bodyUrl=null;
this.body=null;
this.extData=null;
this.expanded=false;
this.container=null;
this.owner=false;
this.replyForm=null;
this.replyRte=null;
this.replyEnabled=false;
this.editLink=null;
this.editForm=null;
this.editRte=null;
this.editEnabled=false;
this.edited=false;
this.editInProgress=false;
this.deleteForm=null;
this.deleteRte=null;
this.deleteEnabled=false;
this.deleted=false;
this.moreLink=null;
this.moreEnabled=false;
this.moreText=null;
this.moreExpanded=false;
var _663=null;
var _664="";
var idx;
for(var ii=1;ii<this.thread.fieldMapping.length;ii++){
var _667=this.thread.fieldMapping[ii];
var _668=lconn.comm.ronin.utils.prototype.findPreferredFeedFieldValue(_662,_667,"alternate",this.thread.baseURL);
switch(_667.elemId){
case "post_subject":
this.subject=_668;
break;
case "post_author":
this.author=_668;
break;
case "post_author_mail":
this.author_mail=_668;
break;
case "post_author_userid":
this.author_userid=_668;
break;
case "post_published":
this.published=_668;
break;
case "post_updated":
this.updated=_668;
break;
case "post_published_modified":
this.published_modified=_668;
break;
case "post_delete_published":
this.delete_published=_668;
break;
case "post_delete_deleted":
this.delete_deleted=_668;
break;
case "post_duration":
this.duration=_668;
break;
case "post_summary":
this.summary=this.adjustLinks(_668,this.thread.baseURL);
break;
case "post_subtitle":
this.subtitle=_668;
break;
case "post_body_url":
this.bodyUrl=_668;
break;
case "post_body_text":
this.body=this.adjustLinks(_668,this.thread.baseURL);
break;
default:
if(this.extData==null){
this.extData=new Array();
}
this.extData[this.extData.length]=new lconn.comm.ronin.extendedData(_667.type,_667.elemId,_667.attrName,_668);
break;
}
}
this.guid=lconn.comm.ronin.utils.prototype.findFeedFieldValue(_662,"entry/id");
if(this.guid!=null){
idx=this.guid.lastIndexOf(":");
if(idx>-1){
this.guid=this.guid.substring(idx+1);
}
}
this.moreLink=lconn.comm.ronin.utils.prototype.findFeedFieldValue(_662,"entry/link@href","enclosure",this.thread.baseURL);
if(this.moreLink.length==0){
this.moreLink=null;
}
this.editLink=lconn.comm.ronin.utils.prototype.findFeedFieldValue(_662,"entry/link@href","edit",this.thread.baseURL);
if(this.editLink.length==0){
this.editLink=null;
}
if(this.thread.layout=="INDENTED"){
if(this.guid!=null&&this.guid.length!=0){
this.thread.postIdLookup[this.guid]=this.postId;
}
var _669=lconn.comm.ronin.utils.prototype.getElementsByTagNameNS(_662,"http://purl.org/syndication/thread/1.0","thr","in-reply-to");
if(_669!=null&&_669.length!=0){
this.parentId=_669[0].getAttribute("ref");
idx=this.parentId.lastIndexOf(":");
if(idx>-1){
this.parentId=this.parentId.substring(idx+1);
}
}
}
if(this.subject!=null&&this.subject.indexOf(this.DELETED_ENTRY)==0){
this.setDeleted(true);
idx=this.DELETED_ENTRY.length;
this.subject=this.subject.substring(idx);
}else{
_664=lconn.comm.ronin.utils.prototype.findFeedFieldValue(_662,"entry/snx:permissions");
if(_664.length==0){
_664=lconn.comm.ronin.utils.prototype.findFeedFieldValue(_662,"entry/permissions");
}
this.setPermissions(_664);
this.updated=lconn.comm.ronin.utils.prototype.findFeedFieldValue(_662,"entry/updated");
var publ=lconn.comm.ronin.utils.prototype.findFeedFieldValue(_662,"entry/published");
if(this.updated.length>0&&publ.length>0){
this.setEdited(this.updated!=publ);
}
}
this.setOwner(this.author==_660);
},adjustLinks:function(text,_66c){
var _66d=text;
_66d=_66d.replace(/&lt;/g,"<").replace(/&gt;/g,">");
if(window.ActiveXObject){
var _66e=/(<\s*(a|img)\s+[^>]*(href|src)\s*=\s*[\"'])(?!http)([^\"'>]+)[\"'>]/gi;
var _66f=_66d.match(_66e);
if(_66f!=null){
for(var i=0;i<_66f.length;i++){
var _671=_66f[i].split("\"/");
_66d=_66d.replace(_66f[i],_671[0]+"\""+_66c+"/"+_671[1]);
}
}
}else{
var _672=document.createElement("div");
_672.innerHTML=_66d;
var _673=_672.getElementsByTagName("*");
for(var i=0;i<_673.length;i++){
var _674=_673[i].nodeName.toLowerCase();
if(_674=="a"){
var _675=_673[i].getAttribute("href",2);
if(_675!=null&&_675!=""){
_675=dojo.trim(_675);
var _676=_675.split("/");
if(_676[0].length==0){
_675=_66c+_675;
_673[i].setAttribute("href",_675);
}
}
}else{
if(_674=="img"){
var _677=_673[i].getAttribute("src",2);
if(_677!=null&&_677!=""){
_677=dojo.trim(_677);
var _678=_677.split("/");
if(_678[0].length==0){
_677=_66c+_677;
_673[i].setAttribute("href",_677);
}
}
}
}
}
_66d=_672.innerHTML;
}
return _66d;
},setPermissions:function(_679){
if(_679!=null){
if((_679.indexOf("add_child,")!=-1)&&this.thread.config.context!="TOPIC"){
this.replyEnabled=true;
}
if((_679.indexOf("edit,")!=-1)){
this.editEnabled=true;
}
if((_679.indexOf("delete,")!=-1)){
this.deleteEnabled=true;
}
}
if(this.moreLink!=null){
this.moreEnabled=true;
}
},getOwner:function(){
return this.owner;
},setOwner:function(_67a){
this.owner=_67a;
},getEdited:function(){
return this.edited;
},setEdited:function(_67b){
this.edited=_67b;
},displayEditHistory:function(){
if(this.container!=null){
var _67c=lconn.comm.ronin.utils.prototype.getElementById(this.container,"post_edit_history_"+this.postId);
if(_67c==null){
return;
}
if(this.edited==true){
_67c.style.display="";
}else{
_67c.style.display="none";
}
}
},getDeleted:function(){
return this.deleted;
},setDeleted:function(_67d){
this.deleted=_67d;
},displayDeleteHistory:function(){
if(this.container!=null){
var _67e=lconn.comm.ronin.utils.prototype.getElementById(this.container,"post_entry_"+this.postId);
var _67f=lconn.comm.ronin.utils.prototype.getElementById(this.container,"post_delete_history_"+this.postId);
if(_67f!=null){
if(this.deleted==true){
if(_67e!=null){
_67e.style.display="none";
}
_67f.style.display="";
}else{
_67f.style.display="none";
if(_67e!=null){
_67e.style.display="";
}
}
}
}
},insertPost:function(_680){
if(this.thread.layout=="INDENTED"){
this.insertPostIndented(_680);
}else{
if(this.thread.layout=="FLAT"){
this.insertPostFlat(_680);
}
}
this.displayDeleteHistory();
this.displayEditHistory();
},insertPostIndented:function(_681){
if((this.parentId!=null)&&(lconn.comm.ronin.utils.prototype.getElementById(_681,this.parentId)!=null)){
var _682=lconn.comm.ronin.utils.prototype.getElementById(_681,this.parentId);
if(_682.parentNode.childNodes.length>1){
var _683=_682.parentNode.childNodes[_682.parentNode.childNodes.length-1];
this.insertPostFlat(_683);
}else{
var _684=document.createElement("ul");
this.insertPostFlat(_684);
_682.parentNode.appendChild(_684);
}
}else{
if(_681==null){
_681=document.createElement("ul");
document.getElementById(this.thread.container).appendChild(_681);
}
this.insertPostFlat(_681);
}
},insertPostFlat:function(_685){
var _686=_685.childNodes;
var _687=document.createElement("li");
if(this.thread.layout=="INDENTED"){
_687.className="lotusIndent20";
}
var _688=this.clonePostTemplate();
if(_688!=null){
_688.postObj=this;
this.container=_688;
_687.appendChild(_688);
_685.appendChild(_687);
this.thread.triggerEvent(this.LOAD_POST_EVENT,_688.postObj,_688);
}
},loadTemplate:function(_689,_68a){
var _68b=_689;
var req=new lconn.comm.ronin.AjaxRequestsHandler().xhrGet({url:_68b,error:dojo.hitch(this,this.handleError),handleAs:"text"});
req.addCallback(this,_68a);
},clonePostTemplate:function(){
var _68d=document.getElementById(this.thread.postTemplateDivName);
if(_68d==null){
_68d=this.thread.addTemplateToDOM(this.thread.postTemplateDivName);
}
var _68e=lconn.comm.ronin.utils.prototype.getElementById(_68d,"post_template");
var _68f=_68e.cloneNode(true);
var file=null;
var idx=-1;
var subj=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_subject");
if(subj!=null){
subj.innerHTML=(this.thread.config.enableAcf)?lconn.comm.ronin.utils.prototype.Sanitizer.escapeAllTags(this.subject):this.subject;
}
var auth=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_author");
if(auth!=null){
auth.innerHTML=(this.thread.config.enableAcf)?lconn.comm.ronin.utils.prototype.Sanitizer.escapeAllTags(this.author):this.author;
if(this.thread.authorVisible!=true){
auth.style.display="none";
}else{
auth.innerHTML=auth.innerHTML+"&nbsp;";
}
}
var _694=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_author_mail");
if(_694!=null){
_694.innerHTML=this.author_mail;
}
var _695=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_author_userid");
if(_695!=null){
_695.innerHTML=this.author_userid;
}
var publ=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_published");
if(publ!=null){
publ.innerHTML=this.convertDate(this.published)+"<br/>";
}
var _697=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_published_modified");
if(_697!=null){
_697.innerHTML=this.published_modified+"<br/>";
}
var _698=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_updated");
if(_698!=null){
_698.innerHTML=this.convertDate(this.updated)+"<br/>";
}
var _699=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_delete_published");
if(_699!=null){
_699.innerHTML=this.convertDate(this.delete_published)+"<br/>";
}
var _69a=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_delete_deleted");
if(_69a!=null){
_69a.innerHTML=this.convertDate(this.delete_published)+"<br/>";
}
var dur=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_duration");
if(dur!=null){
dur.innerHTML=this.duration;
}
var summ=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_summary");
if(summ!=null){
summ.innerHTML=this.summary;
}
var subt=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_subtitle");
if(subt!=null){
subt.innerHTML=this.subtitle;
}
var _69e=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_body_text");
if(_69e!=null){
_69e.innerHTML=this.body;
}
this.handleExtData(_68f);
var _69f=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_expand");
if(_69f){
dojo.connect(_69f,"onclick",this,"expandPost");
}
var _6a0=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_collapse");
if(_6a0){
dojo.connect(_6a0,"onclick",this,"collapsePost");
}
var more=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_more");
if(more){
if(this.isMoreEnabled()){
dojo.connect(more,"onclick",this,"morePost");
more.style.display="";
}else{
more.style.display="none";
}
}
var less=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_less");
if(less){
if(this.isMoreEnabled()){
dojo.connect(less,"onclick",this,"lessPost");
}
}
var _6a3=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_reply");
if(_6a3){
if(this.isReplyEnabled()){
dojo.connect(_6a3,"onclick",this,"replyPost");
_6a3.parentNode.style.display="";
_6a3.parentNode.className="lotusFirst";
}else{
_6a3.parentNode.style.display="none";
}
}
var edit=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_edit");
if(edit){
if(this.isEditEnabled()){
dojo.connect(edit,"onclick",this,"editPost");
edit.parentNode.style.display="";
if(!this.isReplyEnabled()){
edit.parentNode.className="lotusFirst";
}
}else{
edit.parentNode.style.display="none";
}
}
var del=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_delete");
if(del){
if(this.isDeleteEnabled()){
dojo.connect(del,"onclick",this,"deletePost");
del.parentNode.style.display="";
}else{
del.parentNode.style.display="none";
}
}
if(this.getOwner()==true){
var _6a6=lconn.comm.ronin.utils.prototype.getElementById(_68f,"post_number_"+this.postId);
if(_6a6){
_6a6.parentNode.className="post_number_owner";
}
}
var _6a7="_"+this.postId;
lconn.comm.ronin.utils.prototype.makeIdsUnique(_68f,_6a7);
_68f.id=this.postId;
return _68f;
},handleExtData:function(_6a8){
if(this.extData!=null){
for(var ii=0;ii<this.extData.length;ii++){
var _6aa=this.extData[ii];
var elem=lconn.comm.ronin.utils.prototype.getElementById(_6a8,_6aa.elemId);
if(elem==null){
elem=lconn.comm.ronin.utils.prototype.getElementById(_6a8,_6aa.elemId+"_"+this.postId);
updated=true;
}
if(elem!=null){
if(_6aa.type==this.FIELD_MAPPING){
elem.innerHTML=(this.thread.config.enableAcf)?lconn.comm.ronin.utils.prototype.Sanitizer.run(_6aa.value):_6aa.value;
}else{
if(_6aa.type==this.ATTRIBUTE_MAPPING){
elem.setAttribute(_6aa.attrName,_6aa.value);
}else{
if(_6aa.type==this.PROPERTY_MAPPING){
elem.innerHTML=this.postId;
}
}
}
}
}
}
},isReplyEnabled:function(){
return this.replyEnabled;
},isEditEnabled:function(){
return this.editEnabled;
},isDeleteEnabled:function(){
return this.deleteEnabled;
},isMoreEnabled:function(){
return this.moreEnabled;
},togglePostBody:function(){
if(this.expanded){
this.collapsePost();
}else{
this.expandPost();
}
return;
},expandPost:function(){
var _6ac=dojo.byId("post_summary_"+this.postId);
var _6ad=dojo.byId("post_body_"+this.postId);
var _6ae=dojo.byId("post_expand_"+this.postId);
var _6af=dojo.byId("post_collapse_"+this.postId);
if(_6ad!=null){
_6ad.style.display="";
}
if(_6ac!=null){
_6ac.style.display="none";
}
if(_6ae!=null&&_6af!=null){
_6ae.style.display="none";
_6af.style.display="";
}
this.expanded=true;
},loadPostBody:function(){
var _6b0=this.bodyUrl;
var _6b1=this.bodyUrl.indexOf("byId");
if(_6b1>-1&&_6b1<2){
_6b0=this.thread.contextURL+this.bodyUrl;
}
dojo.io.bind({url:_6b0,load:function(type,data,evt){
this.parseBodyXMLResponse(data);
},error:function(type,_6b6){
this.handleError(type,_6b6);
},mimetype:"text/plain"});
},collapsePost:function(){
var _6b7=lconn.comm.ronin.utils.prototype.getElementById(this.thread.threadRoot,"post_summary_"+this.postId);
var _6b8=lconn.comm.ronin.utils.prototype.getElementById(this.thread.threadRoot,"post_body_"+this.postId);
var _6b9=dojo.byId("post_expand_"+this.postId);
var _6ba=dojo.byId("post_collapse_"+this.postId);
if(_6b8!=null){
_6b8.style.display="none";
}
if(_6b7!=null){
_6b7.style.display="";
}
if(_6b9!=null&&_6ba!=null){
_6ba.style.display="none";
_6b9.style.display="";
}
this.expanded=false;
},parseBodyXMLResponse:function(_6bb){
this.parseBodyXML(_6bb.documentElement);
var _6bc=document.getElementById(this.postId);
lconn.comm.ronin.utils.prototype.getElementById(_6bc,"post_body_text_"+this.postId).innerHTML=this.body;
lconn.comm.ronin.utils.prototype.getElementById(_6bc,"post_body_"+this.postId).style.display="";
},parseBodyXML:function(dom){
var _6be=dom.getElementsByTagName("entry");
var body=_6be[0].getElementsByTagName("body")[0].childNodes[0].nodeValue;
this.body=body;
},morePost:function(e){
console.log("ronin.morePost");
this.retrievePost();
lconn.comm.ronin.utils.prototype.cancelClick(e);
return false;
},retrievePost:function(e){
console.log("ronin.retrievePost");
var req=null;
if(this.thread.config.dojoCache){
req=new lconn.comm.ronin.AjaxRequestsHandler().xhrGet({url:this.moreLink+"?authenticate=no&public=yes",error:dojo.hitch(this,this.handleError),preventCache:true,handleAs:"text"});
}else{
req=new lconn.comm.ronin.AjaxRequestsHandler().xhrGet({url:this.moreLink+"?authenticate=no&public=yes",error:dojo.hitch(this,this.handleError),handleAs:"text"});
}
req.addCallback(this,"parseMoreResponse");
return;
},parseMoreResponse:function(_6c3){
console.log("ronin.parseMoreResponse");
this.moreText=_6c3;
var _6c4=document.getElementById("post_body_text_"+this.postId);
if(_6c4!=null){
_6c4.innerHTML=this.moreText;
}
var more=document.getElementById("post_more_"+this.postId);
if(more!=null){
more.style.display="none";
}
var less=document.getElementById("post_less_"+this.postId);
if(less!=null){
less.style.display="";
}
if(this.editInProgress){
this.initEdit();
}
return;
},lessPost:function(e){
console.log("ronin.lessPost");
var _6c8=document.getElementById("post_body_text_"+this.postId);
if(_6c8!=null){
_6c8.innerHTML=this.body;
}
var less=document.getElementById("post_less_"+this.postId);
if(less!=null){
less.style.display="none";
}
var more=document.getElementById("post_more_"+this.postId);
if(more!=null){
more.style.display="";
}
lconn.comm.ronin.utils.prototype.cancelClick(e);
return false;
},replyPost:function(e){
console.log("ronin.replyPost");
this.insertReplyForm();
lconn.comm.ronin.utils.prototype.cancelClick(e);
return false;
},insertReplyForm:function(){
console.log("ronin.insertReplyForm");
if(this.thread.isReplyTemplateLoaded()){
var _6cc=document.getElementById(this.postId);
this.replyForm=this.cloneReplyTemplate();
var _6cd=document.createElement("ul");
var _6ce=document.createElement("li");
_6ce.appendChild(this.replyForm);
_6cd.appendChild(_6ce);
if(_6cc!=null){
if(_6cc.parentNode.childNodes.length>1){
_6cc.parentNode.insertBefore(_6cd,_6cc.parentNode.childNodes[1]);
this.showReply();
}else{
_6cc.parentNode.appendChild(_6cd);
this.showReply();
}
}
}else{
this.loadTemplate(this.thread.config.replyTemplate,this.insertReplyTemplate);
}
},insertReplyTemplate:function(_6cf){
console.log("ronin.insertReplyTemplate");
var _6d0=document.getElementById(this.thread.replyTemplateDivName);
if(_6d0==null){
_6d0=this.thread.addTemplateToDOM(this.thread.replyTemplateDivName);
}
_6d0.innerHTML=_6cf;
this.thread.replyTemplateLoaded=true;
this.insertReplyForm();
},cloneReplyTemplate:function(){
var _6d1=document.getElementById(this.thread.replyTemplateDivName);
var _6d2=_6d1.cloneNode(true);
_6d2.id="reply";
var _6d3=lconn.comm.ronin.utils.prototype.getElementById(_6d2,"reply_ok_btn");
if(_6d3!=null){
dojo.connect(_6d3,"onclick",this,"submitReply");
}
var _6d4=lconn.comm.ronin.utils.prototype.getElementById(_6d2,"reply_cancel_btn");
if(_6d4!=null){
dojo.connect(_6d4,"onclick",this,"cancelReply");
}
var _6d5="_"+this.postId;
lconn.comm.ronin.utils.prototype.makeIdsUnique(_6d2,_6d5);
return _6d2;
},showReply:function(){
this.replyForm.style.display="";
if(!this.replyRte){
var _6d6=["bold","italic","underline","strikethrough","|","foreColor","hiliteColor","|","insertUnorderedList","insertOrderedList","|","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull","|","createLink","insertImage","insertHorizontalRule"];
var _6d7={minHeight:"100px",plugins:_6d6};
this.replyRte=new dijit.Editor(_6d7,dojo.byId("reply_body_text_"+this.postId));
}
var subj=document.getElementById("reply_subject_"+this.postId);
if(subj!=null){
subj.focus();
}
return false;
},submitReply:function(e){
var subj="";
var _6db=document.getElementById("reply_subject_"+this.postId);
if(_6db){
subj=lconn.core.HTMLUtil.escapeText(_6db.value);
}
var body="";
if(this.replyRte){
body=this.replyRte.getValue();
}
var _6dd="<contributor>"+"<snx:communityUuid xmlns:snx=\"http://www.ibm.com/xmlns/prod/sn\" component="+"\"http://www.ibm.com/xmlns/prod/sn/activities\">"+this.thread.config.ownersRoleId+"</snx:communityUuid>"+"<category scheme=\"http://www.ibm.com/xmlns/prod/sn/type\" term=\"community\" />"+"<snx:role xmlns:snx=\"http://www.ibm.com/xmlns/prod/sn\" component="+"\"http://www.ibm.com/xmlns/prod/sn/activities\">owner</snx:role>"+"</contributor>"+"<contributor>"+"<snx:communityUuid xmlns:snx=\"http://www.ibm.com/xmlns/prod/sn\" component="+"\"http://www.ibm.com/xmlns/prod/sn/activities\">"+this.thread.config.membersRoleId+"</snx:communityUuid>"+"<category scheme=\"http://www.ibm.com/xmlns/prod/sn/type\" term=\"community\" />"+"<snx:role xmlns:snx=\"http://www.ibm.com/xmlns/prod/sn\" component="+"\"http://www.ibm.com/xmlns/prod/sn/activities\">member</snx:role>"+"</contributor>";
var _6de="<thr:in-reply-to "+"ref=\"urn:lsid:ibm.com:oa:"+this.guid+"\" "+"type=\"application/atom+xml\" "+"href=\""+this.thread.contextURL+"forum/service/atom/forum/reply?activityNodeUuid="+this.guid+"\"  "+"source=\"urn:lsid:ibm.com:oa:"+this.thread.guid+"\"/>";
this.hideReply();
lconn.comm.ronin.utils.prototype.cancelClick(e);
if((subj!=null&&subj.length>0)||(body!=null&&body.length>0)){
var _6df="<entry xmlns=\"http://www.w3.org/2005/Atom\" xmlns:thr=\"http://purl.org/syndication/thread/1.0\"><title type=\"text\"><![CDATA["+subj+"]]></title><content type=\"html\"><![CDATA["+body+"]]></content>"+_6dd+_6de+"</entry>";
var _6e0=this.thread.contextURL+"forum/service/atom/forum/topic/replies?authenticate=no&public=yes&activityUuid="+this.thread.guid;
console.log("ronin.submitReply: submitting reply");
var req=dojo.rawXhrPost({url:_6e0,postData:_6df,contentType:"application/atom+xml",error:dojo.hitch(this,this.handleError),handleAs:"xml"});
req.addCallback(this,"parseReplyResponse");
}
},parseReplyResponse:function(_6e2){
var _6e3=0;
if(this.thread.layout=="INDENTED"){
this.thread.refreshThread();
}else{
this.thread.refreshThread();
}
},hideReply:function(){
if(this.replyRte){
this.replyRte.destroy();
}
this.replyRte=null;
this.replyForm.parentNode.removeChild(this.replyForm);
this.replyForm=null;
return false;
},cancelReply:function(e){
console.log("ronin.cancelReply");
this.hideReply();
lconn.comm.ronin.utils.prototype.cancelClick(e);
},editPost:function(e){
console.log("ronin.editPost");
this.initEdit();
lconn.comm.ronin.utils.prototype.cancelClick(e);
return false;
},initEdit:function(){
this.editInProgress=true;
if((this.isMoreEnabled()&&this.moreText!=null)||!this.isMoreEnabled()){
if(this.thread.isEditTemplateLoaded()){
var _6e6=document.getElementById(this.postId);
this.editForm=this.cloneEditTemplate();
if(_6e6!=null){
if(_6e6.parentNode.childNodes.length>1){
_6e6.parentNode.insertBefore(this.editForm,_6e6.parentNode.childNodes[1]);
this.showEdit();
}else{
_6e6.parentNode.appendChild(this.editForm);
this.showEdit();
}
}
}else{
this.loadTemplate(this.thread.config.editTemplate,this.insertEditTemplate);
}
}else{
this.morePost();
}
},insertEditTemplate:function(_6e7){
console.log("ronin.insertEditTemplate");
var _6e8=document.getElementById(this.thread.editTemplateDivName);
if(_6e8==null){
_6e8=this.thread.addTemplateToDOM(this.thread.editTemplateDivName);
}
_6e8.innerHTML=_6e7;
this.thread.editTemplateLoaded=true;
this.initEdit();
},cloneEditTemplate:function(){
var _6e9=document.getElementById(this.thread.editTemplateDivName);
var _6ea=_6e9.cloneNode(true);
_6ea.id="edit";
var subj=lconn.comm.ronin.utils.prototype.getElementById(_6ea,"edit_subject");
if(subj!=null){
subj.value=this.subject;
}
var _6ec=lconn.comm.ronin.utils.prototype.getElementById(_6ea,"edit_body_text");
if(_6ec!=null){
if(this.isMoreEnabled()){
_6ec.value=this.moreText;
}else{
_6ec.value=this.body;
}
}
var _6ed=lconn.comm.ronin.utils.prototype.getElementById(_6ea,"edit_ok_btn");
if(_6ed!=null){
dojo.connect(_6ed,"onclick",this,"submitEdit");
}
var _6ee=lconn.comm.ronin.utils.prototype.getElementById(_6ea,"edit_cancel_btn");
if(_6ee!=null){
dojo.connect(_6ee,"onclick",this,"cancelEdit");
}
var _6ef="_"+this.postId;
lconn.comm.ronin.utils.prototype.makeIdsUnique(_6ea,_6ef);
return _6ea;
},showEdit:function(){
var post=document.getElementById(this.postId);
if(post){
post.style.display="none";
}
this.editForm.style.display="";
if(!this.editRte){
var _6f1=["bold","italic","underline","strikethrough","|","foreColor","hiliteColor","|","insertUnorderedList","insertOrderedList","|","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull","|","createLink","insertImage","insertHorizontalRule"];
var _6f2={minHeight:"100px",plugins:_6f1};
this.editRte=new dijit.Editor(_6f2,dojo.byId("edit_body_text_"+this.postId));
}
var subj=document.getElementById("edit_subject_"+this.postId);
if(subj!=null){
subj.focus();
}
return false;
},submitEdit:function(e){
var subj="";
var _6f6=document.getElementById("edit_subject_"+this.postId);
if(_6f6){
subj=lconn.core.HTMLUtil.escapeText(_6f6.value);
}
var body="";
if(this.editRte){
body=this.editRte.getValue();
}
var _6f8="<entry xmlns=\"http://www.w3.org/2005/Atom\">"+this.thread.config.customData+"<title type=\"text\"><![CDATA["+subj+"]]></title><content type=\"html\"><![CDATA["+body+"]]></content></entry>";
var _6f9=this.thread.config.editURL+this.guid;
var _6fa=lconn.comm.ronin.utils.prototype.rewriteURL(_6f9,this.thread.config.contextURL,this.thread.config.proxyPrefixURL);
console.debug("ronin.submitEdit: submitting edit");
var req=dojo.rawXhrPut({url:_6fa,putData:_6f8,contentType:"application/atom+xml",error:dojo.hitch(this,this.handleError),handleAs:"xml"});
req.addCallback(this,"parseEditResponse");
this.hideEdit();
lconn.comm.ronin.utils.prototype.cancelClick(e);
},parseEditResponse:function(dom){
console.log("ronin.parseEditResponse");
this.thread.refreshThread();
},cancelEdit:function(e){
this.hideEdit();
lconn.comm.ronin.utils.prototype.cancelClick(e);
},hideEdit:function(){
if(this.editRte){
this.editRte.destroy();
}
this.editRte=null;
this.editForm.parentNode.removeChild(this.editForm);
this.editForm=null;
var post=document.getElementById(this.postId);
if(post){
post.style.display="";
}
this.editInProgress=false;
return false;
},deletePost:function(e){
console.log("ronin.deletePost");
this.initDelete();
lconn.comm.ronin.utils.prototype.cancelClick(e);
return false;
},initDelete:function(){
if((this.thread.config.context=="TOPIC")||(this.thread.config.context=="TOPIC_DISCUSSION_VIEW")){
var _700=confirm(confirmTopicDeleteString);
if(_700){
this.submitDelete();
}
}else{
if(this.thread.isDeleteTemplateLoaded()){
var _701=document.getElementById(this.postId);
this.deleteForm=this.cloneDeleteTemplate();
if(_701!=null){
if(_701.parentNode.childNodes.length>1){
_701.parentNode.insertBefore(this.deleteForm,_701.parentNode.childNodes[1]);
this.showDelete();
}else{
_701.parentNode.appendChild(this.deleteForm);
this.showDelete();
}
}
}else{
this.loadTemplate(this.thread.config.deleteTemplate,this.insertDeleteTemplate);
}
}
},insertDeleteTemplate:function(_702){
console.log("ronin.insertDeleteTemplate");
var _703=document.getElementById(this.thread.deleteTemplateDivName);
if(_703==null){
_703=this.thread.addTemplateToDOM(this.thread.deleteTemplateDivName);
}
_703.innerHTML=_702;
this.thread.deleteTemplateLoaded=true;
this.initDelete();
},cloneDeleteTemplate:function(){
var _704=document.getElementById(this.thread.deleteTemplateDivName);
var _705=_704.cloneNode(true);
_705.id="delete";
var _706=lconn.comm.ronin.utils.prototype.getElementById(_705,"delete_ok_btn");
if(_706!=null){
dojo.connect(_706,"onclick",this,"submitDelete");
}
var _707=lconn.comm.ronin.utils.prototype.getElementById(_705,"delete_cancel_btn");
if(_707!=null){
dojo.connect(_707,"onclick",this,"cancelDelete");
}
var _708="_"+this.postId;
lconn.comm.ronin.utils.prototype.makeIdsUnique(_705,_708);
return _705;
},showDelete:function(){
var post=document.getElementById(this.postId);
if(post){
post.style.display="none";
}
this.deleteForm.style.display="";
if(!this.deleteRte){
var _70a=["bold","italic","underline","strikethrough","|","foreColor","hiliteColor","|","insertUnorderedList","insertOrderedList","|","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull","|","createLink","insertImage","insertHorizontalRule"];
var _70b={minHeight:"100px",plugins:_70a};
this.deleteRte=new dijit.Editor(_70b,dojo.byId("delete_body_text_"+this.postId));
}
if(this.deleteRte){
this.deleteRte.focus();
}
return false;
},submitDelete:function(e){
console.debug("submitDelete: submitting delete");
if((this.thread.config.context=="TOPIC")||(this.thread.config.context=="TOPIC_DISCUSSION_VIEW")){
var _70d=this.thread.config.editURL+this.guid;
var _70e=lconn.comm.ronin.utils.prototype.rewriteURL(_70d,this.thread.config.contextURL,this.thread.config.proxyPrefixURL);
var req=dojo.xhrDelete({url:_70e,error:dojo.hitch(this,this.handleError),handleAs:"text"});
req.addCallback(this,"parseDeleteResponse");
}else{
var subj=this.DELETED_ENTRY;
var body="";
if(this.deleteRte){
body=this.deleteRte.getValue();
}
var _712="<entry xmlns=\"http://www.w3.org/2005/Atom\">"+this.thread.config.customData+"<title type=\"text\"><![CDATA["+subj+"]]></title><content type=\"html\"><![CDATA["+body+"]]></content></entry>";
var _70d=this.thread.config.editURL+this.guid;
var _70e=lconn.comm.ronin.utils.prototype.rewriteURL(_70d,this.thread.config.contextURL,this.thread.config.proxyPrefixURL);
var req=dojo.rawXhrPut({url:_70e,putData:_712,error:dojo.hitch(this,this.handleError),contentType:"application/atom+xml",handleAs:"xml"});
req.addCallback(this,"parseDeleteResponse");
this.hideDelete();
}
lconn.comm.ronin.utils.prototype.cancelClick(e);
},parseDeleteResponse:function(_713){
if(this.thread.config.context=="REPLIES_DISCUSSION_VIEW"){
this.setDeleted(true);
this.editEnabled=false;
var _714=lconn.comm.ronin.utils.prototype.getElementById(this.container,"post_edit_"+this.postId);
if(_714){
_714.style.display="none";
}
this.deleteEnabled=false;
var _715=lconn.comm.ronin.utils.prototype.getElementById(this.container,"post_delete_"+this.postId);
if(_715){
_715.style.display="none";
}
}
if(this.thread.config.context=="TOPIC_DISCUSSION_VIEW"){
var _716=document.getElementById("forumBreadcrumbRoot");
location.href=_716.href;
return;
}
this.thread.refreshThread();
},cancelDelete:function(e){
this.hideDelete();
lconn.comm.ronin.utils.prototype.cancelClick(e);
},hideDelete:function(){
if(this.deleteRte){
this.deleteRte.destroy();
}
this.deleteRte=null;
this.deleteForm.parentNode.removeChild(this.deleteForm);
this.deleteForm=null;
var post=document.getElementById(this.postId);
if(post){
post.style.display="";
}
return false;
},getContainer:function(){
return this.container;
},compareByTs:function(a,b){
return (new Date(Date.parse(a.published))).valueOf()-(new Date(Date.parse(b.published))).valueOf();
},handleError:function(_71b,_71c){
this.triggerEvent(this.ERROR_EVENT,_71b,_71c.xhr.status);
return true;
},convertDate:function(_71d){
var _71e=_71d;
var _71f;
if(_71d.indexOf("-")!=-1){
_71f=lconn.core.DateUtil.AtomDateToString(_71d);
}
if(!_71f){
_71f=lconn.core.DateUtil.toString(_71d);
}
if(_71f){
_71e=_71f;
}
return _71e;
}});
}
if(!dojo._hasResource["lconn.comm.ronin.utils"]){
dojo._hasResource["lconn.comm.ronin.utils"]=true;
dojo.provide("lconn.comm.ronin.utils");
dojo.declare("lconn.comm.ronin.utils",null,{debug:false,version:"1.0",rewriteURL:function(_720,_721,_722){
var _723="";
if(_722!=null&&_722.length>0){
var _724=_721+_722;
_723=_724+"?url="+encodeURIComponent(_720);
}else{
_723=_720;
}
return _723;
},generateThreadUID:function(size){
function getRandomNumber(_726){
return Math.floor(Math.random()*_726);
};
function getRandomChar(){
var _727="0123456789abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
return _727.substr(getRandomNumber(_727.length),1);
};
var buf="";
for(var i=0;i<size;i++){
buf+=getRandomChar();
}
return buf.toString();
},getDomainFromURL:function(str){
var _72b="";
if(str==null||str.length==0){
return "";
}
var i=str.indexOf("/",7);
if(i>-1){
_72b=str.substring(7,i);
}else{
_72b=str.substring(7,str.length);
}
return _72b;
},loadScript:function(_72d){
if((typeof SemTagSvc!="undefined"&&SemTagSvc!=null)&&!SemTagSvc.scripts[_72d]){
SemTagSvc.scripts[_72d]=true;
var _72e=document.createElement("script");
_72e.src=SemTagSvc.baseUrl+_72d;
document.body.insertBefore(_72e,document.body.firstChild);
}
},getFeedType:function(_72f,_730,_731){
var _732=this;
var _733=function(_734,data,evt,_737){
var doc=dojox.data.dom.createDocument(data);
var type=null;
var _73a=null;
var _73b=doc.getElementsByTagName("rss")[0];
if(_73b!=null){
var _73c=_73b.getAttribute("xmlns:itunes");
if(_73c!=null){
type="podcast";
_73a=_73b.getAttribute("version");
return _732.feedType=new lconn.comm.ronin.feedType(type,_73a);
}
_73a=_73b.getAttribute("version");
type="rss";
return _732.feedType=new lconn.comm.ronin.feedType(type,_73a);
}
var _73d=doc.getElementsByTagName("rdf")[0];
if(_73d!=null){
type="rdf";
_73a=_73d.getAttribute("version");
return _732.feedType=new lconn.comm.ronin.feedType(type,_73a);
}
var _73e=doc.getElementsByTagName("feed")[0];
if(_73e!=null){
type="atom";
_73a=_73e.getAttribute("version");
return _732.feedType=new lconn.comm.ronin.feedType(type,_73a);
}
};
if(!_731){
var _73f=this.rewriteURL(_72f,_730);
console.log("getFeedType: Issuing AJAX request "+_73f);
dojo.xhrGet({url:_73f,sync:true,load:function(_740,data,evt){
return _733(_740,data,evt,false);
},error:function(type,_744){
this.handleError(type,_744);
},handleAs:"text"});
}else{
_733(null,_731,null,true);
}
return _732.feedType;
},handleError:function(type,_746){
alert("Error: "+dojo.errorToString(_746));
},trim:function(str){
str=this!=window?this:str;
return str.replace(/^\s+/,"").replace(/\s+$/,"");
},Sanitizer:{escapeAllTags:function(_748){
return _748.replace(/(<)|(>)/g,function(m){
if(m=="<"){
return "&lt;";
}else{
return "&gt;";
}
});
},_enableSimpleTags:function(_74a){
var _74b=/&lt;[\s\/]*(div|b|big|hr|h[1-6]{1,1}|li|ul|ol|small|br|i|em|strong|code|p|span|blockquote)[\s\/]*&gt;/ig;
var _74c=_74a.replace(_74b,function(m){
return m.replace("&lt;","<").replace("&gt;",">");
});
return _74c;
},_enableStartTag:function(_74e,_74f){
var _750=new RegExp("&lt;[\\s]*"+_74f+"[\\s]+","i");
var _751=new RegExp("&lt;[\\s]*"+_74f+"[\\s]+(.|\\s)*","ig");
while(_750.test(_74e)){
_74e=_74e.replace(_751,function(m){
return m.replace("&lt;","<").replace("&gt;",">");
});
}
return _74e;
},_enableATags:function(_753){
_753=this.Sanitizer._enableStartTag(_753,"a");
_753=_753.replace(/&lt;[\s\/]*a[\s]*&gt;/ig,function(m){
return m.replace("&gt;",">").replace("&lt;","<");
});
return _753;
},_enableIMGTags:function(_755){
_755=this.Sanitizer._enableStartTag(_755,"img");
return _755;
},_cleanStartTag:function(m){
var _757=/([\s]+(onblur|onclick|ondblclick|onfocus|onkeydown|onkeypress|onkeyup|onmousedown|onmousemove|onmouseout|onmouseover|onmouseup|style|class)[\s]*=[\s]*)/ig;
var _758=m.replace(_757,function(t){
return " rm=";
});
var _75a=/[\s]+href[\s]*=([^\s>]+)/ig;
var _75b=_758.replace(_75a,function(t){
var _75d=t;
var _75e=RegExp.$1;
if((_75e.search("javascript:")==1)||(_75e.search("vbscript:")==1)){
_75d=" rm="+_75e;
}
return _75d;
});
var _75f=/[\s]+src[\s]*=([^\s>]+)/ig;
var _760=_75b.replace(_75f,function(t){
var _762=t;
var _763=RegExp.$1;
if(_763.search("http://")!=1){
_762=" rm="+_763;
}
return _762;
});
return _760;
},_cleanSelectedStartTags:function(_764,_765){
var _766=new RegExp("<[\\s]*("+_765+")[\\s]+[^>]+>","ig");
_764=_764.replace(_766,this.Sanitizer._cleanStartTag);
return _764;
},run:function(_767){
var _768=_767;
_768=this.Sanitizer.escapeAllTags(_768);
_768=this.Sanitizer._enableSimpleTags(_768);
_768=this.Sanitizer._enableATags(_768);
_768=this.Sanitizer._enableIMGTags(_768);
_768=this.Sanitizer._cleanSelectedStartTags(_768,"a|img");
return _768;
}},removeEvent:function(elm,_76a,fn,_76c){
var _76d;
if(elm.removeEventListener){
elm.removeEventListener(_76a,fn,_76c);
_76d=true;
}else{
if(elm.detachEvent){
_76d=elm.detachEvent("on"+_76a,fn);
}else{
elm["on"+_76a]=null;
_76d=true;
}
}
return _76d;
},findPreferredFeedFieldValue:function(_76e,_76f,_770,_771){
var pos=_76f.prefPathIndex;
var _773=this.findFeedFieldValue(_76e,_76f.paths[pos],_770,_771);
var i=0;
while((i<_76f.paths.length)&&((_773==null)||(_773.length==0))){
if(i!=pos){
_773=this.findFeedFieldValue(_76e,_76f.paths[i],_770,_771);
if((_773!=null)||(_773.length>0)){
_76f.prefPathIndex=i;
}
}
i++;
}
return (_773==null?"":_773);
},selectFromGroup:function(elms,_776,_777){
var _778=null;
if(elms!=null){
_778=elms[0];
if(_776=="link"){
var _778=null;
for(var i=0;i<elms.length;i++){
if(elms[i].getAttribute("rel")==_777){
_778=elms[i];
}else{
if((elms[i].getAttribute("rel")==null)&&(_777=="alternate")&&(_778==null)){
_778=elms[i];
}
}
}
}
}
return _778;
},findFeedFieldValue:function(_77a,_77b,_77c,_77d){
var _77e="";
var _77f=null;
var _780=_77a;
var link="alternate";
if(_77c){
link=_77c;
}
var idx=_77b.lastIndexOf("@");
if(idx!=-1){
_77f=_77b.substring(idx+1);
_77b=_77b.substring(0,idx);
}
var _783=_77b.split("/");
var ii=1;
if(_783[0].length==0){
ii=2;
}
for(;ii<_783.length&&_780!=null;ii++){
if(_783[ii].length>0){
var elms=_780.getElementsByTagName(_783[ii]);
if(elms!=null){
_780=this.selectFromGroup(elms,_783[ii],link);
}
}
}
if(_780!=null){
if(_77f!=null){
_77e=_780.getAttribute(_77f);
}else{
if(_780.childNodes[0]!=null){
_77e=_780.childNodes[0].nodeValue;
}
}
if(_780.tagName=="link"&&_77e){
var idx=_77e.indexOf("http");
if(idx==-1){
_77e=_77d+_77e;
}
}else{
if(_780.tagName=="content"&&_77e){
var _786=_780.getAttribute("type");
if(_786=="text"){
}
}
}
}
return (_77e==null?"":_77e);
},makeIdsUnique:function(_787,_788){
if(_787){
if(_787.id){
_787.id=_787.id+_788;
}
var _789=_787.getElementsByTagName("*");
for(var ii=0;ii<_789.length;ii++){
if(_789[ii].id){
_789[ii].id=_789[ii].id+_788;
}
}
}
},getThreadElement:function(e){
var _78c=false;
var _78d=getEventElement(e);
if(_78d){
while(_78d!=document.body&&!_78c){
_78d=_78d.parentNode;
if(_78d.nodeName.toLowerCase()=="div"&&_78d.threadObj){
_78c=true;
}
}
}
return _78d;
},getPostElement:function(e){
var _78f=false;
var _790=getEventElement(e);
if(_790){
while(_790!=document.body&&!_78f){
_790=_790.parentNode;
if(_790.nodeName.toLowerCase()=="div"&&_790.postObj){
_78f=true;
}
}
}
return _790;
},getEventElement:function(e){
var _792=null;
if(window.event&&window.event.srcElement){
_792=window.event.srcElement;
}else{
if(e&&e.target){
_792=e.target;
}
}
return _792;
},getElementById:function(_793,_794){
var _795=null;
var _796=_793.getElementsByTagName("*");
for(var ii=0;ii<_796.length;ii++){
if(_796[ii].id==_794){
_795=_796[ii];
break;
}
}
return (_795);
},getElementsByClassName:function(_798,_799){
var _79a=new Array();
var _79b=_798.getElementsByTagName("*");
for(var ii=0;ii<_79b.length;ii++){
var _79d=_79b[ii];
var _79e=_79d.className.split(" ");
for(var jj=0;jj<_79e.length;jj++){
if(_79e[jj]==_799){
_79a.push(_79d);
break;
}
}
}
return _79a;
},getElementsByTagNameNS:function(_7a0,ns,_7a2,_7a3){
var _7a4;
if(_7a0.getElementsByTagNameNS){
_7a4=_7a0.getElementsByTagNameNS(ns,_7a3);
}else{
_7a4=_7a0.getElementsByTagName(_7a2+":"+_7a3);
}
return _7a4;
},cancelClick:function(e){
if(e&&e.returnValue){
e.returnValue=false;
}
if(e&&e.preventDefault){
e.preventDefault();
}
},formatDate:function(_7a6){
var ampm="AM";
var _7a8=_7a6.getMonth()+1;
var day=_7a6.getDate();
var year=_7a6.getFullYear();
var _7ab=_7a6.getHours();
var mins=_7a6.getMinutes();
if(_7ab>12){
ampm="PM";
_7ab-=12;
}else{
if(_7ab==0){
_7ab=12;
}
}
if(_7ab<10){
_7ab="0"+_7ab;
}
if(mins<10){
mins="0"+mins;
}
return (_7a8+"/"+day+"/"+year+" "+_7ab+":"+mins+" "+ampm);
}});
}
if(!dojo._hasResource["lconn.comm.ronin.roninService"]){
dojo._hasResource["lconn.comm.ronin.roninService"]=true;
dojo.provide("lconn.comm.ronin.roninService");
function removeEvent(elm,_7ae,fn,_7b0){
var _7b1;
if(elm.removeEventListener){
elm.removeEventListener(_7ae,fn,_7b0);
_7b1=true;
}else{
if(elm.detachEvent){
_7b1=elm.detachEvent("on"+_7ae,fn);
}else{
elm["on"+_7ae]=null;
_7b1=true;
}
}
return _7b1;
};
function findPreferredFeedFieldValue(_7b2,_7b3){
var pos=_7b3.prefPathIndex;
var _7b5=findFeedFieldValue(_7b2,_7b3.paths[pos]);
var i=0;
while((i<_7b3.paths.length)&&((_7b5==null)||(_7b5.length==0))){
if(i!=pos){
_7b5=findFeedFieldValue(_7b2,_7b3.paths[i]);
if((_7b5!=null)||(_7b5.length>0)){
_7b3.prefPathIndex=i;
}
}
i++;
}
return (_7b5==null?"":_7b5);
};
function selectFromGroup(elms,_7b8,_7b9){
var _7ba=null;
if(elms!=null){
_7ba=elms[0];
if(_7b8=="link"){
var _7ba=null;
for(var i=0;i<elms.length;i++){
if(elms[i].getAttribute("rel")==_7b9){
_7ba=elms[i];
}else{
if((elms[i].getAttribute("rel")==null)&&(_7b9=="alternate")&&(_7ba==null)){
_7ba=elms[i];
}
}
}
}
}
return _7ba;
};
function findFeedFieldValue(_7bc,_7bd,_7be){
var _7bf="";
var _7c0=null;
var _7c1=_7bc;
var link="alternate";
if(_7be){
link=_7be;
}
var idx=_7bd.lastIndexOf("@");
if(idx!=-1){
_7c0=_7bd.substring(idx+1);
_7bd=_7bd.substring(0,idx);
}
var _7c4=_7bd.split("/");
var ii=1;
if(_7c4[0].length==0){
ii=2;
}
for(;ii<_7c4.length&&_7c1!=null;ii++){
if(_7c4[ii].length>0){
var elms=_7c1.getElementsByTagName(_7c4[ii]);
if(elms!=null){
_7c1=selectFromGroup(elms,_7c4[ii],link);
}
}
}
if(_7c1!=null){
if(_7c0!=null){
_7bf=_7c1.getAttribute(_7c0);
}else{
if(_7c1.childNodes[0]!=null){
_7bf=_7c1.childNodes[0].nodeValue;
}
}
}
return (_7bf==null?"":_7bf);
};
function makeIdsUnique(_7c7,_7c8){
if(_7c7){
if(_7c7.id){
_7c7.id=_7c7.id+_7c8;
}
var _7c9=_7c7.getElementsByTagName("*");
for(var ii=0;ii<_7c9.length;ii++){
if(_7c9[ii].id){
_7c9[ii].id=_7c9[ii].id+_7c8;
}
}
}
};
function getThreadElement(e){
var _7cc=false;
var _7cd=getEventElement(e);
if(_7cd){
while(_7cd!=document.body&&!_7cc){
_7cd=_7cd.parentNode;
if(_7cd.nodeName.toLowerCase()=="div"&&_7cd.threadObj){
_7cc=true;
}
}
}
return _7cd;
};
function getPostElement(e){
var _7cf=false;
var _7d0=getEventElement(e);
if(_7d0){
while(_7d0!=document.body&&!_7cf){
_7d0=_7d0.parentNode;
if(_7d0.nodeName.toLowerCase()=="div"&&_7d0.postObj){
_7cf=true;
}
}
}
return _7d0;
};
function getEventElement(e){
var _7d2=null;
if(window.event&&window.event.srcElement){
_7d2=window.event.srcElement;
}else{
if(e&&e.target){
_7d2=e.target;
}
}
return _7d2;
};
function getElementById(_7d3,_7d4){
var _7d5=null;
var _7d6=_7d3.getElementsByTagName("*");
for(var ii=0;ii<_7d6.length;ii++){
if(_7d6[ii].id==_7d4){
_7d5=_7d6[ii];
break;
}
}
return (_7d5);
};
function getElementsByClassName(_7d8,_7d9){
var _7da=new Array();
var _7db=_7d8.getElementsByTagName("*");
for(var ii=0;ii<_7db.length;ii++){
var _7dd=_7db[ii];
var _7de=_7dd.className.split(" ");
for(var jj=0;jj<_7de.length;jj++){
if(_7de[jj]==_7d9){
_7da.push(_7dd);
break;
}
}
}
return _7da;
};
function getElementsByTagNameNS(_7e0,ns,_7e2,_7e3){
var _7e4;
if(_7e0.getElementsByTagNameNS){
_7e4=_7e0.getElementsByTagNameNS(ns,_7e3);
}else{
_7e4=_7e0.getElementsByTagName(_7e2+":"+_7e3);
}
return _7e4;
};
function cancelClick(e){
if(e&&e.returnValue){
e.returnValue=false;
}
if(e&&e.preventDefault){
e.preventDefault();
}
};
function formatDate(_7e6){
var ampm="AM";
var _7e8=_7e6.getMonth()+1;
var day=_7e6.getDate();
var year=_7e6.getFullYear();
var _7eb=_7e6.getHours();
var mins=_7e6.getMinutes();
if(_7eb>12){
ampm="PM";
_7eb-=12;
}else{
if(_7eb==0){
_7eb=12;
}
}
if(_7eb<10){
_7eb="0"+_7eb;
}
if(mins<10){
mins="0"+mins;
}
return (_7e8+"/"+day+"/"+year+" "+_7eb+":"+mins+" "+ampm);
};
}
if(!dojo._hasResource["lconn.comm.ronin.thread"]){
dojo._hasResource["lconn.comm.ronin.thread"]=true;
dojo.provide("lconn.comm.ronin.thread");
dojo.declare("lconn.comm.ronin.thread",null,{IMAGES_DIR:"images/",TEMPLATE_DIR:"templates/",EXPANDED:1,COLLAPSED:2,EXPAND_LIMIT:10,POST_TEMPLATE_DIV:"post_template_div",POST_TEMPLATE_NAME:"PostTemplate.jsp",REPLY_TEMPLATE_DIV:"reply_template_div",REPLY_TEMPLATE_NAME:"ReplyTemplate.jsp",EDIT_TEMPLATE_DIV:"edit_template_div",EDIT_TEMPLATE_NAME:"EditTemplate.jsp",DELETE_TEMPLATE_DIV:"delete_template_div",DELETE_TEMPLATE_NAME:"DeleteTemplate.jsp",LOAD_THREAD_EVENT:"loadthread",LOAD_POST_EVENT:"loadpost",DISPLAY_THREAD_EVENT:"viewthread",ADD_POST_EVENT:"addpost",DELETE_POST_EVENT:"deletepost",ERROR_EVENT:"error",DEFAULT_LAYOUT:"FLAT",DEFAULT_ROOT:"item",FIELD_MAPPING:1,ATTRIBUTE_MAPPING:2,PROPERTY_MAPPING:3,DELETED_ENTRY:"[[D]]",PAGE_SIZE:5,config:null,portletNS:null,contextURL:null,targetURL:null,fullURL:null,authorVisible:null,dateVisible:null,interval:null,containerId:null,layout:null,postTemplateMap:null,pageSize:null,id:null,postTemplateDivName:null,editTemplateDivName:null,replyTemplateDivName:null,deleteTemplateDivName:null,threadState:null,threadRoot:null,threadXml:null,postArray:null,nextUniquePostId:null,postIdLookup:null,currentPage:null,lastPage:null,fieldRoot:null,fieldMapping:null,docOwner:null,dataLoaded:null,postTemplateLoaded:null,replyTemplateLoaded:null,editTemplateLoaded:null,deleteTemplateLoaded:null,events:null,container:null,constructor:function(_7ed){
_7ed.contextURL=_7ed.contextURL?_7ed.contextURL:"";
_7ed.portletNS=_7ed.portletNS?_7ed.portletNS:"";
_7ed.staticReplyForm=_7ed.staticReplyForm?_7ed.staticReplyForm:false;
_7ed.layout=_7ed.layout?_7ed.layout:this.DEFAULT_LAYOUT;
_7ed.postTemplate=_7ed.postTemplate?_7ed.postTemplate:this.POST_TEMPLATE_NAME;
_7ed.replyTemplate=_7ed.replyTemplate?_7ed.replyTemplate:this.REPLY_TEMPLATE_NAME;
_7ed.editTemplate=_7ed.editTemplate?_7ed.editTemplate:this.EDIT_TEMPLATE_NAME;
_7ed.deleteTemplate=_7ed.deleteTemplate?_7ed.deleteTemplate:this.DELETE_TEMPLATE_NAME;
_7ed.authorVisible=_7ed.authorVisible?_7ed.authorVisible:true;
_7ed.dateVisible=_7ed.dateVisible?_7ed.dateVisible:true;
_7ed.enableAcf=_7ed.enableAcf?_7ed.enableAcf:false;
_7ed.pageSize=_7ed.pageSize?_7ed.pageSize:this.PAGE_SIZE;
_7ed.loggedIn=_7ed.loggedIn?_7ed.loggedIn:false;
_7ed.context=_7ed.context?_7ed.context:"TOPIC";
_7ed.customData=_7ed.customData?_7ed.customData:"";
_7ed.dojoCache=_7ed.dojoCache?_7ed.dojoCache:false;
this.config=_7ed;
this.portletNS=_7ed.portletNS;
this.contextURL=_7ed.contextURL;
this.targetURL=_7ed.targetURL;
this.fullURL=this.targetURL;
this.baseURL=this.extractBaseURL(this.targetURL);
this.authorVisible=_7ed.authorVisible;
this.dateVisible=_7ed.dateVisible;
this.interval=_7ed.interval;
this.containerId=_7ed.portletNS+_7ed.containerId;
this.layout=_7ed.layout;
this.postTemplateMap=_7ed.postTemplateMap;
this.pageSize=_7ed.pageSize;
this.id=lconn.comm.ronin.utils.prototype.generateThreadUID(25);
this.guid=null;
this.postTemplateDivName=this.POST_TEMPLATE_DIV+"_"+encodeURIComponent(this.config.postTemplate);
this.editTemplateDivName=this.EDIT_TEMPLATE_DIV+"_"+encodeURIComponent(this.config.editTemplate);
this.replyTemplateDivName=this.REPLY_TEMPLATE_DIV+"_"+encodeURIComponent(this.config.replyTemplate);
this.deleteTemplateDivName=this.DELETE_TEMPLATE_DIV+"_"+encodeURIComponent(this.config.deleteTemplate);
this.threadState=this.COLLAPSED;
this.threadRoot=null;
this.threadXml=null,this.postArray=new Array();
this.nextUniquePostId=-1;
this.postIdLookup=new Array();
this.currentPage=0;
this.lastPage=0;
this.fieldRoot=this.DEFAULT_ROOT;
this.fieldMapping=null;
this.docOwner=null;
this.dataLoaded=false;
this.postTemplateLoaded=false;
this.replyTemplateLoaded=false;
this.editTemplateLoaded=false;
this.deleteTemplateLoaded=false;
this.events=new Array();
this.addEvent(this.LOAD_THREAD_EVENT);
this.addEvent(this.LOAD_POST_EVENT);
this.addEvent(this.DISPLAY_THREAD_EVENT);
this.addEvent(this.ADD_POST_EVENT);
this.addEvent(this.ERROR_EVENT);
this.container=document.getElementById(this.containerId);
if(this.container){
this.container.threadObj=this;
}
if(this.config.staticReplyForm){
this.loadTemplate(this.config.replyTemplate,this.insertReplyTemplate);
}
},addEvent:function(_7ee){
this.events[_7ee.toLowerCase()]=new Array();
},addListener:function(_7ef,_7f0){
var name=_7ef.toLowerCase();
var _7f2=this.events[name];
if(_7f2!=null){
_7f2.push(_7f0);
}
},removeListener:function(_7f3,_7f4){
var name=_7f3.toLowerCase();
var _7f6=this.events[name];
if(_7f6!=null){
for(var ii=0;ii<_7f6.length;ii++){
var _7f8=_7f6[ii];
if(_7f8==_7f4){
_7f6.splice(ii,1);
}
}
}
},triggerEvent:function(_7f9,_7fa,_7fb){
var name=_7f9.toLowerCase();
var _7fd=this.events[name];
if(_7fd!=null){
for(var ii=0;ii<_7fd.length;ii++){
var _7ff=_7fd[ii];
_7ff(name,_7fa,_7fb);
}
}
},extractBaseURL:function(_800){
var _801=_800;
idx=_800.indexOf("://");
if(idx>-1){
idx=_800.indexOf("/",idx+3);
if(idx>-1){
_801=_800.substring(0,idx);
}
}
return _801;
},clearThread:function(){
this.container.innerHTML="";
},refreshThread:function(){
console.log("ronin.refreshThread");
this.initThread();
this.loadThread();
},initThread:function(){
console.log("ronin.initThread");
this.threadState=this.COLLAPSED;
this.threadRoot=null;
this.threadXml=null;
this.container.innerHTML="";
this.postArray=new Array();
this.nextUniquePostId=-1;
this.postIdLookup=new Array();
this.currentPage=0;
this.lastPage=0;
this.docOwner=null;
this.guid=null;
this.dataLoaded=false;
},loadThread:function(){
console.log("ronin.loadThread: requesting feed");
if(!this.isDataLoaded()){
var req="";
if(this.config.dojoCache){
req=new lconn.comm.ronin.AjaxRequestsHandler().xhrGet({url:this.fullURL,preventCache:true,error:dojo.hitch(this,this.handleError),handleAs:"text"});
}else{
req=new lconn.comm.ronin.AjaxRequestsHandler().xhrGet({url:this.fullURL,error:dojo.hitch(this,this.handleError),handleAs:"text"});
}
req.addCallback(this,"parseThreadXMLResponse");
}
},getFullURL:function(){
return this.fullURL;
},parseThreadXMLResponse:function(_803){
if(this.threadXml==null){
this.threadXml=_803;
}
if(!this.isPostTemplateLoaded()){
var _804=lconn.comm.ronin.utils.prototype.getFeedType("","",this.threadXml);
if(this.config.postTemplateMap){
this.postTemplateDivName=this.POST_TEMPLATE_DIV+"_"+encodeURIComponent(this.postTemplateMap[_804.type]);
this.loadTemplate(this.postTemplateMap[_804.type],this.insertPostTemplate);
}else{
this.loadTemplate(this.config.postTemplate,this.insertPostTemplate);
}
}else{
console.log("ronin.parseThreadXMLResponse: parsing feed");
this.parseThreadXML(this.threadXml);
if(this.layout=="INDENTED"){
for(var ii=0;ii<this.postArray.length;ii++){
var post=this.postArray[ii];
var _807=this.postIdLookup[post.parentId];
if(_807){
post.parentId=_807;
}else{
post.parentId=null;
}
}
}
this.dataLoaded=true;
nextUniquePostId=this.postArray.length;
this.displayThread();
}
},parseThreadXML:function(dom){
dom=dojox.data.dom.createDocument(dom);
var _809;
this.docOwner=lconn.comm.ronin.utils.prototype.findFeedFieldValue(dom,"feed/author/name");
this.guid=lconn.comm.ronin.utils.prototype.findFeedFieldValue(dom,"feed/snx:activity");
if(this.guid.length==0){
this.guid=lconn.comm.ronin.utils.prototype.findFeedFieldValue(dom,"feed/activity");
}
var _80a=dom.getElementsByTagName(this.fieldRoot);
for(var ii=0;ii<_80a.length;ii++){
_809=this.uniqueId();
this.postArray[_809]=new lconn.comm.ronin.post(this,this.docOwner,_809,_80a[ii]);
}
this.initPaging();
},setPageSize:function(_80c){
this.pageSize=_80c;
this.currentPage=0;
this.initPaging();
this.displayThread();
},getPageSize:function(){
return this.pageSize;
},initPaging:function(){
this.lastPage=Math.ceil(this.postArray.length/this.pageSize)-1;
},hasPreviousPage:function(){
return (this.currentPage>0);
},pageBackward:function(){
if(this.hasPreviousPage()){
this.currentPage--;
this.displayThread();
}
},hasNextPage:function(){
return (this.currentPage<this.lastPage);
},pageForward:function(){
if(this.hasNextPage()){
this.currentPage++;
this.displayThread();
}
},displayThread:function(){
if(this.isDataLoaded()){
console.log("ronin.displayThread: adding feed to the DOM");
var _80d=document.createElement("ul");
this.threadRoot=_80d;
if(this.postArray.length>this.EXPAND_LIMIT){
this.threadState=this.COLLAPSED;
}
var _80e=this.currentPage*this.pageSize;
var _80f=_80e+(this.pageSize-1);
if(_80f>(this.postArray.length-1)){
_80f=this.postArray.length-1;
}
for(var ii=_80e;ii<=_80f;ii++){
var post=this.postArray[ii];
post.insertPost(this.threadRoot);
if(this.threadState==this.EXPANDED){
post.expandPost();
}
}
this.triggerEvent(this.LOAD_THREAD_EVENT,this,this.threadRoot);
this.clearThread();
this.container.appendChild(this.threadRoot);
this.triggerEvent(this.DISPLAY_THREAD_EVENT,this,this.threadRoot);
}
},loadTemplate:function(_812,_813){
var _814=_812;
var req=new lconn.comm.ronin.AjaxRequestsHandler().xhrGet({url:_814,error:dojo.hitch(this,this.handleError),handleAs:"text"});
req.addCallback(this,_813);
},addTemplateToDOM:function(_816){
var _817=document.getElementById(this.containerId);
var _818=document.createElement("div");
_818.id=_816;
_818.style.display="none";
_817.parentNode.appendChild(_818);
return _818;
},insertPostTemplate:function(_819){
console.log("ronin.insertPostTemplate: adding template to the DOM");
var _81a=document.getElementById(this.postTemplateDivName);
if(_81a==null){
_81a=this.addTemplateToDOM(this.postTemplateDivName);
}
_81a.innerHTML=_819;
this.postTemplateLoaded=true;
this.fieldMapping=this.findFieldMapping(_81a);
this.fieldRoot=this.findRootMapping(this.fieldMapping);
this.parseThreadXMLResponse(_819);
},insertReplyTemplate:function(_81b){
var _81c=document.getElementById(this.replyTemplateDivName);
if(_81c==null){
_81c=this.addTemplateToDOM(this.replyTemplateDivName);
}
_81c.innerHTML=_81b;
this.replyTemplateLoaded=true;
var _81d=document.getElementById("reply_template_ok_btn");
if(_81d){
dojo.event.connect(_81d,"onclick",this,"submitReply");
}
},submitReply:function(e){
var body=null;
var _820=null;
body=document.getElementById("reply_template_text");
if(body!=null){
_820=body.value;
if(_820!=null&&_820.length>0){
_820=lconn.core.HTMLUtil.escapeText(_820);
}
}
if(_820!=null&&_820.length>0){
var req=new lconn.comm.ronin.AjaxRequestsHandler().xhrPut({url:this.targetURL,error:dojo.hitch(this,this.handleError),handleAs:"text"});
req.addCallback(this,"parseReplyResponse");
}
this.clearReply();
cancelClick(e);
},parseReplyResponse:function(_822){
var _823=_822.documentElement;
postNum=this.uniqueId();
var post=new lconn.comm.ronin.post(this,this.docOwner,postNum,_823);
this.postArray[postNum]=post;
this.initPaging();
post.insertPost(this.threadRoot);
if(this.threadState==this.EXPANDED){
post.expandPost();
}
},clearReply:function(e){
if(this.config.staticReplyForm){
var _826=document.getElementById("reply_template_subject");
if(_826!=null){
_826.value="";
}
document.getElementById("reply_template_text").value="";
}
},findFieldMapping:function(_827){
var _828=null;
var _829=new Array();
var _82a=_827.getElementsByTagName("*");
var jj=0;
for(var ii=0;ii<_82a.length;ii++){
var _82d=_82a[ii];
_828=_82d.getAttribute("bindField");
if(_828!=null){
templateId=_82d.getAttribute("id");
if(templateId!=null){
_829[jj]=new lconn.comm.ronin.feedMapping(this.FIELD_MAPPING,templateId,_828,"");
jj++;
}
}
_828=_82d.getAttribute("bindAttribute");
if(_828!=null){
templateId=_82d.getAttribute("id");
var idx=_828.indexOf("|");
if(templateId!=null&&idx!=-1){
var _82f=_828.substring(0,idx);
_828=_828.substring(idx+1);
_829[jj]=new lconn.comm.ronin.feedMapping(this.ATTRIBUTE_MAPPING,templateId,_828,_82f);
jj++;
}
}
_828=_82d.getAttribute("bindProperty");
if(_828!=null){
_828=_828.toLowerCase();
templateId=_82d.getAttribute("id");
if(templateId!=null){
_829[jj]=new lconn.comm.ronin.feedMapping(this.PROPERTY_MAPPING,templateId,_828,"");
jj++;
}
}
}
return _829;
},findRootMapping:function(_830){
var _831=this.DEFAULT_ROOT;
if(_830!=null&&_830.length>0){
var _832=_830[0];
var _833=_832.paths[_832.prefPathIndex].split("/");
_831=_833[0];
if(_833[0].length==0){
_831=_833[1];
}
}
return _831;
},getContainer:function(){
return this.container;
},getPostArray:function(){
return this.postArray;
},getPostCount:function(){
retval=0;
if(this.postArray!=null){
retval=this.postArray.length;
}
return retval;
},getThreadState:function(){
return this.threadState;
},getPost:function(_834){
var _835=null;
if(_834>=0&&_834<this.postArray.length){
_835=this.postArray[_834];
}
return _835;
},isDataLoaded:function(){
return this.dataLoaded;
},isPostTemplateLoaded:function(){
return this.postTemplateLoaded;
},isReplyTemplateLoaded:function(){
return this.replyTemplateLoaded;
},isEditTemplateLoaded:function(){
return this.editTemplateLoaded;
},isDeleteTemplateLoaded:function(){
return this.deleteTemplateLoaded;
},setPost:function(_836,post){
if(_836>=0&&_836<this.postArray.length){
this.postArray[_836]=post;
}
},expandAllPosts:function(){
for(var ii=0;ii<this.postArray.length;ii++){
var post=this.postArray[ii];
post.expandPost();
}
this.threadState=this.EXPANDED;
},collapseAllPosts:function(){
for(var ii=0;ii<this.postArray.length;ii++){
var post=this.postArray[ii];
post.collapsePost();
}
this.threadState=this.COLLAPSED;
},uniqueId:function(){
this.nextUniquePostId++;
return this.nextUniquePostId;
},handleError:function(_83c,_83d){
this.triggerEvent(this.ERROR_EVENT,_83c,_83d.xhr.status);
return true;
},handleParseError:function(){
this.triggerEvent(this.ERROR_EVENT,null,404);
return true;
}});
}
if(!dojo._hasResource["lconn.comm.typeahead.AddMembers"]){
dojo._hasResource["lconn.comm.typeahead.AddMembers"]=true;
dojo.provide("lconn.comm.typeahead.AddMembers");
var w={};
w.templateString="<div class=\"AddMembers\">\r\n    <input type=\"hidden\" name=\"owners_P\" dojoAttachPoint=\"owners_P_AP\" />\r\n    <input type=\"hidden\" name=\"authors_P\" dojoAttachPoint=\"authors_P_AP\" />\r\n    <input type=\"hidden\" name=\"owners_G\" dojoAttachPoint=\"owners_G_AP\" />\r\n    <input type=\"hidden\" name=\"authors_G\" dojoAttachPoint=\"authors_G_AP\" />\r\n    <input type=\"hidden\" name=\"owners_C\" dojoAttachPoint=\"owners_C_AP\" />\r\n    <input type=\"hidden\" name=\"authors_C\" dojoAttachPoint=\"authors_C_AP\" />\r\n\r\n    <div class=\"field\">\r\n        <div dojoAttachPoint=\"memberList_AP\" class=\"memberList\"></div>\r\n    </div>\r\n    <br/>\r\n    <div class=\"field\">\r\n        <select id=\"addMembersSelect\" dojoAttachPoint=\"aclLevel_AP\">\r\n            <option dojoAttachPoint=\"owners_AP\" value=\"owners\">${rs_owner}</option>\r\n            <option value=\"authors\" selected=\"selected\">${rs_member}</option>\r\n        </select>\r\n        <input dojoAttachPoint=\"membersCombo_AP\" ></input>\r\n        <button title=\"${rs_addMember_title}\" class=\"fieldAdd\" style=\"display:none\" dojoAttachEvent=\"onclick: newMember\"> </button>\r\n        <span title=\"${rs_addMember_title}\" class=\"fieldAddText\" style=\"display:none\" dojoAttachEvent=\"onclick: newMember\">+</span>\r\n    </div>\r\n</div>\r\n";
w.rs_member="Member";
w.rs_owner="Owner";
w.rs_addMember_title="Click to add member";
w.rs_removeMember_title="Click to remove member";
w.roleLabels={};
w.memberStore=null;
w.typeAhead_W=null;
w.members={};
w.scrollThreshold=4;
w.cellContainer="addMembersContainer";
w.postMixInProperties=function(){
console.log("Entered postMixInProperties");
this.roleLabels={owners:this.rs_owner,authors:this.rs_member};
console.log("Left postMixInProperties");
};
w.postCreate=function(){
console.log("Entered postCreate");
this.members={P:{owners:[],authors:[]},C:{owners:[],authors:[]},G:{owners:[],authors:[]}};
var url=commContextPath+"service/html/community/autoCompleteMembers.do?format=v2";
this.memberStore=new lconn.core.PeopleDataStore({url:url,queryParam:"member"},this.memberStore_AP);
var args={minChars:2,searchDelay:600,multipleValues:false,store:this.memberStore,"class":"typeAhead"};
this.typeAhead_W=new lconn.core.PeopleTypeAhead(args,this.membersCombo_AP);
dojo.connect(this.typeAhead_W,"_doSelect",this,"newMember");
this.memberList_AP.style.height="";
this.memberList_AP.className="memberList";
console.log("Left postCreate");
};
w.uninitialize=function(){
console.log("Entered uninitialize");
this.members=null;
console.log("Left uninitialize");
};
w.reset=function(){
console.log("Entered reset");
this.members={P:{owners:[],authors:[]},C:{owners:[],authors:[]},G:{owners:[],authors:[]}};
this.aclLevel_AP.value="authors";
this.typeAhead_W.setValue("");
this.owners_P_AP.value=this.authors_P_AP.value=this.owners_G_AP.value=this.authors_G_AP.value=this.owners_C_AP.value=this.authors_C_AP.value="";
this.memberList_AP.innerHTML="";
this.memberList_AP.style.height="";
this.memberList_AP.className="memberList";
this.memberList_AP.style.visibility="";
console.log("Left reset");
};
w.newMember=function(){
console.log("Entered newMember");
var _840=null;
var _841="";
var _842=[];
var _843=false;
_840=this.typeAhead_W.getItem();
_841=this.aclLevel_AP.value;
var type,_845;
if(_840){
switch(parseInt(_840.type)){
case 0:
type="P";
break;
case 1:
type="G";
break;
case 2:
type="C";
break;
default:
type="P";
}
_845=_840.userid;
}else{
type="P";
_845=this.typeAhead_W.getTextBoxValue();
}
if(_845&&_845!="null"){
this.addNewPerson(_841,_845,_840.name,_840.member);
}
console.log("Left newMember");
};
w.addNewPerson=function(_846,_847,_848,_849){
console.log("Entered addNewPerson");
var type="P";
this.members[type][_846].push(_847);
var _84b=document.createElement("div");
dojo.addClass(_84b,"member");
_84b.innerHTML="<div class=\""+(type!=undefined?type:"P")+"\">&nbsp;</div>";
var _84c=document.createElement("div");
dojo.addClass(_84c,"nameContent");
var name=_848+(_849?" <"+_849+">":"");
var _84e=lconn.core.NameUtil.getHTML(name,(_849?_849:null),_847);
_84e=_84e.replace(/&lt;/g,"&lrm;&lt;").replace(/&gt;/g,"&gt;&lrm;");
_84c.innerHTML+=_84e+" <span class=\"type\">("+this.roleLabels[_846]+")</span>";
var _84f=document.createElement("input");
_84f.className="fieldDel";
_84f.type="button";
_84f.title=this.rs_removeMember_title;
this.connect(_84f,"ondijitclick",dojo.hitch(this,"removeMember",_847,type,_846,_84b));
var _850=document.createElement("span");
_850.className="fieldDelText";
_850.title=this.rs_removeMember_title;
_850.innerHTML="X";
this.connect(_850,"ondijitclick",dojo.hitch(this,"removeMember",_847,type,_846,_84b));
_84c.appendChild(_84f);
_84c.appendChild(_850);
_84b.appendChild(_84c);
if(this.memberList_AP.firstChild){
this.memberList_AP.insertBefore(_84b,this.memberList_AP.firstChild);
}else{
this.memberList_AP.appendChild(_84b);
}
this.memberList_AP.style.visibility="visible";
if(window.SemTagSvc&&SemTagSvc.parseDom&&SemTagSvc.service!=null){
SemTagSvc.parseDom(0,_84b);
}
if(this.howManyMembers()>=this.scrollThreshold){
this.memberList_AP.style.height=this.memberList_AP.offsetHeight+"px";
dojo.addClass(this.memberList_AP,"scroll");
}
this.typeAhead_W.setValue("");
if(w.cellContainer!=null){
var _851=dojo.byId(w.cellContainer);
if(_851!=null){
_851.style.display="none";
_851.style.display="block";
}
}
console.log("Left addNewPerson");
};
w.howManyMembers=function(){
var _852=0;
for(type in this.members){
for(level in this.members[type]){
_852+=this.members[type][level].length;
}
}
return _852;
};
w.removeMember=function(_853,type,_855,node,evt){
console.log("Entered removeMember");
if(node){
this.memberList_AP.removeChild(node);
}
var i=0;
while(i<this.members[type][_855].length&&this.members[type][_855][i]!=_853){
i++;
}
if(i<this.members[type][_855].length){
this.members[type][_855].splice(i,1);
}
var _859=this.howManyMembers();
if(_859==0){
this.memberList_AP.style.visibility="hidden";
}else{
if(_859<this.scrollThreshold){
dojo.removeClass(this.memberList_AP,"scroll");
this.memberList_AP.style.height="";
}
}
console.log("Left removeMember");
};
w.setHiddenFields=function(){
console.log("Entered setHiddenFields");
var _85a={};
var len=0;
for(type in this.members){
_85a[type]={};
for(level in this.members[type]){
_85a[type][level]=this.members[type][level].join(",");
}
}
this.owners_P_AP.value=_85a.P.owners;
this.authors_P_AP.value=_85a.P.authors;
this.owners_G_AP.value=_85a.G.owners;
this.authors_G_AP.value=_85a.G.authors;
this.owners_C_AP.value=_85a.C.owners;
this.authors_C_AP.value=_85a.C.authors;
console.log("People owners: **"+this.owners_P_AP.value+"**");
console.log("People members: **"+this.authors_P_AP.value+"**");
console.log("Group owners: **"+this.owners_G_AP.value+"**");
console.log("Group members: **"+this.authors_G_AP.value+"**");
console.log("Community owners: **"+this.owners_C_AP.value+"**");
console.log("Community members: **"+this.authors_C_AP.value+"**");
console.log("Left setHiddenFields");
};
w.getMembers=function(){
return (this.authors_P_AP.value);
};
w.getOwners=function(){
return (this.owners_P_AP.value);
};
dojo.declare("lconn.comm.typeahead.AddMembers",[dijit._Widget,dijit._Templated],w);
}
if(!dojo._hasResource["lconn.communitiesBlog.blogSettings"]){
dojo._hasResource["lconn.communitiesBlog.blogSettings"]=true;
dojo.provide("lconn.communitiesBlog.blogSettings");
lconn.communitiesBlog.blogSettings=function(){
this.onLoad=function(){
lconn.communitiesBlog.iContextId=this.iContext.getRootElement().getAttribute("id");
lconn.communitiesBlog.iContext=window["_"+lconn.communitiesBlog.iContextId+"_iContext"];
var _85c=this.iContext.getiWidgetAttributes();
if(!lconn.communitiesBlog.communityId){
lconn.communitiesBlog.communityId=_85c.getItemValue("resourceId");
}
lconn.communitiesBlog.communityBlogHandle=lconn.communitiesBlog.communityId;
lconn.communitiesBlog.blogsWidgetURL=lconn.communitiesBlog.iContext.getElementById("blogsWidgetContextURL").attributes.getNamedItem("value").nodeValue;
lconn.communitiesBlog.blogsAppURL=_85c.getItemValue("blogsBaseUrl");
lconn.communitiesBlog.communitiesAppURL=_85c.getItemValue("communitiesBaseUrl");
lconn.communitiesBlog.profilesAppURL=_85c.getItemValue("profilesBaseUrl");
lconn.communitiesBlog.strings=dojo.i18n.getLocalization("lconn.communitiesBlog","strings");
lconn.communitiesBlog.tagWidgetInit=false;
lconn.communitiesBlog.blogsDate.init();
lconn.communitiesBlog.local=_85c.getItemValue("lang");
var mode=this.iContext.getiDescriptor().getItemValue("mode");
if(mode=="search"){
var _85e="communities:blogs";
var _85f=this.iContext.getElementById("resultContainer");
lconn.core.widgetUtils.search(this.iContext,_85e,_85f);
}else{
if(mode=="view"){
var _860=this.iContext.getUserProfile();
lconn.communitiesBlog.userId=_860.getItemValue("userId");
lconn.communitiesBlog.canContribute=_860.getItemValue("canContribute")=="true";
if(lconn.communitiesBlog.userId!=null){
lconn.communitiesBlog.userLogin=true;
}else{
lconn.communitiesBlog.userLogin=false;
}
var _861=this.getBlogEntryFeed();
if(!_861){
return;
}
if(typeof (lconn.communitiesBlog.blogAPIURL)!="undefined"){
lconn.communitiesBlog.userRole=0;
}else{
if(lconn.communitiesBlog.userLogin){
lconn.communitiesBlog.userRole=1;
}else{
lconn.communitiesBlog.userRole=2;
}
}
lconn.communitiesBlog.blogSection.loadEntriesWithParamSimple();
}else{
if(mode=="edit"){
this.prepareUpdateForm();
}
}
}
dojo.connect(this.iContext.iEvents,"fireEvent",this,"checkEventForUpdateForm");
};
this.switchToMode=function(mode){
this.iContext.iEvents.fireEvent("onModeChanged","","{'newMode': '"+mode+"'}");
};
this.retriveServiceDoc=function(){
dojo.xhrGet({url:this.iContext.io.rewriteURI(lconn.communitiesBlog.blogsAppURL+"/api"),handleAs:"xml",load:function(_863,_864){
if(dojo.isIE){
dojo.forEach(["MSXML2","Microsoft","MSXML","MSXML3"],function(_865){
try{
var dom=new ActiveXObject(_865+".XMLDOM");
dom.async=false;
dom.loadXML(_864.xhr.responseText);
_863=dom;
}
catch(e){
}
});
}
lconn.communitiesBlog.myBlogFeedURL=_863.getElementsByTagName("collection")[0].attributes.getNamedItem("href").nodeValue;
},error:function(data){
if(dojo.isFF){
console.debug(data);
}
},sync:true});
};
this.getBlogEntryFeed=function(){
var _868=true;
lconn.communitiesBlog.haveBlog=true;
var _869=lconn.communitiesBlog.blogsAppURL+"/roller-ui/rendering/feed_form/"+lconn.communitiesBlog.communityBlogHandle+"/entries/atom?ps="+lconn.communitiesBlog.blogSection.defaultEntryPageSize+"&page=0&sortby=0&order=desc&cache=false&fromCommunity=true&lang="+lconn.communitiesBlog.local;
if(lconn.communitiesBlog.userLogin){
_869+="&user="+lconn.communitiesBlog.userId;
}
if(lconn.communitiesBlog.canContribute){
_869+="&isMember=true";
}else{
_869+="&isMember=false";
}
_869=lconn.core.widgetUtils.handleRefresh(_869,this.iContext);
dojo.xhrGet({url:this.iContext.io.rewriteURI(_869),load:function(_86a,_86b){
lconn.communitiesBlog.blogSection.atomDoc=_86a;
var _86c=_86a.getElementsByTagName("link");
for(var j=0;j<_86c.length;j++){
if(_86c[j].attributes.getNamedItem("rel")&&_86c[j].attributes.getNamedItem("rel").nodeValue=="edit"){
lconn.communitiesBlog.blogAPIURL=_86c[j].attributes.getNamedItem("href").nodeValue;
}
}
},error:function(_86e,_86f){
_868=false;
lconn.communitiesBlog.haveBlog=false;
var _870=dojo.i18n.getLocalization("lc_default")["errorUnableToConnect"];
_870=lconn.core.utilities.replacePlaceHolders(_870,[_86f.args.url]);
if("404"==_86e.status){
errorString=dojo.string.substitute(lconn.communitiesBlog.strings.rs_service_not_available,{"htmlLeft":"<a class='lotusAction' href='javascript:lconn.communitiesBlog.iContext.iScope().onLoad();'>","htmlRight":"</a>"});
_86e.message=errorString;
lconn.core.errorhandling.DefaultErrorHandler(_870,_86e,"blogSectionDiv");
}else{
lconn.core.errorhandling.DefaultErrorHandler(_870,_86e,"blogSectionDiv");
}
},handleAs:"xml",sync:true});
return _868;
};
this.updateForm=function(form){
var kw={url:this.iContext.io.rewriteURI(lconn.communitiesBlog.blogAPIURL+"?fromCommunity=true&lang="+lconn.communitiesBlog.local),handleAs:"xml",load:function(data,_874){
if(dojo.isIE){
dojo.forEach(["MSXML2","Microsoft","MSXML","MSXML3"],function(_875){
try{
var dom=new ActiveXObject(_875+".XMLDOM");
dom.async=false;
dom.loadXML(_874.xhr.responseText);
data=dom;
}
catch(e){
}
});
}
var _877;
dojo.forEach(data.getElementsByTagName("title"),function(_878){
if(_878.nodeName=="title"){
_877=_878.childNodes[0].nodeValue;
}
});
if(data.getElementsByTagName("summary").length!=0&&data.getElementsByTagName("summary")[0].childNodes[0]){
var _879=data.getElementsByTagName("summary")[0].childNodes[0].nodeValue;
}
var _87a;
var _87b;
var _87c;
if((dojo.isFF>0&&dojo.isFF<=2)||dojo.isSafari>0){
if(data.getElementsByTagName("timezone").length!=0&&data.getElementsByTagName("timezone")[0].childNodes[0]){
_87a=data.getElementsByTagName("timezone")[0].childNodes[0].nodeValue;
}
if(data.getElementsByTagName("maprole").length!=0&&data.getElementsByTagName("maprole")[0].childNodes[0]){
_87b=data.getElementsByTagName("maprole")[0].childNodes[0].nodeValue;
}
if(data.getElementsByTagName("commentmoderated").length!=0&&data.getElementsByTagName("commentmoderated")[0].attributes.getNamedItem("enabled")){
_87c=data.getElementsByTagName("commentmoderated")[0].attributes.getNamedItem("enabled").nodeValue;
}
}else{
if(data.getElementsByTagName("snx:timezone").length!=0&&data.getElementsByTagName("snx:timezone")[0].childNodes[0]){
_87a=data.getElementsByTagName("snx:timezone")[0].childNodes[0].nodeValue;
}
if(data.getElementsByTagName("snx:maprole").length!=0&&data.getElementsByTagName("snx:maprole")[0].childNodes[0]){
_87b=data.getElementsByTagName("snx:maprole")[0].childNodes[0].nodeValue;
}
if(data.getElementsByTagName("snx:commentmoderated").length!=0&&data.getElementsByTagName("snx:commentmoderated")[0].attributes.getNamedItem("enabled")){
_87c=data.getElementsByTagName("snx:commentmoderated")[0].attributes.getNamedItem("enabled").nodeValue;
}
}
var _87d="";
dojo.forEach(data.getElementsByTagName("category"),function(_87e){
if(_87e.attributes.getNamedItem("scheme")==null){
_87d+=_87e.attributes.getNamedItem("term").nodeValue+" ";
}
});
if(_877){
form.title.value=lconn.communitiesBlog.unescape(_877);
}
if(_879){
form.description.value=lconn.communitiesBlog.unescape(_879);
}
if(_87a){
form.timeZone.value=_87a;
}
if(_87b){
dojo.query("#blogSettingsForm input[name='role']").forEach(function(node){
if(node.value==_87b){
node.checked=true;
}
});
}
if(_87c){
form.commentsMode.value=_87c;
}
if(_87d){
form.tagsAsString.value=lconn.communitiesBlog.unescape(_87d);
}
},error:function(data){
if(dojo.isFF){
console.debug(data);
}
}};
kw.preventCache="true";
dojo.xhrGet(kw);
};
this.updateBlog=function(form){
var _882="<?xml version='1.0' encoding='UTF-8'?>"+"<entry xmlns:snx='http://www.ibm.com/xmlns/prod/sn' xmlns='http://www.w3.org/2005/Atom'>"+"<title type='text'>"+lconn.communitiesBlog.escapeContent(form.title.value)+"</title>"+"<summary type='text'>"+lconn.communitiesBlog.escapeContent(form.description.value)+"</summary>"+"<snx:timezone>"+form.timeZone.value+"</snx:timezone>"+"<snx:handle>"+form.handle.value+"</snx:handle>"+"<snx:containertype>0</snx:containertype>"+"<snx:containerid>"+lconn.communitiesBlog.communityId+"</snx:containerid>"+"<app:control xmlns:app='http://www.w3.org/2007/app'><snx:commentmoderated xmlns:snx='http://www.ibm.com/xmlns/prod/sn' enabled='"+form.commentsMode.value+"' /></app:control>"+"<snx:maprole membership='member'>"+this.getRoleValue()+"</snx:maprole>";
var _883=form.tagsAsString.value;
var _884=_883.split(/ |,/g);
dojo.forEach(_884,function(tag){
_882+="<category term='"+lconn.communitiesBlog.escapeContent(tag)+"'/>";
});
_882+="</entry>";
dojo.rawXhrPut({url:this.iContext.io.rewriteURI(lconn.communitiesBlog.blogAPIURL),handleAs:"xml",putData:_882,headers:{"Content-Type":"application/atom+xml"},load:function(data){
if(dojo.isFF){
console.debug(data);
console.debug(data.getElementsByTagName("id"));
console.debug(data.getElementsByTagName("id")[0]);
}
},error:function(data){
if(dojo.isFF){
console.debug(data);
}
},sync:true});
this.hideEditForm();
};
this.createBlogWithDefaultValue=function(){
var _888=this;
var _889="true";
if(lconn.communitiesBlog.communityInfo.communityType=="public"){
_889="false";
}
var _88a="<?xml version='1.0' encoding='UTF-8'?>"+"<entry xmlns:snx='http://www.ibm.com/xmlns/prod/sn' xmlns='http://www.w3.org/2005/Atom'>"+"<title type='text'>"+lconn.communitiesBlog.escapeContent(lconn.communitiesBlog.communityInfo.title)+"</title>"+"<snx:handle>"+lconn.communitiesBlog.communityBlogHandle+"</snx:handle>"+"<snx:privacy>"+lconn.communitiesBlog.communityInfo.communityType+"</snx:privacy>"+"<snx:timezone>"+this.getClientBrowserTimezone()+"</snx:timezone>"+"<snx:containertype>0</snx:containertype>"+"<snx:containerid>"+lconn.communitiesBlog.communityId+"</snx:containerid>"+"<snx:commentmoderated>"+_889+"</snx:commentmoderated>"+"<snx:maprole membership='member'>author</snx:maprole>";
if(typeof (lconn.communitiesBlog.communityInfo.tagsAsString)!="undefined"){
var _88b=lconn.communitiesBlog.communityInfo.tagsAsString;
var _88c=_88b.split(/ |,/g);
dojo.forEach(_88c,function(tag){
_88a+="<category term='"+lconn.communitiesBlog.escapeContent(tag)+"'/>";
});
}
_88a+="</entry>";
dojo.rawXhrPost({url:this.iContext.io.rewriteURI(lconn.communitiesBlog.myBlogFeedURL),handleAs:"xml",postData:_88a,headers:{"Content-Type":"application/atom+xml"},load:function(data){
if(dojo.isFF){
console.debug(data);
console.debug(data.getElementsByTagName("id"));
console.debug(data.getElementsByTagName("id")[0].childNodes[0].nodeValue);
}
var _88f=data.getElementsByTagName("id")[0].childNodes[0].nodeValue.substring(28);
},error:function(data){
if(dojo.isFF){
console.debug(data);
}
},sync:true});
};
this.submitForm=function(form){
this.updateBlog(form);
return false;
};
this.checkEventForUpdateForm=function(_892,_893,_894){
if("{'newMode':'edit'}"==_894){
this.prepareUpdateForm();
}
};
this.prepareUpdateForm=function(){
if(dijit.registry.byId("tagsAsString")!=null&&!lconn.communitiesBlog.tagWidgetInit){
dijit.byId("tagsAsString").destroy();
}
document.forms.blogSettingsForm.handle.value=lconn.communitiesBlog.communityBlogHandle;
dojo.parser.parse(lconn.communitiesBlog.iContext.getElementById("blogsSettingsDiv"));
lconn.communitiesBlog.tagWidgetInit=true;
dijit.byId("tagsAsString").store.url=this.iContext.io.rewriteURI(lconn.communitiesBlog.blogsAppURL+"/roller-services/json/typeahead?&requestType=blog&limit=10");
if(lconn.communitiesBlog.userRole==0){
this.updateForm(document.forms.blogSettingsForm);
}
};
this.showEditForm=function(){
this.switchToMode(this.iContext.constants.mode.EDIT);
this.prepareUpdateForm();
};
this.hideEditForm=function(){
this.switchToMode(this.iContext.constants.mode.VIEW);
};
this.toggleDeleteBlogDiv=function(){
var div=lconn.communitiesBlog.iContext.getElementById("deleteBlogDiv");
var _896=lconn.communitiesBlog.iContext.getElementById("deleteBlogDivHandle");
if(div.style.display=="none"){
div.style.display="block";
_896.src=lconn.communitiesBlog.communitiesAppURL+"/nav/common/styles/images/searchArrowOpen.gif";
}else{
div.style.display="none";
_896.src=lconn.communitiesBlog.communitiesAppURL+"/nav/common/styles/images/searchArrowClosed.gif";
}
};
this.getRoleValue=function(){
var rt;
dojo.query("#blogSettingsForm input[name='role']").forEach(function(node){
if(node.checked){
rt=node.value;
}
});
return rt;
};
this.retriveCommunityInfo=function(){
if(!lconn.communitiesBlog.communityInfo){
lconn.communitiesBlog.communityInfo=new Object();
}
dojo.xhrGet({url:lconn.communitiesBlog.communitiesAppURL+"/service/atom/community/instance?communityUuid="+lconn.communitiesBlog.communityId,handleAs:"xml",load:function(data,_89a){
if(dojo.isIE){
dojo.forEach(["MSXML2","Microsoft","MSXML","MSXML3"],function(_89b){
try{
var dom=new ActiveXObject(_89b+".XMLDOM");
dom.async=false;
dom.loadXML(_89a.xhr.responseText);
data=dom;
}
catch(e){
}
});
}
if(data.getElementsByTagName("title")[0].length!=0&&data.getElementsByTagName("title")[0].childNodes[0]){
lconn.communitiesBlog.communityInfo.title=data.getElementsByTagName("title")[0].childNodes[0].nodeValue;
}
if((dojo.isFF>0&&dojo.isFF<=2)||dojo.isSafari>0){
if(data.getElementsByTagName("communityType")[0].length!=0&&data.getElementsByTagName("communityType")[0].childNodes[0]){
lconn.communitiesBlog.communityInfo.communityType=data.getElementsByTagName("communityType")[0].childNodes[0].nodeValue;
if(lconn.communitiesBlog.communityInfo.communityType=="publicInviteOnly"){
lconn.communitiesBlog.communityInfo.communityType="moderated";
}
}
}else{
if(data.getElementsByTagName("snx:communityType")[0].length!=0&&data.getElementsByTagName("snx:communityType")[0].childNodes[0]){
lconn.communitiesBlog.communityInfo.communityType=data.getElementsByTagName("snx:communityType")[0].childNodes[0].nodeValue;
if(lconn.communitiesBlog.communityInfo.communityType=="publicInviteOnly"){
lconn.communitiesBlog.communityInfo.communityType="moderated";
}
}
}
var _89d="";
dojo.forEach(data.getElementsByTagName("category"),function(_89e){
if(_89e.attributes.getNamedItem("scheme")==null){
_89d+=_89e.attributes.getNamedItem("term").nodeValue+" ";
}
});
if(_89d.length!=0){
lconn.communitiesBlog.communityInfo.tagsAsString=_89d;
}
},sync:true,error:function(data){
if(dojo.isFF){
console.debug(data);
}
}});
};
this.getClientBrowserTimezone=function(){
var _8a0=function(_8a1){
var _8a2;
_8a1=Math.abs(_8a1);
var a=Math.floor(_8a1);
var b=(_8a1-a)*60;
if(_8a1<10){
_8a2="0"+a+(b==0?"00":b);
}else{
_8a2=""+a+(b==0?"00":b);
}
return _8a2;
};
timeZoneMapping={"n1200":"Etc/GMT+12","n1100":"Pacific/Pago_Pago","n1000":"Pacific/Honolulu","n0900":"America/Anchorage","n0800":"America/Los_Angeles","n0700":"America/Phoenix","n0600":"America/Guatemala","n0500":"America/Lima","n0400":"America/Halifax","n0330":"America/St_Johns","n0300":"America/Sao_Paulo","n0200":"Atlantic/South_Georgia","n0100":"Atlantic/Azores","_00":"Africa/Casablanca","p0100":"Europe/Amsterdam","p0200":"Asia/Amman","p0300":"Asia/Baghdad","p0330":"Asia/Tehran","p0400":"Asia/Muscat","p0430":"Asia/Kabul","p0500":"Asia/Yekaterinburg","p0530":"Asia/Calcutta","p0545":"Asia/Katmandu","p0600":"Asia/Almaty","p0630":"Asia/Rangoon","p0700":"Asia/Bangkok","p0800":"Asia/Hong_Kong","p0900":"Asia/Tokyo","p0930":"Australia/Adelaide","p1000":"Australia/Brisbane","p1100":"Pacific/Noumea","p1200":"Pacific/Auckland","p1300":"Pacific/Tongatapu"};
var date=new Date();
var _8a6=date.toString();
_8a6=_8a6.substring(_8a6.length-8);
if(_8a6==lconn.communitiesBlog.serverDefaultTimezoneOffset&&lconn.communitiesBlog.serverDefaultTimezoneID!=""){
return lconn.communitiesBlog.serverDefaultTimezoneID;
}
var _8a7=date.getTimezoneOffset()/60;
var _8a8;
if(_8a7<0){
_8a8="p"+_8a0(_8a7);
}else{
if(_8a7>0){
_8a8="n"+_8a0(_8a7);
}else{
_8a8="_00";
}
}
var _8a9=eval("timeZoneMapping."+_8a8);
return _8a9;
};
this.recommendEntry=function(_8aa){
dojo.rawXhrPost({url:this.iContext.io.rewriteURI(_8aa),handleAs:"xml",postData:"",headers:{"Content-Type":"application/atom+xml"},load:function(data){
lconn.communitiesBlog.blogSection.loadEntriesWithParam(lconn.communitiesBlog.page,lconn.communitiesBlog.sortby,lconn.communitiesBlog.order);
},error:function(data){
if(isFF){
console.debug(data);
}
},sync:true});
};
this.recommendComment=function(_8ad,_8ae,_8af,page){
dojo.rawXhrPost({url:this.iContext.io.rewriteURI(_8ad),handleAs:"xml",postData:"",headers:{"Content-Type":"application/atom+xml"},load:function(data){
lconn.communitiesBlog.blogSection.showEntryComments(_8ae,_8af,page,true);
},error:function(data){
if(isFF){
console.debug(data);
}
},sync:true});
};
};
}
if(!dojo._hasResource["lconn.communitiesBlog.blogSection"]){
dojo._hasResource["lconn.communitiesBlog.blogSection"]=true;
dojo.provide("lconn.communitiesBlog.blogSection");
lconn.communitiesBlog.blogSection.defaultEntryPageSize=5;
lconn.communitiesBlog.blogSection.defaultCommentPageSize=2;
lconn.communitiesBlog.blogSection.loadEntriesWithParamSimple=function(){
lconn.communitiesBlog.iContext.getElementById("blogSectionDiv").innerHTML="<div id=\"blogEntries\" style=\"text-align:center;\"><img src=\""+lconn.communitiesBlog.communitiesAppURL+"/nav/common/styles/images/loading.gif\"/></div>";
var _8b3;
_8b3=lconn.communitiesBlog.blogSection.atomDoc;
lconn.communitiesBlog.blogSection.atomDoc=undefined;
var _8b4=lconn.core.xslt.transformDocument(_8b3,lconn.communitiesBlog.blogsWidgetURL+"/blogsTiny.xsl?version="+WidgetPlacementConfig.params["version"]);
lconn.communitiesBlog.addPropertiesToStringBundle();
_8b4=dojo.string.substitute(_8b4,lconn.communitiesBlog.strings);
lconn.communitiesBlog.iContext.getElementById("blogSectionDiv").innerHTML=_8b4;
if(!lconn.communitiesBlog.iContext.getElementById("blogsWelcomeBox")){
lconn.communitiesBlog.blogSection.updateDateFormat(lconn.communitiesBlog.iContext.getElementById("blogEntries"));
lconn.communitiesBlog.blogSection.updateRatingImg(lconn.communitiesBlog.iContext.getElementById("blogEntries"));
lconn.communitiesBlog.blogSection.updateBlogsIcon(lconn.communitiesBlog.iContext.getElementById("blogEntries"));
lconn.communitiesBlog.blogSection.updateExpandImg(lconn.communitiesBlog.iContext.getElementById("blogEntries"));
var _8b5=dojo.query(".blogContentContainer",lconn.communitiesBlog.iContext.getElementById("blogEntries"));
for(var i=0;i<_8b5.length;i++){
_8b5[i].innerHTML=lconn.communitiesBlog.unescapeContent(_8b5[i].innerHTML);
if(_8b5[i].innerHTML.length>200){
var _8b7=_8b5[i].innerHTML;
var _8b8=200;
_8b5[i].innerHTML=_8b7.substring(0,_8b8)+" ...";
}
}
if(window.SemTagSvc&&SemTagSvc.parseDom){
SemTagSvc.parseDom(0,lconn.communitiesBlog.iContext.getElementById("blogSectionDiv"));
}
}
var _8b9=lconn.communitiesBlog.iContext.getElementById("blogsLogo");
if(_8b9){
_8b9.src=lconn.communitiesBlog.communitiesAppURL+"/nav/common/styles/images/iconBlog.gif";
}
if(lconn.communitiesBlog.userRole!=0){
var _8ba=lconn.communitiesBlog.iContext.getElementById("blogsAddNewEntryLink");
if(_8ba){
if(!lconn.communitiesBlog.iContext.getElementById("blogsWelcomeBox")){
var _8bb=_8ba.parentNode.parentNode;
_8bb.removeChild(_8ba.parentNode);
}else{
var _8bc=lconn.communitiesBlog.iContext.getElementById("welcomeString");
_8bc.innerHTML=lconn.communitiesBlog.strings.rs_get_started_string2;
var _8bd=_8ba.parentNode;
_8bd.removeChild(_8ba);
}
}
}
var _8be=lconn.communitiesBlog.iContext.getElementById("blogsAddNewEntryLink");
if(_8be!=null){
_8be.href=lconn.communitiesBlog.blogsAppURL+"/roller-ui/authoring/weblog.do?method=create&weblog="+lconn.communitiesBlog.communityBlogHandle+"&fromCommunity="+resourceId+"&lang="+lconn.communitiesBlog.local;
}
};
lconn.communitiesBlog.blogSection.loadEntriesWithParam=function(page,_8c0,_8c1){
lconn.communitiesBlog.page=page;
lconn.communitiesBlog.sortby=_8c0;
lconn.communitiesBlog.order=_8c1;
var _8c2;
var _8c3=lconn.communitiesBlog.blogsAppURL+"/roller-ui/rendering/feed/"+lconn.communitiesBlog.communityBlogHandle+"/entries/atom?ps="+lconn.communitiesBlog.blogSection.defaultEntryPageSize+"&page="+page+"&sortby="+_8c0+"&cache=false&fromCommunity=true";
if(_8c1){
_8c3+="&order="+_8c1;
}
if(typeof (lconn.communitiesBlog.blogSection.atomDoc)=="undefined"){
dojo.xhrGet({url:lconn.communitiesBlog.iContext.io.rewriteURI(_8c3),load:function(_8c4,_8c5){
_8c2=_8c4;
},handleAs:"xml",sync:true});
}else{
_8c2=lconn.communitiesBlog.blogSection.atomDoc;
lconn.communitiesBlog.blogSection.atomDoc=undefined;
}
var _8c6=lconn.core.xslt.transformDocument(_8c2,lconn.communitiesBlog.blogsWidgetURL+"/blogs.xsl");
lconn.communitiesBlog.addPropertiesToStringBundle();
_8c6=dojo.string.substitute(_8c6,lconn.communitiesBlog.strings);
lconn.communitiesBlog.iContext.getElementById("blogSectionDiv").innerHTML=_8c6;
if(!lconn.communitiesBlog.iContext.getElementById("blogsWelcomeBox")){
var link;
switch(_8c0){
case 0:
link=lconn.communitiesBlog.iContext.getElementById("lconn_blogs25_blogSection_sort_date");
if(_8c1=="asc"){
link.href="javascript:lconn.communitiesBlog.blogSection.loadEntriesWithParam(0,0,'desc');";
link.innerHTML+=" <img alt='Ascending Order' src='"+lconn.communitiesBlog.communitiesAppURL+"/nav/common/styles/images/sortAscending.gif'/>";
}else{
link.href="javascript:lconn.communitiesBlog.blogSection.loadEntriesWithParam(0,0,'asc');";
link.innerHTML+=" <img alt='Descending Order' src='"+lconn.communitiesBlog.communitiesAppURL+"/nav/common/styles/images/sortDescending.gif'/>";
}
break;
case 1:
link=lconn.communitiesBlog.iContext.getElementById("lconn_blogs25_blogSection_sort_title");
if(_8c1=="asc"){
link.href="javascript:lconn.communitiesBlog.blogSection.loadEntriesWithParam(0,1,'desc');";
link.innerHTML+=" <img alt='Ascending Order' src='"+lconn.communitiesBlog.communitiesAppURL+"/nav/common/styles/images/sortAscending.gif'/>";
}else{
link.href="javascript:lconn.communitiesBlog.blogSection.loadEntriesWithParam(0,1,'asc');";
link.innerHTML+=" <img alt='Descending Order' src='"+lconn.communitiesBlog.communitiesAppURL+"/nav/common/styles/images/sortDescending.gif'/>";
}
break;
case 2:
link=lconn.communitiesBlog.iContext.getElementById("lconn_blogs25_blogSection_sort_recom");
break;
case 3:
link=lconn.communitiesBlog.iContext.getElementById("lconn_blogs25_blogSection_sort_comment");
break;
case 4:
link=lconn.communitiesBlog.iContext.getElementById("lconn_blogs25_blogSection_sort_visit");
break;
}
dojo.addClass(link,"lotusActiveSort");
var _8c8;
if((dojo.isFF>0&&dojo.isFF<=2)||dojo.isSafari>0){
_8c8=_8c2.getElementsByTagName("totalResults")[0].childNodes[0].nodeValue;
}else{
_8c8=_8c2.getElementsByTagName("openSearch:totalResults")[0].childNodes[0].nodeValue;
}
var _8c9=lconn.communitiesBlog.blogSection.defaultEntryPageSize*page+1;
var _8ca;
if((lconn.communitiesBlog.blogSection.defaultEntryPageSize*(page+1))<=_8c8){
_8ca=lconn.communitiesBlog.blogSection.defaultEntryPageSize*(page+1);
}else{
_8ca=_8c8;
}
lconn.communitiesBlog.blogSection.blogsPagerLeftTemplateValues={"totalResults":_8c8,"startResultNum":_8c9,"endResultNum":_8ca};
var _8cb=lconn.communitiesBlog.strings.blogsPagerLeftTemplate;
blogsPagerLeftString=dojo.string.substitute(_8cb,lconn.communitiesBlog.blogSection.blogsPagerLeftTemplateValues);
lconn.communitiesBlog.iContext.getElementById("blogsPagerLeft").innerHTML=blogsPagerLeftString;
var _8cc=Math.ceil(_8c8/lconn.communitiesBlog.blogSection.defaultEntryPageSize);
lconn.communitiesBlog.iContext.getElementById("blogsPagerCenter").innerHTML=lconn.communitiesBlog.blogSection.showPager(_8cc,page+1,_8c0,_8c1);
var _8cd="<li class='lotusFirst'>";
var _8ce;
var _8cf;
var _8d0=_8c2.getElementsByTagName("link");
for(var i=0;i<_8d0.length;i++){
var _8d2=_8d0[i];
if(_8d2.attributes.getNamedItem("rel")&&_8d2.attributes.getNamedItem("rel").nodeValue=="next"){
_8cf=_8d2.attributes.getNamedItem("href").nodeValue;
}
}
if(page!=0){
_8ce="\"javascript:lconn.communitiesBlog.blogSection.loadEntriesWithParam("+(page-1)+","+_8c0+(_8c1?(",'"+_8c1+"'"):"")+");\"";
_8cd+="<a href="+_8ce+">"+lconn.communitiesBlog.strings.rs_previous+"</a>";
}else{
_8cd+="<span class='disabled lotusDisabled'>"+lconn.communitiesBlog.strings.rs_previous+"</span>";
}
_8cd+="<span class='disabled lotusDisabled'>&nbsp;|&nbsp;</span>";
if(_8cf){
_8cf="\"javascript:lconn.communitiesBlog.blogSection.loadEntriesWithParam("+(page+1)+","+_8c0+(_8c1?(",'"+_8c1+"'"):"")+");\"";
_8cd+="<a href="+_8cf+">"+lconn.communitiesBlog.strings.rs_next+"</a>";
}else{
_8cd+="<span class='disabled lotusDisabled'>"+lconn.communitiesBlog.strings.rs_next+"</span>";
}
_8cd+="</li>";
lconn.communitiesBlog.iContext.getElementById("blogsPagerRight").innerHTML=_8cd;
lconn.communitiesBlog.blogSection.updateDateFormat(lconn.communitiesBlog.iContext.getElementById("blogEntries"));
lconn.communitiesBlog.blogSection.updateRatingImg(lconn.communitiesBlog.iContext.getElementById("blogEntries"));
var _8d3=dojo.query(".entry",lconn.communitiesBlog.iContext.getElementById("blogEntries"));
for(var i=0;i<_8d3.length;i++){
lconn.communitiesBlog.blogSection.updateActionLinks(_8d3[i]);
}
if(dojo.isFF){
var _8d4=dojo.query(".blogContentContainer",lconn.communitiesBlog.iContext.getElementById("blogEntries"));
for(var i=0;i<_8d4.length;i++){
_8d4[i].innerHTML=lconn.communitiesBlog.unescapeContent(_8d4[i].innerHTML);
}
}
lconn.communitiesBlog.blogSection.updateUserPhoto(lconn.communitiesBlog.iContext.getElementById("blogEntries"),".blogEntryPhoto");
if(window.SemTagSvc&&SemTagSvc.parseDom){
SemTagSvc.parseDom(0,lconn.communitiesBlog.iContext.getElementById("blogSectionDiv"));
}
}
var _8d5=lconn.communitiesBlog.iContext.getElementById("blogsLogo");
if(_8d5){
_8d5.src=lconn.communitiesBlog.communitiesAppURL+"/nav/common/styles/images/iconBlogsLarge.png";
}
if(lconn.communitiesBlog.userRole!=0){
var _8d6=dojo.query("span.lotusBtn",lconn.communitiesBlog.iContext.getElementById("blogSectionDiv"))[0];
if(_8d6){
var _8d7=_8d6.parentNode;
_8d7.removeChild(_8d6);
}
}
var _8d8=lconn.communitiesBlog.iContext.getElementById("blogsAddNewEntryLink");
if(_8d8!=null){
_8d8.href=lconn.communitiesBlog.blogsAppURL+"/roller-ui/authoring/weblog.do?method=create&weblog="+lconn.communitiesBlog.communityBlogHandle;
}
};
lconn.communitiesBlog.blogSection.showGetStart=function(_8d9){
var html="<div class=\"lotusWelcomeBox\">"+"<img alt=\""+lconn.communitiesBlog.strings.rs_blogs_logo+"\" title=\""+lconn.communitiesBlog.strings.rs_blogs_logo+"\" src=\""+lconn.communitiesBlog.communitiesAppURL+"/nav/common/styles/images/iconBlogsLarge.png\"/>"+"<h2 style=\"background-color:transparent;\">"+lconn.communitiesBlog.strings.rs_get_started+"</h2>"+"<p>"+lconn.communitiesBlog.strings.rs_get_started_string1+"</p>"+"<p>"+lconn.communitiesBlog.strings.rs_get_started_string2+"</p>"+"<div class=\"lotusBtnContainer\">"+"<span class=\"lotusBtn lotusBtnAction\"><a href=\"javascript:openHelpWindow('"+lconn.communitiesBlog.blogsAppURL+"/roller-ui/blog/help')\">"+lconn.communitiesBlog.strings.rs_learn_more+"</a></span>"+"<span class=\"lotusBtn lotusBtnAction\"><a href=\""+lconn.communitiesBlog.blogsAppURL+"/roller-ui/demos/blogoverview_viewlet_swf.jsp\">"+lconn.communitiesBlog.strings.rs_watch_demo+"</a></span>"+"<span class=\"lotusBtn lotusBtnAction\"><a href=\"javascript:lconn.communitiesBlog.iContext.iScope().showEditForm();\" title=\"Edit Community Blog\">"+lconn.communitiesBlog.strings.rs_edit+"</a></span>"+"</div>"+"</div>";
lconn.communitiesBlog.iContext.getElementById("blogSectionDiv").innerHTML=html;
};
lconn.communitiesBlog.blogSection.showPager=function(_8db,_8dc,_8dd,_8de){
var _8df="<ul class='inlinelist lotusInlinelist' style='text-align:center'>";
var _8e0=new Array();
if(_8db<=7){
for(var i=1;i<=7;i++){
if(i<=_8db){
_8e0.push(i);
}
}
}else{
_8e0.push(1);
if(_8dc<5){
for(var i=2;i<=5;i++){
_8e0.push(i);
}
}else{
_8e0.push(-1);
}
if(_8dc>4&&_8dc<_8db-3){
_8e0.push(_8dc-1);
_8e0.push(_8dc);
_8e0.push(_8dc+1);
}
if(_8dc>_8db-4){
var tl=_8db-4;
var tr=_8db-1;
for(var t=tl;t<tr;t++){
_8e0.push(t);
}
}else{
_8e0.push(-1);
}
_8e0.push(_8db);
}
_8df+="<li class='first lotusFirst'>"+lconn.communitiesBlog.strings.rs_page+" &nbsp;";
lastPageLink=0;
var _8e5;
for(var i=0;i<_8e0.length;i++){
if(_8e0[i]==-1){
_8e5="...";
}else{
_8e5=_8e0[i];
}
if(_8e0[i]!=1&&_8e0[i]!=-1&&lastPageLink!=-1){
_8df+="<span class='disabledLink'>&nbsp;|&nbsp;</span>";
}else{
_8df+="<span class='disabledLink'>&nbsp;</span>";
}
if((_8e0[i]!=-1)&&(_8dc!=_8e0[i])){
var p=_8e0[i]-1;
_8df+="<a href=\"javascript:lconn.communitiesBlog.blogSection.loadEntriesWithParam("+(_8e0[i]-1)+","+_8dd+(_8de?(",'"+_8de+"'"):"")+");\">"+_8e5+"</a>";
}else{
_8df+=_8e5;
}
lastPageLink=_8e0[i];
}
_8df+="</li></ul>";
return _8df;
};
lconn.communitiesBlog.blogSection.showEntryComments=function(_8e7,_8e8,page,_8ea){
_8e8=encodeURI(_8e8);
var _8eb=lconn.communitiesBlog.iContext.getElementById("blogsEntryComment_"+_8e7);
var _8ec;
var _8ed;
var _8ee;
if(_8eb.style.display=="none"||_8ea){
var _8ef=_8e8+"?ps="+lconn.communitiesBlog.blogSection.defaultCommentPageSize+"&page="+page+"&order=asc&cache=false&fromCommunity=true";
if(lconn.communitiesBlog.useAjaxProxy){
_8ef=encodeURI(_8ef);
}
dojo.xhrGet({url:lconn.communitiesBlog.iContext.io.rewriteURI(_8ef),load:function(_8f0,_8f1){
_8ec=_8f0;
},handleAs:"xml",sync:true});
_8ed=lconn.core.xslt.transformDocument(_8ec,lconn.communitiesBlog.blogsWidgetURL+"/blogComment.xsl");
lconn.communitiesBlog.addPropertiesToStringBundle();
_8ed=dojo.string.substitute(_8ed,lconn.communitiesBlog.strings);
_8ee="<li class='lotusFirst'>";
var _8f2;
var _8f3;
var _8f4=_8ec.getElementsByTagName("link");
for(var i=0;i<_8f4.length;i++){
var _8f6=_8f4[i];
if(_8f6.attributes.getNamedItem("rel")&&_8f6.attributes.getNamedItem("rel").nodeValue=="next"){
_8f3=_8f6.attributes.getNamedItem("rel").nodeValue;
}
}
if(page!=0){
_8f2="\"javascript:lconn.communitiesBlog.blogSection.showEntryComments("+_8e7+", '"+_8e8+"', "+(page-1)+", true);\"";
_8ee+="<a href="+_8f2+">"+lconn.communitiesBlog.strings.rs_previous+"</a>";
}else{
_8ee+="<span class='disabled lotusDisabled'>"+lconn.communitiesBlog.strings.rs_previous+"</span>";
}
_8ee+="<span class='disabled lotusDisabled'>&nbsp;|&nbsp;</span>";
if(_8f3){
_8f3="\"javascript:lconn.communitiesBlog.blogSection.showEntryComments("+_8e7+", '"+_8e8+"', "+(page+1)+", true);\"";
_8ee+="<a href="+_8f3+">"+lconn.communitiesBlog.strings.rs_next+"</a>";
}else{
_8ee+="<span class='disabled lotusDisabled'>"+lconn.communitiesBlog.strings.rs_next+"</span>";
}
_8ee+="</li>";
}
var _8f7=dojo.fadeIn({node:_8eb,duration:500});
var _8f8=dojo.fadeOut({node:_8eb,duration:500});
if(!_8ea){
var _8f9=dojo.fx.wipeIn({node:_8eb,duration:500});
var _8fa=dojo.fx.wipeOut({node:_8eb,duration:500});
var show=dojo.fx.combine([_8f7,_8f9]);
var hide=dojo.fx.combine([_8f8,_8fa]);
if(_8eb.style.display!="none"){
hide.play();
}else{
lconn.communitiesBlog.blogSection.updateCommentsDiv(_8eb,_8ed,_8ee,_8e7,_8e8,page);
show.play();
}
}else{
_8f8.onEnd=function(){
lconn.communitiesBlog.blogSection.updateCommentsDiv(_8eb,_8ed,_8ee,_8e7,_8e8,page);
};
currentAnimation=dojo.fx.chain([_8f8,_8f7]);
currentAnimation.play();
}
};
lconn.communitiesBlog.blogSection.updateCommentsDiv=function(_8fd,_8fe,_8ff,_900,_901,page){
_8fd.innerHTML=_8fe;
lconn.communitiesBlog.blogSection.updateDateFormat(_8fd);
lconn.communitiesBlog.blogSection.updateRatingImg(_8fd);
var _903=dojo.query(".entry",_8fd);
for(var i=0;i<_903.length;i++){
var _905=dojo.query(".recommendButton",_903[i])[0];
if(typeof (_905)!="undefined"){
if(lconn.communitiesBlog.userRole==2){
var _906=_905.parentNode;
_906.removeChild(_905);
}else{
var _907=_905.attributes.getNamedItem("recommend_url").nodeValue;
_905.href="javascript:lconn.communitiesBlog.iContext.iScope().recommendComment('"+_907+"', "+_900+", '"+_901+"', "+page+");";
var _908=dojo.query("img",_905)[0];
_908.src=lconn.communitiesBlog.strings.communitiesAppURL+"/nav/common/styles/images/iconAddRating.gif";
}
}
}
if(dojo.query(".blogsCommentsPager",_8fd).length!=0){
dojo.query(".blogsCommentsPager",_8fd)[0].innerHTML=_8ff;
}
if(dojo.isFF){
var _909=dojo.query(".blogContentContainer",_8fd);
for(var i=0;i<_909.length;i++){
_909[i].innerHTML=lconn.communitiesBlog.unescapeContent(_909[i].innerHTML);
}
}
lconn.communitiesBlog.blogSection.updateUserPhoto(_8fd,".blogCommentPhoto");
if(window.SemTagSvc&&SemTagSvc.parseDom){
SemTagSvc.parseDom(0,_8fd);
}
};
lconn.communitiesBlog.blogSection.updateUserPhoto=function(_90a,_90b){
var _90c=dojo.query(_90b,_90a);
for(var i=0;i<_90c.length;i++){
var _90e=_90c[i].attributes.getNamedItem("userid").nodeValue;
_90c[i].src=lconn.communitiesBlog.profilesAppURL+"/photo.do?userid="+_90e;
}
};
lconn.communitiesBlog.blogSection.toggleDetail=function(_90f){
var _910=lconn.communitiesBlog.iContext.getElementById("blogsEntryDetail_"+_90f);
var _911=lconn.communitiesBlog.iContext.getElementById("blogsEntryDetailLink_"+_90f);
var _912=dojo.fx.wipeIn({node:_910,duration:500});
var _913=dojo.fx.wipeOut({node:_910,duration:500});
var _914=dojo.fadeIn({node:_910,duration:500});
var _915=dojo.fadeOut({node:_910,duration:500});
var show=dojo.fx.combine([_914,_912]);
var hide=dojo.fx.combine([_915,_913]);
if(_910.style.display!="none"){
hide.play();
_911.innerHTML="<img class=\"expandImg\" src=\""+lconn.communitiesBlog.communitiesAppURL+"/nav/common/styles/images/plus.gif\" alt=\""+lconn.communitiesBlog.strings.rs_details+"\" title=\""+lconn.communitiesBlog.strings.rs_details+"\" />";
}else{
show.play();
_911.innerHTML="<img class=\"expandImg\" src=\""+lconn.communitiesBlog.communitiesAppURL+"/nav/common/styles/images/minus.gif\" alt=\""+lconn.communitiesBlog.strings.rs_hide+"\" title=\""+lconn.communitiesBlog.strings.rs_hide+"\" />";
}
};
lconn.communitiesBlog.blogSection.updateDateFormat=function(div){
var _919=dojo.query(".blogDate",div);
for(var i=0;i<_919.length;i++){
var _91b=_919[i].attributes.getNamedItem("timestring").nodeValue;
var _91c=dojo.date.stamp.fromISOString(_91b).valueOf();
var _91d=lconn.communitiesBlog.blogsDate.date.localize(_91c);
_919[i].parentNode.innerHTML=_91d;
}
};
lconn.communitiesBlog.blogSection.updateRatingImg=function(div){
var _91f=dojo.query(".blogRatingsImg",div);
for(var i=0;i<_91f.length;i++){
var _921=_91f[i].attributes.getNamedItem("value").nodeValue;
var _922=Math.min(Math.ceil(_921/10),8);
_91f[i].src=lconn.communitiesBlog.communitiesAppURL+"/nav/common/styles/images/iconRating"+_922+".gif";
}
};
lconn.communitiesBlog.blogSection.updateBlogsIcon=function(div){
var _924=dojo.query("td > img",div);
for(var i=0;i<_924.length;i++){
_924[i].src=lconn.communitiesBlog.communitiesAppURL+"/nav/common/styles/images/iconBlog.gif";
}
};
lconn.communitiesBlog.blogSection.updateExpandImg=function(div){
var imgs=dojo.query(".expandImg",div);
for(var i=0;i<imgs.length;i++){
imgs[i].src=lconn.communitiesBlog.communitiesAppURL+"/nav/common/styles/images/plus.gif";
}
};
lconn.communitiesBlog.blogSection.updateActionLinks=function(_929){
var _92a=_929.attributes.getNamedItem("entryurl").nodeValue;
var _92b=_92a.substring(_92a.lastIndexOf("/")+1);
var _92c=_92a+"#action=addcomment";
var _92d=lconn.communitiesBlog.blogsAppURL+"/roller-ui/authoring/weblog.do?method=edit&entry="+_92b+"&weblog="+lconn.communitiesBlog.communityBlogHandle;
var _92e="";
var _92f=dojo.query(".recommendButton",_929)[0];
if(lconn.communitiesBlog.userRole==0||lconn.communitiesBlog.userRole==1){
dojo.query(".blogWidgetLink",_929)[0].href=_92c;
if(_92f){
var _930=dojo.query("img",_92f)[0];
_930.src=lconn.communitiesBlog.strings.communitiesAppURL+"/nav/common/styles/images/iconAddRating.gif";
}
}else{
dojo.removeClass(dojo.query(".blogWidgetLink",_929)[0],"lotusAction");
dojo.addClass(dojo.query(".blogWidgetLink",_929)[0],"blogWidgetDisabledLink");
if(_92f){
var _931=_92f.parentNode;
_931.removeChild(_92f);
}
}
if(lconn.communitiesBlog.userRole==0){
dojo.query(".blogWidgetLink",_929)[2].href=_92d;
}else{
dojo.removeClass(dojo.query(".blogWidgetLink",_929)[2],"lotusAction");
dojo.addClass(dojo.query(".blogWidgetLink",_929)[2],"blogWidgetDisabledLink");
}
};
lconn.communitiesBlog.unescapeContent=function(str){
str=str.replace(/&amp;/g,"&");
str=str.replace(/&lt;/g,"<");
str=str.replace(/&gt;/g,">");
str=str.replace(/&nbsp;/g,"");
str=str.replace(/<[a-zA-Z\/][^>]*>/g,"");
str=str.replace(/<!(?:--[\s\S]*?--\s*)?>\s*/g,"");
return str;
};
lconn.communitiesBlog.unescape=function(str){
str=str.replace(/&amp;/g,"&");
str=str.replace(/&quot;/g,"\"");
str=str.replace(/&apos;/g,"'");
str=str.replace(/&lt;/g,"<");
str=str.replace(/&gt;/g,">");
return str;
};
lconn.communitiesBlog.escapeContent=function(str){
str=str.replace(/&/g,"&amp;");
str=str.replace(/"/g,"&quot;");
str=str.replace(/'/g,"&apos;");
str=str.replace(/</g,"&lt;");
str=str.replace(/>/g,"&gt;");
return str;
};
lconn.communitiesBlog.openHelpWindow=function(url,_936,_937){
if(!_936){
_936=window.screen.width/4;
if(_936<950){
_936=950;
}
}
if(!_937){
_937=window.screen.height/4;
if(_937<550){
_937=550;
}
}
if(typeof (lconn.communitiesBlog.helpWindow)!="undefined"){
lconn.communitiesBlog.helpWindow.close();
}
var _938="height="+_937+",width="+_936+",status=yes,toolbar=no,menubar=no,location=no,scrollbars=yes,resizable=yes";
lconn.communitiesBlog.helpWindow=window.open(lconn.communitiesBlog.blogsAppURL+url,"blogsHelp",_938);
if(window.focus){
lconn.communitiesBlog.helpWindow.focus();
}
};
lconn.communitiesBlog.addPropertiesToStringBundle=function(){
if(lconn.communitiesBlog.strings){
lconn.communitiesBlog.strings.blogsAppURL=lconn.communitiesBlog.blogsAppURL;
lconn.communitiesBlog.strings.profilesAppURL=lconn.communitiesBlog.profilesAppURL;
lconn.communitiesBlog.strings.communitiesAppURL=lconn.communitiesBlog.communitiesAppURL;
lconn.communitiesBlog.strings.blogsWidgetURL=lconn.communitiesBlog.blogsWidgetURL;
}
};
}
if(!dojo._hasResource["lconn.communitiesBlog.blogsDate"]){
dojo._hasResource["lconn.communitiesBlog.blogsDate"]=true;
dojo.provide("lconn.communitiesBlog.blogsDate");
lconn.communitiesBlog.blogsDate={init:function(){
this.Now=new Date();
this.Now_Mills=this.Now.getTime();
this.date.Days=[lconn.communitiesBlog.strings.rs_sunday,lconn.communitiesBlog.strings.rs_monday,lconn.communitiesBlog.strings.rs_tuesday,lconn.communitiesBlog.strings.rs_wednesday,lconn.communitiesBlog.strings.rs_thursday,lconn.communitiesBlog.strings.rs_friday,lconn.communitiesBlog.strings.rs_saturday];
this.date.Month=[lconn.communitiesBlog.strings.rs_jan,lconn.communitiesBlog.strings.rs_feb,lconn.communitiesBlog.strings.rs_mar,lconn.communitiesBlog.strings.rs_apr,lconn.communitiesBlog.strings.rs_may,lconn.communitiesBlog.strings.rs_june,lconn.communitiesBlog.strings.rs_july,lconn.communitiesBlog.strings.rs_aug,lconn.communitiesBlog.strings.rs_sep,lconn.communitiesBlog.strings.rs_oct,lconn.communitiesBlog.strings.rs_nov,lconn.communitiesBlog.strings.rs_dec];
this.date.Yesterday=lconn.communitiesBlog.strings.rs_yesterday;
this.date.Today=lconn.communitiesBlog.strings.rs_today;
this.date.Tomorrow=lconn.communitiesBlog.strings.rs_tomorrow;
}};
lconn.communitiesBlog.blogsDate.date={MILLS_IN_DAY:86400000,Days:[],Month:[],Yesterday:"",Today:"",Tomorrow:"",delta:function(_939){
var _93a=new Date();
_93a.setHours(0);
_93a.setMinutes(0);
_93a.setSeconds(0);
_93a.setMilliseconds(0);
var diff=_93a.getTime()-_939;
var _93c=Math.ceil(diff/(lconn.communitiesBlog.blogsDate.date.MILLS_IN_DAY));
return _93c;
},localize:function(_93d,_93e){
var _93f=new Date();
_93f.setTime(_93d);
var _940=lconn.communitiesBlog.blogsDate.date.delta(_93d);
var _941="";
if(_940<=2&&_940>=-2){
if(_940==2){
if(_93e===undefined){
_941=lconn.communitiesBlog.blogsDate.date.Days[_93f.getDay()]+" "+lconn.communitiesBlog.blogsDate.date.getLocalizedTime(_93f);
}else{
_941=lconn.communitiesBlog.blogsDate.date.Days[_93f.getDay()];
}
}else{
if(_940==1){
if(_93e===undefined){
_941=lconn.communitiesBlog.blogsDate.date.Yesterday+" "+lconn.communitiesBlog.blogsDate.date.getLocalizedTime(_93f);
}else{
_941=lconn.communitiesBlog.blogsDate.date.Yesterday;
}
}else{
if(_940==0){
if(_93e===undefined){
_941=lconn.communitiesBlog.blogsDate.date.Today+" "+lconn.communitiesBlog.blogsDate.date.getLocalizedTime(_93f);
}else{
_941=lconn.communitiesBlog.blogsDate.date.Today;
}
}else{
if(_940==-1){
_941=lconn.communitiesBlog.blogsDate.date.Tomorrow;
}else{
if(_940==-2){
_941=lconn.communitiesBlog.blogsDate.date.Days[_93f.getDay()];
}
}
}
}
}
}else{
if(lconn.communitiesBlog.blogsDate.Now.getFullYear()==_93f.getFullYear()){
var _942=dojo.locale.substring(0,2);
if(_942=="en"){
_941=_93f.getDate()+" "+lconn.communitiesBlog.blogsDate.date.Month[_93f.getMonth()];
}else{
_941=lconn.communitiesBlog.blogsDate.date.getLocalizedDate(_93f);
}
}else{
var _942=dojo.locale.substring(0,2);
if(_942=="en"){
_941=_93f.getDate()+" "+lconn.communitiesBlog.blogsDate.date.Month[_93f.getMonth()]+" "+_93f.getFullYear();
}else{
_941=lconn.communitiesBlog.blogsDate.date.getLocalizedDate(_93f);
}
}
}
return _941;
},correctHoursAndMins:function(date){
var _944=date.getHours();
var mins=date.getMinutes();
if(mins<10){
mins="0"+mins;
}
var _946="";
if(_944==0){
_946="12:"+mins+"am";
}else{
if(_944<12){
_946=_944+":"+mins+"am";
}else{
if(_944<13){
_946=_944+":"+mins+"pm";
}else{
_946=(_944-12)+":"+mins+"pm";
}
}
}
return _946;
},getLocalizedTime:function(date){
return dojo.date.locale.format(date,{formatLength:"short",selector:"time",locale:dojo.locale});
},getLocalizedDate:function(date){
return dojo.date.locale.format(date,{formatLength:"medium",selector:"date",locale:dojo.locale});
}};
}
if(!dojo._hasResource["lconn.comm.bookmarklet"]){
dojo._hasResource["lconn.comm.bookmarklet"]=true;
dojo.provide("lconn.comm.bookmarklet");
this_script=document.getElementById("oa_mailto_script");
if(this_script!=null&&typeof (this_script)!="undefined"){
var url=this_script.src.substring(0,this_script.src.indexOf("/javascript/bookmarklet.js"));
url+="/service/json/mycommunities";
var new_script=document.createElement("script");
new_script.src=url;
document.body.appendChild(new_script);
setTimeout("displayActivities()",120);
}
function displayActivities(){
if(typeof (OpenActivities)!="undefined"){
alert(OpenActivities.collection.url);
}
};
}
if(!dojo._hasResource["lconn.comm.community"]){
dojo._hasResource["lconn.comm.community"]=true;
dojo.provide("lconn.comm.community");
function lconn_comm_community_handleSearchRequest(){
window.debugComm="true";
var str=searchBar.getValue();
str=dojo.string.trim(str);
//str=decodeURI(str);
str=encodeURIComponent(str);
//alert("DJM - original input: "+str);
//Might try encodeURI() here.  but doesn't look quite right.  
//And we may be hitting the AppScan input filter.
if(!str){
return false;
}
var _94a=searchBar.selectedOption;
if(_94a.feature){
return true;
}else{
switch(_94a.scope){
case "community":
var _94b=[];
_94b.push({entryName:"searchKeywords",entryValue:str});
if(window.debugComm!=null){
console.log("search by keyword: "+str);
}
lconn.comm.community.handleSearchRequestbyGeneral(_94b);
break;
case "all":
case "my":
var form=dojo.byId("simpleSearchForm");
form.searchFor.value=str;
form.searchScope.value=_94a.scope;
form.submit();
break;
default:
return true;
break;
}
}
return false;
};
lconn.comm.community.handleSearchRequestbyTag=function(_94d){
if(window.debugComm!=null){
console.log("search by tag: "+_94d);
}
var _94e=[];
_94e.push({entryName:"tagCloudItemValue",entryValue:_94d});
lconn.comm.community.handleSearchRequestbyGeneral(_94e);
};
lconn.comm.community.handleSearchRequestbyGeneral=function(_94f){
try{
closeOtherViews();
registerCloseViewFunction(lconn.comm.community.exitSearchMode);
lconn.core.utilities.hide("tagsContent",false,true);
lconn.core.utilities.hide("contentArea",false,true);
lconn.core.utilities.hide("lotusColRight",false,true);
lconn.core.utilities.hide("lotusInfoBox",false,true);
lconn.core.utilities.hide("widget-container-col1",false,true);
lconn.core.utilities.hide("editCommunityForm",false,true);
var _950="search";
var _951="searchPageTabContanierId";
if(window.debugComm!=null){
console.log("search: invoking: lconn.core.WidgetPlacement.addTabsWithOnclickCalls");
}
lconn.core.WidgetPlacement.addTabsWithOnclickCalls(_951,"searchModeContainer",null,null,null,_950,_94f);
if(window.debugComm!=null){
console.log("search: invoking: activateTabbedWidget");
}
activateTabbedWidget(WidgetPlacementConfig.firstWidget.widgetDefId,WidgetPlacementConfig.firstWidget.widgetDefinitionNode,WidgetPlacementConfig.firstWidget.instanceId,_950,null,_951,_94f);
lconn.core.utilities.show("searchCommunityForm",false,false,true);
}
catch(exception){
console.log(exception);
}
};
lconn.comm.community.exitSearchMode=function(_952){
if(window.pageId!=null&&pageId=="communityOverview"){
handleModeExit();
lconn.core.utilities.show("tagsContent",false,false,true);
lconn.core.utilities.show("contentArea",false,false,true);
lconn.core.utilities.show("lotusColRight",false,false,true);
lconn.core.utilities.show("lotusInfoBox",false,false,true);
lconn.core.utilities.show("widget-container-col1",false,false,true);
lconn.core.utilities.hide("searchCommunityForm",false,true);
dojo.byId("searchPageTabContanierId").innerHTML="";
}else{
window.location=WidgetPlacementConfig.params["communitiesSvcRef"]+"/service/html/communityview?communityUuid="+WidgetPlacementConfig.params.resourceId;
}
};
var Tango={editFormRefCount:0,Util:{constructUrl:function(url,_954){
var _955="";
for(var p in _954){
if(_955.length>0){
_955+="&";
}
_955+=encodeURIComponent(p);
_955+="=";
_955+=encodeURIComponent(_954[p]);
}
if(_955.length>0){
url+="?"+_955;
}
return url;
},getCookie:function(name){
key=name+"=";
c=document.cookie;
start=c.indexOf("; "+key)+2+key.length;
start=start>-1+2+key.length?start:c.indexOf(name+"=")+key.length;
if(start>-1+key.length){
end=c.indexOf(";",start);
end=end>-1?end:c.length;
return unescape(c.substring(start,end));
}else{
return null;
}
},setCookie:function(name,_959){
document.cookie=name+"="+escape(_959)+"; expires="+new Date(new Date().getTime()+365*24*60*60*1000).toGMTString()+"; path=/";
}}};
var COM={editFormRefCount:0,utils:{hide:function(_95a){
var el=_95a;
if(typeof _95a=="string"){
el=dojo.byId(_95a);
}
if(el!=null){
el.style.display="none";
}
},show:function(_95c){
var el=_95c;
if(typeof _95c=="string"){
el=dojo.byId(_95c);
}
if(el!=null){
el.style.display="";
}
},toggle:function(_95e){
var el=dojo.byId(_95e);
if(el.style.display!="none"){
this.hide(el);
}else{
this.show(el);
}
},constructUrl:function(url,_961){
var _962="";
for(var p in _961){
if(_962.length>0){
_962+="&";
}
_962+=encodeURIComponent(p);
_962+="=";
_962+=encodeURIComponent(_961[p]);
}
if(_962.length>0){
url+="?"+_962;
}
return url;
},getCookie:function(name){
key=name+"=";
c=document.cookie;
start=c.indexOf("; "+key)+2+key.length;
start=start>-1+2+key.length?start:c.indexOf(name+"=")+key.length;
if(start>-1+key.length){
end=c.indexOf(";",start);
end=end>-1?end:c.length;
return unescape(c.substring(start,end));
}else{
return null;
}
},setCookie:function(name,_966){
document.cookie=name+"="+escape(_966)+"; expires="+new Date(new Date().getTime()+365*24*60*60*1000).toGMTString()+"; path=/";
}}};
var addMembers_W=null;
function displayMemberCreateForm(_967,_968,_969,_96a){
COM.utils.toggle("memberAddForm");
if(addMembers_W==null){
addMembers_W=new lconn.comm.typeahead.AddMembers({"class":"content","rs_owner":_967,"rs_member":_968,"rs_addMember_title":_969,"rs_removeMember_title":_96a},dojo.byId("addMembersWidget"));
}else{
addMembers_W.reset();
}
setFieldFocus("addMembersSelect");
return false;
};
function saveMemberFields(_96b){
addMembers_W.setHiddenFields();
_96b.elements["members"].value=addMembers_W.getMembers();
_96b.elements["owners"].value=addMembers_W.getOwners();
addMembers_W.reset();
};
function cancelMemberCreateForm(){
COM.utils.hide("errorMessages");
COM.utils.hide("memberAddForm");
if(addMembers_W){
addMembers_W.reset();
}
};
function displayFeedCreateForm(){
COM.utils.hide("feedContentAreaSub");
COM.utils.show("feedAddForm");
setFieldFocus("addFeedUrl");
};
function cancelFeedCreateForm(){
COM.utils.hide("feedAddForm");
COM.utils.show("feedContentAreaSub");
};
function displayFeedEditForm(_96c,_96d){
if(COM.editFormRefCount>0){
return;
}else{
COM.editFormRefCount++;
COM.utils.hide("b_summary_"+_96d);
COM.utils.hide("b_details_"+_96d);
COM.utils.hide("b_feedDisplay_"+_96d);
COM.utils.show("b_editDisplay_"+_96d);
var _96e=document.getElementById("editForm");
var _96f=_96e.cloneNode(true);
var _970=document.getElementById(_96c);
_96f.id="editForm"+"_"+_96d;
var _971=getElementById(_96f,"feed_uuid");
if(_971){
_971.id=_971.id+"_"+_96d;
_971.value=_96d;
}
var _972=getElementById(_96f,"feed_type");
if(_972){
_972.id=_972.id+"_"+_96d;
}
var _973=getElementById(_96f,"autocompletetags_edit");
if(_973){
_973.id=_973.id+"_"+_96d;
}
var _974=getElementById(_96f,"cancelBtn");
var _975=function onclick(_976){
destroyFeedEditForm(_970,_96f,_96d);
return false;
};
_974.onclick=_975;
var name=getElementById(_96f,"editFeedName");
var _978=document.getElementById("b_name_"+_96d);
if(name&&_978){
if(_978.textContent){
name.value=_978.textContent;
}else{
if(_978.innerText){
name.value=_978.innerText;
}
}
}
var uri=getElementById(_96f,"editFeedUrl");
var _97a=document.getElementById("b_uri_"+_96d);
if(uri&&_97a){
uri.value=_97a.getAttribute("href");
}
var desc=getElementById(_96f,"editFeedDescription");
var _97c=document.getElementById("b_description_"+_96d);
if(desc&&_97c){
if(_97c.textContent){
desc.value=dojo.string.trim(_97c.textContent);
}else{
if(_97c.innerText){
desc.value=dojo.string.trim(_97c.innerText);
}
}
}
var _97d=document.getElementById("b_tags_"+_96d);
if(_973&&_97d){
if(_97d.textContent){
_973.value=_97d.textContent;
}else{
if(_97d.innerText){
_973.value=_97d.innerText;
}
}
}
_970.appendChild(_96f);
var _97e=getElementById(_96f,"homepage");
var _97f=document.getElementById("b_homepage_"+_96d);
if(_97e&&(_97f.innerHTML=="true")){
_97e.checked=true;
}
renderWidget(_973);
setFieldFocus("editFeedUrl");
}
};
function destroyFeedEditForm(_980,_981,_982){
_980.removeChild(_981);
COM.utils.show("b_summary_"+_982);
COM.utils.show("b_details_"+_982);
COM.utils.show("b_feedDisplay_"+_982);
COM.utils.hide("b_editDisplay_"+_982);
COM.editFormRefCount--;
};
function setFieldFocus(_983){
var _984=document.getElementById(_983);
if(_984){
setTimeout(function(){
try{
_984.focus();
}
catch(exception){
}
},1000);
}
};
function showTags(_985,_986,_987){
if(_985=="cloud"){
COM.utils.hide(_987);
COM.utils.show(_986);
}else{
COM.utils.show(_987);
COM.utils.hide(_986);
}
};
function toggleBookmarkDisplay(_988,_989){
if(_989=="show"){
COM.utils.hide("b_show_"+_988);
COM.utils.show("b_hide_"+_988);
COM.utils.show("b_details_"+_988);
}else{
COM.utils.show("b_show_"+_988);
COM.utils.hide("b_hide_"+_988);
COM.utils.hide("b_details_"+_988);
}
};
function toggleFeedDisplay(_98a,_98b,_98c){
if(_98c=="show"){
COM.utils.hide("b_show_"+_98a);
COM.utils.show("b_hide_"+_98a);
COM.utils.show("b_details_"+_98a);
_98b.loadThread();
COM.utils.show("b_feedDisplay_"+_98a);
}else{
COM.utils.show("b_show_"+_98a);
COM.utils.hide("b_hide_"+_98a);
COM.utils.hide("b_details_"+_98a);
COM.utils.hide("b_feedDisplay_"+_98a);
}
};
function displayBookmarkCreateForm(){
COM.utils.hide("bookmarkContentAreaSub");
COM.utils.show("bookmarkAddForm");
setFieldFocus("addBookmarkUrl");
};
function cancelBookmarkCreateForm(){
COM.utils.hide("bookmarkAddForm");
COM.utils.show("bookmarkContentAreaSub");
};
function displayBookmarkEditForm(_98d,_98e){
if(COM.editFormRefCount>0){
return;
}else{
COM.editFormRefCount++;
COM.utils.hide("b_summary_"+_98e);
COM.utils.hide("b_details_"+_98e);
COM.utils.show("b_editDisplay_"+_98e);
var _98f=document.getElementById("editForm");
var _990=_98f.cloneNode(true);
var _991=document.getElementById(_98d);
_990.id="editForm"+"_"+_98e;
var _992=getElementById(_990,"bookmark_uuid");
if(_992){
_992.id=_992.id+"_"+_98e;
_992.value=_98e;
}
var _993=getElementById(_990,"bookmark_type");
if(_993){
_993.id=_993.id+"_"+_98e;
}
var _994=getElementById(_990,"autocompletetags_edit");
if(_994){
_994.id=_994.id+"_"+_98e;
}
var _995=getElementById(_990,"cancelBtn");
var _996=function onclick(_997){
destroyBookmarkEditForm(_991,_990,_98e);
return false;
};
_995.onclick=_996;
var name=getElementById(_990,"editBookmarkName");
var _999=document.getElementById("b_name_"+_98e);
if(name&&_999){
if(_999.textContent){
name.value=_999.textContent;
}else{
if(_999.innerText){
name.value=_999.innerText;
}
}
}
var uri=getElementById(_990,"editBookmarkUrl");
var _99b=document.getElementById("b_uri_"+_98e);
if(uri&&_99b){
uri.value=_99b.getAttribute("href");
}
var desc=getElementById(_990,"editBookmarkDescription");
var _99d=document.getElementById("b_description_"+_98e);
if(desc&&_99d){
if(_99d.textContent){
desc.value=dojo.string.trim(_99d.textContent);
}else{
if(_99d.innerText){
desc.value=dojo.string.trim(_99d.innerText);
}
}
}
var _99e=document.getElementById("b_tags_"+_98e);
if(_994&&_99e){
if(_99e.textContent){
_994.value=_99e.textContent;
}else{
if(_99e.innerText){
_994.value=_99e.innerText;
}
}
}
_991.appendChild(_990);
var _99f=getElementById(_990,"homepage");
var _9a0=document.getElementById("b_homepage_"+_98e);
if(_99f&&(_9a0.innerHTML=="true")){
_99f.checked="true";
}
renderWidget(_994);
setFieldFocus("editBookmarkUrl");
}
};
function destroyBookmarkEditForm(_9a1,_9a2,_9a3){
_9a1.removeChild(_9a2);
COM.utils.show("b_summary_"+_9a3);
COM.utils.show("b_entry_"+_9a3);
COM.utils.show("b_entry_date_"+_9a3);
COM.utils.show("b_details_"+_9a3);
COM.editFormRefCount--;
};
function getElementById(_9a4,_9a5){
var _9a6=null;
var _9a7=_9a4.getElementsByTagName("*");
for(var ii=0;ii<_9a7.length;ii++){
if(_9a7[ii].id==_9a5){
_9a6=_9a7[ii];
break;
}
}
return (_9a6);
};
function toggleSection(_9a9,_9aa){
var _9ab=null;
if(_9aa=="show"){
COM.utils.hide(_9a9+"Show");
COM.utils.show(_9a9+"Hide");
COM.utils.show(_9a9);
_9ab=dojo.byId(_9a9+"Hide");
}else{
COM.utils.show(_9a9+"Show");
COM.utils.hide(_9a9+"Hide");
COM.utils.hide(_9a9);
_9ab=dojo.byId(_9a9+"Show");
}
if(_9ab!=null){
_9ab.focus();
}
};
function selectTab(_9ac){
var _9ad=dojo.byId("threadedTab");
var _9ae=dojo.byId("recentTab");
if(_9ac=="threadedTab"){
COM.utils.hide("recentTabContent");
dojo.removeClass(_9ae,"lotusSelected");
dojo.addClass(_9ad,"lotusSelected");
COM.utils.show("threadedTabContent");
}else{
dojo.addClass(_9ae,"lotusSelected");
COM.utils.hide("threadedTabContent");
dojo.removeClass(_9ad,"lotusSelected");
dojo.addClass(_9ae,"lotusSelected");
COM.utils.show("recentTabContent");
}
};
function toggleDisplay(_9af,_9b0){
COM.utils.show(_9af);
COM.utils.hide(_9b0);
};
var communityCreateRTE=null;
var addComMembers_W=null;
function displayCommunityCreate(_9b1,_9b2,_9b3,_9b4){
COM.utils.hide("communitiesList");
COM.utils.show("newCommunityForm");
initializeThemes("");
if(addComMembers_W==null){
addComMembers_W=new lconn.comm.typeahead.AddMembers({"class":"content","rs_owner":_9b1,"rs_member":_9b2,"rs_addMember_title":_9b3,"rs_removeMember_title":_9b4,"cellContainer":"addMembersContainer"},dojo.byId("addComMembersWidget"));
}else{
addComMembers_W.reset();
}
restoreMemberValues();
if(communityCreateRTE==null){
communityCreateRTE=initEditor("newCommunityForm","addCommunityDescription");
}
var _9b5=dojo.byId("editorContainer");
if(_9b5!=null){
setTimeout(function(){
_9b5.style.display="none";
_9b5.style.display="block";
},200);
}
dojo.parser.parse(dojo.byId("tagTypeAheadContainer"));
setFieldFocus("addCommunityName");
};
function initializeThemes(_9b6){
var _9b7=dojo.byId("themeImages");
if(_9b7){
var _9b8=_9b7.getElementsByTagName("img");
if(_9b8!=null&&_9b8.length>=2){
for(i=0;i<_9b8.length;i++){
var _9ba=_9b8[i];
if(_9ba){
var _9bb=dojo.attr(_9ba,"trueSrc");
dojo.attr(_9ba,"src",_9bb);
}
}
var _9bc=document.getElementsByName("theme");
if(_9b6==null||_9b6.length==0){
_9bc[0].checked=true;
}else{
var _9bd=false;
for(var i=0;i<_9bc.length;i++){
_9bc[i].checked=false;
if(_9bc[i].value==_9b6){
_9bc[i].checked=true;
var _9bd=true;
}
}
if(!_9bd){
_9bc[0].checked=true;
}
}
}else{
COM.utils.hide("themeLink");
if(_9b8.length==1){
var _9bc=document.getElementsByName("theme");
if(_9bc[0]){
_9bc[0].checked=true;
}
}
}
}
};
function saveCommunityCreate(_9be){
var _9bf=dijit.byId("addCommunityDescription").getValue(false);
_9be.elements["description"].value=_9bf;
addComMembers_W.setHiddenFields();
_9be.elements["members"].value=addComMembers_W.getMembers();
_9be.elements["owners"].value=addComMembers_W.getOwners();
addComMembers_W.reset();
};
function cancelCommunityCreate(){
COM.utils.hide("errorMessages");
COM.utils.show("photoUploadLink");
COM.utils.hide("photoUploadHelp");
COM.utils.hide("photoUpload");
COM.utils.hide("photoUploadRemove");
var _9c0=dojo.byId("themeLink");
if(_9c0!=null){
dojo.removeClass(_9c0,"lotusFirst");
}
COM.utils.show("themeLink");
COM.utils.hide("themeSelection");
COM.utils.hide("newCommunityForm");
COM.utils.show("communitiesList");
clearCommunityForm();
};
function clearCommunityForm(){
var name=document.getElementById("addCommunityName");
if(name){
name.value="";
}
var _9c2=document.getElementById("addPublicAccess");
if(_9c2){
_9c2.checked=true;
}
var _9c3=document.getElementById("autocompletemembers");
if(_9c3){
_9c3.value="";
}
var desc=document.getElementById("addCommunityDescription");
if(desc){
desc.value="";
}
if(communityCreateRTE){
communityCreateRTE.setValue("");
}
if(addComMembers_W){
addComMembers_W.reset();
}
var _9c5=document.getElementById("photoId");
if(_9c5){
_9c5.value="";
}
var _9c6=document.getElementById("autocompletetags");
if(_9c6){
_9c6.value="";
}
};
var origCommunityName=null;
var origCommunityDescription=null;
var origCommunityTagNameString=null;
var origManagedAppChecked=new Array();
var origCommunityType=null;
function saveCommunityEditOrigValues(_9c7,_9c8){
origCommunityName=document.getElementById("editCommunityName").value;
origCommunityDescription=document.getElementById("editcommunityDescription").innerHTML;
origCommunityTagNameString=document.getElementById("autocompletetags_").value;
for(i=0;i<_9c7;i++){
origManagedAppChecked[i]=document.getElementById("managedApp"+(i+1)).checked;
}
origCommunityType=_9c8;
};
function cancelCommunityEdit(){
populateCommunityEdit(origCommunityName,origCommunityType,origManagedAppChecked,origCommunityDescription,origCommunityTagNameString);
COM.utils.show("photoUploadLink");
COM.utils.hide("photoUploadHelp");
COM.utils.hide("photoUpload");
COM.utils.hide("photoUploadRemove");
var _9c9=dojo.byId("themeLink");
if(_9c9!=null){
dojo.removeClass(_9c9,"lotusFirst");
}
COM.utils.show("themeLink");
COM.utils.hide("themeSelection");
var _9ca=document.getElementById("photoId");
_9ca.value="";
var _9cb=document.getElementById("photoRemove");
_9cb.checked=false;
togglePhotoRemove(_9cb);
COM.utils.hide("community-edit-messages");
COM.utils.hide("editCommunityForm");
COM.utils.show("lotusColRight");
COM.utils.hide("headline-messages");
COM.utils.show("headline-content");
COM.utils.show("communityPage");
COM.utils.show("communityActionBar");
if(WidgetPlacementConfig.handleModeExitExe==null){
handleModeExit(true);
}
lconn.core.WidgetPlacement.registerCloseViewFunction=null;
};
function populateCommunityEdit(_9cc,_9cd,_9ce,_9cf,tags){
var name=document.getElementById("editCommunityName");
name.value=_9cc;
var _9d2=document.getElementById("addPublicAccess");
_9d2.checked=(_9cd=="public");
var _9d3=document.getElementById("addPublicInviteOnlyAccess");
_9d3.checked=(_9cd=="publicInviteOnly");
var _9d4=document.getElementById("addPrivateAccess");
_9d4.checked=(_9cd=="private");
for(i=0;i<_9ce.length;i++){
var _9d5=document.getElementById("managedApp"+(i+1));
_9d5.checked=_9ce[i];
}
communityEditRTE.setValue(_9cf);
var _9d6=document.getElementById("autocompletetags_");
_9d6.value=tags;
};
var communityEditRTE=null;
function displayCommunityEdit(){
closeOtherViews();
registerCloseViewFunction(cancelCommunityEdit);
COM.utils.hide("lotusColRight");
COM.utils.hide("headline-content");
COM.utils.hide("communityPage");
COM.utils.hide("communityActionBar");
lconn.core.utilities.show("editCommunityForm",false,false,true);
if(communityEditRTE==null){
communityEditRTE=initEditor("editCommunityForm","editcommunityDescription");
}
initializeThemes(lconn_comm_global_currentTheme);
dojo.parser.parse(dojo.byId("tagTypeAheadContainer"));
setFieldFocus("editCommunityName");
WidgetPlacementConfig.TabContainerDomId="ediPageTabContanierId";
lconn.core.WidgetPlacement.addEditTabsWithOnclickCalls("ediPageTabContanierId","editModeContainer","initialFormContainer",cancelCommunityEdit,"editPageTabFirstItem");
return false;
};
function saveForm(_9d7,_9d8,_9d9){
var _9da=dijit.byId(_9d9).getValueFromBothModes();
_9d7.elements[_9d8].value=_9da;
};
function initEditor(form,_9dc){
var _9dd=null;
var _9de=dojo.byId(form);
if(_9de){
if(_9de.style.display!="none"){
console.log("ronin.initEditor: creating editor");
dojo.require("lconn.blogs.HtmlToggle");
dojo.subscribe("dijit.Editor.getPlugin",null,function(o){
	if(o.plugin){ return; }
	var args=o.args, p;
       var name=args.name;
       switch(name){
            case "htmlToggle":
               	p=new lconn.blogs.HtmlToggle();
                	break;
       }
       o.plugin=p;
   });
var _9df=["htmlToggle","|","bold","italic","underline","strikethrough","|","foreColor","hiliteColor","|","insertUnorderedList","insertOrderedList","|","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull","|","createLink","insertImage","insertHorizontalRule"];
var _9e0={minHeight:"100px",plugins:_9df};
_9dd=new dijit.Editor(_9e0,dojo.byId(_9dc));
}
}
return _9dd;
};
function displaySelectTheme(){
COM.utils.show("selectThemeForm");
COM.utils.hide("lotusColRight");
COM.utils.hide("headline-content");
COM.utils.hide("communityPage");
COM.utils.hide("communityContent");
};
function cancelSelectTheme(){
COM.utils.hide("selectThemeForm");
COM.utils.show("lotusColRight");
COM.utils.show("headline-content");
COM.utils.show("communityPage");
COM.utils.show("communityContent");
};
function selectTheme(_9e1){
var _9e2=dojo.byId(_9e1+"Ctl");
if(_9e2){
_9e2.checked=true;
}
return true;
};
function setThemeValue(_9e3,_9e4){
var _9e5=dojo.byId(_9e3);
if(_9e5!=null){
var _9e6=_9e5.length;
if(_9e6!=undefined){
for(var i=0;i<_9e6;i++){
_9e5[i].checked=false;
if(_9e5[i].value==_9e4){
_9e5[i].checked=true;
}
}
}
}
};
function displayPhoto(_9e8){
COM.utils.hide("photoUploadLink");
var _9e9=dojo.byId("themeLink");
if(_9e9!=null){
dojo.addClass(_9e9,"lotusFirst");
}
COM.utils.show("photoUploadHelp");
COM.utils.show("photoUpload");
if(_9e8){
COM.utils.show("photoUploadRemove");
}
setFieldFocus("photoId");
};
function displayTheme(){
COM.utils.hide("themeLink");
COM.utils.show("themeSelection");
};
function togglePhotoRemove(_9ea){
var _9eb=document.getElementById("photoId");
if(_9ea.checked){
_9eb.value="";
_9eb.disabled=true;
}else{
_9eb.disabled=false;
}
};
function handleComAjaxErrors(_9ec,_9ed,_9ee,_9ef){
console.log("Entered handleComFeedErrors");
var _9f0=null;
switch(_9ed){
case 302:
case 401:
_9f0="feedErrorUnauth_"+_9ee;
break;
case 404:
if(_9ef){
_9f0="feedErrorDefaultForum_"+_9ee;
}else{
_9f0="feedErrorNotFound_"+_9ee;
}
break;
default:
if(_9ef){
_9f0="feedErrorDefaultForum_"+_9ee;
}else{
_9f0="feedErrorDefault_"+_9ee;
}
break;
}
var _9f1=dojo.byId("feedErrorDetailMessage_"+_9ee);
if(_9f1!=null&&_9ec!=null){
_9f1.innerHTML=_9ec.message;
}
COM.utils.hide("feedContainer_"+_9ee);
COM.utils.show(_9f0);
COM.utils.show("feedErrorContainer_"+_9ee);
return;
};
var topicCreateRTE=null;
function displayForumForm(form,rte){
COM.utils.toggle(form);
if(topicCreateRTE==null){
topicCreateRTE=initEditor(form,rte);
}
setFieldFocus("addForumTitle");
};
function cancelForumForm(form){
clearForumForm();
COM.utils.toggle(form);
};
function clearForumForm(){
console.log("ronin.clearForumForm");
var _9f5=document.getElementById("addForumTitle");
if(_9f5){
_9f5.value="";
}
if(topicCreateRTE){
topicCreateRTE.setValue("");
}
var _9f6=document.getElementById("autocompletetags2");
if(_9f6){
_9f6.value="";
}
};
function createForumItem(_9f7,_9f8,_9f9,_9fa){
var _9fb="";
var _9fc=document.getElementById("addForumTitle");
if(_9fc){
_9fb=lconn.core.HTMLUtil.escapeText(_9fc.value);
}
var _9fd="";
if(topicCreateRTE){
_9fd=topicCreateRTE.getValue();
}
var _9fe="<contributor>"+"<snx:communityUuid xmlns:snx=\"http://www.ibm.com/xmlns/prod/sn\" component="+"\"http://www.ibm.com/xmlns/prod/sn/activities\">"+_9f8+"</snx:communityUuid>"+"<category scheme=\"http://www.ibm.com/xmlns/prod/sn/type\" term=\"community\" />"+"<snx:role xmlns:snx=\"http://www.ibm.com/xmlns/prod/sn\" component="+"\"http://www.ibm.com/xmlns/prod/sn/activities\">owner</snx:role>"+"</contributor>"+"<contributor>"+"<snx:communityUuid xmlns:snx=\"http://www.ibm.com/xmlns/prod/sn\" component="+"\"http://www.ibm.com/xmlns/prod/sn/activities\">"+_9f9+"</snx:communityUuid>"+"<category scheme=\"http://www.ibm.com/xmlns/prod/sn/type\" term=\"community\" />"+"<snx:role xmlns:snx=\"http://www.ibm.com/xmlns/prod/sn\" component="+"\"http://www.ibm.com/xmlns/prod/sn/activities\">member</snx:role>"+"</contributor>";
if(!_9fa){
_9fe=_9fe+"<contributor>"+"<snx:userid xmlns:snx=\"http://www.ibm.com/xmlns/prod/sn\" component=\"http://www.ibm.com/xmlns/prod/sn/activities\">*</snx:userid>"+"<snx:role xmlns:snx=\"http://www.ibm.com/xmlns/prod/sn\" component="+"\"http://www.ibm.com/xmlns/prod/sn/activities\">reader</snx:role>"+"</contributor>";
}
var _9ff="<entry xmlns=\"http://www.w3.org/2005/Atom\"><title type=\"text\"><![CDATA["+_9fb+"]]></title><content type=\"html\"><![CDATA["+_9fd+"]]></content>"+_9fe+"</entry>";
var _a00=feed_thread.getFullURL();
dojo.rawXhrPost({url:_a00,load:function(_a01,_a02){
itemCreated();
return _a01;
},postData:_9ff,error:function(_a03,_a04){
return handleError(_a03,_a04);
},contentType:"application/atom+xml",handleAs:"xml"});
clearForumForm();
COM.utils.hide("add"+_9f7+"Form");
};
function itemCreated(type,data,evt){
if(feed_thread){
feed_thread.refreshThread();
}
};
function handleError(_a08,_a09){
alert("Error: "+_a08.dojoType+" - "+_a08);
console.error(_a08);
return _a08;
};
function addThumbnail(_a0a,_a0b){
if(profileService!=null){
var _a0c=profileService+"/photo.do?userid=";
var _a0d=getElementById(_a0b,"post_photo_"+_a0a.postId);
if(_a0d&&_a0a.author_userid){
_a0d.src=_a0c+_a0a.author_userid;
}
}
};
function renderWidget(_a0e){
dijit.registry.remove(_a0e.id);
dijit.registry.remove("tagTypeAheadStoreId");
var _a0f={queryParam:"tag",url:"autoCompleteTags.do?format=v2"};
var _a10=new lconn.core.TypeAheadDataStore(_a0f,document.getElementById("tagTypeAheadStoreId"));
var _a11={store:_a10,name:"tags",value:_a0e.value,searchDelay:400,minChars:2,multipleValues:true,token:",",style:"width: 98%"};
new lconn.core.TypeAhead(_a11,_a0e);
};
}
if(!dojo._hasResource["lconn.comm.community_help"]){
dojo._hasResource["lconn.comm.community_help"]=true;
dojo.provide("lconn.comm.community_help");
var helpWindow;
function openHelpWindow(url,_a13,_a14){
if(!_a13){
_a13=window.screen.width/4;
if(_a13<950){
_a13=950;
}
}
if(!_a14){
_a14=window.screen.height/4;
if(_a14<550){
_a14=550;
}
}
if(typeof (helpWindow)!="undefined"){
helpWindow.close();
}
var _a15="height="+_a14+",width="+_a13+",status=yes,toolbar=yes,menubar=no,location=yes,scrollbars=yes,resizable=yes";
helpWindow=window.open(commContextPath+url,"help",_a15);
if(window.focus){
helpWindow.focus();
}
};
}
function PopupClass(){
};
PopupClass.prototype={open:{},returnFocusElement:false,numOpenPopups:0,passedState:{},CONTAINER:"oa-popup-container",initialize:function(){
},show:function(id,_a17,_a18){
_a18=_a18||{};
if(this.isOpen(id)){
this.hide(id);
}else{
if(_a18.focus){
this.returnFocusElement=_a18.focus;
}
var _a19=(_a17.target)?_a17.target:_a17.srcElement;
var _a1a=document.getElementById(id);
var _a1b=this.calculatePosition(_a1a,_a19);
var _a1c=this.getPopupContainer();
_a1c.appendChild(_a1a);
var _a1d={element:_a1a,state:_a18.state||{}};
this.open[id]=_a1d;
this.numOpenPopups++;
new Popup.Effect.Appear(id,_a1b.left,_a1b.top);
_a17.cancelBubble=true;
}
},hide:function(id,_a1f){
var _a20=dojo.byId(id);
new Popup.Effect.Fade(_a20);
var _a21=this.open[id];
this.numOpenPopups--;
if(this.numOpenPopups==0&&this.returnFocusElement){
dojo.byId(this.returnFocusElement).focus();
this.returnFocusElement=false;
}
this.open[id]=false;
},isOpen:function(id){
var _a23=this.open[id];
return _a23!=false&&_a23!==null&&_a23!==undefined;
},getState:function(id){
return this.open[id].state;
},getReturnFocus:function(){
return this.returnFocusElement;
},clearReturnFocus:function(){
var _a25=this.returnFocusElement;
this.returnFocusElement=false;
return _a25;
},getPopupContainer:function(){
var _a26=dojo.byId(this.CONTAINER);
if(_a26==null){
_a26=document.createElement("div");
_a26.setAttribute("id",this.CONTAINER);
_a26.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: 900;");
document.body.appendChild(_a26);
}
return _a26;
},calculatePosition:function(_a27,_a28){
var _a29;
if(typeof (bidir)!="undefined"&&bidir!=null&&bidir=="rtl"){
_a29=(_a27.offsetWidth>0)?_a27.offsetWidth:175;
_a29=24-_a29;
}else{
_a29=_a28.offsetWidth-24;
}
var _a2a=(this.menuGetOffsetTop(_a28,0)+_a28.offsetHeight-10);
var _a2b=(this.menuGetOffsetLeft(_a28,0)+_a29);
var body=document.documentElement?document.documentElement:document.body;
var _a2d=window.innerHeight?window.innerHeight:body.clientHeight;
var _a2e=window.innerWidth?window.innerWidth:body.clientWidth;
var _a2f=document.all?document.body.scrollLeft:window.pageXOffset;
var _a30=document.all?document.body.scrollTop:window.pageYOffset;
if((_a2a+_a27.offsetHeight)>_a2d+_a30){
_a2a-=_a27.offsetHeight;
}
if((_a2b+_a27.offsetWidth)>_a2e+_a2f){
_a2b-=_a27.offsetWidth;
}
if(_a2a<_a30){
_a2a=_a30;
}
if(_a2b<_a2f){
_a2b=_a2f;
}
return {left:_a2b+"px",top:_a2a+"px"};
},menuGetOffsetTop:function(_a31,_a32){
var _a33=0;
var _a34=_a31;
while(_a34){
_a33+=_a34.offsetTop;
_a34=_a34.offsetParent;
if(_a34){
_a33-=_a34.scrollTop;
}
}
return _a33;
},menuGetOffsetLeft:function(_a35,_a36){
var _a37=0;
var _a38=_a35;
while(_a38){
_a37+=_a38.offsetLeft;
_a38=_a38.offsetParent;
if(_a38){
_a37-=_a38.scrollLeft;
}
}
return _a37;
}};
MenuPopupClass.prototype=new PopupClass();
MenuPopupClass.prototype.constructor=MenuPopupClass();
function MenuPopupClass(){
};
MenuPopupClass.prototype.currentMenu=false;
MenuPopupClass.prototype.hideMenu=function(_a39){
if(this.currentMenu){
this.hide(this.currentMenu);
this.currentMenu=false;
}
};
MenuPopupClass.prototype.showMenu=function(id,_a3b,_a3c){
var _a3d=this.currentMenu;
this.hideMenu();
if(id!=_a3d){
this.currentMenu=id;
this.show(id,_a3b,_a3c);
}
};
MenuPopupClass.prototype.hideOnKeypress=function(_a3e){
if(typeof (_a3e)!="undefined"&&_a3e!==null&&_a3e.keyCode==Event.KEY_ESC){
MenuPopup.hideMenu();
}
};
MenuPopupClass.prototype.isMenuOpen=function(){
if(this.currentMenu){
return true;
}
return false;
};
MenuPopupClass.prototype.getState=function(){
if(this.currentMenu){
return this.open[this.currentMenu].state;
}
};
var Popup=new PopupClass();
var MenuPopup=new MenuPopupClass();
Popup.Effect={};
Popup.Effect.DURATION=0.25;
Popup.Effect.Fade=function(_a3f){
var elm=dojo.byId(_a3f);
dojo.fadeOut({node:elm,duration:450,onEnd:function(){
dojo.style(elm,{left:"-9999px"});
}}).play();
};
Popup.Effect.Appear=function(_a41,x,y){
var elm=dojo.byId(_a41);
dojo.style(elm,{opacity:"0.0",left:x,top:y});
dojo.fadeIn({node:elm,duration:450}).play();
};
if(!dojo._hasResource["lconn.comm.formBasedUtility"]){
dojo._hasResource["lconn.comm.formBasedUtility"]=true;
dojo.provide("lconn.comm.formBasedUtility");
dojo.declare("lconn.comm.formBasedUtility",null,{_contextRoot:null,REDIRECT_PATH:"/service/html/login",COOKIE_NAME:"CommunitiesReqURL",constructor:function(_a45){
if(!lconn.comm.formBasedUtility.prototype._init){
lconn.comm.formBasedUtility.prototype._init=true;
this._contextRoot=_a45;
this._overrideXhrCalls();
}else{
throw new Error("lconn.comm.formBasedUtility is a singleton. It cannot be instantiated twice");
}
},_overrideXhrCalls:function(){
console.log("overrideXhrCalls");
var auth=com.ibm.ajax.auth;
var url=this._contextRoot+this.REDIRECT_PATH;
var that=this;
var _a49={url:url,authenticationRequired:function(_a4a,_a4b,_a4c){
var racp=window.location.href.replace(/,/g,"%2C");
document.cookie=that.COOKIE_NAME+"="+racp+"; path="+that._contextRoot;
console.log("Hit authenticationRequired");
location.href=this.url;
},onSuccess:function(_a4e,_a4f){
console.log("Successfully loaded");
}};
var _a50=function(_a51,_a52){
if(typeof _a52.xhr.status=="unknown"){
return true;
}
var _a53=_a52.xhr.status;
if(_a53==302||(dojo.isIE&&(_a53==0||_a53==12150))){
return true;
}
return false;
};
var _a54=_a50;
if(typeof (CUSTOM_AUTH_JS_CLASS)!=="undefined"){
var _a55=eval("new "+CUSTOM_AUTH_JS_CLASS+"()");
if(typeof (_a55.isAuthenticationRequired)!=="undefined"){
_a54=_a55.isAuthenticationRequired;
}
if(typeof (_a55.handler)!=="undefined"){
auth.setAuthenticationHandler(dojo.hitch(_a55.handler,_a55.handler.authenticationRequired));
}else{
auth.setAuthenticationHandler(dojo.hitch(_a49,_a49.authenticationRequired));
}
}else{
auth.setAuthenticationHandler(dojo.hitch(_a49,_a49.authenticationRequired));
}
var _a56=new lconn.core.auth.whiteListHelper(lconn_comm_global_services,lconn_comm_global_proxyUrl);
originaldojoxhr=dojo.xhr;
dojo.xhr=function(){
var _a57=arguments[1];
if(_a56.isWhiteListedURL(_a57.url)){
if(typeof _a57.handleAs=="undefined"){
_a57.handleAs="text";
}
try{
_a57[1]=auth.prepareSecure(_a57,_a54);
}
catch(e){
console.log("exception in overriden dojo.xhr (form-based auth");
console.log(e);
}
}
return originaldojoxhr(arguments[0],arguments[1],arguments[2]);
};
}});
lconn.comm.formBasedUtility.prototype._init=false;
}
if(!dojo._hasResource["lconn.communities.CommunityMembers"]){
dojo._hasResource["lconn.communities.CommunityMembers"]=true;
dojo.provide("lconn.communities.CommunityMembers");
lconn.communities.CommunityMembers=function(){
this.MEMBERSDOMID="membersdiv";
this.FULLMEMBERSDOMID="fullmembersdiv";
this.ADDBUTTONDOMID="memberAddButton";
this.ADDFORMDIVDOMID="memberAddFormDiv";
this.ADDMEMBERSDOMID="addMembersWidget";
this.MEMBERSLASTSPANDOMID_PREFIX="membersLastSpan";
this.MEMBERSLASTSPANDOMID="";
this.MEMBERS_FEED="/service/atom/forms/community/members";
this.MEMBERS_FEED_NO_FORMS="/service/atom/community/members";
this.MEMBERS_ADDSUBMIT="/service/html/community/members/add";
this.MEMBERS_EXPORT_ACTION="/service/html/community/members/export";
this.COMMUNITY_VIEW_PAGE="/service/html/communityview";
this.MEMBERS_FULL_VIEW_PAGE="service/html/community/members";
this.PROFILES_PHOTO_ACTION="/photo.do";
this.ALL_COMMUNITIES_MEMBER_SEARCH_URL="/service/html/allcommunities";
this.USERID_PARAM="userid";
this.COMMUNITYUUID_PARAM="communityUuid";
this.PAGESIZE_PARAM="ps";
this.ASC_PARAM="asc";
this.DESC_PARAM="desc";
this.SORTFIELD_PARAM="sortField";
this.SORTFIELD_VALUE_BY_CREATED="created";
this.SORTFIELD_VALUE_BY_NAME="name";
this.SORTFIELD_VALUE_RANDOM="random";
this.ROLE_PARAM="role";
this.ROLE_VALUE_MEMBER="member";
this.ROLE_VALUE_OWNER="owner";
this.ROLE_VALUE_ALL="all";
this.FILTER_ROLE="filterRole";
this.FILTER_PHOTO="filterPhoto";
this.UPARROW="/nav/common/styles/images/arrowScrollUp.gif";
this.DOWNARROW="/nav/common/styles/images/arrowScrollDown.gif";
this.BLANKIMAGE="/nav/common/styles/images/blank.gif";
this.FORMAT_PARAM="format";
this.FORMAT_VALUE_FULL="full";
this.PAGINGTYPE_PARAM="pagingtype";
this.PAGINGTYPE_VALUE_OFFSETS="offsets";
this.membersTimeout=null;
this.applicationContext=null;
this.commId=null;
this.loggedInUserid=null;
this.canAddOthers=null;
this.canRemoveOthers=null;
this.profileService=null;
this.profilePhotoPartialUrl=null;
this.atomCommunityMembersUrl=null;
this.atomCommunityMembersUrlForSubscription=null;
this.xslCommunityMembersUrl=null;
this.membersPerPage=5;
this.currentMembersUIState=null;
this.fullMembersMode=null;
this.widgetObjStr=null;
this.linkSelf=null;
this.linkPrev=null;
this.numEntries=null;
this.isEditInProgress=false;
this.addMembers_W=null;
this.lastMembersAtomUrl=null;
this.lastMod="0";
this.bidi=false;
this.dangerousurlnonce=null;
this.exposeEmail=false;
this.stringResources=null;
this.onLoad=function(){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: onLoad()");
}
}
this.loadStrings();
var _a58=this.iContext.getiWidgetAttributes();
this.membersPerPage=_a58.getItemValue("membersPerPage");
this.xslCommunityMembersUrl=this.iContext.io.rewriteURI("communityMembers.xsl");
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: xslCommunityMembersUrl: "+this.xslCommunityMembersUrl);
}
}
this.xslCommunityMembersUrl=lconn.core.widgetUtils.addVersionNumber(this.xslCommunityMembersUrl);
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: Updated xslCommunityMembersUrl with version: "+this.xslCommunityMembersUrl);
}
}
this.widgetObjStr="_"+this.iContext.widgetId+"_iContext.scope";
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: widgetObjStr: "+this.widgetObjStr);
}
}
this.fullMembersMode=false;
var mode=this.iContext.getiDescriptor().getItemValue("mode");
if(mode=="fullpage"){
this.fullMembersMode=true;
}
this.commId=_a58.getItemValue("resourceId");
this.applicationContext=WidgetPlacementConfig.applicationContext;
if(typeof isBidi!="undefined"){
this.bidi=isBidi;
}
if(typeof dangerousurlnonce!="undefined"){
this.dangerousurlnonce=dangerousurlnonce;
}
if(typeof exposeEmail!="undefined"){
this.exposeEmail=exposeEmail;
}
if(typeof lastMod!="undefined"){
this.setLastMod(lastMod);
}
this.UPARROW=this.applicationContext+this.UPARROW;
this.DOWNARROW=this.applicationContext+this.DOWNARROW;
this.BLANKIMAGE=this.applicationContext+this.BLANKIMAGE;
this.MEMBERSLASTSPANDOMID=this.MEMBERSLASTSPANDOMID_PREFIX+this.iContext.widgetId;
var _a5a=this.iContext.getUserProfile();
this.loggedInUserid=_a5a.getItemValue("userId");
this.canAddOthers=_a5a.getItemValue("canPersonalize");
this.canRemoveOthers=_a5a.getItemValue("canPersonalize");
if(typeof profileService!="undefined"&&profileService!=null&&profileService!=""){
this.profileService=profileService;
this.profilePhotoPartialUrl=this.profileService+this.PROFILES_PHOTO_ACTION+"?"+this.USERID_PARAM+"=";
}else{
}
this.atomCommunityMembersUrl=this.applicationContext+this.MEMBERS_FEED+"?"+this.COMMUNITYUUID_PARAM+"="+this.commId;
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: this.atomCommunityMembersUrl: "+this.atomCommunityMembersUrl);
}
}
var _a5b=lconn.core.widgetUtils.handleRefresh(this.atomCommunityMembersUrl,this.iContext);
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: mod_atomCommunityMembersUrl: "+_a5b);
}
}
this.atomCommunityMembersUrl=_a5b;
this.atomCommunityMembersUrlForSubscription=this.applicationContext+this.MEMBERS_FEED_NO_FORMS+"?"+this.COMMUNITYUUID_PARAM+"="+this.commId;
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: this.atomCommunityMembersUrlForSubscription: "+this.atomCommunityMembersUrlForSubscription);
}
}
if(this.fullMembersMode==true){
this.membersPerPage=_a58.getItemValue("membersPerPageFullPage");
this.MEMBERSDOMID=this.FULLMEMBERSDOMID;
if(this.canAddOthers){
}
this.currentMembersUIState=new lconn.communities.MembersUIState(this,null,null,null,this.membersPerPage);
this.currentMembersUIState.setFormat(this.FORMAT_VALUE_FULL);
this.executeNewestButton();
}else{
this.currentMembersUIState=new lconn.communities.MembersUIState(this,this.SORTFIELD_VALUE_BY_CREATED,this.DESC_PARAM,null,this.membersPerPage);
this.currentMembersUIState.setPagingType(this.PAGINGTYPE_VALUE_OFFSETS);
this.setCurrentMembersUIState(this.currentMembersUIState);
}
};
this.loadStrings=function(){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: loadStrings()");
}
}
if(this.stringResources==null){
this.stringResources=dojo.i18n.getLocalization("lconn.communities","strings");
}
};
this.getOffsetTop=function(_a5c){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: getOffsetTop(): pElem: "+_a5c);
}
}
var _a5d=0;
var _a5e=_a5c;
while(_a5e){
_a5d+=_a5e.offsetTop;
_a5e=_a5e.offsetParent;
if(_a5e){
_a5d-=_a5e.scrollTop;
}
}
return _a5d;
};
this.getOffsetLeft=function(_a5f){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: getOffsetLeft(): pElem: "+_a5f);
}
}
var _a60=0;
var _a61=_a5f;
while(_a61){
_a60+=_a61.offsetLeft;
_a61=_a61.offsetParent;
if(_a61){
_a60-=_a61.scrollLeft;
}
}
return _a60;
};
this.openEditUI=function(_a62){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: openEditUI(): uniqueID: "+_a62);
}
}
if(this.isEditInProgress){
return;
}
this.isEditInProgress=true;
var node=this.iContext.getElementById("table"+_a62);
var _a64=this.iContext.getElementById("edit"+_a62);
var _a65=this.iContext.getElementById("form"+_a62);
var _a66=this.iContext.getElementById("editremove"+_a62);
_a66.style.visibility="hidden";
var _a67=this.iContext.getElementById("name_"+_a62);
_a67.setAttribute("href","javascript:void(0);");
var _a68="table"+_a62;
node.setAttribute("id",_a68+"1");
var _a69="name_"+_a62;
_a67.setAttribute("id",_a69+"1");
var _a6a="userid_"+_a62;
var _a6b=this.iContext.getElementById(_a6a);
_a6b.setAttribute("id",_a6a+"1");
var _a6c="editremove"+_a62;
_a66.setAttribute("id",_a6c+"1");
var _a6d=node.cloneNode(true);
node.setAttribute("id",_a68);
_a67.setAttribute("id",_a69);
_a6b.setAttribute("id",_a6a);
_a66.setAttribute("id",_a6c);
var form=_a65;
form.insertBefore(_a6d,form.firstChild);
_a64.style.width=node.offsetWidth+5+"px";
_a64.style.top=this.getOffsetTop(node)+"px";
_a64.style.left=this.getOffsetLeft(node)+"px";
_a64.style.borderStyle="solid";
_a64.style.borderWidth="2px";
_a64.style.display="block";
if(dojo.isIE&&this.bidi){
_a64.style.position="static";
}
var _a6f=this.iContext.getElementById("name_"+_a62+"1");
_a6f.focus();
};
this.closeEditUI=function(_a70){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: closeEditUI(): uniqueID: "+_a70);
}
}
var _a71=this.iContext.getElementById("edit"+_a70);
var _a72=this.iContext.getElementById("wai_edit"+_a70);
var form=this.iContext.getElementById("form"+_a70);
form.removeChild(form.firstChild);
var _a74=this.iContext.getElementById("editremove"+_a70);
_a74.style.visibility="visible";
var _a75=this.iContext.getElementById("userid_"+_a70);
var _a76=this.iContext.getElementById("name_"+_a70);
if(_a75!=null){
_a76.setAttribute("href",this.applicationContext+"/service/html/allcommunities?userid="+_a75.innerHTML);
}else{
_a76.setAttribute("href","javascript:void(0);");
}
_a71.style.display="none";
_a71.style.borderStyle="none";
_a71.style.borderWidth="0px";
form.reset();
this.isEditInProgress=false;
};
this.saveEdit=function(_a77,_a78,_a79,_a7a,_a7b,_a7c){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: saveEdit(): theForm: "+_a77);
console.log("CommunityMembers.js: saveEdit(): editurl: "+_a78);
console.log("CommunityMembers.js: saveEdit(): userid: "+_a79);
console.log("CommunityMembers.js: saveEdit(): linkSelf: "+_a7a);
console.log("CommunityMembers.js: saveEdit(): uniqueID: "+_a7b);
console.log("CommunityMembers.js: saveEdit(): communityLastMod: "+_a7c);
}
}
var _a7d=_a77.elements["role"];
if(typeof _a7d!="undefined"&&_a7d!=null){
var _a7e=null;
for(var x=0;x<_a7d.length;x++){
if(_a7d[x].checked){
_a7e=_a7d[x].value;
}
}
var _a80=this;
var _a81=function(res,_a83){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: saveEdit: callbackfn: res: "+res);
if(typeof (res)!="undefined"&&res!=null){
if(typeof (res.body)!="undefined"&&res.body!=null){
console.log("CommunityMembers.js: saveEdit: callbackfn: res.body: "+res.body);
if(typeof (res.body.innerHTML)!="undefined"&&res.body.innerHTML!=null){
console.log("CommunityMembers.js: saveEdit: callbackfn: res.body.innerHTML: "+res.body.innerHTML);
}
}
}
console.log("CommunityMembers.js: saveEdit: callbackfn: ioArgs: "+_a83);
}
}
_a80.closeEditUI(_a7b);
if(_a79==_a80.loggedInUserid){
window.location.href=_a80.applicationContext+_a80.MEMBERS_FULL_VIEW_PAGE+"?"+_a80.COMMUNITYUUID_PARAM+"="+_a80.commId;
window.location.reload(true);
}else{
_a80.loadMembers(_a7a,_a7c,true);
}
return res;
};
var _a84="<?xml version='1.0' encoding='utf-8'?>"+"<entry xmlns='http://www.w3.org/2005/Atom' xmlns:snx='http://www.ibm.com/xmlns/prod/sn'>"+"<contributor>"+"<snx:userid>"+_a79+"</snx:userid>"+"</contributor>"+"<snx:role component='http://www.ibm.com/xmlns/prod/sn/communities'>"+_a7e+"</snx:role>"+"</entry>";
var _a85=new Object();
_a85["Content-Type"]="application/atom+xml";
dojo.xhrPut({url:_a78,putData:_a84,sync:true,load:_a81,error:dojo.hitch(this,this.xhrerrorcallback),headers:_a85});
}
};
this.xhrerrorcallback=function(res,_a87){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: xhrerrorcallback: res: "+res);
if(typeof (res)!="undefined"&&res!=null){
if(typeof (res.body)!="undefined"&&res.body!=null){
console.log("CommunityMembers.js: xhrerrorcallback: res.body: "+res.body);
if(typeof (res.body.innerHTML)!="undefined"&&res.body.innerHTML!=null){
console.log("CommunityMembers.js: xhrerrorcallback: res.body.innerHTML: "+res.body.innerHTML);
}
}
}
console.log("CommunityMembers.js: xhrerrorcallback: ioArgs: "+_a87);
}
}
if(this.lastMembersAtomUrl!=null){
this.loadMembers(this.lastMembersAtomUrl,null,true);
}
if((typeof _a87.xhr.status!="unknown")&&_a87.xhr.status!=302&&_a87.xhr.status!=0&&_a87.xhr.status!=12150){
var _a88=this.applicationContext+"/common/styles/images/iconError.gif";
var _a89="membersmessagesstart"+"<div class=\"lotusMessage\" >"+"<img class=\"lotusIcon\" src=\""+_a88+"\" alt=\""+res.message+"\" title=\""+res.message+"\"/>"+"<span>"+res.message+"</span>"+"</div>"+"membersmessagesend";
this.displayMessages(_a89);
alert(dojo.string.substitute(this.stringResources["rs_member_generic_error"],[res.message]));
}
if(this.lastMembersAtomUrl==null){
window.location.href=this.applicationContext+this.MEMBERS_FULL_VIEW_PAGE+"?"+this.COMMUNITYUUID_PARAM+"="+this.commId;
window.location.reload(true);
}
};
this.pageTo=function(junk,page){
this.setCurrentMembersUIState(this.currentMembersUIState,"&page="+(page+1));
};
this.doMemberDelete=function(_a8c,_a8d,_a8e,_a8f,_a90,_a91,_a92){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: doMemberDelete(): numEntries: "+_a8c);
console.log("CommunityMembers.js: doMemberDelete(): linkSelf: "+_a8d);
console.log("CommunityMembers.js: doMemberDelete(): linkPrev: "+_a8e);
console.log("CommunityMembers.js: doMemberDelete(): confirmMsg: "+_a8f);
console.log("CommunityMembers.js: doMemberDelete(): displayName: "+_a90);
console.log("CommunityMembers.js: doMemberDelete(): deleteUrl: "+_a91);
console.log("CommunityMembers.js: doMemberDelete(): communityLastMod: "+_a92);
}
}
if(this.isEditInProgress){
return;
}
if(confirm(dojo.string.substitute(_a8f,[_a90]))){
this.numEntries=_a8c;
this.linkSelf=_a8d;
this.linkPrev=_a8e;
var _a93=this;
var _a94=function(res,_a96){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: doMemberDelete: callbackfn: res: "+res);
if(typeof (res)!="undefined"&&res!=null){
if(typeof (res.body)!="undefined"&&res.body!=null){
console.log("CommunityMembers.js: doMemberDelete: callbackfn: res.body: "+res.body);
if(typeof (res.body.innerHTML)!="undefined"&&res.body.innerHTML!=null){
console.log("CommunityMembers.js: doMemberDelete: callbackfn: res.body.innerHTML: "+res.body.innerHTML);
}
}
}
console.log("CommunityMembers.js: doMemberDelete: callbackfn: ioArgs: "+_a96);
}
}
if(_a93.numEntries<=1){
_a93.loadMembers(_a93.linkPrev,_a92,true);
}else{
_a93.loadMembers(_a93.linkSelf,_a92,true);
}
};
dojo.xhrDelete({url:_a91,load:_a94,error:dojo.hitch(this,this.xhrerrorcallback)});
}
};
this.setCurrentMembersUIState=function(_a97,_a98){
if(typeof _a98!="undefined"&&_a98!=null){
this.loadMembers(_a97.toString()+_a98);
}else{
this.loadMembers(_a97.toString());
}
};
this.displaySorted=function(_a99){
this.currentMembersUIState.setSortField(_a99);
this.setCurrentMembersUIState(this.currentMembersUIState);
};
this.displayDirection=function(_a9a){
this.currentMembersUIState.setSortDirection(_a9a);
this.setCurrentMembersUIState(this.currentMembersUIState);
};
this.displayOnlyRole=function(role){
var _a9c=new lconn.communities.CommunityRoleFilter(this,role);
var _a9d={};
_a9d[this.FILTER_ROLE]=_a9c;
this.currentMembersUIState.setFilters(_a9d);
this.setCurrentMembersUIState(this.currentMembersUIState);
};
this.showFullMembersWidget=function(){
this.iContext.iEvents.fireEvent("onModeChanged","","{'newMode': 'fullpage'}");
return false;
};
this.setLastMod=function(_a9e){
this.lastMod=_a9e;
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: setLastMod(): Updated this.lastMod: "+this.lastMod);
}
}
};
this.configLastModInGivenUrl=function(_a9f,_aa0,_aa1){
if(typeof (_aa0)!="undefined"&&_aa0!=null&&_aa0!=""){
this.setLastMod(_aa0);
}
if(_a9f.indexOf("lastMod")<0){
if(typeof (_aa1)=="undefined"||_aa1==null||_aa1==false){
if(this.lastMod!=null&&this.lastMod!=""){
_a9f+="&lastMod="+this.lastMod;
}
}
}else{
var _aa2="lastMod=";
var _aa3=_a9f.indexOf(_aa2);
var _aa4=_a9f.substring(0,_aa3);
var _aa5=_a9f.substring(_aa3);
var _aa6=_aa5.indexOf("&");
var _aa7="";
if(_aa6>-1){
_aa7=_aa5.substring(0,_aa6);
_aa5=_aa5.substring(_aa6);
}else{
_aa7=_aa5.substring(0);
_aa5=null;
}
if((typeof (_aa1)=="undefined"||_aa1==null||_aa1==false)&&this.lastMod!=null&&this.lastMod!=""){
if(this.lastMod==_aa7){
return _a9f;
}
console.log("CommunityMembers.js: configLastModInGivenUrl: updating lastMod in old membersAtomUrl = "+_a9f);
if(_aa5!=null){
_a9f=_aa4+_aa2+this.lastMod+_aa5;
}else{
_a9f=_aa4+_aa2+this.lastMod;
}
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: configLastModInGivenUrl: updated lastMod in new membersAtomUrl = "+_a9f);
}
}
}else{
if(_aa5!=null){
_a9f=_aa4+_aa5.substring(1);
}else{
_a9f=_aa4.substring(0,_aa4.length-1);
}
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: configLastModInGivenUrl: removed lastMod in new membersAtomUrl = "+_a9f);
}
}
}
}
return _a9f;
};
this.loadMembers=function(_aa8,_aa9,_aaa){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: loadMembers(): membersAtomUrl: "+_aa8);
console.log("CommunityMembers.js: loadMembers(): membersAtomUrl: "+_aa9);
}
}
_aa8=this.configLastModInGivenUrl(_aa8,_aa9,_aaa);
this.lastMembersAtomUrl=_aa8;
this.isEditInProgress=false;
var _aab=this.iContext.getElementById("membersmessages");
if(typeof _aab!="undefined"&&_aab!=null){
_aab.style.display="none";
}
var _aac=this.iContext.getElementById(this.MEMBERSLASTSPANDOMID);
if(typeof _aac!="undefined"&&_aac!=null){
_aac.parentNode.removeChild(_aac);
}
var _aad=new Array();
var x=0;
_aad[x++]=["enableBizCard","true"];
if(this.profilePhotoPartialUrl!=null&&this.profilePhotoPartialUrl!=""){
_aad[x++]=["photoUrl",this.profilePhotoPartialUrl];
}
if(this.fullMembersMode!=null&&this.fullMembersMode){
_aad[x++]=["fullMembersMode",this.fullMembersMode];
}
if(this.loggedInUserid!=null&&this.loggedInUserid!=""){
_aad[x++]=["loggedInUserid",this.loggedInUserid];
}
if(this.canAddOthers!=null&&this.canAddOthers!=""){
_aad[x++]=["canAddOthers",this.canAddOthers];
}
if(this.canRemoveOthers!=null&&this.canRemoveOthers!=""){
_aad[x++]=["canRemoveOthers",this.canRemoveOthers];
}
if(this.UPARROW!=null&&this.UPARROW!=""){
_aad[x++]=["upArrow",this.UPARROW];
}
if(this.DOWNARROW!=null&&this.DOWNARROW!=""){
_aad[x++]=["downArrow",this.DOWNARROW];
}
if(this.BLANKIMAGE!=null&&this.BLANKIMAGE!=""){
_aad[x++]=["blankImage",this.BLANKIMAGE];
}
if(this.currentMembersUIState.getSortButtonID()!=null){
_aad[x++]=["sortButtonID",this.currentMembersUIState.getSortButtonID()];
}
if(this.exposeEmail!=null){
_aad[x++]=["exposeEmail",this.exposeEmail];
}
if(this.bidi!=null){
_aad[x++]=["bidi",this.bidi];
}
if(this.atomCommunityMembersUrl!=null){
_aad[x++]=["atomCommunityMembersUrl",this.atomCommunityMembersUrlForSubscription];
}
_aad[x++]=["applicationContext",this.applicationContext];
if(this.stringResources!=null){
for(str in this.stringResources){
_aad[x++]=[str,this.stringResources[str]];
}
}
_aad[x++]=["widgetObj",this.widgetObjStr];
_aad[x++]=["widgetId",this.iContext.widgetId];
this.transformAndRenderMembers(_aa8,this.xslCommunityMembersUrl,_aad);
this.handleAfterLoad();
};
this.handleAfterLoad=function(){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: handleAfterLoad() ");
}
}
lconn.core.utilities.processUntilElementIsFound(this.MEMBERSLASTSPANDOMID,dojo.hitch(this,function(){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: handleAfterLoad(): DOM object, which has its id, "+this.MEMBERSLASTSPANDOMID+", is in the DOM now.");
}
}
lconn.core.utilities.processUntilAvailable(dojo.hitch(this,function(){
if(window.SemTagSvc!=null){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: handleAfterLoad(): Enabling the person card by parsing DOM object, which has its id, "+this.MEMBERSDOMID);
}
}
lconn.core.utilities.processUntilElementIsFound(this.MEMBERSDOMID,dojo.hitch(this,function(){
SemTagSvc.parseDom(null,dojo.byId(this.MEMBERSDOMID));
}));
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: handleAfterLoad(): Finished parsing DOM object, which has its id, "+this.MEMBERSDOMID);
}
}
}
}),"(window.SemTagSvc != undefined)");
}));
};
this.getMemberPhotoURL=function(){
};
this.transformAndRenderMembers=function(_aaf,_ab0,_ab1){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: transformAndRenderMembers()");
}
}
var _ab2={xmlDocUrl:_aaf,xsltUrl:_ab0,htmlContainerElemId:this.MEMBERSDOMID,aXslParams:_ab1,dojoErrorHandler:lconn.core.errorhandling.DefaultXHRErrorHandler,exceptionHandler:lconn.core.errorhandling.DefaultErrorHandler};
lconn.core.xslt.transformAndRender(_ab2);
};
this.executeNewestButton=function(){
this.currentMembersUIState.setSortButtonID("memButtonNewest");
this.currentMembersUIState.setSortDirection(this.DESC_PARAM);
this.currentMembersUIState.setSortField(this.SORTFIELD_VALUE_BY_CREATED);
this.displayOnlyRole(this.ROLE_VALUE_ALL);
};
this.executeOwnersButton=function(){
this.currentMembersUIState.setSortButtonID("memButtonOwners");
this.currentMembersUIState.setSortDirection(this.ASC_PARAM);
this.currentMembersUIState.setSortField(this.SORTFIELD_VALUE_BY_NAME);
this.displayOnlyRole(this.ROLE_VALUE_OWNER);
};
this.executeAllButton=function(){
this.currentMembersUIState.setSortButtonID("memButtonAll");
this.currentMembersUIState.setSortDirection(this.ASC_PARAM);
this.currentMembersUIState.setSortField(this.SORTFIELD_VALUE_BY_NAME);
this.displayOnlyRole(this.ROLE_VALUE_ALL);
};
this.changePageSize=function(size){
this.currentMembersUIState.setPageSize(size);
this.setCurrentMembersUIState(this.currentMembersUIState);
};
this.displayMessages=function(_ab4){
var _ab5=this.iContext.getElementById("membersmessages");
if(typeof _ab5!="undefined"&&_ab5!=null){
if(typeof _ab4!="undefined"&&_ab4!=null&&_ab4.length>0){
var _ab6="membersmessagesstart";
var _ab7="membersmessagesend";
var _ab8=_ab4.indexOf(_ab6);
var _ab9=_ab4.indexOf(_ab7);
var _aba="";
if(_ab8>=0&&_ab9>=0){
_aba=_ab4.substr(_ab8+_ab6.length,_ab9-(_ab8+_ab6.length));
}
_ab5.innerHTML=_aba;
_ab5.style.display="block";
}
}
};
this.displayImport=function(_abb){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: displayImport()");
}
}
var _abc="importMembersWidget"+this.iContext.widgetId;
this.iContext.getElementById("csvtextarea"+this.iContext.widgetId).innerHTML="";
var _abd=this;
var _abe=function(_abf){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: displayImport: callbackfn: dialogfields: "+_abf);
}
}
};
var _ac0=function(_ac1){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: displayImport: cancelcallbackfn: dialogfields: "+_ac1);
}
}
_abd.cancelImport();
};
var _ac2=this.iContext.getElementById("importMembers"+this.iContext.widgetId).innerHTML;
var _ac3="importMembersForm"+this.iContext.widgetId;
var _ac4=new RegExp(_ac3,"g");
var _ac5=_ac3+"1";
_ac2=_ac2.replace(_ac4,_ac5);
var _ac6=new dijit.Dialog({"widgetId":_abc,"id":_abc,"title":_abb,"execute":_abe,"onCancel":_ac0,"class":"lotusDialog lotusDialogBorder"});
_ac6.closeButtonNode.style.display="none";
_ac6.attr("content",_ac2);
_ac6.startup();
_ac6.show();
return false;
};
this.cancelImport=function(){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: cancelImport()");
}
}
var _ac7="importMembersWidget"+this.iContext.widgetId;
if(dijit.byId(_ac7)){
dijit.byId(_ac7).destroy();
}
};
this.executeImport=function(){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: executeImport()");
}
}
var _ac8=this;
var _ac9=function(res,_acb){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: executeImport: callbackfn: res: "+res);
if(typeof (res)!="undefined"&&res!=null){
if(typeof (res.body)!="undefined"&&res.body!=null){
console.log("CommunityMembers.js: executeImport: callbackfn: res.body: "+res.body);
if(typeof (res.body.innerHTML)!="undefined"&&res.body.innerHTML!=null){
console.log("CommunityMembers.js: executeImport: callbackfn: res.body.innerHTML: "+res.body.innerHTML);
}
}
}
console.log("CommunityMembers.js: executeImport: callbackfn: ioArgs: "+_acb);
}
}
var _acc=null;
if(typeof (res.body.innerHTML)!="undefined"&&res.body.innerHTML!=null){
_acc=res.body.innerHTML;
_acc=_acc.replace(/&lt;/g,"<").replace(/&gt;/g,">");
}
_ac8.cancelImport();
if(_acc==null||_acc.length<=0){
if(_ac8.lastMembersAtomUrl!=null){
_ac8.loadMembers(_ac8.lastMembersAtomUrl,null,true);
}else{
window.location.href=_ac8.applicationContext+_ac8.MEMBERS_FULL_VIEW_PAGE+"?"+_ac8.COMMUNITYUUID_PARAM+"="+_ac8.commId;
window.location.reload(true);
}
}else{
_ac8.setLastModFromResponse(_acc);
_ac8.executeNewestButton();
_ac8.displayMessages(_acc);
}
return res;
};
var _acd=function(res,_acf){
_ac8.cancelImport();
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: executeImport: errorCallbackfn: res: "+res);
if(typeof (res)!="undefined"&&res!=null){
if(typeof (res.body)!="undefined"&&res.body!=null){
console.log("CommunityMembers.js: executeImport: errorCallbackfn: res.body: "+res.body);
if(typeof (res.body.innerHTML)!="undefined"&&res.body.innerHTML!=null){
console.log("CommunityMembers.js: executeImport: errorCallbackfn: res.body.innerHTML: "+res.body.innerHTML);
}
}
}
console.log("CommunityMembers.js: executeImport: errorCallbackfn: ioArgs: "+_acf);
}
}
if(_ac8.lastMembersAtomUrl!=null){
_ac8.loadMembers(_ac8.lastMembersAtomUrl,null,true);
}
if((typeof _acf.xhr.status!="unknown")&&_acf.xhr.status!=302&&_acf.xhr.status!=0&&_acf.xhr.status!=12150){
var _ad0=this.applicationContext+"/common/styles/images/iconError.gif";
var _ad1="membersmessagesstart"+"<div class=\"lotusMessage\" >"+"<img class=\"lotusIcon\" src=\""+_ad0+"\" alt=\""+res.message+"\" title=\""+res.message+"\"/>"+"<span>"+res.message+"</span>"+"</div>"+"membersmessagesend";
_ac8.displayMessages(_ad1);
alert(dojo.string.substitute(this.stringResources["rs_member_generic_error"],[res.message]));
}
if(_ac8.lastMembersAtomUrl==null){
window.location.href=_ac8.applicationContext+_ac8.MEMBERS_FULL_VIEW_PAGE+"?"+_ac8.COMMUNITYUUID_PARAM+"="+_ac8.commId;
window.location.reload(true);
}
};
dojo.io.iframe.send({url:this.applicationContext+this.MEMBERS_ADDSUBMIT,method:"POST",contentType:"multipart/form-data",handleAs:"html",form:"importMembersForm"+this.iContext.widgetId+"1",content:{"dangerousurlnonce":this.dangerousurlnonce,"communityUuid":this.commId},load:_ac9,preventCache:"true",error:dojo.hitch(this,_acd)});
};
this.displayExport=function(_ad2){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: displayExport()");
}
}
var _ad3="exportMembersWidget"+this.iContext.widgetId;
var _ad4=this;
var _ad5=function(_ad6){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: displayExport: callbackfn: dialogfields: "+_ad6);
}
}
};
var _ad7=function(_ad8){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: displayExport: cancelcallbackfn: dialogfields: "+_ad8);
}
}
_ad4.cancelExport();
};
var _ad9=this.iContext.getElementById("exportMembers"+this.iContext.widgetId).innerHTML;
var _ada="exportMembersForm"+this.iContext.widgetId;
var _adb=new RegExp(_ada,"g");
var _adc=_ada+"1";
_ad9=_ad9.replace(_adb,_adc);
var _add=new dijit.Dialog({"widgetId":_ad3,"id":_ad3,"title":_ad2,"execute":_ad5,"onCancel":_ad7,"class":"lotusDialog lotusDialogBorder"});
_add.closeButtonNode.style.display="none";
_add.attr("content",_ad9);
_add.startup();
_add.show();
return false;
};
this.cancelExport=function(){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: cancelExport()");
}
}
var _ade="exportMembersWidget"+this.iContext.widgetId;
if(dijit.byId(_ade)){
dijit.byId(_ade).destroy();
}
};
this.executeExport=function(){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: executeExport()");
}
}
var role=null;
var _ae0=false;
var _ae1=dojo.byId("ownersCheckboxexportMembersForm"+this.iContext.widgetId+"1");
var _ae2=dojo.byId("membersCheckboxexportMembersForm"+this.iContext.widgetId+"1");
if(_ae1.checked&&_ae2.checked){
_ae0=true;
role=null;
}else{
if(_ae1.checked){
_ae0=true;
role="owner";
}else{
if(_ae2.checked){
_ae0=true;
role="member";
}
}
}
if(_ae0==true){
var str=this.applicationContext+this.MEMBERS_EXPORT_ACTION+"?"+"communityUuid="+this.commId+"&ps=-1"+(role!=null?"&role="+role:"");
location.href=str;
}
this.cancelExport();
};
this.displayMemberCreateForm=function(_ae4,_ae5,_ae6,_ae7){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: displayMemberCreateForm(): ownerStr: "+_ae4);
console.log("CommunityMembers.js: displayMemberCreateForm(): memberStr: "+_ae5);
console.log("CommunityMembers.js: displayMemberCreateForm(): addStr: "+_ae6);
console.log("CommunityMembers.js: displayMemberCreateForm(): removeStr: "+_ae7);
}
}
var _ae8=this.iContext.getElementById(this.ADDFORMDIVDOMID);
_ae8.style.display="block";
var tmp=this.iContext.getElementById(this.ADDMEMBERSDOMID);
if(typeof tmp!="undefined"&&tmp!=null){
var comp=dijit.byId(tmp.id);
if(typeof comp!="undefined"&&comp!=null){
comp.destroy();
this.iContext.getElementById("addMembersWidgetTD").innerHTML="<div id=\"addMembersWidget\"> </div>";
}
}
this.addMembers_W=new lconn.comm.typeahead.AddMembers({"class":"content","rs_owner":_ae4,"rs_member":_ae5,"rs_addMember_title":_ae6,"rs_removeMember_title":_ae7},this.iContext.getElementById(this.ADDMEMBERSDOMID));
var _aeb=document.getElementsByTagName("input");
for(var x=0;x<_aeb.length;x++){
var id=_aeb[x].id;
if(typeof id!="undefined"&&id!=null){
if(id.indexOf("lconn_core_PeopleTypeAhead")>=0){
_aeb[x].focus();
}
}
}
return false;
};
this.cancelMemberCreateForm=function(){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: cancelMemberCreateForm(): ");
}
}
var _aee=this.iContext.getElementById("errorMessages");
if(typeof _aee!="undefined"&&_aee!=null){
_aee.style.display="none";
}
var _aef=this.iContext.getElementById(this.ADDFORMDIVDOMID);
if(typeof _aef!="undefined"&&_aef!=null){
_aef.style.display="none";
}
if(this.addMembers_W){
this.addMembers_W.reset();
}
};
this.saveMemberFields=function(_af0){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: saveMemberFields(): ");
}
}
this.addMembers_W.setHiddenFields();
_af0.elements["dangerousurlnonce"].value=this.dangerousurlnonce;
_af0.elements["communityUuid"].value=this.commId;
_af0.elements["members"].value=this.addMembers_W.getMembers();
_af0.elements["owners"].value=this.addMembers_W.getOwners();
var _af1=this;
var _af2=function(res,_af4){
if(window.debugComm!=null){
if(window.console!=null){
console.log("CommunityMembers.js: saveMemberFields: callbackfn: res: "+res);
if(typeof (res)!="undefined"&&res!=null){
if(typeof (res.body)!="undefined"&&res.body!=null){
console.log("CommunityMembers.js: saveMemberFields: callbackfn: res.body: "+res.body);
if(typeof (res.body.innerHTML)!="undefined"&&res.body.innerHTML!=null){
console.log("CommunityMembers.js: saveMemberFields: callbackfn: res.body.innerHTML: "+res.body.innerHTML);
}
}
}
console.log("CommunityMembers.js: saveMemberFields: callbackfn: ioArgs: "+_af4);
}
}
_af1.cancelMemberCreateForm();
_af1.setLastModFromResponse(res);
_af1.executeNewestButton();
_af1.displayMessages(res);
};
dojo.xhrPost({url:this.applicationContext+this.MEMBERS_ADDSUBMIT,form:_af0,sync:true,load:_af2,error:dojo.hitch(this,this.xhrerrorcallback)});
};
this.setLastModFromResponse=function(_af5){
if(typeof _af5!="undefined"&&_af5!=null&&_af5.length>0){
var _af6="lastmodstart";
var _af7="lastmodend";
var _af8=_af5.indexOf(_af6);
var _af9=_af5.indexOf(_af7);
var _afa=_af5.substr(_af8+_af6.length,_af9-(_af8+_af6.length));
this.setLastMod(_afa);
}
};
this.getRandomInteger=function(min,max){
return Math.floor(Math.random()*(max-min+1))+min;
};
this.atomLinkOnClick=function(){
var _afd=navigator.appVersion;
var _afe=_afd.split(";");
var bVer=_afe[1].replace(/[\s]/g,"");
if(bVer=="MSIE6.0"){
alert(this.stringResources["rs_popup_subscribe_to_feed"]);
return false;
}
return true;
};
};
lconn.communities.CommunityRoleFilter=function(_b00,role){
this.membersWidget=_b00;
this.role=role;
this.toString=function(){
if(this.role==null||this.role==this.membersWidget.ROLE_VALUE_ALL){
return "";
}else{
return "&"+this.membersWidget.ROLE_PARAM+"="+this.role;
}
};
this.setRole=function(role){
this.role=role;
};
};
lconn.communities.MembersUIState=function(_b03,_b04,_b05,_b06,_b07){
this.membersWidget=_b03;
this.sortField=_b04;
this.sortDirection=_b05;
this.pageSize=_b07;
this.format=null;
this.pagingType=null;
this.sortButtonID="memButtonNewest";
if(_b06!=null){
this.filters=_b06;
}else{
this.filters=new Object();
}
this.setSortField=function(_b08){
this.sortField=_b08;
};
this.setSortDirection=function(_b09){
this.sortDirection=_b09;
};
this.setPageSize=function(_b0a){
this.pageSize=_b0a;
};
this.setFormat=function(_b0b){
this.format=_b0b;
};
this.setPagingType=function(_b0c){
this.pagingType=_b0c;
};
this.setSortButtonID=function(_b0d){
this.sortButtonID=_b0d;
};
this.getSortButtonID=function(){
return this.sortButtonID;
};
this.setFilters=function(_b0e){
for(key in _b0e){
this.filters[key]=_b0e[key];
}
};
this.toString=function(){
var _b0f="";
if(this.sortField!=null){
_b0f+="&"+this.membersWidget.SORTFIELD_PARAM+"="+this.sortField;
if(this.sortDirection!=null){
_b0f+="&"+this.sortDirection+"=true";
}
}
if(this.filters!=null){
for(key in this.filters){
_b0f+=this.filters[key];
}
}
if(this.pageSize!=null){
_b0f+="&"+this.membersWidget.PAGESIZE_PARAM+"="+this.pageSize;
}
if(this.format!=null){
_b0f+="&"+this.membersWidget.FORMAT_PARAM+"="+this.format;
}
if(this.pagingType!=null){
_b0f+="&"+this.membersWidget.PAGINGTYPE_PARAM+"="+this.pagingType;
}
return this.membersWidget.atomCommunityMembersUrl+_b0f;
};
};
}
if(!dojo._hasResource["lconn.core.TopicList"]){
dojo._hasResource["lconn.core.TopicList"]=true;
dojo.provide("lconn.core.TopicList");
lconn.core.TopicList=function(){
};
var p=lconn.core.TopicList.prototype;
p.commUuid=null;
p.topicFeedPath=null;
p.pageSize=15;
p.page=1;
p.topicsUrl="";
p.forceRefresh=false;
p.onLoad=function(){
var _b10=this.iContext.getiWidgetAttributes();
this.topicFeedPath=_b10.getItemValue("topicFeedPath");
if(!this.topicFeedPath){
throw ("lconn.core.TopicList has been loaded without the required topicFeedPath attribute");
}
this.commUuid=_b10.getItemValue("resourceId");
if(!this.commUuid){
throw ("lconn.core.TopicList has been loaded without the resource ID");
}
this.rs=dojo.i18n.getLocalization("lconn.core","strings");
var ps=parseInt(_b10.getItemValue("ps"));
if(ps){
this.pageSize=ps;
}
var mode=this.iContext.getiDescriptor().getItemValue("mode");
var up=this.iContext.getUserProfile();
this.isLoggedIn=up.getItemValue("userId");
this.isOwner=up.getItemValue("canPersonalize")=="true";
this.isMember=up.getItemValue("canContribute")=="true";
this.listNode=this.iContext.getElementById("list");
if(mode=="search"){
lconn.core.widgetUtils.search(this.iContext,"communities:forum",this.listNode);
}else{
this.topicsUrl=this.topicFeedPath+"?communityUuid="+this.commUuid+"&sortOrder=desc&ps="+this.pageSize;
if(this.forceRefresh){
this.topicsUrl=this.topicsUrl+"&preventCache="+(new Date().getTime());
}else{
this.forceRefresh=true;
}
this.getTopics();
}
};
p.getTopics=function(){
this.listNode.innerHTML=this.rs.rs_loading;
this.xslt=null;
this.xml=null;
var that=this;
var _b15=null;
if(window.WidgetPlacementConfig&&WidgetPlacementConfig.params&&WidgetPlacementConfig.params["version"]){
_b15=WidgetPlacementConfig.params["version"];
}
var _b16="topicList.xsl";
if(_b15){
_b16+="?version="+_b15;
}
dojo.xhrGet({url:this.iContext.io.rewriteURI(_b16),load:function(_b17){
that.xslt=_b17;
if(that.xml){
that.transform(that.xml,that.xslt);
}
},handleAs:"xml"});
dojo.xhrGet({url:this.topicsUrl,load:function(_b18){
that.xml=dojox.data.dom.createDocument(_b18);
if(that.xslt){
that.transform(that.xml,that.xslt);
}
},handleAs:"text"});
};
p.transform=function(xml,xsl){
var html;
if(window.ActiveXObject){
html=xml.transformNode(xsl);
}else{
if(document.implementation&&document.implementation.createDocument){
var _b1c=new XSLTProcessor();
_b1c.importStylesheet(xsl);
var _b1d=_b1c.transformToFragment(xml,document);
var tmp=document.createElement("div");
tmp.appendChild(_b1d);
html=tmp.innerHTML;
}
}
if(this.isLoggedIn){
this.rs.emptyForumMessage=this.rs.rs_noTopicsLoggedIn;
}else{
this.rs.emptyForumMessage=this.rs.rs_noTopics;
}
html=dojo.string.substitute(html,this.rs);
this.listNode.innerHTML=this.iContext.processMarkup(html);
this.startTopicNode=this.iContext.getElementById("startTopicLink");
if(this.isMember){
dojo.removeClass(this.startTopicNode,"lotusHidden");
}
this.parseDates();
if(window.SemTagSvc&&SemTagSvc.parseDom){
SemTagSvc.parseDom(0,this.iContext.getRootElement());
}
};
p.parseDates=function(){
dojo.query(".formatDate",this.listNode).forEach(function(item){
item.innerHTML=lconn.core.DateUtil.AtomDateToString(item.innerHTML);
dojo.removeClass(item,"lotusHidden");
});
};
p.addPageLabel=function(){
var _b20=dojo.query(".lotusPaging .pageRange",this.listNode);
var _b21=dojo.query(".lotusTable",this.listNode);
var _b22=0;
if(_b21.length>0){
_b22=(_b21[0].childNodes[0].childNodes.length-1)/2;
}else{
_b22=this.pageSize;
}
var _b23=(this.page-1)*_b22+1;
var end=_b23+_b22-1;
if(_b20.length>0){
_b20[0].innerHTML=_b23+" &ndash; "+end;
}
};
}
if(!dojo._hasResource["lconn.core.QuoteEditorPlugin"]){
dojo._hasResource["lconn.core.QuoteEditorPlugin"]=true;
dojo.provide("lconn.core.QuoteEditorPlugin");
dojo.declare("lconn.core.QuoteEditorPlugin",dijit._editor._Plugin,{buttonClass:dijit.form.Button,useDefaultCommand:false,constructor:function(){
var b=dojo.i18n.getLocalization("lconn.core","strings");
this.button=new this.buttonClass({label:b.rs_quote,showLabel:false,iconClass:"lconnSprite lconnSprite-iconQuote16",onClick:dojo.hitch(this,"setValue"),tabIndex:"-1"});
},setValue:function(args){
var _b27;
if(!dojo.withGlobal(this.editor.window,"getAncestorElement",dijit._editor.selection,["blockquote"])){
_b27=dojo.withGlobal(this.editor.window,dijit._editor.selection.getSelectedText);
if(_b27.length>0){
var _b28="<br><blockquote class=\"lconnQuote\">"+_b27+"</blockquote><br>";
this.editor.execCommand("inserthtml",_b28);
}
}
}});
dojo.subscribe(dijit._scopeName+".Editor.getPlugin",null,function(o){
if(o.plugin){
return;
}
if(o.args.name=="lconn.core.QuoteEditorPlugin"){
return new lconn.core.QuoteEditorPlugin({});
}
});
}
if(!dojo._hasResource["lconn.forums.PostForm"]){
dojo._hasResource["lconn.forums.PostForm"]=true;
dojo.provide("lconn.forums.PostForm");
dojo.declare("lconn.forums.PostForm",[dijit._Widget,dijit._Templated],{templateString:["<div class=\"lotusPostForm lotusPost\">","<div class=\"lotusPostAuthorInfo lotusHidden\" dojoAttachPoint=\"cardNode\"><div dojoAttachPoint=\"avatarNode\" class=\"lotusPostAvatar\"></div>","<div class=\"lotusPostName\"><span class=\"lotusPerson\">${displayName}</span></div></div>","<div class=\"lotusPostContent\">","<div class=\"lotusPostDetails\">","<div class=\"${dialogBorderClass}\" style=\"max-width: none; width: auto; zoom: 1\">","<form class=\"lotusDialog lotusForm\" dojoAttachPoint=\"formNode\" action=\"${url}\" method=\"POST\" dojoAttachEvent=\"onsubmit:post\">","<h1>${rs_newTopic}</h1>","<input type=\"hidden\" name=\"containerUuid\" value=\"${communityUuid}\" dojoAttachPoint=\"communityUuidInput\" />","<input type=\"hidden\" name=\"forumUuid\" value=\"${forumUuid}\" />","<input type=\"hidden\" name=\"uuid\" value=\"\" dojoAttachPoint=\"replyUuidInput\" />","<input type=\"hidden\" name=\"description\" value=\"\" dojoAttachPoint=\"descriptionInput\" />","<input type=\"hidden\" name=\"topicUuid\" value=\"${topicUuid}\" dojoAttachPoint=\"topicUuidInput\" />","<input type=\"hidden\" name=\"parentUuid\" value=\"\" dojoAttachPoint=\"parentUuidInput\" />","<input type=\"hidden\" name=\"dangerousurlnonce\" value=\"\" dojoAttachPoint=\"nonceInput\" />","<input type=\"hidden\" name=\"isXHR\" value=\"1\" dojoAttachPoint=\"isXhrInput\" />","<div class=\"${dialogContentClass}\"><table class=\"lotusFormTable\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">","<tbody>","<tr class=\"forumError lotusHidden\" dojoAttachPoint=\"formErrorRow\"><td><div class=\"lotusMessage\"><img src=\"${_blankGif}\" class=\"lconnSprite lconnSprite-iconError16\" /> <span dojoAttachPoint=\"formErrorNode\"> </span></div></td></tr>","<tr class=\"forumError lotusHidden\" dojoAttachPoint=\"titleErrorRow\"><td class=\"lotusFormError\"><img src=\"${_blankGif}\" class=\"lconnSprite lconnSprite-iconError16\" /> <span dojoAttachPoint=\"titleErrorCell\"> </span></td></tr>","<tr class=\"lotusFormFieldRow\" dojoAttachPoint=\"titleFieldRow\"><td><input class=\"lotusText\" id=\"${id}_postTitle\" title=\"${rs_title}\" type=\"text\" name=\"title\" dojoAttachPoint=\"titleNode\" /></td></tr>","<tr class=\"forumError lotusHidden\" dojoAttachPoint=\"descriptionErrorRow\"><td class=\"lotusFormError\"><img src=\"${_blankGif}\" class=\"lconnSprite lconnSprite-iconError16\" /> <span dojoAttachPoint=\"descriptionErrorCell\"> </span></td></tr>","<tr class=\"lotusFormFieldRow\"><td><div class=\"lotusText\" name=\"description\" dojoAttachPoint=\"descriptionNode\"></div></td></tr>","<tr class=\"lotusFormFieldRow\" style=\"${subscribeFieldRowStyle}\"><td><input name=\"subscribe\" dojoAttachPoint=\"subscribeNode\" type=\"checkbox\" id=\"${id}_subscribe\" value=\"true\" ${checkedAttr} /> <label for=\"${id}_subscribe\">${rs_notifyTopicPrompt}</label></td></tr>","</tbody></table></div>","<div class=\"${dialogFooterClass}\">","<span dojoAttachPoint=\"footerButtonNode\">","<input id=\"submitBtn\" type=\"submit\" class=\"lotusFormButton\" value=\"${rs_ok}\" />"," <a class=\"lotusActionCancel\" href=\"javascript:;\" dojoAttachEvent=\"onclick:cancel\">${rs_cancel}</a>","</span>","<span class=\"lotusHidden\" dojoAttachPoint=\"footerLoadingNode\">${rs_loading}</span>","</div>","</form>","</div>","</div>","</div></div>"].join(""),editor:null,_isTopic:false,displayName:"",thumbnailPath:"",communityUuid:"",forumUuid:"",topicUuid:"",parentUuid:"",uuid:"",content:"",title:"",showCard:true,subscribed:false,xhr:true,nonceThread:null,checkedAttr:"",titleLimit:256,descriptionLimit:500000,onPost:null,inlineForm:false,subscriptionsEnabled:true,subscribeFieldRowStyle:"",dialogBorderClass:"lotusDialogBorder",dialogContentClass:"lotusDialogContent",dialogFooterClass:"lotusDialogFooter",postMixInProperties:function(){
var b=dojo.i18n.getLocalization("lconn.core","strings");
this.rs_attachFile=b.rs_attachFile;
this.rs_ok=b.rs_ok;
this.rs_cancel=b.rs_cancel;
this.rs_loading=b.rs_loading;
this.rs_messageTooLong=b.rs_messageTooLong;
this.rs_newTopic=b.rs_newTopic;
this.rs_notifyTopicPrompt=b.rs_notifyTopicPrompt;
this.rs_title=b.rs_title;
this.rs_titleCantBeEmpty=b.rs_titleCantBeEmpty;
this.rs_titleTooLong=b.rs_titleTooLong;
this.rs_timeoutMsg=b.rs_timeoutMsg;
this.rs_tryAgain=b.rs_tryAgain;
this.rs_unknownError=b.rs_unknownError;
this.rs_loggedOut=b.rs_loggedOut;
this.rs_logIn=b.rs_logIn;
if(this.inlineForm){
this.dialogBorderClass="";
this.dialogContentClass="";
this.dialogFooterClass="lotusDialogFooter lotusDialogFooterAlign";
}
if(this.subscribed){
this.checkedAttr="checked=\"checked\"";
}
if(!this.subscriptionsEnabled){
this.subscribeFieldRowStyle="display: none";
}
},postCreate:function(){
if(!this.topicUuid||this.topicUuid==this.uuid){
this._isTopic=true;
}else{
this._isTopic=false;
}
if(!this._isTopic&&(!this.parentUuid&&!this.uuid)){
throw new Error("Exception: "+this.declaredClass+" requires either a parentUuid or uuid parameter when posting a reply");
return;
}
if(this.showCard){
dojo.removeClass(this.cardNode,"lotusHidden");
if(this.thumbnailPath){
this.avatarNode.innerHTML="<img height=\"45\" width=\"45\" src=\""+this.thumbnailPath+"\" />";
}
}
if(this.title||this._isTopic){
dojo.removeClass(this.titleFieldRow,"lotusHidden");
this.titleNode.value=this.title;
}
if(this.content){
this.descriptionNode.innerHTML=this.content;
}
var _b2b=new dojo.Deferred();
_b2b.addCallback(dojo.hitch(this,"focus"));
var _b2c=["bold","italic","underline","strikethrough","|","foreColor","hiliteColor","|","insertUnorderedList","insertOrderedList","|","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull","|","createLink","insertImage","insertHorizontalRule","lconn.core.QuoteEditorPlugin"];
this.editor=new dijit.Editor({height:200,onLoadDeferred:_b2b,plugins:_b2c,styleSheets:dojo.moduleUrl("lconn","themes/default/editor.css").toString(),extraPlugins:[{name:"dijit._editor.plugins.EnterKeyHandling",blockNodeForEnter:"DIV"}]},this.descriptionNode);
},focus:function(evt){
if(this.title||this._isTopic){
this.titleNode.focus();
}else{
this.attachFileNode.focus();
}
return evt;
},nonceSuccess:function(_b2e){
this.post();
},post:function(evt){
this.hideErrors();
if(!this.validate()){
if(evt){
dojo.stopEvent(evt);
}
return false;
}
var _b30=this.nonceThread.getNonce();
if(!_b30){
this.nonceThread.addListener(dojo.hitch(this,"nonceSuccess"),dojo.hitch(this,"error"));
dojo.addClass(this.footerButtonNode,"lotusHidden");
dojo.removeClass(this.footerLoadingNode,"lotusHidden");
if(evt){
dojo.stopEvent(evt);
}
return false;
}
this.nonceInput.value=_b30;
this.replyUuidInput.value=this.uuid;
this.descriptionInput.value=this.editor.getValue();
this.parentUuidInput.value=this.parentUuid;
if(this.xhr){
this.isXhrInput.value="1";
dojo.addClass(this.footerButtonNode,"lotusHidden");
dojo.removeClass(this.footerLoadingNode,"lotusHidden");
dojo.xhrPost({url:this.url,form:this.formNode,handleAs:"text",isPostRequest:true,timeout:30000,load:dojo.hitch(this,"loadReply"),error:dojo.hitch(this,"error"),contentType:"application/x-www-form-urlencoded;charset=UTF-8"});
if(evt){
dojo.stopEvent(evt);
}
return false;
}else{
this.isXhrInput.value="";
return true;
}
},loadReply:function(_b31,_b32){
var ciaa=com.ibm.ajax.auth;
if(!ciaa.isAuthenticationRequired(_b31,_b32)&&!(window.IS_FORUMS_AUTHENTICATION_REQUIRED&&IS_FORUMS_AUTHENTICATION_REQUIRED(_b31,_b32))){
if(this.onPost){
this.onPost(_b31,_b32);
}
}else{
this.error(_b31,_b32);
}
return _b31;
},error:function(_b34,_b35){
var _b36=document.createElement("a");
_b36.onclick=dojo.hitch(this,"post");
_b36.href="javascript:;";
_b36.innerHTML=this.rs_tryAgain;
if(_b34.dojoType&&_b34.dojoType=="timeout"){
this.formErrorNode.innerHTML=this.rs_timeoutMsg;
}else{
this.formErrorNode.innerHTML=this.rs_unknownError;
}
this.formErrorNode.appendChild(document.createTextNode(" "));
this.formErrorNode.appendChild(_b36);
dojo.removeClass(this.formErrorRow,"lotusHidden");
dojo.removeClass(this.footerButtonNode,"lotusHidden");
dojo.addClass(this.footerLoadingNode,"lotusHidden");
_b35.args._tryAgainLink=_b36;
_b35.args._logIn=dojo.hitch(this,"logIn");
},logIn:function(_b37,_b38){
var _b39=document.createElement("a");
_b39.href=_b38;
_b39.innerHTML=this.rs_logIn;
this.formErrorNode.innerHTML=this.rs_loggedOut;
this.formErrorNode.appendChild(document.createTextNode(" "));
this.formErrorNode.appendChild(_b39);
},cancel:function(evt){
dojo.stopEvent(evt);
},reset:function(){
this.formNode.reset();
this.descriptionInput.value="";
this.replyUuidInput.value="";
this.parentUuidInput.value="";
this.hideErrors();
dojo.removeClass(this.footerButtonNode,"lotusHidden");
dojo.addClass(this.footerLoadingNode,"lotusHidden");
},validate:function(){
var _b3b=true;
this.hideErrors();
if(this.titleNode.value.length==0){
_b3b=false;
dojo.removeClass(this.titleErrorRow,"lotusHidden");
this.titleErrorCell.innerHTML=this.rs_titleCantBeEmpty;
}else{
if(this.titleNode.value.length>this.titleLimit){
_b3b=false;
dojo.removeClass(this.titleErrorRow,"lotusHidden");
this.titleErrorCell.innerHTML=dojo.string.substitute(this.rs_titleTooLong,[this.titleLimit]);
}
}
if(this.editor.getValue().length>this.descriptionLimit){
_b3b=false;
dojo.removeClass(this.descriptionErrorRow,"lotusHidden");
this.descriptionErrorCell.innerHTML=dojo.string.substitute(this.rs_messageTooLong,[(this.descriptionLimit/1000)+"KB"]);
}
return _b3b;
},hideErrors:function(){
dojo.query(".forumError",this.domNode).addClass("lotusHidden");
},showError:function(str){
dojo.removeClass(this.formErrorRow,"lotusHidden");
this.formErrorNode.innerHTML="<span>"+str+"</span>";
},uninitialize:function(){
if(this.editor){
this.editor.destroyRecursive();
}
}});
}
if(!dojo._hasResource["lconn.forums.NonceThread"]){
dojo._hasResource["lconn.forums.NonceThread"]=true;
dojo.provide("lconn.forums.NonceThread");
lconn.forums.NonceThread=function(_b3d,_b3e,_b3f){
this.period=_b3d;
this.url=_b3e;
this.topic=_b3f;
var _b40=false;
var that=this;
var _b42=null;
var _b43=[];
var _b44=[];
var _b45=null;
var _b46=null;
var _b47=false;
this.start=function(){
if(!_b40&&!_b47){
_b40=true;
fetchNonce();
}
};
this.stop=function(){
if(_b40){
_b40=false;
}
};
this.getNonce=function(){
return _b42;
};
this.isLoggedOut=function(){
return _b47;
};
this.addListener=function(_b48,_b49){
if(_b42){
fn();
}else{
if(_b48){
_b43.push(_b48);
}
if(_b49){
_b44.push(_b49);
}
if(!_b45){
if(_b46){
clearTimeout(_b46);
}
fetchNonce();
}
}
};
function delayedFetch(){
if(_b40&&!_b47){
_b46=setTimeout(fetchNonce,that.period);
}
};
function fetchNonce(){
_b42=null;
_b45=dojo.xhrGet({url:that.url,handleAs:"json",timeout:10000,load:function(_b4a,_b4b){
_b45=null;
if(_b40){
_b42=_b4a.nonce;
dojo.publish(that.topic,[_b42]);
for(var i in _b43){
_b43[i](_b42);
}
delayedFetch();
}
_b43=[];
_b44=[];
},error:function(_b4d,_b4e){
_b45=null;
for(var i in _b44){
_b44[i](_b4d,_b4e);
}
_b43=[];
_b44=[];
if(_b40){
delayedFetch();
}
var _b50=_b4e.args._logIn;
_b4e.args._logIn=function(_b51,_b52){
that.stop();
_b47=true;
if(_b50){
_b50(_b51,_b52);
}
};
}});
};
};
}
if(!dojo._hasResource["lconn.forums.TopicList"]){
dojo._hasResource["lconn.forums.TopicList"]=true;
dojo.provide("lconn.forums.TopicList");
dojo.declare("lconn.forums.TopicList",[dijit._Widget],{topicForm:null,communityUuid:"",contextPath:"",forumUuid:"",showForm:false,topicListNode:null,topicListTbody:null,previousLink:null,nextLink:null,topicForm:null,page:0,ps:null,numPages:1,isPaging:false,sessionTimeout:"",nonceThread:null,subscriptionsEnabled:true,postUrl:"/service/forum/forms/post/topic",topicsUrl:"/service/forum/forms/get/topics",postCreate:function(){
var div=document.createElement("div");
dojo.place(div,this.domNode,"before");
dojo.place(this.domNode,div,"first");
this.topicListNode=this.domNode;
this.domNode=div;
this.postUrl=this.contextPath+this.postUrl;
this.topicsUrl=this.contextPath+this.topicsUrl;
this.parseDates(this.domNode);
if(this.numPages==1){
this._disableLink(this._getNextLink());
}
if(this.sessionTimeout){
this.nonceThread=new lconn.forums.NonceThread((this.sessionTimeout*1000)-10000,this.contextPath+"/service/forum/get/nonce","newNonce");
this.nonceThread.start();
}
if(this.showForm){
this.newTopic();
}
},parseDates:function(node){
dojo.query(".formatDate",node).forEach(function(item){
item.innerHTML=lconn.core.DateUtil.AtomDateToString(item.innerHTML);
dojo.removeClass(item,"lotusHidden");
});
},newTopic:function(){
dojo.addClass(this.topicListNode,"lotusHidden");
if(!this.topicForm){
var div=document.createElement("div");
this.domNode.appendChild(div);
this.topicForm=new lconn.forums.PostForm({"class":"lotusForumNewTopic",url:this.postUrl,showCard:false,communityUuid:this.communityUuid,forumUuid:this.forumUuid,nonceThread:this.nonceThread,subscribed:true,subscriptionsEnabled:this.subscriptionsEnabled,onPost:dojo.hitch(this,"onPost")},div);
this.connect(this.topicForm,"cancel","closeForm");
}else{
dojo.removeClass(this.topicForm.domNode,"lotusHidden");
this.topicForm.focus();
}
},closeForm:function(){
dojo.addClass(this.topicForm.domNode,"lotusHidden");
dojo.removeClass(this.topicListNode,"lotusHidden");
this.topicForm.reset();
},onPost:function(_b57,_b58){
if(_b57){
location.href=_b57;
}else{
throw new Error("Response from trying to create a topic did not contain anything");
}
},focusTopic:function(node){
if(!node){
node=this.domNode;
}
links=dojo.query("a[href]",node);
if(links.length>0){
links[0].focus();
}
},previous:function(){
if(this.page>0){
this.pageTo(--this.page);
}
},next:function(){
this.pageTo(++this.page);
},pageTo:function(page){
if(typeof page!="number"){
return;
}
if(this.isPaging){
return;
}
var args={page:page};
if(this.ps){
args.ps=this.ps;
}
if(this.communityUuid){
args.communityUuid=this.communityUuid;
}
if(this.forumUuid){
args.forumUuid=this.forumUuid;
}
this.isPaging=true;
dojo.xhrGet({url:this.topicsUrl,content:args,timeout:10000,load:dojo.hitch(this,"onPageTo"),error:dojo.hitch(this,"onPageToError")});
},onPageTo:function(_b5c,_b5d){
this.isPaging=false;
var _b5e=document.createElement("div");
_b5e.innerHTML=_b5c;
var _b5f=this._getPageRangeNodes();
var _b60=dojo.query("table",_b5e);
var _b61=this._getTbody();
var _b62=_b60.attr("rangeLow")[0];
var _b63=_b60.attr("rangeHigh")[0];
var _b64=_b60.attr("rangeTotal")[0];
if(_b5f){
_b5f[0].innerHTML=_b62;
_b5f[1].innerHTML=_b63;
_b5f[2].innerHTML=_b64;
}
this.numPages=Math.ceil(parseInt(_b64)/this.ps);
var _b65=this._getNextLink();
if(parseInt(_b63)>=parseInt(_b64)){
this._disableLink(_b65);
}else{
this._enableLink(_b65,dojo.hitch(this,"next"));
}
var _b66=this._getPreviousLink();
if(parseInt(_b62)==1){
this._disableLink(_b66);
}else{
this._enableLink(_b66,dojo.hitch(this,"previous"));
}
if(!_b61){
throw new Exception("Exception: "+this.declaredClass+".onPageTo() couldn't find a table in the topic list.");
return;
}
if(_b60.length==0){
throw new Exception("Exception: "+this.declaredClass+".onPageTo() a received malformed HTML response.");
return;
}
parentContainer=_b61.parentNode.parentNode;
dojo.place(_b60[0],_b61.parentNode,"before");
parentContainer.removeChild(_b61.parentNode);
_b61=null;
_b60[0]=null;
this.topicListTbody=null;
this.parseDates(this.domNode);
},onPageToError:function(_b67,_b68){
this.isPaging=false;
},setRedirectCookie:function(){
document.cookie="CommunitiesReqURL="+location.href+"; expires="+new Date(new Date().getTime()+365*24*60*60*1000).toGMTString()+"; path="+this.contextPath;
},_disableLink:function(_b69){
for(var i=0;_b69&&i<_b69.length;i++){
var a=dojo.query("a",_b69[i]);
if(a.length>0){
_b69[i].innerHTML=a[0].innerHTML;
a[0]=null;
}
}
},_enableLink:function(_b6c,fn){
if(_b6c&&fn){
for(var i=0;i<_b6c.length;i++){
if(dojo.query("a",_b6c[i]).length>0){
return;
}
var a=document.createElement("a");
a.href="javascript:;";
a.onclick=fn;
a.innerHTML=_b6c[i].innerHTML;
_b6c[i].innerHTML="";
_b6c[i].appendChild(a);
}
}
},_getTbody:function(){
if(this.topicListTbody){
return this.topicListTbody;
}
var _b70=dojo.query("table tbody",this.topicListNode);
if(_b70.length>0){
return (this.topicListTbody=_b70[0]);
}else{
return null;
}
},_getNextLink:function(){
if(this.nextLink){
return this.nextLink;
}
var link=dojo.query(".lotusNavNext",this.topicListNode);
if(link.length>0){
return (this.nextLink=link);
}else{
return null;
}
},_getPageRangeNodes:function(){
var _b72=dojo.query(".forumRangeLow",this.topicListNode);
var _b73=dojo.query(".forumRangeHigh",this.topicListNode);
var _b74=dojo.query(".forumRangeTotal",this.topicListNode);
if(_b72.length>0&&_b73.length>0&&_b74.length>0){
return [_b72[0],_b73[0],_b74[0]];
}else{
return null;
}
},_getPreviousLink:function(){
if(this.previousLink){
return this.previousLink;
}
var link=dojo.query(".lotusNavPrevious",this.topicListNode);
if(link.length>0){
return (this.previousLink=link);
}else{
return null;
}
}});
}
if(!dojo._hasResource["lconn.forums.ConfirmDelete"]){
dojo._hasResource["lconn.forums.ConfirmDelete"]=true;
dojo.provide("lconn.forums.ConfirmDelete");
dojo.declare("lconn.forums.ConfirmDelete",[dijit._Widget,dijit._Templated],{templateString:"<div class=\"ConfirmDelete lotusDialogBorder\">\r\n    <form class=\"lotusDialog\" dojoAttachPoint=\"formNode\" onsubmit=\"return false\">\r\n        <h1>\r\n            <a class=\"lotusBtnImg lotusClose\" title=\"${rs_cancel}\" href=\"javascript:;\" dojoattachevent=\"onclick:cancel\">\r\n                <img alt=\"\" src=\"${_blankGif}\"/>\r\n                <span class=\"lotusAltText\">X</span>\r\n            </a>\r\n            <span dojoAttachPoint=\"titleNode\">${rs_deleteReply}</span>\r\n        </h1>\r\n        <div class=\"lotusDialogContent\" style=\"padding: 5px\">\r\n            <div class=\"lotusHidden lotusError\" dojoAttachPoint=\"errorNode\"></div>\r\n            <div dojoAttachPoint=\"deleteReplyNode\">\r\n                <input type=\"hidden\" name=\"dangerousurlnonce\" value=\"\" dojoAttachPoint=\"nonceInput\" />\r\n                <input type=\"hidden\" name=\"uuid\" value=\"${uuid}\" dojoAttachPoint=\"uuidInput\" />\r\n                <div dojoAttachPoint=\"reasonErrorRow\" class=\"lotusFormError lotusHidden\">\r\n                    <img src=\"${_blankGif}\" class=\"lconnSprite lconnSprite-iconError16\" /> \r\n                    <span dojoAttachPoint=\"reasonErrorLabel\"></span>\r\n                </div>\r\n                <div><label for=\"${id}_deleteReason\">${rs_deleteReason}</label></div>\r\n                <div><textarea dojoAttachPoint=\"deleteReasonNode\" class=\"lotusText\" name=\"reason\" id=\"${id}_deleteReason\"></textarea></div>\r\n            </div>\r\n            <div dojoAttachPoint=\"deleteTopicNode\">${rs_deleteTopicConfirm}</div>\r\n        </div>\r\n        <div class=\"lotusDialogFooter\" style=\"padding: 5px\">\r\n            <span dojoAttachPoint=\"footerButtonNode\"><input class=\"lotusFormButton\" value=\"${rs_deleteEntry}\" type=\"submit\"> <a class=\"lotusAction\" href=\"javascript:;\" dojoattachevent=\"onclick:cancel\">${rs_cancel}</a></span>\r\n            <span class=\"lotusHidden\" dojoAttachPoint=\"footerLoadingNode\">${rs_loading}</span>\r\n        </div>\r\n    </form> \r\n</div>\r\n",url:"",uuid:"",nonceThread:null,isTopic:false,reasonLimit:256,postMixInProperties:function(){
var b=dojo.i18n.getLocalization("lconn.core","strings");
this.rs_cancel=b.rs_cancel;
this.rs_deleteEntry=b.rs_deleteEntry;
this.rs_deleteReason=b.rs_deleteReason;
this.rs_deleteReply=b.rs_deleteReply;
this.rs_deleteTopic=b.rs_deleteTopic;
this.rs_deleteTopicConfirm=b.rs_deleteTopicConfirm;
this.rs_loading=b.rs_loading;
this.rs_messageTooLong=b.rs_messageTooLong;
this.rs_timeoutMsg=b.rs_timeoutMsg;
this.rs_tryAgain=b.rs_tryAgain;
this.rs_unknownError=b.rs_unknownError;
},postCreate:function(){
if(typeof this.url!="string"||!this.url){
throw new Error("Exception: "+this.declaredClass+" missing required parameter url.");
return;
}
this.connect(this.formNode,"onsubmit","post");
},loadNode:function(uuid,_b78){
this.uuid=uuid;
this.uuidInput.value=uuid;
if(_b78){
this.deleteTopicNode.style.display="";
this.deleteReplyNode.style.display="none";
this.titleNode.innerHTML=this.rs_deleteTopic;
}else{
this.deleteTopicNode.style.display="none";
this.deleteReplyNode.style.display="";
this.titleNode.innerHTML=this.rs_deleteReply;
}
},nonceSuccess:function(_b79){
this.post();
},post:function(evt){
dojo.addClass(this.errorNode,"lotusHidden");
dojo.addClass(this.reasonErrorRow,"lotusHidden");
if(!this.validate()){
if(evt){
dojo.stopEvent(evt);
}
return false;
}
dojo.addClass(this.footerButtonNode,"lotusHidden");
dojo.removeClass(this.footerLoadingNode,"lotusHidden");
var _b7b=this.nonceThread.getNonce();
if(!_b7b){
this.nonceThread.addListener(dojo.hitch(this,"nonceSuccess"),dojo.hitch(this,"error"));
if(evt){
dojo.stopEvent(evt);
}
return false;
}
this.nonceInput.value=_b7b;
dojo.xhrPost({url:this.url,form:this.formNode,handleAs:"text",timeout:5000,load:dojo.hitch(this,"deleteDone"),error:dojo.hitch(this,"error")});
if(evt){
dojo.stopEvent(evt);
}
return false;
},deleteDone:function(_b7c,_b7d){
return _b7c;
},error:function(_b7e,_b7f){
var _b80=document.createElement("a");
_b80.onclick=dojo.hitch(this,"post");
_b80.href="javascript:;";
_b80.innerHTML=this.rs_tryAgain;
if(_b7e.dojoType&&_b7e.dojoType=="timeout"){
this.errorNode.innerHTML=this.rs_timeoutMsg;
}else{
this.errorNode.innerHTML=this.rs_unknownError;
}
this.errorNode.appendChild(document.createTextNode(" "));
this.errorNode.appendChild(_b80);
dojo.removeClass(this.errorNode,"lotusHidden");
dojo.removeClass(this.footerButtonNode,"lotusHidden");
dojo.addClass(this.footerLoadingNode,"lotusHidden");
},cancel:function(){
},reset:function(){
this.formNode.reset();
this.uuidInput.value="";
dojo.addClass(this.errorNode,"lotusHidden");
dojo.addClass(this.reasonErrorRow,"lotusHidden");
dojo.removeClass(this.footerButtonNode,"lotusHidden");
dojo.addClass(this.footerLoadingNode,"lotusHidden");
},validate:function(){
if(this.deleteReasonNode.value.length>this.reasonLimit){
this.reasonErrorLabel.innerHTML=dojo.string.substitute(this.rs_messageTooLong,[this.reasonLimit]);
dojo.removeClass(this.reasonErrorRow,"lotusHidden");
return false;
}
return true;
}});
}
if(!dojo._hasResource["lconn.forums.TopicThread"]){
dojo._hasResource["lconn.forums.TopicThread"]=true;
dojo.provide("lconn.forums.TopicThread");
dojo.declare("lconn.forums.TopicThread",[dijit._Widget],{replyForm:null,confirmDelete:null,deleteDialog:null,contextPath:"",thumbnailPath:"",displayName:"",topicUuid:"",sessionTimeout:"",subscribeCheckId:"",subscribed:null,subscriptionChanged:false,openReplyForm:"",subscriptionsEnabled:true,postUrl:"/service/forum/forms/post/reply",pinUrl:"/service/forum/forms/post/pin",delReplyUrl:"/service/forum/forms/post/deleteReply",delTopicUrl:"/service/forum/forms/post/deleteTopic",subscribeUrl:"/service/forum/post/subscribe",uuidToDelete:"",deletedTopic:null,subscribeCheckbox:null,nonceThread:null,messageTypes:{ERROR:0,WARNING:1,INFO:2,CONFIRM:3},postMixInProperties:function(){
var b=dojo.i18n.getLocalization("lconn.core","strings");
this.rs_pinError=b.rs_pinError;
this.rs_deleteReply=b.rs_deleteReply;
this.rs_deleteTopic=b.rs_deleteTopic;
this.rs_deleteTopicConfirmation=b.rs_deleteTopicConfirmation;
this.rs_re=b.rs_re;
this.rs_subscribeTopicConfirm=b.rs_subscribeTopicConfirm;
this.rs_timeoutMsg=b.rs_timeoutMsg;
this.rs_tryAgain=b.rs_tryAgain;
this.rs_unknownError=b.rs_unknownError;
this.rs_unsubscribeTopicConfirm=b.rs_unsubscribeTopicConfirm;
},postCreate:function(){
if(!this.topicUuid){
throw new Error("Exception: "+this.declaredClass+" initialized without required parameter topicUuid");
}
this.postUrl=this.contextPath+this.postUrl;
this.pinUrl=this.contextPath+this.pinUrl;
this.delReplyUrl=this.contextPath+this.delReplyUrl;
this.delTopicUrl=this.contextPath+this.delTopicUrl;
this.subscribeUrl=this.contextPath+this.subscribeUrl;
if(this.subscribeCheckId){
this.subscribeCheckbox=dojo.byId(this.subscribeCheckId);
this.subscribeCheckbox.checked=this.subscribed;
this.connect(this.subscribeCheckbox,"onclick","onToggleSubscribe");
}
this.parseDates(this.domNode);
if(this.sessionTimeout){
this.nonceThread=new lconn.forums.NonceThread((this.sessionTimeout*1000)-10000,this.contextPath+"/service/forum/get/nonce","newNonce");
this.nonceThread.start();
}
if(this.subscriptionChanged&&this.subscribed){
this.setMessage(this.messageTypes.CONFIRM,this.rs_subscribeTopicConfirm);
}else{
if(this.subscriptionChanged&&!this.subscribed){
this.setMessage(this.messageTypes.CONFIRM,this.rs_unsubscribeTopicConfirm);
}
}
if(this.openReplyForm){
this.reply(this.openReplyForm);
}
},parseDates:function(node){
dojo.query(".formatDate",node).forEach(function(item){
item.innerHTML=lconn.core.DateUtil.AtomDateToString(item.innerHTML);
dojo.removeClass(item,"lotusHidden");
});
},parseParentNames:function(node){
dojo.query(".parentName",node).forEach(function(item){
var _b86=item.getAttribute("parentUuid");
var _b87=dojo.query("[uuid="+_b86+"] .lotusPostName .lotusPerson",this.domNode);
if(_b87&&_b87.length>0){
item.innerHTML=_b87[0].innerHTML;
dojo.removeClass(item,"lotusHidden");
}
});
},parsePersonCard:function(node){
if(window.SemTagSvc){
dojo.query(".vcardParent",node).forEach(function(item){
SemTagSvc.parseDom(0,item);
});
}
},reply:function(uuid){
if(!uuid||typeof uuid!="string"){
throw new Error("lconn.forums.TopicThread.reply(string uuid) was not initialized with the correct parameter.");
}
if(this.replyForm){
return;
}
var _b8b=this._getPostChildrenNodeByUuid(uuid);
if(_b8b){
var l=_b8b;
var li=document.createElement("li");
l.appendChild(li);
if(!this.replyForm){
var div=document.createElement("div");
li.appendChild(div);
var _b8f=this._getTopicTitle(uuid);
var reg=new RegExp(dojo.string.substitute(this.rs_re,["*"]));
if(!_b8f.match(reg)){
_b8f=dojo.string.substitute(this.rs_re,[_b8f]);
}
this.replyForm=new lconn.forums.PostForm({title:_b8f,inlineForm:true,url:this.postUrl,displayName:this.displayName,thumbnailPath:this.thumbnailPath,topicUuid:this.topicUuid,parentUuid:uuid,nonceThread:this.nonceThread,subscriptionsEnabled:this.subscriptionsEnabled,subscribed:this.subscribed},div);
this.connect(this.replyForm,"onPost","onReply");
this.connect(this.replyForm,"cancel","cancelForm");
}else{
}
this.scrollToMiddle(li);
}
},edit:function(uuid){
if(!uuid||typeof uuid!="string"){
throw new Error("lconn.forums.TopicThread.edit(string uuid) was not initialized with the correct parameter.");
}
if(this.replyForm){
return;
}
var post=this._getPostNodeByUuid(uuid);
if(post){
post.style.display="none";
var div1=document.createElement("div");
var div2=document.createElement("div");
dojo.place(div1,post,"after");
div1.appendChild(div2);
var _b95="",_b96;
_b96=dojo.query(".lotusPostDetails",post);
if(_b96&&_b96.length>0){
_b95=_b96[0].innerHTML;
}else{
throw new Error("lconn.forums.TopicThread.edit() expected the forum post "+uuid+" to contain a DOM node with class forumPostDetails.");
return;
}
this.replyForm=new lconn.forums.PostForm({url:this.postUrl,inlineForm:true,displayName:this.displayName,thumbnailPath:this.thumbnailPath,topicUuid:this.topicUuid,uuid:uuid,content:_b95,title:this._getTopicTitle(uuid),nonceThread:this.nonceThread,subscriptionsEnabled:this.subscriptionsEnabled,subscribed:this.subscribed},div2);
this.connect(this.replyForm,"onPost","onReply");
this.connect(this.replyForm,"cancel","cancelForm");
}
},deletePost:function(uuid,_b98){
if(!uuid||typeof uuid!="string"){
throw new Error("Exception: "+this.declaredClass+".delete(string uuid) was not initialized with the correct parameter.");
}
if(!this.confirmDelete){
var _b99=document.createElement("div");
var _b9a=document.createElement("div");
_b9a.appendChild(_b99);
this.confirmDelete=new lconn.forums.ConfirmDelete({url:this.delReplyUrl,nonceThread:this.nonceThread},_b99);
this.deleteDialog=new dijit.Dialog({},_b9a);
_b99=_b9a=null;
this.connect(this.confirmDelete,"deleteDone","onDelete");
this.connect(this.confirmDelete,"cancel","closeDeleteForm");
}
if(!_b98){
this.deletedTopic=false;
_b98=false;
this.confirmDelete.url=this.delReplyUrl;
this.deleteDialog.titleBar.title=this.rs_deleteReply;
this.deleteDialog.containerNode.title=this.rs_deleteReply;
}else{
this.deletedTopic=true;
this.confirmDelete.url=this.delTopicUrl;
this.deleteDialog.titleBar.title=this.rs_deleteTopic;
this.deleteDialog.containerNode.title=this.rs_deleteTopic;
}
this.uuidToDelete=uuid;
this.confirmDelete.reset();
this.confirmDelete.loadNode(uuid,_b98);
this.deleteDialog.show();
},closeDeleteForm:function(){
this.deleteDialog.hide();
},pin:function(uuid,_b9c){
if(!uuid||typeof uuid!="string"){
throw new Error("Exception: "+this.declaredClass+".pin(string uuid) was not called with the correct parameter.");
return;
}
if(typeof _b9c=="undefined"){
_b9c=true;
}
dojo.xhrPost({url:this.pinUrl,content:{uuid:uuid,setPin:(_b9c?"true":"false")},handleAs:"text",timeout:10000,load:dojo.hitch(this,"onPin"),error:dojo.hitch(this,"pinError")});
},onPin:function(_b9d,_b9e){
var uuid=_b9e.args.content.uuid;
var _ba0=(_b9e.args.content.setPin=="true");
var _ba1=dojo.query("[uuid="+uuid+"] > .lotusPost .lotusPinAction",this.domNode);
var _ba2=dojo.query("[uuid="+uuid+"] > .lotusPost .lotusUnpinAction",this.domNode);
var _ba3=dojo.query(".forumPinIndicator",this.domNode);
if(_ba1.length==0||_ba2.length==0){
throw new Exception("Exception: "+this.declaredClass+" expected to find pin and unpin links but couldn't.");
}
if(_ba3.length==0){
throw new Exception("Exception: "+this.declaredClass+" expected to find a pin icon with class forumPinIndicator.");
}
if(_ba0){
_ba1[0].style.display="none";
_ba2[0].style.display="";
dojo.removeClass(_ba3[0],"lotusHidden");
}else{
_ba1[0].style.display="";
_ba2[0].style.display="none";
dojo.addClass(_ba3[0],"lotusHidden");
}
},pinError:function(){
this.setMessage(this.messageTypes.ERROR,this.rs_pinError);
},cancelForm:function(_ba4){
if(!_ba4||typeof _ba4!="boolean"){
_ba4=false;
}
dojo.addClass(this.replyForm.domNode,"lotusHidden");
var post;
if(this.replyForm.uuid&&(post=this._getPostNodeByUuid(this.replyForm.uuid))){
post.style.display="";
if(!_ba4){
this.focusPost(this.replyForm.uuid);
}
}else{
if(!_ba4){
this.focusPost(this.replyForm.parentUuid);
}
}
var _ba6=this.replyForm.domNode.parentNode;
this.replyForm.destroyRecursive();
this.replyForm=null;
_ba6.parentNode.removeChild(_ba6);
},focusPost:function(_ba7){
if(!_ba7){
return;
}
var post;
if(typeof _ba7=="string"){
post=this._getPostNodeByUuid(_ba7);
}else{
post=_ba7;
}
if(post){
links=dojo.query("a[href]",post);
if(links.length>0){
links[0].focus();
}
}
},onDelete:function(_ba9,_baa){
this.closeDeleteForm();
if(this.deletedTopic){
this.domNode.innerHTML=this.rs_deleteTopicConfirmation;
}else{
this.onFinishPost(_ba9,_baa,null,this.uuidToDelete);
}
},onReply:function(_bab,_bac){
var _bad=this.replyForm.replyUuidInput.value;
var _bae=this.replyForm.parentUuidInput.value;
var _baf=this.replyForm.subscribeNode.checked;
var _bb0=((_baf&&!this.subscribed)||(!_baf&&this.subscribed));
if(_baf){
this.subscribed=true;
if(this.subscribeCheckbox){
this.subscribeCheckbox.checked=true;
}
}else{
this.subscribed=false;
if(this.subscribeCheckbox){
this.subscribeCheckbox.checked=false;
}
}
if(_bb0&&this.subscribed){
this.setMessage(this.messageTypes.CONFIRM,this.rs_subscribeTopicConfirm);
}else{
if(_bb0&&!this.subscribed){
this.setMessage(this.messageTypes.CONFIRM,this.rs_unsubscribeTopicConfirm);
}
}
if(_bb0&&this.subscribed){
this.setMessage(this.messageTypes.CONFIRM,this.rs_subscribeTopicConfirm);
}else{
if(_bb0&&!this.subscribed){
this.setMessage(this.messageTypes.CONFIRM,this.rs_unsubscribeTopicConfirm);
}
}
this.onFinishPost(_bab,_bac,_bae,_bad);
this.cancelForm(true);
},onFinishPost:function(_bb1,_bb2,_bb3,_bb4){
_bb1=dojo.string.trim(_bb1);
if(!_bb4&&!_bb3){
throw new Error("Exception: lconn.forums.TopicThread missing either parentUuid or replyUuid parameters");
return;
}
var li=document.createElement("li");
li.innerHTML=_bb1;
var _bb6=null;
var _bb7=null;
for(var i=0;i<li.childNodes.length;i++){
if(dojo.hasClass(li.childNodes[i],"forumPostSummary")){
_bb7=li.childNodes[i];
}
if(dojo.hasClass(li.childNodes[i],"lotusPost")){
_bb6=li.childNodes[i];
}
if(_bb6&&_bb7){
break;
}
}
if(!_bb6||!_bb7){
throw new Error("Exception: response was malformed");
return;
}
var _bb9=this._getPostSummary();
if(_bb9){
dojo.place(_bb7,_bb9,"after");
_bb9.parentNode.removeChild(_bb9);
_bb9=null;
this.parseDates(_bb7);
}else{
throw new Error("Exception: "+this.declaredClass+" expected to find a post summary.");
return;
}
if(_bb4){
var _bba=this._getPostNodeByUuid(_bb4);
if(_bba){
_bba.innerHTML=_bb6.innerHTML;
this.parseDates(_bba);
this.parseParentNames(_bba);
this.parsePersonCard(_bba);
_bba.style.display="";
this.focusPost(_bba);
}else{
throw new Error("Exception: lconn.forums.TopicThread expected to find a DOM node with uuid="+_bb4);
return;
}
}else{
var _bbb=dojo.query(".lotusPost > a",li);
for(var i=0;i<_bbb.length;i++){
if((_bb4=_bbb[i].getAttribute("name"))){
break;
}
}
if(!_bb4){
throw new Error("Exception: response was malformed");
return;
}
li.setAttribute("uuid",_bb4);
var _bbc=this._getPostChildrenNodeByUuid(_bb3);
if(_bbc){
var _bbd=document.createElement("ul");
dojo.addClass(_bbd,"lotusChild lotusCommentList");
_bbc.appendChild(li);
this.parseDates(li);
this.parseParentNames(li);
this.parsePersonCard(li);
li.appendChild(_bbd);
this.focusPost(li);
}else{
throw new Error("Exception: lconn.forums.TopicThread expected to find a node matching [uuid="+_bb3+"] > .lotusCommentList");
return;
}
}
},scroll:function(uuid){
var q="[uuid="+uuid+"]";
var _bc0=dojo.query(q,this.domNode);
if(_bc0.length>0){
dojox.fx.smoothScroll({duration:400,win:window,node:_bc0[0],easing:dojox.fx.easing.easeOut}).play();
}
},scrollToMiddle:function(node){
if(!node){
return;
}
var _bc2;
if(window.innerHeight){
_bc2=window.innerHeight;
}else{
if(document.documentElement&&document.documentElement.clientHeight&&document.documentElement.clientHeight>0){
_bc2=document.documentElement.clientHeight;
}
}
var _bc3=dojo.coords(node,true);
if(_bc2){
var _bc4=_bc2/2-_bc3.h/2;
_bc3.y-=(_bc4>0?_bc4:0);
}
dojox.fx.smoothScroll({duration:400,win:window,target:_bc3,easing:dojox.fx.easing.easeOut}).play();
},toggleSubscribe:function(){
if(this.subscribeCheckbox){
var _bc5=this.subscribeCheckbox.checked;
this.subscribeCheckbox.checked=!_bc5;
this.onToggleSubscribe();
}
},onToggleSubscribe:function(){
if(!this.subscribeCheckbox){
return;
}
var _bc6=this.subscribeCheckbox;
dojo.xhrPost({content:{subscribe:_bc6.checked,uuid:this.topicUuid},handleAs:"text",url:this.subscribeUrl,timeout:10000,error:dojo.hitch(this,"onSubscribeError"),load:dojo.hitch(this,"onSubscribe")});
},onSubscribe:function(_bc7,_bc8){
if(!this.subscribeCheckbox){
return;
}
var _bc9=this.subscribeCheckbox.checked;
this.subscribed=_bc9;
if(_bc9){
this.setMessage(this.messageTypes.CONFIRM,this.rs_subscribeTopicConfirm);
}else{
this.setMessage(this.messageTypes.CONFIRM,this.rs_unsubscribeTopicConfirm);
}
},onSubscribeError:function(_bca,_bcb){
if(!this.subscribeCheckbox){
return;
}
var _bcc=this.subscribeCheckbox.checked;
this.subscribeCheckbox.checked=!_bcc;
var node=document.createElement("span");
if(_bca.dojoType&&_bca.dojoType=="timeout"){
message=this.rs_timeoutMsg;
}else{
if(_bca.toString){
message=_bca.toString();
}else{
if(!(message=dojo.trim(_bca))){
message=this.rs_unknownError;
}
}
}
var _bce=document.createElement("a");
_bce.onclick=dojo.hitch(this,"toggleSubscribe");
_bce.href="javascript:;";
_bce.innerHTML=this.rs_tryAgain;
node.innerHTML=message;
node.appendChild(document.createTextNode(" "));
node.appendChild(_bce);
this.setMessage(this.messageTypes.ERROR,node);
},setMessage:function(_bcf,_bd0){
var node;
if((node=this._getMessageNode())){
switch(_bcf){
case this.messageTypes.ERROR:
node.className="lotusMessage";
icon="iconError16";
break;
case this.messageTypes.WARNING:
node.className="lotusMessage lotusWarning";
icon="iconWarning16";
break;
case this.messageTypes.INFO:
node.className="lotusMessage lotusInfo";
icon="iconAttention16";
break;
default:
node.className="lotusMessage lotusConfirm";
icon="iconConfirmation16";
}
node.innerHTML="<img src=\""+this._blankGif+"\" class=\"lconnSprite lconnSprite-"+icon+"\" />";
if(_bd0&&typeof _bd0=="string"){
node.appendChild(document.createTextNode(_bd0));
}else{
node.appendChild(_bd0);
}
}
},setRedirectCookie:function(){
document.cookie="CommunitiesReqURL="+location.href+"; expires="+new Date(new Date().getTime()+365*24*60*60*1000).toGMTString()+"; path="+this.contextPath;
},_getMessageNode:function(){
var node=dojo.query(".lotusMessage",this.domNode);
if(node&&node.length>0){
return node[0];
}else{
return null;
}
},_getPostNodeByUuid:function(uuid){
if(!uuid||typeof uuid!="string"){
throw new Error("lconn.forums.TopicThread._getDomNodeByUuid(string uuid) was not initialized with the correct parameter.");
}
var node=dojo.query("[uuid="+uuid+"] > .lotusPost",this.domNode);
if(node&&node.length>0){
return node[0];
}else{
return null;
}
},_getPostChildrenNodeByUuid:function(uuid){
if(!uuid||typeof uuid!="string"){
throw new Error("lconn.forums.TopicThread._getPostChildrenNodeByUuid(string uuid) was not initialized with the correct parameter.");
}
var node=dojo.query("[uuid="+uuid+"] > .lotusCommentList",this.domNode);
if(node&&node.length>0){
return node[0];
}else{
return null;
}
},_getPostSummary:function(){
var node=dojo.query(".forumPostSummary",this.domNode);
if(node&&node.length>0){
return node[0];
}else{
return null;
}
},_getTopicTitle:function(uuid){
if(!uuid||typeof uuid!="string"){
throw new Error(this.declaredClass+"._getTopicTitle(string uuid) was not initialized with the correct parameter");
}
var node=dojo.query("[uuid="+uuid+"] > .lotusPost .forumPostTitle",this.domNode);
if(node&&node.length>0){
return node[0].innerText||node[0].textContent;
}else{
return "";
}
}});
}
if(!dojo._hasResource["lconn.forums.FormAuthUtility"]){
dojo._hasResource["lconn.forums.FormAuthUtility"]=true;
dojo.provide("lconn.forums.FormAuthUtility");
dojo.declare("lconn.forums.FormAuthUtility",null,{_contextRoot:null,REDIRECT_PATH:"/service/html/login",COOKIE_NAME:"CommunitiesReqURL",constructor:function(_bda){
if(!lconn.forums.FormAuthUtility.prototype._init){
lconn.forums.FormAuthUtility.prototype._init=true;
this._contextRoot=_bda;
this._overrideXhrCalls();
}else{
throw new Error("lconn.forums.FormAuthUtility is a singleton. It cannot be instantiated twice");
}
},_overrideXhrCalls:function(){
console.log("overrideXhrCalls");
var auth=com.ibm.ajax.auth;
var url=this._contextRoot+this.REDIRECT_PATH;
var that=this;
var _bde={url:url,authenticationRequired:function(_bdf,_be0,_be1){
var racp=window.location.href.replace(/,/g,"%2C");
document.cookie=that.COOKIE_NAME+"="+racp+"; path="+that._contextRoot;
console.log("Hit authenticationRequired");
if(_be0.args._logIn==undefined){
location.href=this.url;
}else{
_be0.args._logIn(_be0.args._tryAgainLink,this.url);
}
},onSuccess:function(_be3,_be4){
console.log("Successfully loaded");
}};
var _be5=function(_be6,_be7){
var ciaa=com.ibm.ajax.auth;
if(typeof _be7.xhr.status=="unknown"){
return true;
}
var _be9=_be7.xhr.status;
if(_be9==302||(dojo.isIE&&(_be9==0||_be9==12150))){
return true;
}
if(_be7.xhr&&(!_be6||dojo.indexOf(["cancel","timeout"],_be6.dojoType)==-1)){
if(ciaa.checkByContentType&&_be7.args&&_be7.args.isPostRequest&&_be7.xhr&&/^text\/html/.exec(_be7.xhr.getResponseHeader("Content-Type"))&&_be7.xhr.status>=200&&_be7.xhr.status<300){
return true;
}
}
return false;
};
IS_FORUMS_AUTHENTICATION_REQUIRED=_be5;
var _bea=_be5;
if(typeof (CUSTOM_AUTH_JS_CLASS)!=="undefined"){
var _beb=eval("new "+CUSTOM_AUTH_JS_CLASS+"()");
if(typeof (_beb.isAuthenticationRequired)!=="undefined"){
auth.setDefaultAuthenticationTests(true,true,true);
_bea=_beb.isAuthenticationRequired;
if(typeof (_beb.handler)!=="undefined"){
auth.setAuthenticationHandler(dojo.hitch(_beb.handler,_beb.handler.authenticationRequired));
}else{
auth.setAuthenticationHandler(dojo.hitch(_bde,_bde.authenticationRequired));
}
}
}else{
auth.setDefaultAuthenticationTests(true,true,true);
auth.setAuthenticationHandler(dojo.hitch(_bde,_bde.authenticationRequired));
}
originaldojoxhr=dojo.xhr;
dojo.xhr=function(){
var _bec=arguments[1];
if(typeof _bec.handleAs=="undefined"){
_bec.handleAs="text";
}
try{
_bec[1]=auth.prepareSecure(_bec,_bea);
}
catch(e){
console.log("exception in overriden dojo.xhr (form-based auth");
console.log(e);
}
return originaldojoxhr(arguments[0],arguments[1],arguments[2]);
};
}});
lconn.forums.FormAuthUtility.prototype._init=false;
}
if(!dojo._hasResource["lconn.core.TextBox"]){
dojo._hasResource["lconn.core.TextBox"]=true;
dojo.provide("lconn.core.TextBox");
dojo.declare("lconn.core.TextBox",[dijit._Widget,dijit._Templated],{shadowText:"",shadowTextOn:true,name:"",textBoxClass:"",templateString:"<span><input type=\"text\" class=\"${textBoxClass}\" dojoAttachPoint=\"textbox\" /><input type=\"hidden\" value=\"\" dojoAttachPoint=\"hiddenbox\" /></span>",postCreate:function(){
this.textbox.onfocus=dojo.hitch(this,"textBoxFocus");
this.textbox.onblur=dojo.hitch(this,"textBoxBlur");
this.textbox.name=this.id+"_textbox";
if(this.value){
this.textbox.value=this.value;
this.hiddenbox.value=this.value;
this.shadowTextOn=false;
}else{
dojo.addClass(this.textbox,"lotusInactive");
this.textbox.value=this.shadowText;
}
if(this.name){
this.hiddenbox.name=this.name;
}
if(this.title){
this.textbox.title=this.title;
}
},textBoxBlur:function(){
if(this.textbox.value.length==0){
dojo.addClass(this.textbox,"lotusInactive");
this.shadowTextOn=true;
this.textbox.value=this.shadowText;
this.hiddenbox.value="";
}else{
this.hiddenbox.value=this.textbox.value;
this.shadowTextOn=false;
}
},textBoxFocus:function(){
if(this.shadowTextOn){
this.shadowTextOn=false;
this.textbox.value="";
this.hiddenbox.value="";
dojo.removeClass(this.textbox,"lotusInactive");
this.textbox.focus();
}
},setHiddenValue:function(){
if(this.shadowTextOn){
this.hiddenbox.value="";
}else{
this.hiddenbox.value=this.textbox.value;
}
},focus:function(){
this.textbox.focus();
},getValue:function(){
return this.hiddenbox.value;
}});
}
if(!dojo._hasResource["lconn.core.SearchBar"]){
dojo._hasResource["lconn.core.SearchBar"]=true;
dojo.provide("lconn.core.SearchBar");
dojo.declare("lconn.core.SearchBar",[dijit._Widget,dijit._Templated],{templateString:["<div class=\"lotusSearch\"><form dojoAttachPoint=\"formNode\" method=\"POST\" dojoAttachEvent=\"onsubmit:formSubmitted\">","<input name=\"scope\" value=\"\" dojoAttachPoint=\"scopeInputNode\" type=\"hidden\" />","<input name=\"component\" value=\"\" dojoAttachPoint=\"featureInputNode\" type=\"hidden\" />","<table class=\"lotusLayout\" role=\"presentation\" summary=\"\"><tbody><tr>","<td><span id=\"${id}searchLbl\" class=\"lotusHidden\">${lblSelectScope}</span>","<a href=\"javascript:;\" title=\"${lblSelectScope}\" aria-labelledby=\"${id}searchLbl\" aria-describedby=\"${id}searchOpt\" wairole=\"menu\" role=\"menu\" class=\"lotusScope\" dojoAttachPoint=\"scopeNode\" dojoAttachEvent=\"onclick:openMenu\">","<img class=\"lotusIcon\" alt=\"\" src=\"${_blankGif}\" dojoAttachPoint=\"currScopeIconNode\" role=\"presentation\"/>","<span id=\"${id}searchOpt\" dojoAttachPoint=\"currScopeLabelNode\"> </span>","<span class=\"lotusAltText\" role=\"presentation\">&#9660;</span>","</a></td>","<td>","<label class=\"lotusHidden\" for=\"${id}searchInput\">${lblSearch}</label>","<input id=\"${id}searchInput\" dojoAttachPoint=\"textNode\" class=\"lotusText lotusInactive\" type=\"text\" name=\"query\" title=\"${lblSearch}\"/>","</td>","<td>","<span class=\"lotusBtnImg\">","<input dojoAttachPoint=\"onclick:submitForm\" class=\"lotusSearchButton\" type=\"image\" src=\"${_blankGif}\" alt=\"${lblSearch}\"/>","<a href=\"javascript:;\" alt=\"${lblSearch}\" dojoAttachEvent=\"onclick:submitForm\" class=\"lotusAltText\">${lblSearch}</a>","</span>","</td>","</tr></tbody></table>","</form></div>"].join(""),localOptions:[],globalOptions:[],localAction:"",searchContextPath:"",lblSearch:"",lblSelectScope:"",lblAllConnections:"",lblAdvanced:"",menuItems:[],featureIcons:{allareas:"lconnSprite lconnSprite-iconConnections16",activities:"lconnSprite lconnSprite-iconActivities16",blogs:"lconnSprite lconnSprite-iconBlogs16",communities:"lconnSprite lconnSprite-iconCommunities16",dogear:"lconnSprite lconnSprite-iconDogear16",files:"lconnSprite lconnSprite-iconFiles16",profiles:"lconnSprite lconnSprite-iconProfiles16",wikis:"lconnSprite lconnSprite-iconWikis16"},selectedOption:null,textBox:null,globalAction:"",advancedSearchUrl:"",SEARCH_ADVANCED:"searchAdvancedIdentifier",SEARCH_POST_PATH:"/web/search",SEARCH_ADVANCED_PATH:"/web/jsp/advancedSearch.jsp",postCreate:function(){
if(this.searchContextPath){
this.globalAction=this.searchContextPath+this.SEARCH_POST_PATH;
this.advancedSearchUrl=this.searchContextPath+this.SEARCH_ADVANCED_PATH;
}
this.showDefaultOption();
this.textBox=new lconn.core.TextBox({shadowText:this.lblSearch,textBoxClass:"lotusText",name:"query",title:this.lblSearch},this.textNode);
if(this.globalOptions&&this.globalOptions.length>0){
this.globalOptions.splice(0,0,{label:this.lblAllConnections,feature:"allareas",iconClass:"lconnSprite lconnSprite-iconConnections16"});
}
},changeLocalOptions:function(_bed){
this.localOptions=_bed;
if(this.scopeMenu){
this.scopeMenu.destroyRecursive();
this.scopeMenu=null;
this.menuItems=[];
}
this.showDefaultOption();
},showDefaultOption:function(){
for(var i in this.localOptions){
if(this.localOptions[i].defaultOption){
this.selectOption(this.localOptions[i],false);
return;
}
}
if(this.globalOptions&&this.globalOptions.length>0){
this.selectOption(this.globalOptions[0],false);
}
},getScopeMenu:function(){
if(!this.scopeMenu){
this.scopeMenu=new dijit.Menu({onItemClick:dojo.hitch(this,"selectOption")});
this.connect(this.scopeMenu,"_onBlur","closeMenu");
this.menuItems=[];
var _bef=this.localOptions;
for(var i in _bef){
	if (!(_bef[i] instanceof Function)) {
_bef[i].parentMenu=this.scopeMenu;
this.menuItems.push(new dijit.MenuItem(_bef[i]));
}
}
if(this.globalOptions.length>0){
this.menuItems.push(new dijit.MenuSeparator({parentMenu:this.scopeMenu}));
}
_bef=this.globalOptions;
for(var i in _bef){
if(_bef[i].feature&&this.featureIcons[_bef[i].feature]){
_bef[i].parentMenu=this.scopeMenu;
_bef[i].iconClass=this.featureIcons[_bef[i].feature];
this.menuItems.push(new dijit.MenuItem(_bef[i]));
}
}
if(this.globalOptions.length>0){
this.menuItems.push(new dijit.MenuSeparator({parentMenu:this.scopeMenu}));
this.menuItems.push(new dijit.MenuItem({label:this.lblAdvanced,feature:this.SEARCH_ADVANCED}));
}
for(var i in this.menuItems){
this.scopeMenu.addChild(this.menuItems[i]);
}
}
return this.scopeMenu;
},openMenu:function(evt){
var menu=this.getScopeMenu();
dijit.popup.open({popup:menu,around:this.scopeNode,orient:(dojo._isBodyLtr()?{"BL":"TL","BR":"TR","TL":"BL","TR":"BR"}:{"BR":"TR","BL":"TL","TR":"BR","TL":"BL"}),onExecute:function(){
},onCancel:dojo.hitch(this,function(){
dijit.popup.close(menu);
dijit.focus(this.scopeNode);
}),onClose:function(){
}});
menu.focus();
dojo.stopEvent(evt);
},closeMenu:function(){
if(this.scopeMenu){
dijit.popup.close(this.scopeMenu);
}
},onSelectOption:function(item,evt){
this.selectOption(item,true);
},selectOption:function(item,_bf6){
this.closeMenu();
this.selectedOption=item;
if(item.feature&&item.feature==this.SEARCH_ADVANCED){
location.href=this.advancedSearchUrl;
return;
}
this.currScopeLabelNode.innerHTML=item.label;
this.currScopeIconNode.className="lotusIcon";
if(item.iconClass){
dojo.addClass(this.currScopeIconNode,item.iconClass);
}
if(item.scope){
this.scopeInputNode.value=item.scope;
this.featureInputNode.value="";
}else{
if(item.feature){
if(item.feature=="allareas"){
this.featureInputNode.value="";
}else{
this.featureInputNode.value=item.feature;
}
this.scopeInputNode.value="";
}
}
if(item.action){
this.formNode.action=item.action;
}else{
if(item.feature){
this.formNode.action=this.globalAction;
}else{
this.formNode.action=this.localAction;
}
}
if(_bf6){
this.textBox.focus();
}
},submitForm:function(evt){
this.textBox.setHiddenValue();
if(this.onSubmit()){
this.formNode.submit();
}
if(evt){
dojo.stopEvent(evt);
}
return false;
},getValue:function(){
return this.textBox.getValue();
},formSubmitted:function(evt){
this.submitForm();
dojo.stopEvent(evt);
},onSubmit:function(){
}});
}
if(!dojo._hasResource["lconn.search.utils.DateFormater"]){
dojo._hasResource["lconn.search.utils.DateFormater"]=true;
dojo.provide("lconn.search.utils.DateFormater");
djConfig=dojo.config;
dojo.declare("lconn.search.utils.DateFormater",null,{formatDateTime:function(date){
var d=date instanceof Date?date:dojo.date.stamp.fromISOString(date);
var _bfb=null;
try{
_bfb=lconn.core.DateUtil.toString(d);
}
catch(ignoreException){
}
return _bfb;
}});
}
if(!dojo._hasResource["lconn.search.searchAPI"]){
dojo._hasResource["lconn.search.searchAPI"]=true;
dojo.provide("lconn.search.searchAPI");
dojo.declare("lconn.search.searchAPI",null,{queryString:null,contextRoot:null,apiUrl:"/atom/search/results",tagApiUrl:"/atom/search/facets/tags",page:1,ps:10,sortorder:null,sortkey:null,componentFilter:"",personApiUrl:"/atom/search/facets/people",dateApiUrl:"/atom/search/facets/date",privateApiUrl:"/atom/mysearch/results",privateTagApiUrl:"/atom/mysearch/facets/tags",privatePersonApiUrl:"/atom/mysearch/facets/people",privateDateApiUrl:"/atom/mysearch/facets/date",setup:function(cr,qs){
this.queryString=qs;
this.queryString=this.queryString.replace("?tag=&","?","g");
this.queryString=this.queryString.replace("&tag=&","&","g");
this.queryString=this.queryString.replace("&&","&","g");
this.queryString=this.queryString.replace("&=&","&","g");
this.queryString=this.queryString.replace("?=&","?","g");
if((this.queryString.indexOf("?sortkey")==-1)&&(this.queryString.indexOf("&sortkey")==-1)){
this.sortkey=null;
}else{
var _bfe=new RegExp("[\\?&]sortkey=([^&#]*)");
var _bff=_bfe.exec(this.queryString);
if(_bff!=null){
if(_bff.length>1){
this.sortkey=_bff[1];
this.queryString=this.queryString.replace("?sortkey="+_bff[1]+"&","?");
this.queryString=this.queryString.replace("&sortkey="+_bff[1]+"&","&");
}
}
}
if((this.queryString.indexOf("?sortorder")==-1)&&(this.queryString.indexOf("&sortorder")==-1)){
this.sortorder=null;
}else{
var _bfe=new RegExp("[\\?&]sortorder=([^&#]*)");
var _bff=_bfe.exec(this.queryString);
if(_bff!=null){
if(_bff.length>1){
this.sortorder=_bff[1];
this.queryString=this.queryString.replace("?sortorder="+_bff[1]+"&","?");
this.queryString=this.queryString.replace("&sortorder="+_bff[1]+"&","&");
}
}
}
if((this.queryString.indexOf("?component")==-1)&&(this.queryString.indexOf("&component")==-1)){
this.componentFilter="";
}else{
var _bfe=new RegExp("[\\?&]component=([^&#]*)");
var _bff=_bfe.exec(this.queryString);
if(_bff.length>1){
this.componentFilter=_bff[1];
}
}
this.contextRoot=cr;
},getDateFacetAPI:function(_c00){
if(_c00){
return this.contextRoot+this.dateApiUrl+this.queryString;
}else{
return this.contextRoot+this.privateDateApiUrl+this.queryString;
}
},getPersonFacetAPI:function(_c01){
if(_c01){
return this.contextRoot+this.personApiUrl+this.queryString;
}else{
return this.contextRoot+this.privatePersonApiUrl+this.queryString;
}
},getTagFacetAPI:function(_c02){
if(_c02){
return this.contextRoot+this.tagApiUrl+this.queryString+"&tagcloud=true";
}else{
return this.contextRoot+this.privateTagApiUrl+this.queryString+"&tagcloud=true";
}
},getSearchResultsAPI:function(_c03){
if(_c03){
return this.contextRoot+this.apiUrl+this.queryString+"&page="+this.page+"&ps="+this.ps;
}else{
return this.contextRoot+this.privateApiUrl+this.queryString+"&page="+this.page+"&ps="+this.ps;
}
},getCombinedAPI:function(_c04){
if(_c04){
if(this.sortkey!=null){
return this.contextRoot+"/atom/search"+this.queryString+"&page="+this.page+"&ps="+this.ps+"&sortkey="+this.sortkey+"&sortorder="+this.sortorder;
}else{
return this.contextRoot+"/atom/search"+this.queryString+"&page="+this.page+"&ps="+this.ps;
}
}else{
if(this.sortkey!=null){
return this.contextRoot+"/atom/mysearch"+this.queryString+"&page="+this.page+"&ps="+this.ps+"&sortkey="+this.sortkey+"&sortorder="+this.sortorder;
}else{
return this.contextRoot+"/atom/mysearch"+this.queryString+"&page="+this.page+"&ps="+this.ps;
}
}
},getParameterString:function(){
return this.queryString;
},getTagParameters:function(){
var _c05=new RegExp("[\\?&]tag=([^&#]*)","g");
var tags=new Array();
var _c07;
tags.push(this.queryString);
do{
_c07=_c05.exec(this.queryString);
if(_c07!=null){
tags.push(decodeURIComponent(_c07[1]));
}
}while(_c07!=null);
return tags;
},getDateParameters:function(){
var _c08=new RegExp("[\\?&]Date=([^&#]*)");
return _c08.exec(this.queryString);
},getPersonParameters:function(){
var _c09=new RegExp("[\\?&]person=([^&#]*)","g");
var _c0a=new Array();
var _c0b;
_c0a.push(this.queryString);
do{
_c0b=_c09.exec(this.queryString);
if(_c0b!=null){
_c0a.push(decodeURIComponent(_c0b[1]));
}
}while(_c0b!=null);
return _c0a;
},addTag:function(tag){
var _c0d=false;
var tags=this.getTagParameters();
if(tags!=null&&tags.length>1){
for(var i=1;i<tags.length;i++){
if(tags[i]==tag){
_c0d=true;
}
}
}
if(!_c0d){
if(this.queryString.indexOf("?")==-1){
this.queryString=this.queryString+"?tag="+encodeURIComponent(tag);
}else{
this.queryString=this.queryString+"&tag="+encodeURIComponent(tag);
}
this.page=1;
return true;
}else{
return false;
}
},removeTag:function(tag){
tag=tag.replace("\\\"","\"","g");
tag=tag.replace("\\'","'","g");
tag=encodeURIComponent(tag);
if(this.queryString.indexOf("?tag="+tag+"&")>=0){
this.queryString=this.queryString.replace("?tag="+tag,"?");
}else{
if(this.queryString.indexOf("&tag="+tag+"&")>=0){
this.queryString=this.queryString.replace("&tag="+tag,"&");
}else{
if(this.queryString.indexOf("?tag="+tag)>=0){
this.queryString=this.queryString.replace("?tag="+tag,"");
}else{
if(this.queryString.indexOf("&tag="+tag)>=0){
this.queryString=this.queryString.replace("&tag="+tag,"");
}
}
}
}
this.page=1;
},addDate:function(date){
var _c12=this.getDateParameters();
if(_c12!=null&&_c12.length>1){
for(var i=1;i<_c12.length;i++){
this.removeDate(_c12[i]);
}
}
if(this.queryString.indexOf("?")==-1){
this.queryString=this.queryString+"?Date="+date;
}else{
this.queryString=this.queryString+"&Date="+date;
}
this.page=1;
},removeDate:function(date){
if(this.queryString.indexOf("?Date="+date+"&")>=0){
this.queryString=this.queryString.replace("?Date="+date,"?");
}else{
if(this.queryString.indexOf("&Date="+date+"&")>=0){
this.queryString=this.queryString.replace("&Date="+date,"&");
}else{
if(this.queryString.indexOf("?Date="+date)>=0){
this.queryString=this.queryString.replace("?Date="+date,"");
}else{
if(this.queryString.indexOf("&Date="+date)>=0){
this.queryString=this.queryString.replace("&Date="+date,"");
}
}
}
}
this.page=1;
},addPerson:function(_c15){
var _c16=false;
_c15=encodeURIComponent(_c15);
var _c17=this.getPersonParameters();
if(_c17!=null&&_c17.length>1){
for(var i=1;i<_c17.length;i++){
if(_c17[i]==_c15){
_c16=true;
}
}
}
if(!_c16){
if(this.queryString.indexOf("?")==-1){
this.queryString=this.queryString+"?person="+_c15;
}else{
this.queryString=this.queryString+"&person="+_c15;
}
this.page=1;
return true;
}else{
return false;
}
},removePerson:function(_c19){
_c19=encodeURIComponent(_c19);
if(this.queryString.indexOf("?person="+_c19+"&")>=0){
this.queryString=this.queryString.replace("?person="+_c19,"?");
}else{
if(this.queryString.indexOf("&person="+_c19+"&")>=0){
this.queryString=this.queryString.replace("&person="+_c19,"&");
}else{
if(this.queryString.indexOf("?person="+_c19)>=0){
this.queryString=this.queryString.replace("?person="+_c19,"");
}else{
if(this.queryString.indexOf("&person="+_c19)>=0){
this.queryString=this.queryString.replace("&person="+_c19,"");
}
}
}
}
this.page=1;
},changeComponent:function(_c1a){
if((this.queryString.indexOf("&component")==-1)&&(this.queryString.indexOf("?component")==-1)){
}else{
var _c1b=new RegExp("[\\?&]component=([^&#]*)");
var _c1c=_c1b.exec(this.queryString);
if(_c1c!=null){
if(_c1c.length>1){
for(var i=1;i<_c1c.length;i++){
this.queryString=this.queryString.replace("&component="+_c1c[i]+"&","&");
this.queryString=this.queryString.replace("?component="+_c1c[i]+"&","?");
this.queryString=this.queryString.replace("&component="+_c1c[i],"");
this.queryString=this.queryString.replace("?component="+_c1c[i],"");
}
}
}
}
if(_c1a!="none"){
if(this.queryString.indexOf("?")==-1){
this.queryString=this.queryString+"?component="+_c1a;
}else{
this.queryString=this.queryString+"&component="+_c1a;
}
}
this.page=1;
},removeComponent:function(_c1e){
if(this.queryString.indexOf("?component="+_c1e)>0){
this.queryString=this.queryString.replace("?component="+_c1e,"");
}else{
if(this.queryString.indexOf("&component="+_c1e)>0){
this.queryString=this.queryString.replace("&component="+_c1e,"");
}
}
this.page=1;
},changePage:function(page){
this.page=page;
},changePs:function(_c20){
this.ps=_c20;
this.page=1;
},changeQuery:function(_c21){
if((this.queryString.indexOf("?query")==-1)&&(this.queryString.indexOf("&query")==-1)){
}else{
var _c22=new RegExp("[\\?&]query=([^&#]*)");
var _c23=_c22.exec(this.queryString);
if(_c23!=null){
if(_c23.length>1){
this.queryString=this.queryString.replace("&query="+_c23[1],"&query="+encodeURIComponent(encQueryRes));
this.queryString=this.queryString.replace("?query="+_c23[1],"?query="+encodeURIComponent(encQueryRes));
}
}
}
},clearQueryString:function(){
this.queryString="";
},sortResults:function(key,_c25){
this.sortkey=key;
this.sortorder=_c25;
},getComponentFilter:function(){
return this.componentFilter;
}});
}
if(!dojo._hasResource["dojox.collections._base"]){
dojo._hasResource["dojox.collections._base"]=true;
dojo.provide("dojox.collections._base");
dojox.collections.DictionaryEntry=function(k,v){
this.key=k;
this.value=v;
this.valueOf=function(){
return this.value;
};
this.toString=function(){
return String(this.value);
};
};
dojox.collections.Iterator=function(arr){
var a=arr;
var _c2a=0;
this.element=a[_c2a]||null;
this.atEnd=function(){
return (_c2a>=a.length);
};
this.get=function(){
if(this.atEnd()){
return null;
}
this.element=a[_c2a++];
return this.element;
};
this.map=function(fn,_c2c){
return dojo.map(a,fn,_c2c);
};
this.reset=function(){
_c2a=0;
this.element=a[_c2a];
};
};
dojox.collections.DictionaryIterator=function(obj){
var a=[];
var _c2f={};
for(var p in obj){
if(!_c2f[p]){
a.push(obj[p]);
}
}
var _c31=0;
this.element=a[_c31]||null;
this.atEnd=function(){
return (_c31>=a.length);
};
this.get=function(){
if(this.atEnd()){
return null;
}
this.element=a[_c31++];
return this.element;
};
this.map=function(fn,_c33){
return dojo.map(a,fn,_c33);
};
this.reset=function(){
_c31=0;
this.element=a[_c31];
};
};
}
if(!dojo._hasResource["dojox.collections.Dictionary"]){
dojo._hasResource["dojox.collections.Dictionary"]=true;
dojo.provide("dojox.collections.Dictionary");
dojox.collections.Dictionary=function(_c34){
var _c35={};
this.count=0;
var _c36={};
this.add=function(k,v){
var b=(k in _c35);
_c35[k]=new dojox.collections.DictionaryEntry(k,v);
if(!b){
this.count++;
}
};
this.clear=function(){
_c35={};
this.count=0;
};
this.clone=function(){
return new dojox.collections.Dictionary(this);
};
this.contains=this.containsKey=function(k){
if(_c36[k]){
return false;
}
return (_c35[k]!=null);
};
this.containsValue=function(v){
var e=this.getIterator();
while(e.get()){
if(e.element.value==v){
return true;
}
}
return false;
};
this.entry=function(k){
return _c35[k];
};
this.forEach=function(fn,_c3f){
var a=[];
for(var p in _c35){
if(!_c36[p]){
a.push(_c35[p]);
}
}
dojo.forEach(a,fn,_c3f);
};
this.getKeyList=function(){
return (this.getIterator()).map(function(_c42){
return _c42.key;
});
};
this.getValueList=function(){
return (this.getIterator()).map(function(_c43){
return _c43.value;
});
};
this.item=function(k){
if(k in _c35){
return _c35[k].valueOf();
}
return undefined;
};
this.getIterator=function(){
return new dojox.collections.DictionaryIterator(_c35);
};
this.remove=function(k){
if(k in _c35&&!_c36[k]){
delete _c35[k];
this.count--;
return true;
}
return false;
};
if(_c34){
var e=_c34.getIterator();
while(e.get()){
this.add(e.element.key,e.element.value);
}
}
};
}
if(!dojo._hasResource["lconn.search.utils.xslt"]){
dojo._hasResource["lconn.search.utils.xslt"]=true;
dojo.provide("lconn.search.utils.xslt");
lconn.search.utils.xslt.ie={};
lconn.search.utils.xslt.gecko={};
lconn.search.utils.xslt.cache=new dojox.collections.Dictionary();
lconn.search.utils.xslt.getXmlHttpRequest=function(){
var oXml=null;
if(typeof ActiveXObject!="undefined"){
oXml=new ActiveXObject("Microsoft.XMLHTTP");
}else{
oXml=new XMLHttpRequest();
}
return oXml;
};
lconn.search.utils.xslt.loadXml=function(sUrl){
if(typeof ActiveXObject!="undefined"){
return lconn.search.utils.xslt.ie.loadXml(sUrl);
}else{
return lconn.search.utils.xslt.gecko.loadXml(sUrl);
}
};
lconn.search.utils.xslt.loadXmlString=function(sXml){
if(typeof ActiveXObject!="undefined"){
return lconn.search.utils.xslt.ie.loadXmlString(sXml);
}else{
return lconn.search.utils.xslt.gecko.loadXmlString(sXml);
}
};
lconn.search.utils.xslt.loadXsl=function(sUrl){
var _c4b=lconn.search.utils.xslt.cache;
var _c4c=null;
if(_c4b.contains(sUrl)){
_c4c=_c4b.item(sUrl);
}else{
if(typeof ActiveXObject!="undefined"){
_c4c=lconn.search.utils.xslt.ie.loadXsl(sUrl);
}else{
_c4c=lconn.search.utils.xslt.gecko.loadXsl(sUrl);
}
_c4b.add(sUrl,_c4c);
}
return _c4c;
};
lconn.search.utils.xslt.transform=function(xml,xsl,_c4f,_c50,_c51){
if(typeof ActiveXObject!="undefined"){
return lconn.search.utils.xslt.ie.transform(xml,xsl,_c4f,_c50,_c51);
}else{
return lconn.search.utils.xslt.gecko.transform(xml,xsl,_c4f,_c50,_c51);
}
};
lconn.search.utils.xslt.transformDocument=function(_c52,_c53,_c54){
var _c55=lconn.search.utils.xslt.loadXsl(_c53);
if(_c55.documentElement==null){
return null;
}
var _c56=lconn.search.utils.xslt.transform(_c52,_c55,null,_c54,true);
return _c56;
};
lconn.search.utils.xslt.transformAndUpdate=function(_c57,xml,xsl,_c5a,_c5b){
if(typeof ActiveXObject!="undefined"){
var _c5c=lconn.search.utils.xslt.ie.transform(xml,xsl,_c5a,_c5b,true);
_c57.innerHTML+=_c5c;
}else{
_c5c=lconn.search.utils.xslt.gecko.transform(xml,xsl,_c5a,_c5b,false);
var _c5d=_c5c.documentElement;
if(_c5c.documentElement.tagName=="transformiix:result"){
_c5d=_c5c.documentElement.childNodes;
dojomum.dom.copyChildren(_c5c.documentElement,_c57,true);
}else{
_c57.appendChild(_c5d);
}
}
};
lconn.search.utils.xslt.ie.loadXml=function(sUrl){
var _c5f=new ActiveXObject("MSXML2.DOMDocument");
_c5f.async=0;
_c5f.resolveExternals=0;
if(!_c5f.load(sUrl)){
throw new Error("Error loading xml file "+sUrl);
}
return _c5f;
};
lconn.search.utils.xslt.ie.loadXmlString=function(sXml){
var _c61=new ActiveXObject("MSXML2.DOMDocument");
_c61.async=0;
_c61.resolveExternals=0;
if(!_c61.loadXML(sXml)){
throw new Error("Error loading xml string "+sXml);
}
return _c61;
};
lconn.search.utils.xslt.ie.loadXsl=function(sUrl){
var _c63=new ActiveXObject("MSXML2.FreeThreadedDOMDocument");
_c63.async=0;
_c63.resolveExternals=0;
dojo.xhrGet({sync:true,url:sUrl,handleAs:"text",load:function(_c64,_c65){
_c63.loadXML(_c64);
},error:function(_c66,_c67){
throw new Error("Error loading xsl file "+_c67.url);
}});
return _c63;
};
lconn.search.utils.xslt.ie.transform=function(_c68,xsl,_c6a,_c6b,_c6c){
var oXml=_c68;
var oXsl=xsl;
try{
if(!oXsl.documentElement){
oXsl=this.loadXsl(xsl);
}
}
catch(e){
var sMsg=e.message;
throw new Error(""+sMsg,""+sMsg);
}
var _c70=new ActiveXObject("Msxml2.XSLTemplate");
_c70.stylesheet=oXsl;
var _c71=_c70.createProcessor();
_c71.input=oXml;
if(_c6b){
for(var p=0;p<_c6b.length;p++){
_c71.addParameter(_c6b[p][0],_c6b[p][1]);
}
}
if(_c6a){
_c71.addParameter("mode",_c6a);
}
if(_c6c){
if(!_c71.transform()){
throw new Error("Error transforming xml doc "+oXml);
}
return _c71.output;
}else{
var _c73=new ActiveXObject("MSXML2.DOMDocument");
_c73.async=0;
_c73.validateOnParse=1;
oXml.transformNodeToObject(oXsl,_c73);
return _c73;
}
};
lconn.search.utils.xslt.gecko.loadXml=function(sUrl){
};
lconn.search.utils.xslt.gecko.loadXmlString=function(sXml){
var _c76=new DOMParser();
try{
oXmlDoc=_c76.parseFromString(sXml,"text/xml");
}
catch(exc){
throw new Error("Error loading xml string "+sXml);
}
return oXmlDoc;
};
lconn.search.utils.xslt.gecko.loadXsl=function(sUrl){
var _c78=document.implementation.createDocument("","",null);
_c78.async=false;
if(dojo.isSafari){
_c78.load=function(url){
var req=dojo.xhrGet({sync:true,url:url,handleAs:"xml",load:function(data,_c7c){
_c78=data;
}});
};
}
_c78.load(sUrl);
return _c78;
};
lconn.search.utils.xslt.gecko.transform=function(_c7d,xsl,_c7f,_c80,_c81){
try{
var _c82=xsl;
if(!_c82.documentElement){
console.log("xslDoc is not a Document, loading it...");
_c82=this.loadXsl(xsl);
}
var proc=new XSLTProcessor();
proc.importStylesheet(_c82);
if(_c80){
for(var p=0;p<_c80.length;p++){
proc.setParameter(null,_c80[p][0],_c80[p][1]);
}
}
if(_c7f){
proc.setParameter(null,"mode",_c7f);
}
var _c85=proc.transformToFragment(_c7d,document);
if(!_c81){
return _c85;
}
var _c86=new XMLSerializer();
resultStr=_c86.serializeToString(_c85);
}
catch(exc){
throw new Error("Error transforming xml doc "+exc);
}
return resultStr;
};
lconn.search.utils.xslt.setLayerContentByXml=function(_c87,xml,xsl,_c8a,_c8b){
var _c8c=lconn.search.utils.xslt.transform(xml,xsl,null,_c8a,_c8b);
if(_c87.innerHTML){
_c87.innerHTML=_c8c;
}else{
var obj=document.getElementById(_c87);
obj.innerHTML=_c8c;
}
};
}
if(!dojo._hasResource["lconn.search.tagCloud"]){
dojo._hasResource["lconn.search.tagCloud"]=true;
dojo.provide("lconn.search.tagCloud");
dojo.declare("lconn.search.tagCloud",null,{containerReference:null,xslTemplate:dojo.moduleUrl("lconn.search","xslt/search.xsl").toString(),_dataStore:null,setup:function(_c8e,_c8f,_c90,ds){
this.containerReference=_c8e;
if(_c90){
this.xslTemplate=_c90;
}
this._dataStore=ds;
},update:function(url){
if(this.containerReference!=null){
if(url){
var _c93={url:url,handleAs:"text",timeout:this.timeout,load:dojo.hitch(this,"transformTags")};
var req=dojo.xhrGet(_c93);
}else{
var _c95=this._dataStore.tagTransform(null,null);
this.containerReference.innerHTML=_c95;
this.finished();
}
}
},transformTags:function(data,evt){
var _c98=null;
if(this._dataStore!=null){
_c98=this._dataStore.tagTransform(data,this.xslTemplate);
}else{
var _c99=dojox.data.dom.createDocument(data);
_c98=lconn.search.utils.xslt.transformDocument(_c99,this.xslTemplate,[["action","tags"]]);
}
this.containerReference.innerHTML=_c98;
this.finished();
},finished:function(){
}});
}
if(!dojo._hasResource["lconn.search.personCloud"]){
dojo._hasResource["lconn.search.personCloud"]=true;
dojo.provide("lconn.search.personCloud");
dojo.declare("lconn.search.personCloud",null,{containerReference:null,xslTemplate:dojo.moduleUrl("lconn.search","xslt/search.xsl").toString(),_dataStore:null,setup:function(_c9a,_c9b,_c9c,ds){
this.containerReference=_c9a;
if(_c9c){
this.xslTemplate=_c9c;
}
this._dataStore=ds;
},update:function(url){
if(this.containerReference!=null){
if(url){
var _c9f={url:url,handleAs:"text",timeout:this.timeout,load:dojo.hitch(this,"transformPeople")};
var req=dojo.xhrGet(_c9f);
}else{
var _ca1=this._dataStore.peopleTransform(null,null);
this.containerReference.innerHTML=_ca1;
try{
SemTagSvc.parseDom(null,this.containerReference);
}
catch(e){
}
this.finished();
}
}
},transformPeople:function(data,evt){
var _ca4=null;
if(this._dataStore!=null){
_ca4=this._dataStore.peopleTransform(data,this.xslTemplate);
}else{
var _ca5=dojox.data.dom.createDocument(data);
_ca4=lconn.search.utils.xslt.transformDocument(_ca5,this.xslTemplate,[["action","people"]]);
}
this.containerReference.innerHTML=_ca4;
this.finished();
},finished:function(){
}});
}
if(!dojo._hasResource["lconn.search.dateCloud"]){
dojo._hasResource["lconn.search.dateCloud"]=true;
dojo.provide("lconn.search.dateCloud");
dojo.declare("lconn.search.dateCloud",null,{containerReference:null,xslTemplate:dojo.moduleUrl("lconn.search","xslt/search.xsl").toString(),_dataStore:null,setup:function(_ca6,_ca7,_ca8,ds){
this.containerReference=_ca6;
if(_ca8){
this.xslTemplate=_ca8;
}
this._dataStore=ds;
},update:function(url){
if(this.containerReference!=null){
if(url){
var _cab={url:url,handleAs:"text",timeout:this.timeout,load:dojo.hitch(this,"transformDates")};
var req=dojo.xhrGet(_cab);
}else{
var _cad=this._dataStore.dateTransform(null,null);
this.containerReference.innerHTML=_cad;
this.finished();
}
}
},transformDates:function(data,evt){
var _cb0=null;
if(this._dataStore!=null){
_cb0=this._dataStore.dateTransform(data,this.xslTemplate);
}else{
var _cb1=dojox.data.dom.createDocument(data);
_cb0=lconn.search.utils.xslt.transformDocument(_cb1,this.xslTemplate,null);
}
this.containerReference.innerHTML=_cb0;
this.finished();
},finished:function(){
}});
}
if(!dojo._hasResource["lconn.search.searchData"]){
dojo._hasResource["lconn.search.searchData"]=true;
dojo.provide("lconn.search.searchData");
dojo.declare("lconn.search.searchData",null,{_Trans:null,_dataCache:null,_errorMessage:null,XSLTemplate:null,filter:"none",hasError:false,timeout:12000,setup:function(_cb2){
this.XSLTemplate=_cb2;
this._Trans=dojo.i18n.getLocalization("lconn.search","searchData");
},performQuery:function(_cb3,URL,_cb5,_cb6){
var _cb7={url:URL,handleAs:"text",timeout:this.timeout,sync:false,load:dojo.hitch(this,"cacheData"),error:dojo.hitch(this,"createErrorMessage"),handle:dojo.hitch(_cb5,_cb6)};
if(!_cb3&&(typeof dojo.getObject("com.ibm.ajax.auth.prepareSecure")=="function")){
_cb7=com.ibm.ajax.auth.prepareSecure(_cb7,dojo.hitch(this,"isLogin"));
}
var req=dojo.xhrGet(_cb7);
},isLogin:function(_cb9,_cba){
var _cbb=true;
if(_cb9.substring(0,5)=="<?xml"){
_cbb=false;
}
return _cbb;
},cacheData:function(data,evt){
this.hasError=false;
if(data.substring(0,5)=="<?xml"){
this._dataCache=data;
}else{
this._dataCache="<?xml version=\"1.0\" encoding=\"UTF-8\"?><ResultSet xmlns=\"http://www.ibm.com/xmlns/ass\" />";
this._errorMessage=this._Trans.NO_CONTACT;
this.hasError=true;
}
},createErrorMessage:function(data,evt){
var xml=null;
var xslt=null;
var _cc2=null;
this.hasError=true;
xslt=this.XSLTemplate;
if(data.status==404){
this._errorMessage=this._Trans.NO_CONTACT;
}else{
if(data.status==500){
this._errorMessage=this._Trans.SERVER_ERROR;
}else{
if(data.status==403){
this._errorMessage=this._Trans.NO_CONTACT;
}else{
this._errorMessage=this._Trans.NO_CONTACT;
}
}
}
},getError:function(){
return this._errorMessage;
},resultsTransform:function(data,_cc4){
var xml=null;
var xslt=null;
var _cc7=null;
if(data!=null){
xml=dojox.data.dom.createDocument(data);
}else{
xml=dojox.data.dom.createDocument(this._dataCache);
}
if(_cc4!=null){
xslt=_cc4;
}else{
xslt=this.XSLTemplate;
}
if((xml!=null)||(xslt!=null)){
if(this.filter=="activities"){
_cc7=lconn.search.utils.xslt.transformDocument(xml,xslt,[["activitiesIcon",dojo.moduleUrl("lconn.search","images/iconActivity.gif").toString()],["privateIcon",dojo.moduleUrl("lconn.search","images/small_private_key.gif").toString()],["smallCommunityIcon",dojo.moduleUrl("lconn.search","images/small_communities_icon.gif").toString()],["MsgShow",this._Trans.SHOW],["MsgPrevious",this._Trans.PREVIOUS],["MsgNext",this._Trans.NEXT],["MsgResults",this._Trans.RESULTS],["MsgPage",this._Trans.PAGE],["Activities",this._Trans.ACTIVITIES],["Tags",this._Trans.TAGS],["NoResultsMessage",this._Trans.NORESULTSMESSAGE],["sortBy",this._Trans.SORT_BY],["sortRelevance",this._Trans.SORT_RELEVANCE],["sortLastUpdated",this._Trans.SORT_LAST_UPDATED],["sortDueDate",this._Trans.SORT_DUE_DATE],["private",this._Trans.PRIVATE],["communityActivity",this._Trans.COMMUNITY_ACTIVITY],["relevanceAlt",this._Trans.SORT_RELEVANCE_LABEL],["updatedAlt",this._Trans.SORT_UPDATED_LABEL],["duedateAlt",this._Trans.SORT_DUE_LABEL],["commentOn",this._Trans.COMMENT_ON]]);
}else{
if(this.filter=="blogs"){
_cc7=lconn.search.utils.xslt.transformDocument(xml,xslt,[["blogsIcon",dojo.moduleUrl("lconn.search","images/iconBlog.gif").toString()],["privateIcon",dojo.moduleUrl("lconn.search","images/small_private_key.gif").toString()],["rec0",dojo.moduleUrl("lconn.search","images/iconRecommend0.gif").toString()],["rec1",dojo.moduleUrl("lconn.search","images/iconRecommend1.gif").toString()],["rec2",dojo.moduleUrl("lconn.search","images/iconRecommend2.gif").toString()],["rec3",dojo.moduleUrl("lconn.search","images/iconRecommend3.gif").toString()],["smallCommunityIcon",dojo.moduleUrl("lconn.search","images/small_communities_icon.gif").toString()],["MsgShow",this._Trans.SHOW],["MsgPrevious",this._Trans.PREVIOUS],["MsgNext",this._Trans.NEXT],["MsgResults",this._Trans.RESULTS],["MsgPage",this._Trans.PAGE],["Blogs",this._Trans.BLOGS],["Comments",this._Trans.COMMENTS],["Tags",this._Trans.TAGS],["NoResultsMessage",this._Trans.NORESULTSMESSAGE],["sortBy",this._Trans.SORT_BY],["sortRelevance",this._Trans.SORT_RELEVANCE],["sortDate",this._Trans.SORT_DATE],["sortVisits",this._Trans.SORT_VISITS],["sortComments",this._Trans.SORT_COMMENTS],["sortRecommendations",this._Trans.SORT_RECOMMENDATION],["private",this._Trans.PRIVATE],["communityBlog",this._Trans.COMMUNITY_BLOG],["ratingAlt",this._Trans.RATING],["relevanceAlt",this._Trans.SORT_RELEVANCE_LABEL],["dateAlt",this._Trans.SORT_DATE_LABEL],["visitsAlt",this._Trans.SORT_VISITS_LABEL],["commentsAlt",this._Trans.SORT_COMMENTS_LABEL],["recommendAlt",this._Trans.SORT_RECOMMENDATIONS_LABEL]]);
}else{
if(this.filter=="communities"){
_cc7=lconn.search.utils.xslt.transformDocument(xml,xslt,[["activitiesIcon",dojo.moduleUrl("lconn.search","images/iconActivity.gif").toString()],["blogsIcon",dojo.moduleUrl("lconn.search","images/iconBlog.gif").toString()],["communitiesIcon",dojo.moduleUrl("lconn.search","images/iconCommunities.gif").toString()],["wikiIcon",dojo.moduleUrl("lconn.search","images/iconWikis.gif").toString()],["forumIcon",dojo.moduleUrl("lconn.search","images/iconForums.png").toString()],["filesIcon",dojo.moduleUrl("lconn.search","images/iconFiles.gif").toString()],["privateIcon",dojo.moduleUrl("lconn.search","images/small_private_key.gif").toString()],["cbookmarkIcon",dojo.moduleUrl("lconn.search","images/iconDogear.gif").toString()],["smallCommunityIcon",dojo.moduleUrl("lconn.search","images/small_communities_icon.gif").toString()],["feedIcon",dojo.moduleUrl("lconn.search","images/icon_feed.gif").toString()],["rec0",dojo.moduleUrl("lconn.search","images/iconRecommend0.gif").toString()],["rec1",dojo.moduleUrl("lconn.search","images/iconRecommend1.gif").toString()],["rec2",dojo.moduleUrl("lconn.search","images/iconRecommend2.gif").toString()],["rec3",dojo.moduleUrl("lconn.search","images/iconRecommend3.gif").toString()],["MsgShow",this._Trans.SHOW],["MsgPrevious",this._Trans.PREVIOUS],["MsgNext",this._Trans.NEXT],["MsgResults",this._Trans.RESULTS],["MsgPage",this._Trans.PAGE],["Activities",this._Trans.ACTIVITIES],["Blogs",this._Trans.BLOGS],["Communities",this._Trans.COMMUNITIES],["Files",this._Trans.FILES],["Wikis",this._Trans.WIKI],["Comments",this._Trans.COMMENTS],["Members",this._Trans.MEMBERS],["Tags",this._Trans.TAGS],["NoResultsMessage",this._Trans.NORESULTSMESSAGE],["sortBy",this._Trans.SORT_BY],["sortRelevance",this._Trans.SORT_RELEVANCE],["sortDate",this._Trans.SORT_DATE],["private",this._Trans.PRIVATE],["communityActivity",this._Trans.COMMUNITY_ACTIVITY],["communityBlog",this._Trans.COMMUNITY_BLOG],["communityFile",this._Trans.COMMUNITY_FILE],["communityWiki",this._Trans.COMMUNITY_WIKI],["communityFeed",this._Trans.COMMUNITY_FEED],["communityBookmark",this._Trans.COMMUNITY_BOOKMARK],["ratingAlt",this._Trans.RATING],["relevanceAlt",this._Trans.SORT_RELEVANCE_LABEL],["dateAlt",this._Trans.SORT_DATE_LABEL],["commentOn",this._Trans.COMMENT_ON]]);
}else{
if(this.filter=="dogear"){
_cc7=lconn.search.utils.xslt.transformDocument(xml,xslt,[["dogearIcon",dojo.moduleUrl("lconn.search","images/iconDogear.gif").toString()],["privateIcon",dojo.moduleUrl("lconn.search","images/small_private_key.gif").toString()],["MsgShow",this._Trans.SHOW],["MsgPrevious",this._Trans.PREVIOUS],["MsgNext",this._Trans.NEXT],["MsgResults",this._Trans.RESULTS],["MsgPage",this._Trans.PAGE],["Dogear",this._Trans.DOGEAR],["Tags",this._Trans.TAGS],["NoResultsMessage",this._Trans.NORESULTSMESSAGE],["People",this._Trans.PEOPLE],["filter",this.filter],["sortBy",this._Trans.SORT_BY],["sortRelevance",this._Trans.SORT_RELEVANCE],["sortDate",this._Trans.SORT_DATE],["sortPopularity",this._Trans.SORT_POPULARITY],["private",this._Trans.PRIVATE],["relevanceAlt",this._Trans.SORT_RELEVANCE_LABEL],["dateAlt",this._Trans.SORT_DATE_LABEL],["popularityAlt",this._Trans.SORT_POPULARITY_LABEL]]);
}else{
if(this.filter=="files"){
_cc7=lconn.search.utils.xslt.transformDocument(xml,xslt,[["filesIcon",dojo.moduleUrl("lconn.search","images/iconFiles.gif").toString()],["privateIcon",dojo.moduleUrl("lconn.search","images/small_private_key.gif").toString()],["rec0",dojo.moduleUrl("lconn.search","images/iconRecommend0.gif").toString()],["rec1",dojo.moduleUrl("lconn.search","images/iconRecommend1.gif").toString()],["rec2",dojo.moduleUrl("lconn.search","images/iconRecommend2.gif").toString()],["rec3",dojo.moduleUrl("lconn.search","images/iconRecommend3.gif").toString()],["smallCommunityIcon",dojo.moduleUrl("lconn.search","images/small_communities_icon.gif").toString()],["MsgShow",this._Trans.SHOW],["MsgPrevious",this._Trans.PREVIOUS],["MsgNext",this._Trans.NEXT],["MsgResults",this._Trans.RESULTS],["MsgPage",this._Trans.PAGE],["Files",this._Trans.FILES],["Tags",this._Trans.TAGS],["NoResultsMessage",this._Trans.NORESULTSMESSAGE],["sortBy",this._Trans.SORT_BY],["sortRelevance",this._Trans.SORT_RELEVANCE],["sortDate",this._Trans.SORT_DATE],["sortDownloads",this._Trans.SORT_DOWNLOADS],["sortType",this._Trans.SORT_TYPE],["sortSize",this._Trans.SORT_SIZE],["sortTitle",this._Trans.SORT_TITLE],["private",this._Trans.PRIVATE],["communityFile",this._Trans.COMMUNITY_FILE],["ratingAlt",this._Trans.RATING],["relevanceAlt",this._Trans.SORT_RELEVANCE_LABEL],["dateAlt",this._Trans.SORT_DATE_LABEL],["popularityAlt",this._Trans.SORT_POPULARITY_LABEL]]);
}else{
if(this.filter=="profiles"){
_cc7=lconn.search.utils.xslt.transformDocument(xml,xslt,[["MsgShow",this._Trans.SHOW],["MsgPrevious",this._Trans.PREVIOUS],["MsgNext",this._Trans.NEXT],["MsgResults",this._Trans.RESULTS],["MsgPage",this._Trans.PAGE],["Profiles",this._Trans.PROFILES],["Tags",this._Trans.TAGS],["NoResultsMessage",this._Trans.NORESULTSMESSAGE],["sortBy",this._Trans.SORT_BY],["sortRelevance",this._Trans.SORT_RELEVANCE],["sortFirstName",this._Trans.SORT_FIRSTNAME],["sortLastName",this._Trans.SORT_LASTNAME],["relevanceAlt",this._Trans.SORT_RELEVANCE_LABEL],["firstnameAlt",this._Trans.SORT_FIRST_NAME_LABEL],["lastnameAlt",this._Trans.SORT_LAST_NAME_LABEL]]);
}else{
if(this.filter=="wikis"){
_cc7=lconn.search.utils.xslt.transformDocument(xml,xslt,[["wikiIcon",dojo.moduleUrl("lconn.search","images/iconWikis.gif").toString()],["privateIcon",dojo.moduleUrl("lconn.search","images/small_private_key.gif").toString()],["rec0",dojo.moduleUrl("lconn.search","images/iconRecommend0.gif").toString()],["rec1",dojo.moduleUrl("lconn.search","images/iconRecommend1.gif").toString()],["rec2",dojo.moduleUrl("lconn.search","images/iconRecommend2.gif").toString()],["rec3",dojo.moduleUrl("lconn.search","images/iconRecommend3.gif").toString()],["smallCommunityIcon",dojo.moduleUrl("lconn.search","images/small_communities_icon.gif").toString()],["MsgShow",this._Trans.SHOW],["MsgPrevious",this._Trans.PREVIOUS],["MsgNext",this._Trans.NEXT],["MsgResults",this._Trans.RESULTS],["MsgPage",this._Trans.PAGE],["Wiki",this._Trans.WIKI],["Comments",this._Trans.COMMENTS],["Members",this._Trans.MEMBERS],["Tags",this._Trans.TAGS],["NoResultsMessage",this._Trans.NORESULTSMESSAGE],["People",this._Trans.PEOPLE],["sortBy",this._Trans.SORT_BY],["sortRelevance",this._Trans.SORT_RELEVANCE],["sortDate",this._Trans.SORT_DATE],["sortVisits",this._Trans.SORT_VISITS],["sortComments",this._Trans.SORT_COMMENTS],["sortRecommendations",this._Trans.SORT_RECOMMENDATION],["private",this._Trans.PRIVATE],["communityWiki",this._Trans.COMMUNITY_WIKI],["ratingAlt",this._Trans.RATING],["relevanceAlt",this._Trans.SORT_RELEVANCE_LABEL],["dateAlt",this._Trans.SORT_DATE_LABEL]]);
}else{
_cc7=lconn.search.utils.xslt.transformDocument(xml,xslt,[["activitiesIcon",dojo.moduleUrl("lconn.search","images/iconActivity.gif").toString()],["blogsIcon",dojo.moduleUrl("lconn.search","images/iconBlog.gif").toString()],["communitiesIcon",dojo.moduleUrl("lconn.search","images/iconCommunities.gif").toString()],["dogearIcon",dojo.moduleUrl("lconn.search","images/iconDogear.gif").toString()],["profilesIcon",dojo.moduleUrl("lconn.search","images/iconProfiles.gif").toString()],["wikiIcon",dojo.moduleUrl("lconn.search","images/iconWikis.gif").toString()],["forumIcon",dojo.moduleUrl("lconn.search","images/iconForums.png").toString()],["filesIcon",dojo.moduleUrl("lconn.search","images/iconFiles.gif").toString()],["privateIcon",dojo.moduleUrl("lconn.search","images/small_private_key.gif").toString()],["feedIcon",dojo.moduleUrl("lconn.search","images/icon_feed.gif").toString()],["cbookmarkIcon",dojo.moduleUrl("lconn.search","images/iconDogear.gif").toString()],["smallCommunityIcon",dojo.moduleUrl("lconn.search","images/small_communities_icon.gif").toString()],["rec0",dojo.moduleUrl("lconn.search","images/iconRecommend0.gif").toString()],["rec1",dojo.moduleUrl("lconn.search","images/iconRecommend1.gif").toString()],["rec2",dojo.moduleUrl("lconn.search","images/iconRecommend2.gif").toString()],["rec3",dojo.moduleUrl("lconn.search","images/iconRecommend3.gif").toString()],["MsgShow",this._Trans.SHOW],["MsgPrevious",this._Trans.PREVIOUS],["MsgNext",this._Trans.NEXT],["MsgResults",this._Trans.RESULTS],["MsgPage",this._Trans.PAGE],["Activities",this._Trans.ACTIVITIES],["Blogs",this._Trans.BLOGS],["Communities",this._Trans.COMMUNITIES],["Dogear",this._Trans.DOGEAR],["Files",this._Trans.FILES],["Profiles",this._Trans.PROFILES],["Wiki",this._Trans.WIKI],["private",this._Trans.PRIVATE],["communityActivity",this._Trans.COMMUNITY_ACTIVITY],["communityBlog",this._Trans.COMMUNITY_BLOG],["communityFile",this._Trans.COMMUNITY_FILE],["communityWiki",this._Trans.COMMUNITY_WIKI],["communityFeed",this._Trans.COMMUNITY_FEED],["Comments",this._Trans.COMMENTS],["Members",this._Trans.MEMBERS],["Tags",this._Trans.TAGS],["NoResultsMessage",this._Trans.NORESULTSMESSAGE],["People",this._Trans.PEOPLE],["sortBy",this._Trans.SORT_BY],["sortRelevance",this._Trans.SORT_RELEVANCE],["sortDate",this._Trans.SORT_DATE],["communityBookmark",this._Trans.COMMUNITY_BOOKMARK],["ratingAlt",this._Trans.RATING],["relevanceAlt",this._Trans.SORT_RELEVANCE_LABEL],["dateAlt",this._Trans.SORT_DATE_LABEL],["commentOn",this._Trans.COMMENT_ON]]);
}
}
}
}
}
}
}
}
return _cc7;
},tagTransform:function(data,_cc9){
var xml=null;
var xslt=null;
var _ccc=null;
if(data){
xml=dojox.data.dom.createDocument(data);
}else{
xml=dojox.data.dom.createDocument(this._dataCache);
}
if(_cc9){
xslt=_cc9;
}else{
xslt=this.XSLTemplate;
}
if((xml!=null)||(xslt!=null)){
_ccc=lconn.search.utils.xslt.transformDocument(xml,xslt,[["action","tags"],["noTag",this._Trans.NO_TAG]]);
}
return _ccc;
},dateTransform:function(data,_cce){
var xml=null;
var xslt=null;
var _cd1=null;
if(data){
xml=dojox.data.dom.createDocument(data);
}else{
xml=dojox.data.dom.createDocument(this._dataCache);
}
if(_cce){
xlst=_cce;
}else{
xslt=this.XSLTemplate;
}
if((xml!=null)||(xslt!=null)){
_cd1=lconn.search.utils.xslt.transformDocument(xml,xslt,[["action","date"],["Jan",this._Trans.JAN],["Feb",this._Trans.FEB],["Mar",this._Trans.MAR],["Apr",this._Trans.APR],["May",this._Trans.MAY],["Jun",this._Trans.JUN],["Jul",this._Trans.JUL],["Aug",this._Trans.AUG],["Sep",this._Trans.SEP],["Oct",this._Trans.OCT],["Nov",this._Trans.NOV],["Dec",this._Trans.DEC],["noDate",this._Trans.NO_DATE],["twistyAlt",this._Trans.EXPAND_COLLAPSE]]);
}
return _cd1;
},peopleTransform:function(data,_cd3){
var xml=null;
var xslt=null;
var _cd6=null;
if(data){
xml=dojox.data.dom.createDocument(data);
}else{
xml=dojox.data.dom.createDocument(this._dataCache);
}
if(_cd3){
xslt=_cd3;
}else{
xslt=this.XSLTemplate;
}
if((xml!=null)||(xslt!=null)){
_cd6=lconn.search.utils.xslt.transformDocument(xml,xslt,[["action","people"],["noPeople",this._Trans.NO_PEOPLE]]);
}
return _cd6;
},setFilter:function(_cd7){
if(_cd7=="activities"){
this.XSLTemplate=dojo.moduleUrl("lconn.search","xslt/searchActivities.xsl").toString();
}else{
if(_cd7=="blogs"){
this.XSLTemplate=dojo.moduleUrl("lconn.search","xslt/searchBlogs.xsl").toString();
}else{
if(_cd7=="communities"){
this.XSLTemplate=dojo.moduleUrl("lconn.search","xslt/searchCommunities.xsl").toString();
}else{
if(_cd7=="dogear"){
this.XSLTemplate=dojo.moduleUrl("lconn.search","xslt/searchDogear.xsl").toString();
}else{
if(_cd7=="files"){
this.XSLTemplate=dojo.moduleUrl("lconn.search","xslt/searchFiles.xsl").toString();
}else{
if(_cd7=="profiles"){
this.XSLTemplate=dojo.moduleUrl("lconn.search","xslt/searchProfiles.xsl").toString();
}else{
if(_cd7=="wikis"){
this.XSLTemplate=dojo.moduleUrl("lconn.search","xslt/searchWikis.xsl").toString();
}else{
this.XSLTemplate=dojo.moduleUrl("lconn.search","xslt/searchAll.xsl").toString();
}
}
}
}
}
}
}
this.filter=_cd7;
}});
}
if(!dojo._hasResource["lconn.search.searchResults"]){
dojo._hasResource["lconn.search.searchResults"]=true;
dojo.provide("lconn.search.searchResults");
dojo.declare("lconn.search.searchResults",null,{TAGCLOUD:null,DATECLOUD:null,PERSONCLOUD:null,APIHandler:null,DATASTORE:null,_Trans:null,contextRoot:null,profilesApi:"/profiles",timeout:15000,xslTemplate:dojo.moduleUrl("lconn.search","xslt/searchAll.xsl").toString(),publicSearch:true,resultContainer:null,dateContainer:null,tagContainer:null,personContainer:null,loadingDiv:null,setup:function(cr,cq,_cda,_cdb,_cdc,_cdd,_cde){
this._Trans=dojo.i18n.getLocalization("lconn.search","searchResults");
if(_cdb){
this.resultContainer=_cdb;
}
this.contextRoot=cr;
this.publicSearch=_cda;
this.APIHandler=new lconn.search.searchAPI();
this.APIHandler.setup(cr,cq);
var _cdf=this.APIHandler.getComponentFilter();
this.DATASTORE=new lconn.search.searchData();
this.DATASTORE.setup(this.xslTemplate);
this.DATASTORE.setFilter(_cdf);
if(_cdb){
if(_cdb!=null){
if(typeof (_cdb)=="string"){
this.resultContainer=dojo.byId(_cdb);
}else{
this.resultContainer=_cdb;
}
}
}
if(_cdc){
if(_cdc!=null){
if(typeof (_cdc)=="string"){
this.dateContainer=dojo.byId(_cdc);
}else{
this.dateContainer=_cdc;
}
this.DATECLOUD=new lconn.search.dateCloud();
this.DATECLOUD.setup(this.dateContainer,null,null,this.DATASTORE);
}
}
if(_cdd){
if(_cdd!=null){
if(typeof (_cdd)=="string"){
this.tagContainer=dojo.byId(_cdd);
}else{
this.tagContainer=_cdd;
}
this.TAGCLOUD=new lconn.search.tagCloud();
this.TAGCLOUD.setup(this.tagContainer,null,null,this.DATASTORE);
}
}
if(_cde){
if(_cde!=null){
if(typeof (_cde)=="string"){
this.personContainer=dojo.byId(_cde);
}else{
this.personContainer=_cde;
}
this.PERSONCLOUD=new lconn.search.personCloud();
this.PERSONCLOUD.setup(this.personContainer,null,null,this.DATASTORE);
}
}
},updatePage:function(){
this.updateResults(this.APIHandler.getCombinedAPI(this.publicSearch));
},updateQuery:function(_ce0){
this.APIHandler.changeQuery(_ce0);
this.updatePage();
},performFilter:function(_ce1){
var tags=this.APIHandler.getTagParameters();
if(tags!=null){
if(tags.length>1){
var _ce3=document.getElementById("searchFilter");
if(_ce3!=null){
_ce3.innerHTML="";
}
for(var j=1;j<tags.length;j++){
this.addTagFilter(tags[j]);
}
}
}
this.APIHandler.changeComponent(_ce1);
this.APIHandler.sortResults(null,null);
this.DATASTORE.setFilter(_ce1);
this.updatePage();
},removeFilter:function(){
this.APIHandler.changeComponent("none");
this.APIHandler.changePage(1);
this.updatePage();
},performTagFilter:function(tag){
if(this.APIHandler.addTag(tag)){
this.addTagFilter(tag);
this.APIHandler.changePage(1);
this.updatePage();
}
},performPersonFilter:function(_ce6){
if(this.APIHandler.addPerson(_ce6)){
this.addPersonFilter(_ce6);
this.APIHandler.changePage(1);
this.updatePage();
}
},performDateFilter:function(date){
this.filterdate=date;
this.addDateFilter(date);
this.APIHandler.changePage(1);
this.APIHandler.addDate(date);
this.updatePage();
},performPagination:function(page){
this.APIHandler.changePage(page);
this.updateResults(this.APIHandler.getSearchResultsAPI(this.publicSearch));
},updateResults:function(_ce9){
this.loadingDiv=document.createElement("DIV");
this.loadingDiv.style.position="absolute";
this.loadingDiv.style.width=this.resultContainer.offsetWidth+"px";
this.loadingDiv.style.height=this.resultContainer.offsetHeight+"px";
this.loadingDiv.style.backgroundColor="#fff";
this.loadingDiv.style.opacity=".80";
this.loadingDiv.style.filter="alpha(opacity=80)";
this.loadingDiv.innerHTML="<div style=\"width:150px;height:70px;padding:10px;position:relative;margin-top:100px;margin-left:auto;margin-right:auto;border:1px solid #000;background: #cfecff url("+dojo.moduleUrl("lconn.search","images/loading.gif")+") no-repeat center 10px;opacity:1.0;filter:none;\"><br /><br /><strong style=\"text-align:center;width:100%;\">"+this._Trans.LOADING+"</strong></div>";
if(this.resultContainer.childNodes!=null&&this.resultContainer.childNodes.length>0){
this.resultContainer.insertBefore(this.loadingDiv,this.resultContainer.childNodes[0]);
}else{
this.resultContainer.appendChild(this.loadingDiv);
}
this.DATASTORE.performQuery(this.publicSearch,this.APIHandler.getCombinedAPI(this.publicSearch),this,"handleResults");
},updateTags:function(){
if(this.tagContainer!=null){
this.TAGCLOUD.update();
this.setVisible(25,this.tagContainer);
}
},updatePeople:function(){
if(this.personContainer!=null){
this.PERSONCLOUD.update();
this.setPVisible(4,this.personContainer);
}
},updateDate:function(){
if(this.dateContainer!=null){
this.DATECLOUD.update();
}
},handleResults:function(data,evt){
if(this.DATASTORE.hasError){
var _cec=document.createElement("DIV");
dojo.addClass(_cec,"lotusMessage");
var _ced=document.createElement("IMG");
_ced.src=dojo.moduleUrl("lconn.search","images/iconError.gif");
_cec.appendChild(_ced);
var _cee=document.createElement("SPAN");
_cee.innerHTML=this.DATASTORE.getError();
_cec.appendChild(_cee);
this.resultContainer.innerHTML="";
this.resultContainer.appendChild(_cec);
}else{
this.updateTags();
this.updatePeople();
this.updateDate();
if(this.resultContainer!=null){
var _cef=this.DATASTORE.resultsTransform(null,null);
this.resultContainer.innerHTML=_cef;
var _cf0=dojo.query(".searchSummaryHighlight",this.resultContainer);
for(var i=0;i<_cf0.length;i++){
_cf0[i].innerHTML=this.highlightXSLHack(_cf0[i].innerHTML);
}
this.dateHandler();
try{
SemTagSvc.parseDom(null,this.resultContainer);
}
catch(e){
}
}
if(this.tagContainer!=null){
this.updateTags(this.APIHandler.getTagFacetAPI(this.publicSearch));
this.setVisible(25,this.tagContainer);
}
if(this.personContainer!=null){
this.updatePeople(this.APIHandler.getPersonFacetAPI(this.publicSearch));
this.setPVisible(4,this.personContainer);
}
if(this.dateContainer!=null){
this.updateDate(this.APIHandler.getDateFacetAPI(this.publicSearch));
}
}
},highlightXSLHack:function(html){
var dn=document.createElement("DIV");
dn.innerHTML=html;
if(dn.innerText){
return dn.innerText;
}
return dn.textContent;
},addTagFilter:function(tag){
var _cf5=document.getElementById("searchFilter");
if(_cf5!=null){
var _cf6=document.createElement("A");
var _cf7=tag.replace("'","\\'","g");
_cf7=_cf7.replace("\"","\\\"","g");
dojo.addClass(_cf6,"lotusFilter");
_cf6.setAttribute("href","javascript:void(0);");
_cf6.setAttribute("name",_cf7);
if(typeof (_cf6.textContent)=="undefined"){
_cf6.innerText=tag+" [X] ";
}else{
_cf6.textContent=tag+" [X] ";
}
dojo.connect(_cf6,"onclick",this,"removeTagFilter");
_cf5.appendChild(_cf6);
}
},addPersonFilter:function(_cf8){
_cf8=_cf8.replace("","%02");
var _cf9=document.getElementById("searchFilter");
if(_cf9!=null){
var _cfa=document.createElement("A");
var _cfb=_cf8.replace("'","\\'","g");
var _cfb=_cfb.replace("\"","\\\"","g");
dojo.addClass(_cfa,"lotusFilter");
_cfa.setAttribute("href","javascript:void(0);");
_cfa.setAttribute("name",_cfb);
var _cfc=_cf8.split("");
if(_cfc.length==1){
_cfc=_cf8.split("%02");
}
if(typeof (_cfa.textContent)=="undefined"){
_cfa.innerText=decodeURI(_cfc[1])+" [X] ";
}else{
_cfa.textContent=decodeURI(_cfc[1])+" [X] ";
}
dojo.connect(_cfa,"onclick",this,"removePersonFilter");
_cf9.appendChild(_cfa);
}
},addDateFilter:function(date){
var _cfe=document.getElementById("searchFilter");
var dfs=dojo.query(".dateFilter",_cfe);
if(dfs!=null&&dfs.length>0){
for(var i=0;i<dfs.length;i++){
_cfe.removeChild(dfs[i]);
}
}
if(_cfe!=null){
var _d01=document.createElement("A");
dojo.addClass(_d01,"lotusFilter");
dojo.addClass(_d01,"dateFilter");
_d01.setAttribute("href","javascript:void(0);");
_d01.setAttribute("name",date);
_d01.innerHTML=date+"&nbsp;[X]&nbsp;";
dojo.connect(_d01,"onclick",this,"removeDateFilter");
_cfe.appendChild(_d01);
}
},removeTagFilter:function(evt){
var _d03=(typeof evt!=="undefined")?evt:event;
var elem=(typeof _d03.target!=="undefined")?_d03.target:_d03.srcElement;
this.APIHandler.removeTag(elem.getAttribute("name"));
var _d05=document.getElementById("searchFilter");
if(_d05!=null){
_d05.removeChild(elem);
}
this.updatePage();
},removePersonFilter:function(evt){
var _d07=(typeof evt!=="undefined")?evt:event;
var elem=(typeof _d07.target!=="undefined")?_d07.target:_d07.srcElement;
this.APIHandler.removePerson(elem.getAttribute("name"));
var _d09=document.getElementById("searchFilter");
if(_d09!=null){
_d09.removeChild(elem);
}
this.updatePage();
},removeDateFilter:function(evt){
var _d0b=(typeof evt!=="undefined")?evt:event;
var elem=(typeof _d0b.target!=="undefined")?_d0b.target:_d0b.srcElement;
this.APIHandler.removeDate(elem.getAttribute("name"));
var _d0d=document.getElementById("searchFilter");
if(_d0d!=null){
_d0d.removeChild(elem);
}
this.updatePage();
},setVisible:function(_d0e,_d0f){
var _d10;
if(typeof (_d0f)=="string"){
_d10=dojo.byId(_d0f);
}else{
_d10=_d0f;
}
if(_d10!=null){
var as=_d10.getElementsByTagName("span");
if(as!=null){
for(var i=0;i<as.length;i++){
var a=as[i];
var m=a.className.match(/^f\d+-(\d+)/);
if(m){
var p=m[1];
a.style.display=(p>=_d0e)?"inline":"none";
}
}
}else{
return;
}
}else{
return;
}
},setPVisible:function(_d16,_d17){
var _d18;
if(typeof (_d17)=="string"){
_d18=dojo.byId(_d17);
}else{
_d18=_d17;
}
if(_d18!=null){
var as=_d18.getElementsByTagName("li");
for(var i=0;i<as.length;i++){
as[i].style.display=(i<_d16)?"":"none";
}
}
return;
},dateHandler:function(_d1b){
var _d1c=new lconn.search.utils.DateFormater();
var _d1d=dojo.query(".searchDateClass",document.getElementById("lotusContent"));
for(var i=0;i<_d1d.length;i++){
_d1d[i].innerHTML=_d1c.formatDateTime(_d1d[i].innerHTML);
}
},toggleChildren:function(id,_d20){
var _d21=document.getElementById(id);
if(_d21){
if(_d21.style.display=="none"){
_d21.style.display="block";
if(_d20){
dojo.removeClass(_d20,"lotusTwistyClosed");
dojo.addClass(_d20,"lotusTwistyOpen");
}
}else{
_d21.style.display="none";
if(_d20){
dojo.removeClass(_d20,"lotusTwistyOpen");
dojo.addClass(_d20,"lotusTwistyClosed");
}
}
}
},setPageSize:function(_d22){
this.APIHandler.changePs(_d22);
this.updateResults();
},sortBy:function(_d23,_d24){
this.APIHandler.sortResults(_d23,_d24);
this.updateResults();
},toggleSort:function(evt){
var _d26=(typeof evt!=="undefined")?evt:event;
var elem=(typeof _d26.target!=="undefined")?_d26.target:_d26.srcElement;
if(elem!=null){
if(dojo.hasClass(elem,"lotusAscending")){
this.sortBy(elem.getAttribute("key"),"desc");
}else{
this.sortBy(elem.getAttribute("key"),"asc");
}
}
},sortDescending:function(evt){
var elem;
if(!evt){
evt=window.event;
}
if(evt.target){
elem=evt.target;
}else{
if(evt.srcElement){
elem=evt.srcElement;
}
}
if(elem.nodeType==3){
elem=elem.parentNode;
}
if(elem!=null){
this.sortBy(elem.getAttribute("key"),"desc");
}
},sortAscending:function(evt){
var elem;
if(!evt){
evt=window.event;
}
if(evt.target){
elem=evt.target;
}else{
if(evt.srcElement){
elem=evt.srcElement;
}
}
if(elem.nodeType==3){
elem=elem.parentNode;
}
if(elem!=null){
this.sortBy(elem.getAttribute("key"),"asc");
}
},clearSort:function(evt){
this.sortBy(null,null);
},tagOnlySearch:function(tag){
this.APIHandler.clearQueryString();
this.APIHandler.addTag(tag);
this.updatePage();
},navigate:function(_d2e,_d2f){
return true;
}});
}
if(!dojo._hasResource["com.ibm.mm.livetext.serviceImpl"]){
dojo._hasResource["com.ibm.mm.livetext.serviceImpl"]=true;
dojo.provide("com.ibm.mm.livetext.serviceImpl");
dojo.declare("com.ibm.mm.livetext.serviceImpl",null,{_tagTypes:null,tagChanged:"/com/ibm/mashups/livetext/livetextchanged",tagStatusChange:"/com/ibm/mashups/livetext/livetextchanged",tagContentChanged:"/com/ibm/mashups/livetext/livetextcontentchanged",entryAdded:"/com/ibm/mashups/livetext/configentryadded",entryRemoved:"/com/ibm/mashups/livetext/configentryremoved",init:function(){
this._loadTags();
dojo.subscribe(this.tagChanged,this,"onTagChanged");
dojo.subscribe(this.tagContentChanged,this,"onTagContentChanged");
dojo.subscribe(this.entryAdded,this,"onAddConfigEntry");
dojo.subscribe(this.entryRemoved,this,"onRemoveConfigEntry");
dojo.publish(this.tagContentChanged,[document,true]);
},_getNodes:function(node,_d31){
if(_d31.processEnclosedTags){
return dojo.query(_d31.match,node);
}else{
var a=dojo.query(_d31.match+" "+_d31.match,node);
var b=dojo.query(_d31.match,node);
var _d34,_d35;
while(a.length>0){
_d34=a[0];
_d35=0;
while(_d35<b.length){
if(_d34==b[_d35]){
a.splice(0,1);
b.splice(_d35,1);
break;
}else{
_d35++;
}
}
}
return b;
}
},onTagChanged:function(node,_d37,_d38,_d39){
var tag=null,_d3b=null,tags=null;
for(var _d3d=0;_d3d<this._tagTypes.length;_d3d++){
tag=this._tagTypes[_d3d];
this._processTypeTag(node,tag,_d37,_d38,_d39,true);
}
},onTagContentChanged:function(node,_d3f,_d40,_d41){
var tag=null,_d43=null,tags=null;
for(var _d45=0;_d45<this._tagTypes.length;_d45++){
tag=this._tagTypes[_d45];
this._processTypeTag(node,tag,_d3f,_d40,_d41,false);
}
},_processTypeTag:function(node,tag,_d48,_d49,_d4a,_d4b){
var tags=[];
if(_d4b&&this._checkRoot(node,tag)){
tags[0]=node;
}
tags=tags.concat(this._getNodes(node,tag));
var _d4d=[];
_d4d=_d4d.concat(tags);
if(_d4d.length>0){
if(tag.loaded==null){
this._loadTagHandler(tag);
}
var _d4e=[];
if(dojo.isFunction(_d49)){
try{
_d49(node,_d4d);
}
catch(error){
console.debug(error);
}
}
for(var _d4f=0;_d4f<tags.length;_d4f++){
try{
tag.tagHandler.processTag(tags[_d4f]);
}
catch(error){
_d4e[_d4e.length]=error;
if(_d48){
break;
}
}
}
if(dojo.isFunction(_d4a)){
try{
_d4a(node,_d4d,_d4e);
}
catch(error){
console.debug(error);
}
}
}
},_checkRoot:function(node,tag){
var _d52=false;
if(node!=null&&node.nodeType){
var _d53=node.cloneNode(false);
var _d54=document.createElement("div");
_d54.appendChild(_d53);
var _d55=this._getNodes(_d54,tag);
if(_d55!=null&&_d55.length>0){
_d52=true;
}
delete _d53;
delete _d54;
delete _d55;
}
return _d52;
},_loadTags:function(){
if(this._tagTypes==null){
var _d56=this;
if(typeof livetextCfg!="undefined"){
this._tagTypes=livetextCfg;
}else{
dojo.xhrGet({url:dojo.moduleUrl("com.ibm.mm.livetext","tagservice.entries.cfg"),handleAs:"text",sync:true,load:function(_d57){
_d56._tagTypes=dojo.fromJson(_d57);
},error:function(data){
console.dir(data);
}});
}
}
},onAddConfigEntry:function(_d59){
},onRemoveConfigEntry:function(_d5a){
},parseDom:function(_d5b,node){
dojo.publish(this.tagChanged,[node]);
},_loadTagHandler:function(tag){
dojo.registerModulePath(tag.module,tag.path);
dojo.eval("dojo.r"+"equire('"+tag.baseClass+"')");
var _d5e="{create:function(){return new "+tag.baseClass+"()}}";
var _d5f=dojo.fromJson(_d5e);
tag.tagHandler=_d5f.create();
tag.loaded=true;
}});
}
if(!dojo._hasResource["lconn.core.url"]){
dojo._hasResource["lconn.core.url"]=true;
dojo.provide("lconn.core.url");
dojo.provide("lconn.core.url.UrlStruct");
dojo.provide("lconn.core.url.ProxyUrlHelper");
lconn.core.url._const={regex:/(^[a-zA-Z]+)\:\/\/([a-zA-Z\d][\a-z\A-Z\d\-\.]*)(:\d{1,5})?([\/\?\#].*)?/,protocolPorts:{"http":80,"https":443}};
dojo.declare("lconn.core.url.UrlStruct",null,{isInvalidUrl:false,url:"",protocol:"",host:"",port:"",hasPort:false,urlRemainder:"",constructor:function(url){
if(url!=null&&url.match(lconn.core.url._const.regex)){
var t=lconn.core.url._const.regex.exec(url);
this.url=t[0];
this.protocol=t[1];
this.host=t[2];
this.port=this._parsePort(t[3]);
this.urlRemainder=t[4];
}else{
this.isInvalidUrl=true;
}
},_parsePort:function(_d62){
if(_d62==null||_d62==""){
return "";
}
this.hasPort=true;
return _d62.substr(_d62.indexOf(":")+1);
},normalizedPort:function(){
var pp=lconn.core.url._const.protocolPorts;
if(this.hasPort){
return this.port;
}else{
if(typeof (pp[this.protocol])=="undefined"){
return "";
}else{
return pp[this.protocol];
}
}
}});
dojo.declare("lconn.core.url.ProxyUrlHelper",null,{proxyURL:"",_proxyStruct:null,constructor:function(_d64){
if(_d64.length>1&&_d64.lastIndexOf("/")==_d64.length-1){
_d64=_d64.substr(0,_d64.length-1);
}
this.proxyURL=_d64;
this._proxyStruct=new lconn.core.url.UrlStruct(this.proxyURL);
},getProxifiedURL:function(url){
var surl=new lconn.core.url.UrlStruct(url);
var _d67=this._proxyStruct;
if(this._matchUrlBase(surl)){
return surl.protocol+"://"+surl.host+(_d67.hasPort?":"+_d67.port:"")+surl.urlRemainder;
}
return this.proxyURL+"/"+surl.protocol+"/"+surl.host+(surl.hasPort?"%3A"+surl.port:"")+surl.urlRemainder;
},_matchUrlBase:function(surl){
var ps=this._proxyStruct;
return (ps.protocol==surl.protocol&&ps.host==surl.host&&this._matchPort(surl));
},_matchPort:function(surl){
var np=this._proxyStruct.normalizedPort();
return np==surl.normalizedPort();
}});
}
if(!dojo._hasResource["lconn.core.bizCard.bizCardUtils"]){
dojo._hasResource["lconn.core.bizCard.bizCardUtils"]=true;
dojo.provide("lconn.core.bizCard.bizCardUtils");
lconn.core.bizCard.bizCardUtils={enabledUids:new Array,disabledUids:new Array(),isDebug:false,scriptResourceName:"semanticTagService.js",version:"2.5.0",scripts:new Array(),css:new Array(),initiated:false,_haveProxy:false,_proxyHelper:null,appChksum:null
,checkUid:function(_uid) {
	if (!this.isUidDisabled(_uid) && !this.isUidEnabled(_uid)) {
		new Ajax.Request('/developerworks/mydeveloperworks/profiles/actions/checkpd.jsp?uid='+_uid+'&ts='+new Date().getTime(), {
			asynchronous:false,
		  onSuccess: function(response) {
				if (response.responseText.indexOf("disabled")>=0) {
					lconn.core.bizCard.bizCardUtils.addDisabledUid(_uid);
					return false;
				}
				else {
					lconn.core.bizCard.bizCardUtils.addEnabledUid(_uid);
					return true;
				}
		  }
		});
	}
	if (this.isUidEnabled(_uid)) return true;
	return false;
}	
,addDisabledUid:function(_uid){
	if (!this.isUidDisabled(_uid))
		this.disabledUids.push(_uid);	
}
,addEnabledUid:function(_uid){
	if (!this.isUidEnabled(_uid))
		this.enabledUids.push(_uid);		
}
,isUidDisabled:function(_uid) {
	var _exists=false;
	for (var i=0;i<this.disabledUids.length;i++)
		if (this.disabledUids[i]==_uid) 
				_exists = true;	
	return _exists;	
}
,isUidEnabled:function(_uid) {
	var _exists=false;
	for (var i=0;i<this.enabledUids.length;i++)
		if (this.enabledUids[i]==_uid) 
				_exists = true;	
	return _exists;	
}
,init:function(_d6c){
if(this.initiated==false){
this.baseUrl=lconn.core.bizCard.bizCardUtils.initBaseUrl();
this._initProxyHelper();
this._initAppCksum();
if(window.semtagrs==null){
lconn.core.bizCard.bizCardUtils.loadScript(this.baseUrl+"/resourceStrings.do?t=1");
}
if(window.SemTagSvcConfig!=null&&SemTagSvcConfig.debug==true){
lconn.core.bizCard.bizCardUtils.isDebug=true;
}
if(window.SemTagPersonConfig_noCss==null){
if(window.SemTagSvcConfig!=null){
if(SemTagSvcConfig.loadCssFiles==true){
lconn.core.bizCard.bizCardUtils.loadCssIfNeeded();
}
}else{
lconn.core.bizCard.bizCardUtils.loadCssIfNeeded();
}
}
this.initiated=true;
}
},initBaseUrl:function(){
var _d6d="";
if(window.SemTagSvc_baseUrl!=null){
_d6d=SemTagSvc_baseUrl;
}else{
if(window.SemTagSvcConfig!=null&&SemTagSvcConfig.baseUrl!=null){
_d6d=SemTagSvcConfig.baseUrl;
}else{
_d6d=this.getURL(this.scriptResourceName,"script",SemTagSvc.baseUrl,"src").baseUrl;
}
}
return _d6d;
},_initProxyHelper:function(){
if(window.SemTagSvcConfig!=null&&typeof (window.SemTagSvcConfig.proxyURL)!="undefined"&&window.SemTagSvcConfig.proxyURL.length>0){
this._haveProxy=true;
this._proxyHelper=new lconn.core.url.ProxyUrlHelper(window.SemTagSvcConfig.proxyURL);
}
},_initAppCksum:function(){
this.appChksum=this._getConfigValue("appChksum","UNDEFINED");
},_getConfigValue:function(_d6e,_d6f){
if(window.SemTagSvcConfig!=null&&typeof (window.SemTagSvcConfig[_d6e])!="undefined"){
return window.SemTagSvcConfig[_d6e];
}
return _d6f;
},appendAppChkSum:function(url){
if(url==null||url.indexOf("acs=")>=0){
return url;
}
var c=null;
if(url.indexOf("?")<0){
c="?";
}else{
c="&";
}
return url+c+"acs="+this.appChksum;
},getService:function(_d72){
for(i=0;i<livetextCfg.length;i++){
var _d73=livetextCfg[i];
if(_d73.id==_d72){
return _d73;
}
}
return null;
},processUntilAvailable:function(_d74,test,_d76){
var _d77="";
_d77=window.setInterval(function(){
if(eval(test)){
if(_d76!=null){
_d74(_d76);
}else{
_d74();
}
window.clearInterval(_d77);
}
},300);
},getBaseURL:function(_d78){
var _d79=lconn.core.bizCard.bizCardUtils.getService(_d78);
if(_d79!=null&&_d79.baseURL!=null){
return _d79.baseURL;
}else{
return this.baseUrl;
}
},buildBaseURL:function(_d7a){
var _d7b=_d7a.indexOf("//")+2;
var _d7c=_d7a.substring(0,_d7b);
var _d7d=_d7a.substring(_d7b,_d7a.length);
_d7b=_d7d.indexOf("/")+1;
var _d7e=_d7d.substring(0,_d7b);
_d7d=_d7d.substring(_d7b,_d7d.length);
_d7b=_d7d.indexOf("/");
var _d7f=_d7d.substring(0,_d7b);
_d7d=_d7d.substring(_d7b,_d7d.length);
var _d80=_d7c+_d7e+_d7f;
return _d80;
},getURL:function(_d81,_d82,_d83,_d84){
var temp={};
var _d86=location.protocol+"//"+location.host;
var s=document.getElementsByTagName(_d82);
var _d88="";
var _d89=null;
for(var i=0;i<s.length;i++){
var src=s[i].getAttribute(_d84);
if(src&&src.indexOf(_d81)!=-1){
_d89=src;
_d88=src.substring(0,src.indexOf(_d83));
if(_d83==null){
_d88=this.buildBaseURL(src);
temp.baseUrl=_d88;
}
temp.resourceFound=true;
break;
}
}
if(temp.baseUrl=="undefined"){
temp.baseUrl=(_d88==_d86)?_d83:_d88+_d83;
}
return temp;
},getUrlParam:function(_d8c){
var _d8d=unescape(window.location);
if(_d8d.indexOf(_d8c)==-1){
return null;
}else{
var _d8e=_d8d.substring(_d8d.indexOf(_d8c+"=")+_d8c.length+1);
var _d8f=_d8e.indexOf("&");
if(_d8f!=-1){
_d8e=_d8e.substring(0,_d8f);
}
return _d8e;
}
},getProxifiedURL:function(url,_d91,_d92){
for(var key in _d91){
var _d94=new RegExp("@@@"+key+"@@@");
var val=_d91[key];
url=url.replace(_d94,val);
}
url=this.appendAppChkSum(url);
if(this._haveProxy){
return this._proxyHelper.getProxifiedURL(url);
}
return url+"&callback="+_d92;
},_timeout:10000,getBizCardData:function(url,_d97,_d98,_d99,_d9a,_d9b,_d9c){
var url=this.getProxifiedURL(url,_d97,_d98);
if(this._haveProxy){
var _d9d=function(_d9e){
var data=dojo.fromJson(_d9e.replace(/^\s*while\(1\);/,""));
_d9a(true,data,_d9b);
};
var _da0=function(_da1){
_d9a(false,data,_d9b);
};
dojo.xhrGet({url:url,timeout:this._timeout,load:_d9d,error:_da0});
}else{
_d99.request(url,this._timeout,_d9a,_d9b,_d9c);
}
},out:function(){
this.buffer="";
this.write=function(str){
this.buffer+=str;
};
},hasRule:function(_da3){
var _da4=document.styleSheets;
if(_da4&&_da4.length){
for(var i=0;i<_da4.length;i++){
var _da6=_da4[i];
var _da7=_da6.cssRules||_da6.rules;
if(_da7&&_da7.length){
for(var j=0;j<_da7.length;j++){
var rule=_da7[j];
if(rule&&rule.selectorText==_da3){
return true;
}
}
}
}
}
return false;
},loadCssIfNeeded:function(){
if(!this.hasRule(".lotusVCard")){
if(window.SemTagSvcConfig!=null&&SemTagSvcConfig.isBidiRTL){
this.loadCss(this.baseUrl+"/nav/common/styles/base/standaloneVcardRTL.css");
}else{
this.loadCss(this.baseUrl+"/nav/common/styles/base/standaloneVcard.css");
}
this.loadCss(this.baseUrl+"/nav/common/styles/base/semanticTagStyles.css");
this.standaloneCSSloaded=true;
}
},getSinglePropertyValue:function(prop){
if(!prop){
return false;
}
var _dab=prop.innerHTML.replace(/<[a-zA-Z\/][^>]*>/gi,"");
return _dab;
},sortByOrder:function(a,b){
if(a.order>b.order){
return 1;
}else{
if(a.order<b.order){
return -1;
}else{
return 0;
}
}
},getElementsByClassName:function(_dae,_daf,_db0,_db1){
if(!_daf){
_daf=document.body;
}
if(!_db0){
limit=0;
}
if(!_db1){
_db1=["*"];
}
var _db2=new RegExp("(^|\\s)"+_dae+"(\\s|$)");
if(_daf&&_daf.className&&_daf.className.match(_db2)){
return new Array(_daf);
}
var _db3=new Array();
for(var t=0;t<_db1.length;t++){
var _db5=_daf.getElementsByTagName(_db1[t]);
for(var i=0;i<_db5.length;i++){
var _db7=_db5[i];
if(_db7.className.match(_db2)){
_db3.push(_db7);
}
if(0<_db0&&_db0==_db3.length){
break;
}
}
}
return _db3;
},getParentByClassName:function(_db8,_db9){
if(!_db9){
return null;
}
var _dba=new RegExp("(^|\\s)"+_db8+"(\\s|$)");
if(_db9.className&&_db9.className.match(_dba)){
return _db9;
}
while(_db9.parentNode){
_db9=_db9.parentNode;
if(_db9.className&&_db9.className.match(_dba)){
return _db9;
}
}
},addHover:function(elem,_dbc,_dbd,_dbe){
while(typeof SemTagMenu==undefined){
alert("waiting...");
}
var _dbf=elem.getAttribute(this.refcntAttr);
if(_dbf){
elem.setAttribute(this.refcntAttr,parseInt(Number(_dbf)+1));
if(SemTagMenu.staticHover){
var img=SemTagMenu.findHoverFromLiveElement(elem);
if(img){
dojo.connect(img,"onclick",_dbd);
img.setAttribute("href","javascript:a11y()");
}else{
alert("couldn't find the hover for this element!");
}
}else{
dojo.connect(elem,"onmouseover",_dbc);
dojo.connect(elem,"onfocus",_dbc);
}
}else{
elem.setAttribute(this.refcntAttr,"1");
if(SemTagMenu.staticHover){
var img=this.createHoverImage();
dojo.connect(img,"onclick",_dbd);
img.setAttribute("href","javascript:a11y()");
var _dc1=elem.nextSibling;
if(_dc1){
_dc1.parentNode.insertBefore(img,_dc1);
}else{
elem.parentNode.appendChild(img);
}
elem.setAttribute(this.hoverIdPrefix+"idx",parseInt(this.hoverIdx));
elem.id=this.liveElemPrefix+this.hoverIdx;
}else{
var _dc2=dojo.isFF?elem.getAttribute("class"):elem.className;
if(_dc2&&0<_dc2.length){
_dc2+=" hasHover";
}else{
_dc2="hasHover";
}
if(dojo.isFF){
elem.setAttribute("class",_dc2);
}else{
elem.className=_dc2;
}
dojo.connect(elem,"onmouseover",_dbc);
dojo.connect(elem,"onfocus",_dbc);
}
if(_dbe!=null){
dojo.connect(elem,"onkeydown",_dbe);
}
}
},createHoverImage:function(){
var img=document.createElement("img");
this.hoverIdx++;
img.id=this.hoverIdPrefix+this.hoverIdx;
img.className=SemTagMenu.iconName;
img.setAttribute("src",this.baseUrl+"/images/menu_selected_hover.gif");
img.setAttribute("border","0");
var link=document.createElement("a");
dojo.connect(link,"onfocus",SemTagMenu.activateHover);
dojo.connect(link,"onmouseover",SemTagMenu.activateHover);
dojo.connect(link,"onmouseout",SemTagMenu.deactivateHover);
link.appendChild(img);
return link;
},showHover:function(_dc5,_dc6){
try{
SemTagMenu.showHover(_dc5,_dc6);
}
catch(e){
console.log("Error in lconn.core.bizCard.bizCardUtils.showHover");
console.log(e);
}
},setMenuData:function(_dc7,_dc8,_dc9,_dca,_dcb){
SemTagMenu.setMenuData(_dc7,_dc8,_dc9,_dca,_dcb);
},getMenuItemJson:function(_dcc,href,_dce,icon){
var o=_dce?_dce:0;
var i=icon?icon:"";
return {"label":_dcc,"href":href,"order":o,"icon":i};
},getMenuHeaderJson:function(_dd2,_dd3){
return {"markup":_dd2,"order":_dd3};
},getMenuFooterJson:function(_dd4,_dd5){
return {"markup":_dd4,"order":_dd5};
},getElementFromEvent:function(_dd6){
return _dd6.target?_dd6.target:_dd6.srcElement;
},getLiveElementFromEvent:function(_dd7){
return SemTagMenu.findLiveElementFromEventSource(this.getElementFromEvent(_dd7));
},getEventAbsoluteX:function(e){
var x=0;
if(e.pageX){
x=e.pageX;
}else{
if(e.clientX){
x=e.clientX+document.body.scrollLeft;
}
}
return x;
},getEventAbsoluteY:function(e){
var y=0;
if(e.pageY){
y=e.pageY;
}else{
if(e.clientY){
y=e.clientY+document.body.scrollTop;
}
}
return y;
},findPosition:function(obj){
var _ddd=0,posX=0,posY=0;
var _de0=1400*1;
if(obj.offsetParent){
if(obj.currentStyle){
posY+=obj.offsetHeight-parseInt(this.getStyle(obj,"paddingBottom"));
}else{
if(window.getComputedStyle){
posY+=obj.offsetHeight-parseInt(this.getStyle(obj,"padding-bottom"));
}
}
while(obj!=null){
if(obj.offsetLeft>=_de0&&SemTagSvcConfig.isBidiRTL){
posX+=obj.offsetLeft-250;
}else{
posX+=obj.offsetLeft;
}
posY+=obj.offsetTop;
obj=obj.offsetParent;
_ddd++;
}
return [posX,posY];
}else{
return [obj.x,obj.y];
}
},getStyle:function(node,_de2){
var _de3;
if(window.getComputedStyle){
_de3=document.defaultView.getComputedStyle(node,null).getPropertyValue(_de2);
}else{
if(node.currentStyle){
_de3=node.currentStyle[_de2];
}
}
return _de3;
},createGroupJson:function(ctx,exts){
return {"context":ctx,"extenders":exts};
},createActionJson:function(id,ctx,_de8,desc,url,_deb){
var o=parseInt(_deb);
return {"id":id,"context":ctx,"label":_de8,"description":desc,"url":url,"order":o};
},parseOrder:function(_ded){
if(_ded==null||_ded.length==0){
return 0;
}
if(_ded.charAt(0)=="-"){
return parseInt(_ded.substr(1))*-1;
}else{
return parseInt(_ded);
}
},_langParamValue:"",getLangParam:function(){
if(this._langParamValue==""){
if(window.djConfig!=null&&djConfig.locale!=null){
this._langParamValue=djConfig.locale;
return this._langParamValue;
}
var _dee="lcLang";
if(typeof (profilesData)!="undefined"&&typeof (profilesData.config)!="undefined"&&typeof (profilesData.config.langCookieName)!="undefined"){
_dee=profilesData.config.langCookieName;
}
var _def=dojo.cookie(_dee);
if(_def==null||_def==""){
_def=this.getUrlParam("lang");
}
if(_def==null||_def==""){
if(typeof (navigator.language)!="undefined"){
_def=navigator.language;
}else{
if(typeof (navigator.browserLanguage)!="undefined"){
_def=navigator.browserLanguage;
}
}
}
var _df0=/(\w\w){1}([\-_]\w\w){0,2}/i;
if(_def!=null&&!_def.match(_df0)){
_def=null;
}
if(_def==null||_def==""){
_def="en";
}
_def=_def.replace(/\-/g,"_");
_def=_def.toLowerCase();
this._langParamValue=_def;
}
return this._langParamValue;
},getTextValue:function(elem){
if(!elem){
return "";
}
return elem.innerHTML.replace(/<[a-zA-Z\/][^>]*>/gi,"");
},getTypedValue:function(elem,_df3){
if(!_df3){
_df3="def";
}
var _df4=new Array();
var _df5=this.getElementsByClassName("type",elem);
var _df6=this.getElementsByClassName("value",elem);
var _df7="";
if(_df6.length<1){
_df7=this.getTextValue(elem);
}
for(i=0;i<_df6.length;i++){
_df7+=this.getTextValue(_df6[i]);
}
if(_df5.length<1){
_df4[_df3]=_df7;
}else{
for(j=0;j<_df5.length;j++){
var _df8=_df5[j];
var type=_df8.tagName.match(/^abbr$/i)?_df8.getAttribute("title"):this.getTextValue(_df8);
_df4[type.toLowerCase()]=_df7;
}
}
return _df4;
},findNameElementInHcard:function(elem){
if(elem.className!="vcard"){
elem=this.getParentByClassName("vcard",elem);
}
var _dfb=this.getElementsByClassName("fn",elem)[0];
if(!_dfb){
_dfb=this.getElementsByClassName("n",elem)[0];
}
return _dfb;
},findElementByNameInHcard:function(elem,name){
if(elem.className!="vcard"){
elem=this.getParentByClassName("vcard",elem);
}
return this.getElementsByClassName(name,elem)[0];
},loadScript:function(_dfe){
var _dff=this.getLangParam();
if(_dfe.indexOf("lang=")!=-1&&_dff!=null){
_dfe=_dfe.substring(0,_dfe.indexOf("lang"))+"lang="+_dff;
}else{
if(_dfe.indexOf("resourcebundle")!=-1&&_dff!=null){
_dfe=_dfe+"&lang="+_dff;
}
if(_dfe.indexOf("resourceStrings")!=-1&&_dff!=null){
_dfe=_dfe+"&lang="+_dff;
}
if(_dfe.indexOf("js-resources.js")!=-1&&_dff!=null){
_dfe=_dfe+((_dfe.indexOf("?")!=-1)?"&":"?")+"lang="+_dff;
}
}
_dfe=this.appendAppChkSum(_dfe);
if(!this.scripts[_dfe]){
this.scripts[_dfe]=true;
var _e00=document.createElement("script");
_e00.src=_dfe;
document.body.insertBefore(_e00,document.body.firstChild);
}
},loadCss:function(css){
css=this.appendAppChkSum(css);
if(!this.css[css]){
var head=document.getElementsByTagName("head");
if(head[0]){
this.css[css]=true;
var _e03=document.createElement("link");
_e03.rel="stylesheet";
_e03.href=css;
_e03.type="text/css";
_e03.media="screen";
head[0].appendChild(_e03);
}
}
},toggleInlineCard:function(pDiv){
var _e05=document.getElementById(pDiv+"_Pivot");
var _e06=document.getElementById(pDiv+"_Details");
if(_e05!=null&&_e06!=null){
if(_e05.className.indexOf("lotusPivotNavOpen")!=-1){
_e05.className="lotusPivotNav";
_e06.style.display="none";
}else{
_e05.className="lotusPivotNav lotusPivotNavOpen";
_e06.style.display="block";
}
}
}};
window.SemTagMenu={isDebug:false,staticHover:false,id:"semtagmenu",hideDelay:3000,showDelay:500,timeouts:new Array(),iconName:"menu_drop_icon",showing:false,currentElem:null,refCount:-1,tabOrderByDomNodeOrder:0,tabOrderByTabIndex:0,elemOrigTabIdx:null,elemTempTabIdx:1000,elemNext:null,svcHandlers:new Array(),items:new Array(),headers:new Array(),footers:new Array(),hoverIdRE:null,iconNameRE:new RegExp("(^|\\s)menu_drop_icon(\\s|$)"),initited:false,init:function(){
if(this.initited==false){
SemTagMenu.hoverIdRE=new RegExp(lconn.core.bizCard.bizCardUtils.hoverIdPrefix);
dojo.connect(document,"onclick",SemTagMenu.click);
dojo.connect(document,"onkeydown",SemTagMenu.catchEscape);
this.initited=true;
}
},activateFocus:function(_e07){
lconn.core.bizCard.bizCardUtils.activateHover(_e07);
},activateHover:function(_e08){
var _e09=lconn.core.bizCard.bizCardUtils.getElementFromEvent(_e08);
if(_e09){
_e09.src=lconn.core.bizCard.bizCardUtils.baseUrl+"/images/menu_selected_hover.gif";
}
SemTagMenu.setCurrentElement(SemTagMenu.findLiveElementFromEventSource(_e09));
},deactivateHover:function(_e0a){
var _e0b=lconn.core.bizCard.bizCardUtils.getElementFromEvent(_e0a);
if(_e0b){
_e0b.src=lconn.core.bizCard.bizCardUtils.baseUrl+"/images/menu_selected_hover.gif";
}
SemTagMenu.setCurrentElement(null);
},showHover:function(_e0c,_e0d){
try{
if(SemTagMenu.staticHover){
return;
}
var elem=lconn.core.bizCard.bizCardUtils.getElementFromEvent(_e0c);
SemTagMenu.elemOrigTabIdx=elem.getAttribute("tabIndex");
if(SemTagMenu.tabOrderByTabIndex&&!SemTagMenu.elemOrigTabIdx){
SemTagMenu.elemNext=elem.nextSibling;
elem.setAttribute("tabIndex",parseInt(Number(SemTagMenu.elemTempTabIdx)));
}
var tag=SemTagMenu.getMenuTag(elem);
var _e10=0;
if(elem&&elem!=SemTagMenu.currentElem){
SemTagMenu.clearAllSvcHandlers(tag);
_e10=elem.getAttribute(lconn.core.bizCard.bizCardUtils.refcntAttr);
if(_e10){
SemTagMenu.setCurrentElement(elem);
}else{
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("SemTagMenu.showHover called for a DOM element with no refcnt attribute!");
}
SemTagMenu.setCurrentElement(null);
return;
}
}
SemTagMenu.addSvcHandler(tag,_e0d);
SemTagMenu.setRefCount(_e10);
if(SemTagMenu.showing&&tag.style.display!="none"){
return;
}
SemTagMenu.showing=false;
var out=new lconn.core.bizCard.bizCardUtils.out();
SemTagMenu.writeHover(out,"ltr",elem);
tag.innerHTML=out.buffer;
var pos=SemTagMenu.currentElemPosition;
SemTagMenu.show(SemTagMenu.id,_e0c,pos[0]+SemTagMenu.hoverOffset[0],pos[1]+SemTagMenu.hoverOffset[1],SemTagMenu.hoverDimension[0],SemTagMenu.hoverDimension[1]);
}
catch(e){
console.log("Error in SemTagMenu.showHover");
console.log(e);
}
},addSvcHandler:function(tag,_e14){
SemTagMenu.svcHandlers.push(dojo.connect(tag,"onclick",_e14));
},clearAllSvcHandlers:function(tag){
while(0<SemTagMenu.svcHandlers.length){
var _e16=SemTagMenu.svcHandlers.pop();
if(_e16){
dojo.disconnect(_e16);
}
}
},setCurrentElement:function(elem){
if(elem!=null){
SemTagMenu.currentElem=elem;
SemTagMenu.currentElemPosition=lconn.core.bizCard.bizCardUtils.findPosition(elem);
SemTagMenu.setRefCount(elem?Number(elem.getAttribute(lconn.core.bizCard.bizCardUtils.refcntAttr)):0);
while(0<SemTagMenu.headers.length){
SemTagMenu.headers.pop();
}
while(0<SemTagMenu.items.length){
SemTagMenu.items.pop();
}
while(0<SemTagMenu.footers.length){
SemTagMenu.footers.pop();
}
}
},setRefCount:function(cnt){
SemTagMenu.refCount=cnt;
},setMenuData:function(_e19,_e1a,_e1b,_e1c,_e1d){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("Menu.setMenuData: items.length="+_e1a.length);
}
if(!SemTagMenu.staticHover&&SemTagMenu.refCount<0){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("setMenuData called when refCount="+SemTagMenu.refCount);
}
return;
}
var elem=SemTagMenu.findLiveElementFromEventSource(lconn.core.bizCard.bizCardUtils.getElementFromEvent(_e19));
if(!elem){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("setMenuData called on a null live element");
}
return;
}
if(SemTagMenu.staticHover&&(elem!=SemTagMenu.currentElem||SemTagMenu.showing)){
SemTagMenu.setCurrentElement(elem);
}
for(var i=0;i<_e1a.length;i++){
SemTagMenu.items.push(_e1a[i]);
}
if(_e1b){
SemTagMenu.currentMenuCss=_e1b;
}
if(_e1c){
SemTagMenu.headers.push(_e1c);
}
if(_e1d){
SemTagMenu.footers.push(_e1d);
}
SemTagMenu.stopEvent(_e19);
SemTagMenu.showMenu();
},getCurrentElement:function(){
return SemTagMenu.currentElem;
},showMenu:function(){
SemTagMenu.items.sort(lconn.core.bizCard.bizCardUtils.sortByOrder);
if(1<SemTagMenu.headers.length){
SemTagMenu.headers.sort(lconn.core.bizCard.bizCardUtils.sortByOrder);
}
if(1<SemTagMenu.footers.length){
SemTagMenu.footers.sort(lconn.core.bizCard.bizCardUtils.sortByOrder);
}
var out=new lconn.core.bizCard.bizCardUtils.out();
SemTagMenu.startMenu(out,"ltr");
if(0<SemTagMenu.headers.length){
SemTagMenu.writeHeader(out,SemTagMenu.headers[0],"ltr");
}
SemTagMenu.startActionSection(out,"ltr",SemTagMenu.currentMenuCss);
for(var i=0;i<SemTagMenu.items.length;i++){
SemTagMenu.writeMenuItem(out,SemTagMenu.items[i],"ltr");
}
SemTagMenu.endActionSection(out,"ltr");
if(0<SemTagMenu.footers.length){
SemTagMenu.writeFooter(out,SemTagMenu.footers[0],"ltr");
}
SemTagMenu.endMenu(out,"ltr");
var tag=SemTagMenu.getMenuTag();
SemTagMenu.clearAllSvcHandlers(tag);
SemTagMenu.offScreen(tag);
tag.innerHTML=out.buffer;
SemTagMenu.showing=true;
SemTagMenu.defaultCursor();
if(SemTagMenu.staticHover&&dojo.isFF){
var _e23=tag.getElementsByTagName("a");
if(0<_e23.length){
_e23[0].focus();
}
}
var _e24={"target":SemTagMenu.currentElem};
var pos=SemTagMenu.currentElemPosition;
SemTagMenu.show(SemTagMenu.id,_e24,pos[0]+SemTagMenu.menuOffset[0],pos[1]+SemTagMenu.menuOffset[1],tag.offsetWidth,tag.offsetHeight);
},getMenuTag:function(elem){
var tag=document.getElementById(SemTagMenu.id);
if(!tag){
tag=document.createElement((SemTagMenu.tabOrderByDomNodeOrder?"div":"span"));
tag.setAttribute("id",SemTagMenu.id);
tag.style.position=(SemTagMenu.tabOrderByDomNodeOrder?"fixed":"absolute");
tag.style.display="none";
if(SemTagMenu.tabOrderByTabIndex&&typeof (elem)!="undefined"&&elem!=null){
var _e28=elem.getAttribute("tabIndex");
if(SemTagMenu.tabOrderByTabIndex&&_e28){
tag.setAttribute("tabIndex",parseInt(Number(_e28)+1));
}
}
dojo.connect(tag,"onmouseout",SemTagMenu.mouseout);
dojo.connect(tag,"onmouseover",SemTagMenu.mouseover);
dojo.connect(tag,"onfocus",SemTagMenu.focus);
if(SemTagMenu.tabOrderByTabIndex){
dojo.connect(tag,"keydown",SemTagMenu.keydown);
}
if(SemTagMenu.tabOrderByDomNodeOrder){
if(elem){
elem.parentNode.appendChild(tag);
}else{
document.body.insertBefore(tag,document.body.firstChild);
}
}else{
document.body.insertBefore(tag,document.body.firstChild);
}
}else{
if(SemTagMenu.tabOrderByTabIndex&&typeof (elem)!="undefined"&&elem!=null){
var _e28=elem.getAttribute("tabIndex");
if(_e28){
tag.setAttribute("tabIndex",parseInt(Number(_e28)+1));
}
}else{
if(SemTagMenu.tabOrderByDomNodeOrder){
if(elem){
elem.parentNode.appendChild(tag);
}
}
}
}
return tag;
},show:function(_e29,e,xpos,ypos,_e2d,_e2e){
SemTagMenu.clearTimeouts();
var _e2f=document.getElementById(_e29);
if(_e2d==null){
_e2d=0;
}
if(_e2e==null){
_e2e=0;
}
var top,left;
if(xpos!=null&&ypos!=null){
var top=ypos;
var left=xpos;
}else{
var top=lconn.core.bizCard.bizCardUtils.getEventAbsoluteY(e);
var left=lconn.core.bizCard.bizCardUtils.getEventAbsoluteX(e);
}
var vSrc=(e.target)?e.target:e.srcElement;
var _e33,_e34,d=document;
if(typeof window.innerWidth!="undefined"){
_e33=window.innerWidth;
_e34=window.innerHeight;
}else{
if(d.documentElement&&typeof d.documentElement.clientWidth!="undefined"&&d.documentElement.clientWidth!=0){
_e33=d.documentElement.clientWidth;
_e34=d.documentElement.clientHeight;
}else{
if(d.body&&typeof d.body.clientWidth!="undefined"){
_e33=d.body.clientWidth;
_e34=d.body.clientHeight;
}
}
}
var _e36=(document.body.scrollLeft>document.documentElement.scrollLeft)?document.body.scrollLeft:document.documentElement.scrollLeft;
if((left+_e2d)>(_e33+_e36)){
var _e37=(left+_e2d)-_e33-_e36;
left-=_e37;
}
var _e38=(document.body.scrollTop>document.documentElement.scrollTop)?document.body.scrollTop:document.documentElement.scrollTop;
if((top+_e2e)>(_e34+_e38)){
var _e37=(top+_e2e)-_e34-_e38;
top-=_e37;
}
_e2f.style.top=top+"px";
_e2f.style.left=left+"px";
_e2f.style.display="block";
var _e39=document.getElementById("tempIframe");
if(_e39==null){
_e39=document.createElement("iframe");
_e39.setAttribute("id","tempIframe");
_e39.setAttribute("frameBorder","no");
_e39.setAttribute("scrolling","no");
_e39.setAttribute("src",lconn.core.bizCard.bizCardUtils.baseUrl+"/nav/blankIE.html");
_e39.style.position="absolute";
_e39.style.left=left+"px";
_e39.style.top=top+"px";
_e39.width=(_e2f.offsetWidth).toString()+"px";
_e39.height=(_e2f.offsetHeight).toString()+"px";
_e39.style.display="block";
_e39.style.zIndex="899";
document.body.appendChild(_e39);
}else{
_e39.style.left=left+"px";
_e39.style.top=top+"px";
_e39.width=(_e2f.offsetWidth).toString()+"px";
_e39.height=(_e2f.offsetHeight).toString()+"px";
_e39.style.display="block";
}
var _e3a=document.getElementById("A11Yblank");
if(_e3a){
_e3a.focus();
}else{
if(typeof (SemTagMenu.startHideTimer)!="undefined"){
SemTagMenu.startHideTimer(_e29);
}
}
},hide:function(_e3b,e){
var tag=SemTagMenu.getMenuTag();
if(!tag){
return false;
}
tag.style.display="none";
SemTagMenu.showing=false;
SemTagMenu.setCurrentElement(null);
SemTagMenu.clearAllSvcHandlers(tag);
SemTagMenu.defaultCursor();
var elem=SemTagMenu.getCurrentElement();
if(SemTagMenu.tabOrderByTabIndex&&elem&&elem.getAttribute("tabIndex")){
tag.setAttribute("tabIndex",null);
elem.setAttribute("tabIndex",SemTagMenu.elemOrigTabIdx);
}
var _e3f=document.getElementById("tempIframe");
if(_e3f!=null){
_e3f.style.display="none";
}
return true;
},offScreen:function(_e40){
_e40.style.top="-1000px";
_e40.style.left="-1000px";
_e40.style.display="block";
},findLiveElementFromEventSource:function(_e41){
if(SemTagMenu.staticHover){
var id=_e41.id;
if(!id.match(SemTagMenu.hoverIdRE)){
var _e43=_e41.getElementsByTagName("img");
for(var i=0;i<_e43.length;i++){
if(_e43[i].id&&_e43[i].id.match(SemTagMenu.hoverIdRE)){
id=_e43[i].id;
break;
}
}
}
var idx=id.substr(lconn.core.bizCard.bizCardUtils.hoverIdPrefix.length);
return document.getElementById(lconn.core.bizCard.bizCardUtils.liveElemPrefix+idx);
}else{
var _e46=SemTagMenu.getCurrentElement();
return _e46?_e46:_e41;
}
},findHoverFromLiveElement:function(_e47){
var idx=_e47.getAttribute(lconn.core.bizCard.bizCardUtils.hoverIdPrefix+"idx");
return document.getElementById(lconn.core.bizCard.bizCardUtils.hoverIdPrefix+idx);
},inMenu:function(_e49,_e4a,_e4b,_e4c){
if(!_e49){
return false;
}
if(!SemTagMenu.showing){
return false;
}
if(!_e4b){
_e4b=0;
}
if(!_e4c){
_e4c=0;
}
var _e4d=lconn.core.bizCard.bizCardUtils.getEventAbsoluteX(_e4a);
var _e4e=lconn.core.bizCard.bizCardUtils.getEventAbsoluteY(_e4a);
var _e4f=_e49.style.left.replace(/px$/,"");
var _e50=_e49.style.top.replace(/px$/,"");
var sumX=parseInt(_e4f)+parseInt(_e49.clientWidth);
var sumY=parseInt(_e50)+parseInt(_e49.clientHeight);
if((_e4d-1<=(_e4f-_e4b))||(_e4e-1<=(_e50-_e4c))||(_e4d>=(sumX+_e4b))||(_e4e>=(sumY+_e4c))){
return false;
}else{
return true;
}
},mouseout:function(_e53){
var _e54=SemTagMenu.id;
menuElem=document.getElementById(_e54);
if(SemTagMenu.inMenu(menuElem,_e53)){
}else{
if(typeof (SemTagMenu.startHideTimer)!="undefined"){
SemTagMenu.startHideTimer(_e54);
}
}
},mouseover:function(_e55){
SemTagMenu.clearTimeouts();
},focus:function(_e56){
SemTagMenu.mouseover(_e56);
},unfocus:function(_e57){
SemTagMenu.mouseout(_e57);
},click:function(_e58){
if(!_e58){
return;
}
var _e59=lconn.core.bizCard.bizCardUtils.getElementFromEvent(_e58);
if(_e59.className!="javlinHover"){
menuElem=document.getElementById(SemTagMenu.id);
if(!SemTagMenu.inMenu(menuElem,_e58)){
SemTagMenu.hide(SemTagMenu.id);
}
}
},keydown:function(_e5a){
SemTagMenu.catchEscape(_e5a);
SemTagMenu.catchTab(_e5a);
},catchEscape:function(_e5b){
if(_e5b.keyCode==27){
SemTagMenu.hide(SemTagMenu.id);
}
},catchTab:function(_e5c){
if(_e5c.keyCode==9){
if(SemTagMenu.elemNext&&typeof (SemTagMenu.elemNext.focus)!="undefined"){
SemTagMenu.elemNext.focus();
}
SemTagMenu.hide(SemTagMenu.id);
}
},simulateClick:function(_e5d){
if(_e5d.ctrlKey&&_e5d.keyCode==13){
if(_e5d.preventDefault){
_e5d.preventDefault();
}
var evt=null;
if(document.createEvent){
evt=document.createEvent("MouseEvents");
}
if(evt&&evt.initMouseEvent){
evt.initMouseEvent("click",true,true,document.defaultView,1,0,0,0,0,false,false,false,false,0,null);
}
var _e5f=document.getElementById(SemTagMenu.id);
if(_e5f.dispatchEvent){
_e5f.dispatchEvent(evt);
}else{
if(_e5f.fireEvent){
_e5f.fireEvent("onclick");
}
}
}
},stopEvent:function(_e60){
if(!_e60){
return;
}
if(dojo.isFF){
if(_e60.preventDefault==null){
_e60=_e60.original;
}
_e60.preventDefault();
_e60.stopPropagation();
}else{
try{
if(_e60.returnValue==null){
_e60=_e60.original;
}
_e60.returnValue=false;
_e60.cancelBubble=true;
}
catch(e){
}
}
},startHideTimer:function(_e61){
if(0<SemTagMenu.hideDelay){
SemTagMenu.timeouts.push(window.setTimeout("SemTagMenu.endHideTimer(\""+_e61+"\")",SemTagMenu.hideDelay));
}
},endHideTimer:function(_e62){
menuElem=document.getElementById(_e62);
SemTagMenu.hide(_e62);
},clearTimeouts:function(){
for(i=0;i<SemTagMenu.timeouts.length;i++){
window.clearTimeout(SemTagMenu.timeouts[i]);
}
},defaultCursor:function(){
document.body.style.cursor="default";
},waitCursor:function(){
document.body.style.cursor="wait";
},clickCursor:function(){
document.body.style.cursor="pointer";
}};
SemTagMenu.defaultLoaded=true;
SemTagMenu.hoverDimension=[14,14];
SemTagMenu.hoverOffset=[15,3];
SemTagMenu.menuOffset=[15,0];
SemTagMenu.writeHover=function(out,bidi,elem){
if(window.semtagrs!=null){
var _e65="z-index: 900; opacity: 1;";
if(window.SemTagSvcConfig!=null&&SemTagSvcConfig.isBidiRTL){
_e65+="padding:2px 25px 2px 3px; background-position:96% center;";
}
var _uid = lconn.profiles.bizCard.bizCard.getElementUserId(elem);
if (!lconn.core.bizCard.bizCardUtils.checkUid(_uid)) // false for disabled profile , true for active profile
	out.write("<div class='javlinHover' "+" onmouseover='javascript:SemTagMenu.defaultCursor();'"+" onmouseout='javascript:SemTagMenu.defaultCursor();'"+" style='"+_e65+"' "+" title='"+semtagrs["label.semtag.hover.disabled"]+"' "+">"+semtagrs["label.semtag.hover.disabled"]+"</div>");			
else		
	out.write("<div class='javlinHover' "+" onmouseover='javascript:SemTagMenu.clickCursor();'"+" onmouseout='javascript:SemTagMenu.defaultCursor();'"+" style='"+_e65+"' "+" title='"+semtagrs["label.semtag.hover"]+"' "+">"+semtagrs["label.semtag.hover"]+"</div>");				
}else{
console.log("SemTagMenu.writeHover: semtagrs is null. Need for strings");
}
};
SemTagMenu.startMenu=function(out,bidi){
out.write("<div class='popupPersonCard' style='z-index: 900;'>");
};
SemTagMenu.writeHeader=function(out,_e69,bidi){
out.write(_e69.markup);
};
SemTagMenu.startActionSection=function(out,bidi,_e6d){
out.write("<a href='javascript:a11y()'><a>");
if(!_e6d){
_e6d="personMenuActions";
}
out.write("<div class='"+_e6d+"'>");
out.write("<ul>");
};
SemTagMenu.writeMenuItem=function(out,item,bidi){
out.write("<li><a href='"+item.href+"'>"+item.label+"</a></li>");
};
SemTagMenu.endActionSection=function(out,bidi){
out.write("</ul>");
out.write("</div>");
};
SemTagMenu.writeFooter=function(out,_e74,bidi){
out.write(_e74.markup);
};
SemTagMenu.endMenu=function(out,bidi){
out.write("</div>");
};
window.SemTagUtil={crossDomainRequest:function(){
var _e78=new Array();
var _e79=new Array();
var _e7a=new Array();
var self=this;
createTimeoutFunction=function(_e7c){
return function(){
self.cancelRequest(_e7c);
};
};
this.getScriptId=function(id){
return "_JVLN_"+id;
};
this.getScriptObject=function(id){
return document.getElementById(this.getScriptId(id));
};
this.cloneObject=function(obj){
var _e80=new Object();
for(i in obj){
_e80[i]=obj[i];
}
return _e80;
};
this.request=function(url,_e82,_e83,_e84,_e85){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("SemTagUtil.request: started");
}
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("SemTagUtil.request: connectionId "+_e85);
}
_e85=_e85.toLowerCase();
var _e86=this.getScriptId(_e85);
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("SemTagUtil.request: objId "+_e86);
}
if(_e83!=null){
_e78[_e85]=_e83;
}
if(_e84!=null){
if(!dojo.isFF){
_e79[_e85]=this.cloneObject(_e84);
}else{
_e79[_e85]=_e84;
}
}
var _e87=document.createElement("script");
_e87.id=_e86;
_e87.type="text/javascript";
_e87.defer=true;
try{
_e87.src=url;
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("SemTagUtil.request: url: "+url);
}
}
catch(e){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("SemTagUtil.request: error:",e);
}
return false;
}
try{
var body=document.getElementsByTagName("body");
if(body[0]){
body[0].appendChild(_e87);
}else{
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("SemTagUtil.request: error getting body element to insert script:"+_e87.id);
}
return false;
}
}
catch(e){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("SemTagUtil.request: error:",e);
}
return false;
}
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("SemTagUtil.request: added script: "+_e87.id);
}
if(_e82){
var self=this;
_e7a[_e85]=window.setTimeout(createTimeoutFunction(_e85),_e82);
}
};
this.cancelRequest=function(id){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("SemTagUtil.cancelRequest:  Request ["+id+"] took too long.  Cancelling request for id: "+_e7a[id]);
}
var _e8b=_e78[id];
_e78[id]=null;
var _e8c=_e79[id];
_e79[id]=null;
if(_e8b!=null){
try{
if(_e8b){
_e8b(false,null,_e8c);
}
this.removeScript(id);
}
catch(e){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("SemTagUtil.cancelRequest: Exception Caught: "+e);
}
}
}else{
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("SemTagUtil.cancelRequest: no callback for : "+id);
}
}
};
this.removeScript=function(id){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("SemTagUtil.removeScript: removing script element for: "+id);
}
if(id){
var _e8e=this.getScriptObject(id);
if(_e8e!=null){
var body=document.getElementsByTagName("body");
body[0].removeChild(_e8e);
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("SemTagUtil.removeScript: removed script for id: "+id);
}
}else{
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("SemTagUtil.removeScript: script is null for id: "+id);
}
}
}else{
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("SemTagUtil.removeScript: id is null");
}
}
};
this.dispatch=function(id,data){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("SemTagUtil.dispatch: id: "+id);
}
if(id!=null){
id=id.toLowerCase();
}
try{
if(id!=null&&typeof (_e7a[id])!="undefined"&&_e7a[id]!=null){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("request dispatched. removing timeout for id ["+id+"]  timeout id: "+_e7a[id]);
}
window.clearTimeout(_e7a[id]);
}
var _e92=_e78[id];
var _e93=_e79[id];
_e79[id]=null;
if(_e92!=null){
_e78[id]=null;
_e92(true,data,_e93);
window.setTimeout(function(){
self.removeScript(id);
},1000);
}else{
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("SemTagUtil.dispatch: callback is null for id: "+id);
}
}
}
catch(e){
console.log("SemTagUtil.dispatch: Exception Caught: ");
console.log(e);
}
};
}};
}
if(!dojo._hasResource["lconn.communities.bizCard.bizCard"]){
dojo._hasResource["lconn.communities.bizCard.bizCard"]=true;
dojo.provide("lconn.communities.bizCard.bizCard");
lconn.communities.bizCard.bizCard={servletUrl:null,requestor:null,initited:false,init:function(){
this.servletUrl=lconn.core.bizCard.bizCardUtils.getBaseURL("hgroup")+"/service/json/communityview?communityUuid=@@@UUID@@@";
if(this.initited==false){
this.requestor=new SemTagUtil.crossDomainRequest();
this.initited=true;
}
},getIdMethod:function(_e94){
return _e94.uuid?_e94.uuid:null;
},convMethod:function(_e95){
return _e95;
},customTrim:function(_e96){
return _e96.replace(/^\s+/,"").replace(/\s+$/,"");
},processTag:function(_e97){
try{
if(!this.initited){
lconn.core.bizCard.bizCardUtils.init();
SemTagMenu.init();
this.init();
}
this.processHcard(_e97);
}
catch(e){
console.log(e);
}
},processHcard:function(_e98){
var _e99=this.getNameElement(_e98);
if(!_e99){
return;
}
if(this.isInline(_e98)){
var _e9a={"target":_e99};
this.getTagFromServer(_e9a);
}else{
lconn.core.bizCard.bizCardUtils.addHover(_e99,lconn.communities.bizCard.bizCard.showHover,lconn.communities.bizCard.bizCard.showMenu);
}
},isInline:function(_e9b){
return this.getHcardAttributeValue("X-community-display-inline",_e9b);
},loadHcardCommunity:function(_e9c){
var _e9d=new Object();
var _e9e=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcomm",_e9c);
var _e9f=_e9e.getElementsByTagName("*");
for(i=0;i<_e9f.length;i++){
var _ea0=_e9f[i];
if(_ea0.className){
var _ea1=_ea0.className.split(" ");
for(j=0;j<_ea1.length;j++){
var c=_ea1[j];
var attr=this.getHcardAttributeValue(c,_e9e);
if(attr){
_e9d[c]=attr;
}
}
}
}
return _e9d;
},getHcardAttributeValue:function(_ea4,_ea5){
switch(_ea4){
case ("name"):
return this.getHcardTypedAttribute(_ea5,_ea4,"name");
case ("uuid"):
return this.getHcardTypedAttribute(_ea5,_ea4,"uuid");
case ("selectedWidgetId"):
return this.getHcardTypedAttribute(_ea5,_ea4,"selectedWidgetId");
}
var _ea6=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcomm",_ea5);
var _ea7=lconn.core.bizCard.bizCardUtils.getElementsByClassName(_ea4,_ea6,1);
if(_ea7.length>0&&_ea7[0].tagName.match(/^abbr$/i)){
return _ea7[0].getAttribute("title");
}
switch(_ea4){
case ("uuid"):
var uuid=lconn.core.bizCard.bizCardUtils.getSinglePropertyValue(_ea7[0]);
if(uuid){
return uuid;
}else{
return this.getHcardAttributeValue("name",_ea5);
}
break;
case ("name"):
var name=lconn.core.bizCard.bizCardUtils.getSinglePropertyValue(_ea7[0]);
if(name){
return name;
}
break;
case ("selectedWidgetId"):
var _eaa=lconn.core.bizCard.bizCardUtils.getSinglePropertyValue(_ea7[0]);
if(_eaa){
return _eaa;
}
break;
case ("X-community-display-inline"):
if(_ea7.length>0){
return true;
}else{
return false;
}
default:
return lconn.core.bizCard.bizCardUtils.getSinglePropertyValue(_ea7[0]);
break;
}
},getHcardTypedAttribute:function(_eab,_eac,_ead){
var _eae=new Object();
var _eaf=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcomm",_eab);
var _eb0=lconn.core.bizCard.bizCardUtils.getElementsByClassName(_eac,_eaf);
for(i=0;i<_eb0.length;i++){
var _eb1=_eb0[i];
_eae=lconn.core.bizCard.bizCardUtils.getTypedValue(_eb1,_ead);
}
return _eae;
},showHover:function(_eb2){
try{
lconn.core.bizCard.bizCardUtils.showHover(_eb2,lconn.communities.bizCard.bizCard.showMenu);
}
catch(e){
console.log("Error in lconn.communities.bizCard.bizCard.showHover");
console.log(e);
}
},showMenu:function(_eb3){
var _982=lconn.core.bizCard.bizCardUtils.getLiveElementFromEvent(_eb3);	
var _988=lconn.profiles.bizCard.bizCard.getElementUserId(_982);
if (lconn.core.bizCard.bizCardUtils.checkUid(_988)) { //profile is active			
SemTagMenu.waitCursor();
lconn.communities.bizCard.bizCard.getTagFromServer(_eb3);
}
},getTagFromServer:function(_eb4){
var _eb5=null;
var _eb6=null;
if(_eb4!=null&&_eb4.target!=null&&_eb4.target.className=="name"){
_eb5=_eb4.target;
_eb6=_eb4;
SemTagMenu.currentElem=_eb5;
}else{
_eb5=SemTagMenu.currentElem;
_eb6={target:_eb5,original:_eb4};
if(_eb5==null&&_eb4!=null){
_eb6=_eb4;
_eb5=_eb4.target;
}
}
var _eb7=this.customTrim(this.getElementUuid(_eb5));
var _eb8={"UUID":_eb7};
var _eb9="lconn.communities.bizCard.bizCard.dispatch";
var _eba=_eb7;
if(lconn.core.bizCard.bizCardUtils.isDebug){
window.status="Community.getTagFromServer sending request for: "+_eb7+")";
}
lconn.core.bizCard.bizCardUtils.getBizCardData(this.servletUrl+"&preventCache="+new Date().getTime(),_eb8,_eb9,this.requestor,this.requestReturn,_eb6,_eba);
},requestReturn:function(_ebb,_ebc,_ebd){
if(lconn.core.bizCard.bizCardUtils.isDebug){
window.status="Community.requestReturn: success="+_ebb;
}
var _ebe=_ebb?lconn.communities.bizCard.bizCard.convMethod(_ebc):{};
var _ebf=lconn.core.bizCard.bizCardUtils.getLiveElementFromEvent(_ebd);
lconn.communities.bizCard.bizCard.fillCommunityJsonMoreFromDom(_ebe,_ebf);
lconn.communities.bizCard.bizCard.update(_ebe,_ebf,_ebd);
},fillCommunityJsonMoreFromDom:function(_ec0,_ec1){
if(lconn.core.bizCard.bizCardUtils.isDebug){
window.status="Community.fillCommunityJsonMoreFromDom";
}
if(!_ec0.name){
var _ec2=lconn.core.bizCard.bizCardUtils.findNameElementInHcard(_ec1);
if(_ec2){
_ec0.name=lconn.core.bizCard.bizCardUtils.getTextValue(_ec2);
}
}
if(!_ec0.uuid){
var uuid=this.getElementUuid(_ec1);
_ec0.uuid=uuid;
}
},update:function(_ec4,_ec5,_ec6){
if(lconn.core.bizCard.bizCardUtils.isDebug){
window.status="Community.update";
}
this.currentCommunity=_ec4;
var _ec7=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcomm",_ec5);
if(this.isInline(_ec7)){
var out=new lconn.core.bizCard.bizCardUtils.out();
var _ec9=this.getHcardAttributeValue("selectedWidgetId",_ec7).selectedWidgetId;
lconn.communities.bizCard.bizCardUI.getInlineMarkup(_ec4,"ltr",out,_ec9);
var prev=lconn.core.bizCard.bizCardUtils.getElementsByClassName("personinlinemenu",_ec7,1);
if(prev.length>0){
prev[0].innerHTML=out.buffer;
}else{
var span=document.createElement("span");
span.className="personinlinemenu";
span.innerHTML=out.buffer;
_ec7.appendChild(span);
}
}else{
var _ecc=new Array();
var _ecd="personMenuActions";
var _ece=new lconn.core.bizCard.bizCardUtils.out();
var _ecf=new lconn.core.bizCard.bizCardUtils.out();
lconn.communities.bizCard.bizCardUI.getMenuData(_ec4,"ltr",_ecc,_ecd,_ece,_ecf);
lconn.core.bizCard.bizCardUtils.setMenuData(_ec6,_ecc,_ecd,lconn.core.bizCard.bizCardUtils.getMenuHeaderJson(_ece.buffer,-100));
}
},dispatch:function(data){
var _ed1=this.getIdMethod(data);
this.requestor.dispatch(_ed1,data);
},getElementUuid:function(elem){
var uuid;
var _ed4=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcomm",elem);
if(_ed4!=null){
uuid=this.getHcardAttributeValue("uuid",_ed4);
uuid=uuid.uuid;
}
return uuid;
},getNameElement:function(elem){
if(elem.className!="vcomm"){
elem=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcomm",elem);
}
var _ed6=lconn.core.bizCard.bizCardUtils.getElementsByClassName("name",elem,1)[0];
return _ed6;
}};
}
if(!dojo._hasResource["lconn.communities.bizCard.bizCardUI"]){
dojo._hasResource["lconn.communities.bizCard.bizCardUI"]=true;
var showLinks=(dojo.cookie("community.inline.card.links")==1);
dojo.provide("lconn.communities.bizCard.bizCardUI");
lconn.communities.bizCard.bizCardUI={getMenuData:function(_ed7,bidi,_ed9,_eda,_edb,_edc){
var _edd=dojo.i18n.getLocalization("lc_default")["label.overview"];
if(_edd==null){
_edd=dojo.i18n.getLocalization("lc_default")["label.navigation.overview.heading"];
}
var _ede="";
if(lconn.core.bizCard.bizCardUtils.standaloneCSSloaded){
_ede=" lotusui";
}
_edb.write("<div id='container' "+_ede+" style='width: 32em; height:12em;border: 1px solid #e0e0e0; -moz-border-radius:7px;background-color:#F5F8FF;padding:10px 0px 8px 10px;'>");
_edb.write("  <div id='navigationLinks' style='clear:left; border-bottom:1px solid #e0e0e0;padding: 0px 0pt 5px 0px;margin:0;'>");
_edb.write("      <a href='"+_ed7.homeUrl+"' title=\""+_edd+"\" class='action'>"+_edd+"</a>");
this.writeLinksforPopupCard(_edb,_ed7);
_edb.write("  </div><br/>");
if(_ed7.imageUrl!=null&&_ed7.imageUrl!=""){
_edb.write("  <img src='"+_ed7.imageUrl+"' alt=\""+_ed7.name+"\" title=\""+_ed7.name+"\" height='95' width='95' style='float:left;margin: 0px 10px 10px 10px; padding:2px !important; border:1px solid #c2c2c2;background-color:#fff;'/>");
}
_edb.write("  <div  style='height:9em;overflow:hidden;'>");
_edb.write("  <h2 style='font-size:1.1em;margin:0;margin-right:20px;padding:0;'>"+_ed7.name+"<span id='membersCount' style='font-size:.9em;color:#999;font-weight:normal;'> ("+_ed7.membercount+" "+dojo.i18n.getLocalization("lc_default")["label.members.lowercase"]+")</span></h2>");
if(_ed7.tags!=null&&_ed7.tags!=""){
_edb.write("  <div style='font-size:.9em;color:#999;padding:0;margin:0;'>"+dojo.i18n.getLocalization("lc_default")["label.tags"]+" "+_ed7.tags+"</div>");
}
if(_ed7.description!=null&&_ed7.description!=""){
_edb.write("  <p id='communityDescription' style='font-size:.9em;padding:3px 5px 0 0;margin:0;'>");
_edb.write("      "+_ed7.description);
_edb.write("  </p>                        ");
}
_edb.write("  </div>                      ");
_edb.write("</div><!-- end container -->");
},getInlineMarkup:function(comm,bidi,_ee1,_ee2){
var _ee3=_ee1;
var _ee4=(dojo.cookie("community.inline.card.links")!=0);
var _ee5="lotusTwistyOpen";
if(_ee4){
_ee5="lotusTwistyOpen";
}else{
_ee5="lotusTwistyClosed";
}
var _ee6="";
if(lconn.core.bizCard.bizCardUtils.standaloneCSSloaded){
_ee6="lotusui";
}
_ee3.write("<div class=\"lotusMenu "+_ee6+"\">");
_ee3.write("<div class=\"lotusBottomCorner  lotusInlineMenu\">");
_ee3.write("<div class=\"lotusInner\">");
_ee3.write("<div class=\" lotusCenter lotusInlinePhoto\"><a href=\""+comm.homeUrl+"\"><img src=\""+comm.imageUrl+"\" width=\"155\" height=\"155\" alt=\""+comm.name+"\" /></a></div>");
_ee3.write("<div class=\"lotusLeft\"><a id=\""+comm.uuid+"_twisty\" class=\"lotusSprite lotusArrow "+_ee5+"\" href=\"javascript:lconn.communities.bizCard.bizCardUI.toggleSection('"+comm.uuid+"');\"></a></div>");
_ee3.write("<h2><a href=\""+comm.homeUrl+"\">"+comm.name+"</a></h2>");
_ee3.write("<div class=\"lotusMenuSeparator\"></div>");
this.writeLinks(_ee3,comm,_ee2,_ee4);
_ee3.write("</div>");
_ee3.write("</div>");
_ee3.write("</div>");
},writeLinksforPopupCard:function(_ee7,_ee8){
for(var i=0;_ee8.links!=null&&i<_ee8.links.length;i++){
_ee7.write("&nbsp;&nbsp;|&nbsp;<a href='"+_ee8.links[i].url+"' title='"+_ee8.links[i].label+"' class='action'>"+_ee8.links[i].label+"</a>");
}
},toggleSection:function(_eea){
var _eeb=dojo.byId(_eea+"_twisty");
var _eec=dojo.byId(_eea+"_comm_appLinks");
if(_eec.style.display=="none"){
dojo.fx.wipeIn({node:_eec,duration:300}).play();
dojo.removeClass(_eeb,"lotusTwistyClosed");
dojo.addClass(_eeb,"lotusTwistyOpen");
dojo.cookie("community.inline.card.links",1);
}else{
dojo.fx.wipeOut({node:_eec,duration:300}).play();
dojo.removeClass(_eeb,"lotusTwistyOpen");
dojo.addClass(_eeb,"lotusTwistyClosed");
dojo.cookie("community.inline.card.links",0);
}
},writeLinks:function(_eed,_eee,_eef,_ef0){
var _ef1=dojo.i18n.getLocalization("lc_default")["label.overview"];
if(_ef1==null){
_ef1=dojo.i18n.getLocalization("lc_default")["label.navigation.overview.heading"];
}
if(_ef0){
_eed.write("<ul id=\""+_eee.uuid+"_comm_appLinks\">");
}else{
_eed.write("<ul id=\""+_eee.uuid+"_comm_appLinks\" style=\"display: none\">");
}
_eed.write("<li>"+"<a href='"+_eee.homeUrl+"' title=\""+_ef1+"\" class='action'>"+_ef1+"</a>"+"</li>");
for(var i=0;_eee.links!=null&&i<_eee.links.length;i++){
_eed.write("<li id=\""+_eee.links[i].id+"navItem\"");
if(_eef==_eee.links[i].id){
_eed.write(" class=\"lotusSelected\" ");
}
_eed.write("><a href=\""+_eee.links[i].url+"\" title=\""+_eee.links[i].label+"\" class=\"action\">"+_eee.links[i].label+"</a></li>");
}
_eed.write("</ul>");
return;
}};
}
if(!dojo._hasResource["lconn.profiles.bizCard.bizCard"]){
dojo._hasResource["lconn.profiles.bizCard.bizCard"]=true;
dojo.provide("lconn.profiles.bizCard.bizCard");
if(!window.SemTagPerson){
window.SemTagPerson={services:[]};
}
lconn.profiles.bizCard.bizCard={applicationContext:null,servletUrlByUserId:null,servletUrlByEmail:null,requestor:null,services:[],initited:false,init:function(){
if(this.initited==false){
this.applicationContext=lconn.core.bizCard.bizCardUtils.getBaseURL("hcard");
this.servletUrlByUserId2=lconn.core.bizCard.bizCardUtils.getBaseURL("hcard")+"/json/profile.do?userid=@@@USERID@@@&lang=@@@LANG@@@";
this.servletUrlByEmail2=lconn.core.bizCard.bizCardUtils.getBaseURL("hcard")+"/json/profile.do?email=@@@EMAIL@@@&lang=@@@LANG@@@";
this.servletUrlByUserId=lconn.core.bizCard.bizCardUtils.getBaseURL("hcard")+"/json/profile.do?userid=@@@USERID@@@&callback=lconn.profiles.bizCard.bizCard.dispatchByUserId&lang=@@@LANG@@@";
this.servletUrlByEmail=lconn.core.bizCard.bizCardUtils.getBaseURL("hcard")+"/json/profile.do?email=@@@EMAIL@@@&callback=lconn.profiles.bizCard.bizCard.dispatchByEmail&lang=@@@LANG@@@";
this.requestor=new SemTagUtil.crossDomainRequest();
if(window.generalrs==null){
lconn.core.bizCard.bizCardUtils.loadScript(lconn.core.bizCard.bizCardUtils.getBaseURL("hcard")+"/resources/js-resources.js");
}
this.initited=true;
}
},getIdMethod:function(_ef3){
return (_ef3.email&&_ef3.email.internet)?_ef3.email.internet:null;
},convMethod:function(_ef4){
return _ef4;
},dispatchByEmail:function(data){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("lconn.profiles.bizCard.bizCard.dispatchByEmail: data: "+data);
}
var _ef6=(data.email&&data.email.internet)?data.email.internet:null;
this.dispatch(_ef6,data);
},dispatchByUserId:function(data){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("lconn.profiles.bizCard.bizCard.dispatchByUserId: data: "+data);
}
var _ef8=data.X_lconn_userid?data.X_lconn_userid:null;
this.dispatch(_ef8,data);
},dispatchByConfig:function(data){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("lconn.profiles.bizCard.bizCard.dispatchByConfig: data: "+data);
}
this.dispatch("configDataId",data);
},dispatch:function(id,data){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("lconn.profiles.bizCard.bizCard.dispatch: id:"+id+"  data: "+data);
}
this.requestor.dispatch(id,data);
},processTag:function(_efc){
try{
if(!this.initited){
lconn.core.bizCard.bizCardUtils.init();
SemTagMenu.init();
this.init();
}
this.processHcard(_efc);
}
catch(e){
console.log(e);
}
},processHcard:function(_efd){
var _efe=this.getNameElement(_efd);
if(!_efe){
return;
}
if(this.isInline(_efd)){
var _eff={"target":_efe};
this.getTagFromServer(_eff);
}else{
lconn.core.bizCard.bizCardUtils.addHover(_efe,this.showHover,this.showMenu,this.keystrokeHandler);
}
},isInline:function(_f00){
return this.getHcardAttributeValue("X-person-display-inline",_f00);
},loadHcardPerson:function(_f01){
var _f02=new Object();
var _f03=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcard",_f01);
var _f04=_f03.getElementsByTagName("*");
for(i=0;i<_f04.length;i++){
var _f05=_f04[i];
if(_f05.className){
var _f06=_f05.className.split(" ");
for(j=0;j<_f06.length;j++){
var c=_f06[j];
var attr=this.getHcardAttributeValue(c,_f03);
if(attr){
_f02[c]=attr;
}
}
}
}
return _f02;
},getHcardAttributeValue:function(_f09,_f0a){
switch(_f09){
case ("email"):
return this.getHcardTypedAttribute(_f0a,_f09,"internet");
case ("tel"):
return this.getHcardTypedAttribute(_f0a,_f09,"voice");
case ("adr"):
return this.getHcardTypedAttribute(_f0a,_f09,"intl");
}
var _f0b=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcard",_f0a);
var _f0c=lconn.core.bizCard.bizCardUtils.getElementsByClassName(_f09,_f0b,1);
if(_f0c.length>0&&_f0c[0].tagName.match(/^abbr$/i)){
return _f0c[0].getAttribute("title");
}
switch(_f09){
case ("fn"):
var fn=lconn.core.bizCard.bizCardUtils.getSinglePropertyValue(_f0c[0]);
if(fn){
return fn;
}else{
return this.getHcardAttributeValue("n",_f0a);
}
break;
case ("n"):
if(_f0c.length>0){
var _f0e=_f0c[0];
var _f0f="";
var _f10=["honorific-prefix","given-name","additional-name","family-name","honorific-suffix"];
for(i=0;i<5;i++){
var n=lconn.core.bizCard.bizCardUtils.getSinglePropertyValue(lconn.core.bizCard.bizCardUtils.getElementsByClassName(_f10[i],_f0e,1)[0]);
if(n){
_f0f+=n+" ";
}
}
return _f0f;
}
return "";
break;
case ("photo"):
var _f12=_f0c[0];
if(_f12){
return _f12.getAttribute("src");
}else{
return;
}
break;
case ("X-sametime-status"):
var _f13=_f0c[0];
if(!_f13){
return "";
}
var _f14=_f13.getAttribute("value");
if(_f14){
return _f14;
}else{
return lconn.core.bizCard.bizCardUtils.getSinglePropertyValue(_f13);
}
break;
case ("X-person-display-inline"):
if(_f0c.length>0){
return true;
}else{
return false;
}
case ("street-address"):
case ("post-office-box"):
case ("extended-address"):
case ("locality"):
case ("region"):
case ("postal-code"):
case ("country-name"):
case ("title"):
case ("role"):
case ("org"):
default:
return lconn.core.bizCard.bizCardUtils.getSinglePropertyValue(_f0c[0]);
break;
}
},getHcardTypedAttribute:function(_f15,_f16,_f17){
var _f18=new Object();
var _f19=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcard",_f15);
var _f1a=lconn.core.bizCard.bizCardUtils.getElementsByClassName(_f16,_f19);
for(i=0;i<_f1a.length;i++){
var _f1b=_f1a[i];
if(_f16=="email"&&_f1b.nodeName.toLowerCase()=="a"&&_f1b.href.match(/^mailto:/)){
var _f1c=_f1b.href.indexOf("?");
if(_f1c>-1){
_f18[_f17]=_f1b.href.slice(7,_f1c);
}else{
_f18[_f17]=_f1b.href.slice(7);
}
continue;
}
_f18=lconn.core.bizCard.bizCardUtils.getTypedValue(_f1b,_f17);
}
return _f18;
},showHover:function(_f1d){
try{
lconn.core.bizCard.bizCardUtils.showHover(_f1d,lconn.profiles.bizCard.bizCard.showMenu);
}
catch(e){
console.log("Error in lconn.profiles.bizCard.bizCard.showHover");
console.log(e);
}
},showMenu:function(_f1e){
var _982=lconn.core.bizCard.bizCardUtils.getLiveElementFromEvent(_f1e);	
lconn.profiles.bizCard.bizCardUI.setLinkSource(_982);
var _988=lconn.profiles.bizCard.bizCard.getElementUserId(_982);
if (lconn.core.bizCard.bizCardUtils.checkUid(_988)) { //profile is active			
SemTagMenu.waitCursor();
lconn.profiles.bizCard.bizCard.getTagFromServer(_f1e);
}
},keystrokeHandler:function(_f1f){
if(_f1f.ctrlKey&&(_f1f.keyCode==13)){
if(_f1f.preventDefault){
_f1f.preventDefault();
}
lconn.profiles.bizCard.bizCard.showMenu(_f1f);
}
},getSearchType:function(_f20){
indexOf.lconn.core.bizCard.bizCardUtils.getBaseURL("hcard");
},getTagFromServer:function(_f21){
var _f22=lconn.core.bizCard.bizCardUtils.getLiveElementFromEvent(_f21);
var _f23=lconn.core.bizCard.bizCardUtils.getLangParam();
var _f24={"LANG":lconn.core.bizCard.bizCardUtils.getLangParam()};
var url=null;
var _f26=null;
var _f27=null;
var _f28=this.getElementUserId(_f22);
if(_f28){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("Person.getTagFromServer sending request for user id: "+_f28);
}
_f24["USERID"]=_f28;
_f26=_f28;
url=this.servletUrlByUserId2;
_f27="lconn.profiles.bizCard.bizCard.dispatchByUserId";
}else{
var _f29=this.getElementEmail(_f22);
if(_f29){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("Person.getTagFromServer sending request for email: "+_f29);
}
_f24["EMAIL"]=_f29;
_f26=_f29;
url=this.servletUrlByEmail2;
_f27="lconn.profiles.bizCard.bizCard.dispatchByEmail";
}
}
if(_f26!=null){
lconn.core.bizCard.bizCardUtils.getBizCardData(url,_f24,_f27,this.requestor,this.requestReturn,_f21,_f26);
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("Person.getTagFromServer sent");
}
}else{
this.noInformationProvided(_f22,_f21);
}
},noInformationProvided:function(_f2a,_f2b){
lconn.profiles.bizCard.bizCard.update(null,_f2a,_f2b);
},requestReturn:function(_f2c,_f2d,_f2e){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("Person.requestReturn: success="+_f2c);
}
var _f2f=lconn.core.bizCard.bizCardUtils.getLiveElementFromEvent(_f2e);
var _f2d=_f2c?lconn.profiles.bizCard.bizCard.convMethod.call(null,_f2d):{};
lconn.profiles.bizCard.bizCard.fillPersonJsonMoreFromDom(_f2d,_f2f);
lconn.profiles.bizCard.bizCard.update(_f2d,_f2f,_f2e);
},fillPersonJsonMoreFromDom:function(_f30,_f31){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("Person.fillPersonJsonMoreFromDom");
}
if(!_f30.photo){
_f30.photo=lconn.core.bizCard.bizCardUtils.baseUrl+"/images/profileNoPhoto.gif";
}
if(!_f30.fn){
var _f32=lconn.core.bizCard.bizCardUtils.findNameElementInHcard(_f31);
if(_f32){
_f30.fn=lconn.core.bizCard.bizCardUtils.getTextValue(_f32);
}
}
if(!_f30.email||!_f30.email.internet){
var _f33=this.getElementEmail(_f31);
_f30.email={"internet":_f33};
}
if(!_f30.tel||!_f30.tel.voice){
var _f34=lconn.core.bizCard.bizCardUtils.findElementByNameInHcard(_f31,"tel");
if(_f34){
var tels=lconn.core.bizCard.bizCardUtils.getTypedValue(_f34,"voice");
_f30.tel={"voice":tels["voice"]};
}
}
var _f36=lconn.core.bizCard.bizCardUtils.findElementByNameInHcard(_f31,"adr");
var _f37={};
if(_f36){
_f37=SemTagAddr.getAddressJson(_f36);
_f30.adr=_f37;
}
},update:function(_f38,_f39,_f3a){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("Person.update");
}
this.currentPerson=_f38;
var _f3b=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcard",_f39);
if(this.isInline(_f3b)){
var out=new lconn.core.bizCard.bizCardUtils.out();
lconn.profiles.bizCard.bizCardUI.getInlineMarkup(_f38,"ltr",out);
var span=document.createElement("span");
span.innerHTML=out.buffer;
_f3b.appendChild(span);
var _f3e=(dojo.cookie("card.inline.expanded")?false:true);
}else{
var _f3f=new Array();
var _f40="personMenuActions";
var _f41=new lconn.core.bizCard.bizCardUtils.out();
var _f42=new lconn.core.bizCard.bizCardUtils.out();
lconn.profiles.bizCard.bizCardUI.getMenuData(_f38,"ltr",_f3f,_f40,_f41,_f42);
lconn.core.bizCard.bizCardUtils.setMenuData(_f3a,_f3f,_f40,lconn.core.bizCard.bizCardUtils.getMenuHeaderJson(_f41.buffer,-100));
}
if(_f38!=null){
if(_f38.X_bizCardSTAwareness){
this.invokeSametimeAwareness(_f38);
}
}
},invokeSametimeAwareness:function(_f43){
if(this.attemptedToLoadSametime==null&&window.Status==null){
var _f44="http://localhost:59449/stwebapi/";
lconn.core.bizCard.bizCardUtils.loadScript(_f44+"getStatusNonDojo.js");
lconn.core.bizCard.bizCardUtils.loadCss(lconn.core.bizCard.bizCardUtils.getBaseURL("hcard")+"/css/sametime/main.css");
this.attemptedToLoadSametime=true;
}
lconn.core.utilities.processUntilAvailable(this.invokeSametimeAwarenessForPerson,"window.Status != null",_f43);
},invokeSametimeAwarenessForPerson:function(_f45){
var _f46="http://localhost:59449/stwebapi/";
var url=_f46+"getstatus/";
url+=_f45.email.internet+"?jsonp=lconn.profiles.bizCard.bizCard.sametimeCallBack&time="+new Date().getTime();
lconn.core.bizCard.bizCardUtils.loadScript(url);
},sametimeCallBack:function(_f48){
if(_f48.error!=null){
}else{
var _f49=document.getElementById(_f48.username+"vcardNameElem");
if(_f49!=null&&typeof (Status)!="undefined"){
_f49.className+=" awareness "+Status.getStyleForStatus(_f48.status);
_f49.setAttribute("userId",_f48.username);
_f49.onclick=function(){
var _f4a=this.getAttribute("userId");
sametime_invoke("chat",_f4a);
};
}
if(dojo.byId(_f48.username+"ChatAction")!=null){
dojo.byId(_f48.username+"ChatAction").style.display="inline";
}
if(dojo.byId(_f48.username+"ChatActionMore")!=null){
dojo.byId(_f48.username+"ChatActionMore").style.display="inline";
}
if(dojo.byId(_f48.username+"CallActionMore")){
dojo.byId(_f48.username+"CallActionMore").style.display="inline";
}
if(dojo.byId(_f48.username+"vcardCommentElem")!=null){
if(_f48.statusMessage!=null&&_f48.statusMessage!=""){
dojo.byId(_f48.username+"vcardCommentElem").style.display="block";
dojo.byId(_f48.username+"vcardStStatusElem").innerHTML=_f48.statusMessage;
}
}
}
},sametimeStart:function(_f4b,_f4c){
sametime_invoke(_f4b,_f4c);
},getElementEmail:function(elem){
var _f4e;
var _f4f=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcard",elem);
if(_f4f){
_f4e=this.getHcardAttributeValue("email",_f4f);
_f4e=_f4e.internet;
}else{
if(elem.nodeName.toLowerCase()=="a"&&elem.href.match(/^mailto:/)){
_f4e=elem.href.replace(/^mailto:/,"");
}
}
return _f4e;
},getElementUserId:function(elem){
var _f51="";
var _f52=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcard",elem);
if(_f52){
_f51=this.getHcardAttributeValue("x-lconn-userid",_f52);
}
return _f51;
},getNameElement:function(elem){
if(elem.className!="vcard"){
elem=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcard",elem);
}
var _f54=lconn.core.bizCard.bizCardUtils.getElementsByClassName("fn",elem,1)[0];
if(!_f54){
_f54=lconn.core.bizCard.bizCardUtils.getElementsByClassName("n",elem,1)[0];
}
return _f54;
},requestReturnMiniBizCard:function(_f55,_f56,_f57,_f58){
var _f56=_f55?lconn.profiles.bizCard.bizCard.convMethod.call(null,_f56):{};
var _f59=new lconn.core.bizCard.bizCardUtils.out();
lconn.profiles.bizCard.bizCardUI.getMenuData(_f56,null,null,null,_f59,null,true,(_f58?true:false));
if(_f57.target!=null){
_f57.target.innerHTML=_f59.buffer;
}else{
if(_f57.callbackfn!=null){
_f57.callbackfn(_f59.buffer);
}
}
},renderMiniBizCard:function(_f5a,_f5b,_f5c){
this.init();
var _f5d={"target":_f5c,"callbackfn":_f5b};
var src=this.servletUrlByUserId.replace(/@@@USERID@@@/,_f5a);
this.requestor.request(src,10000,this.requestReturnMiniBizCard,_f5d,_f5a);
}};
}
if(!dojo._hasResource["lconn.profiles.bizCard.bizCardUI"]){
dojo._hasResource["lconn.profiles.bizCard.bizCardUI"]=true;
dojo.provide("lconn.profiles.bizCard.bizCardUI");
lconn.profiles.bizCard.bizCardUI={isDebug:false,isSlim:false,isExpandable:true,isEmailEnabled:true,linkSource:null,getMenuData:function(_f5f,bidi,_f61,_f62,_f63,_f64,_f65,_f66){
var _f67=dojo.cookie("card.popup.slim");
if(typeof (_f65)!="undefined"&&_f65!=null){
this.isSlim=_f65;
}else{
if(_f67!=null){
this.isSlim=(_f67==1);
}
}
if(typeof (_f66)!="undefined"){
this.isExpandable=_f66;
}
if(_f5f!=null){
this.isEmailEnabled=(_f5f.email!=null&&_f5f.email.internet!=null);
}else{
this.isEmailEnabled=false;
}
if(this.isDebug){
SemTagSvc.debug("slim? "+this.isSlim);
SemTagSvc.debug("expandable? "+this.isExpandable);
SemTagSvc.debug("email? "+this.isEmailEnabled);
}
var _f68=lconn.core.bizCard.bizCardUtils.getBaseURL("hcard");
_f63.write("<div class=\"lotusui\">");
_f63.write("<div id=\"cardDiv\" class=\"lotusVCard\" style=\"margin: 10px; position: static; opacity: 1;\">");
_f63.write("<a id=\"A11Yblank\" href=\"javascript:void(0);\" ><img src=\""+_f68+"/nav/common/styles/images/blank.gif\" alt=\"\" /></a>");
_f63.write("<table id=\"cardTable\" class=\"lotusContainer\" cellspacing=\"0\">");
_f63.write("<tbody>");
_f63.write("<tr id=\"cardHeader\" "+((this.isSlim)?"style=\"display:none\"":"")+">"+"<td>"+"<table cellspacing=\"0\" width=\"100%\">");
if(_f5f!=null){
this.writeHeaderUIContent(_f63,_f5f,false);
}
_f63.write("</table>"+"</td></tr>");
_f63.write("<tr id=\"cardBody\">");
_f63.write("<td class=\"lotusDetails\" colspan=\"6\">");
this.writeBodyUIContent(_f5f,bidi,_f61,_f62,_f63,_f64,_f68);
_f63.write("</td>");
_f63.write("</tr>");
if(_f5f!=null){
this.writeFooterUIContent(_f5f,bidi,_f61,_f62,_f63,_f64,_f68);
}
_f63.write("</tbody></table></div></div>");
},
keystrokeHandler:function(ev){
var cardDiv = dojo.byId("cardDiv");
var semtagmenuDiv = dojo.byId("semtagmenu");

if((ev.keyCode==10)||(ev.keyCode==13)){
if(ev.preventDefault){
ev.preventDefault();
}
if (navigator.appName == "Netscape"){
cardDiv.style.display = "none";
}else{ 
semtagmenuDiv.style.display = "none";
}
if(this.linkSource != null){
 this.linkSource.focus();
}
}
}
,writeHeaderUIContent:function(_f69,_f6a,_f6b){
this.writeLinks(_f69,_f6a,_f6b);
},writeBodyUIContent:function(_f6c,bidi,_f6e,_f6f,_f70,_f71,_f72){
this.getSubUIContent(_f6c,bidi,_f6e,_f6f,_f70,_f71,_f72);
},writeFooterUIContent:function(_f73,bidi,_f75,_f76,_f77,_f78,_f79){
_f77.write("<tr id=\"cardFooter\""+((this.isSlim)?"style=\"display:none\"":"")+">");
_f77.write("<td colspan=\"6\">");
if(_f73.X_inDirectory){
_f77.write("<div class=\"lotusPersonActions\">");
_f77.write("<ul class=\"lotusInlinelist\">");
var _f7a=(typeof (SemTagSvcConfig)!="undefined"&&SemTagSvcConfig.isBidiRTL);
if(_f73.X_bizCardActions.length>0){
_f77.write("<li class=\"lotusFirst\">"+this.getActionLink(_f73,0,true)+"</li>");
if(_f7a){
_f77.write("<li class=\"lotusFirst\"></li>");
}
}
if(this.isEmailEnabled&&_f73.X_bizCardSTAwareness){
if(_f73.X_STChatAction){
_f77.write("<li id=\""+_f73.email.internet+"ChatAction\" "+(_f7a?"class=\"lotusFirst\"":"")+" style=\"display:none;\">"+"<a href=\"javascript:void(0);\" onclick=\"lconn.profiles.bizCard.bizCard.sametimeStart('chat', '"+_f73.email.internet+"');\">"+"<img src=\""+_f79+"/nav/common/styles/images/iconChat.gif\" alt=\"\" /> "+generalrs.personCardChat+"</a>"+"</li>");
}
if(typeof (SemTagSvcConfig)!="undefined"&&SemTagSvcConfig.isBidiRTL){
_f77.write("<li class=\"lotusFirst\"></li>");
}
}
if(_f73.X_bizCardActions.length>1){
_f77.write("<li "+(!this.isEmailEnabled||_f7a?"class=\"lotusFirst\"":"")+">"+"<a href=\"javascript:void(0);\" onclick=\"lconn.profiles.bizCard.bizCardUI.displayMore('"+_f73.key+"MoreActionMenu',this.parentNode.parentNode);event.cancelBubble=true\">"+generalrs.personCardMoreActions+"<img src=\""+_f79+"/nav/common/styles/images/btnDropDown.gif\" alt=\""+generalrs.personCardMoreActionsAltText+"\" title=\""+generalrs.personCardMoreActionsAltText+"\">"+"</a>"+"</li>");
}
var baseURL=lconn.core.bizCard.bizCardUtils.getBaseURL("hcard");
_f77.write("<li><input type=\"image\" href=\"\" onkeypress=\"lconn.profiles.bizCard.bizCardUI.keystrokeHandler(event)\" src=\""+baseURL+"/nav/common/styles/images/blank.gif\" alt=\" Press control-enter to close the business card \" /></li>");
_f77.write("</ul>"+"</div>");
if(_f73.X_bizCardActions.length>1||(this.isEmailEnabled&&_f73.X_bizCardSTAwareness)){
this.writeMoreActionsMenu(_f77,_f73,_f79,false);
}
}
_f77.write("</td></tr>");
},getActionLink:function(_f7b,_f7c,_f7d){
var _f7e=_f7b.X_bizCardActions[_f7c];
var icon="";
if(_f7d&&typeof (_f7e.icon)!="undefined"){
icon="<img src=\""+_f7e.icon.href+"\" alt=\""+_f7e.icon.alt+"\" /> ";
}
return "<a class=\"email\" href=\""+_f7e.urlPattern+"\">"+icon+_f7e.label+"</a>";
},getSubUIContent:function(_f80,bidi,_f82,_f83,_f84,_f85,_f86){
if(this.isExpandable){
this.writeExpandoUIContent(_f84,_f86);
}
if(_f80!=null){
if(_f80.X_bizCardShowPhoto){
_f84.write("<div class=\"lotusPhoto photo\"><img src=\""+_f80.photo+"\" alt=\""+_f80.fn+"\" title=\""+_f80.fn+"\" height=\"59\" width=\"59\"></div>");
}
_f84.write("<div class=\"lotusPersonInfo\">");
if(_f80.X_inDirectory!="true"){
var _f87=generalrs["label.personcard.noprofilemsg"];
_f84.write("<h3 id='noProfileMsg'>"+_f87+"</h3>");
}else{
_f84.write(_f80.X_bizCardMainHtml);
}
_f84.write("</div><!--end lotusInfo-->");
var _f88=((this.isEmailEnabled)?_f80.email.internet:"");
_f84.write("<div id=\""+_f88+"vcardCommentElem\" class=\"lotusComment\" style=\"display: none;\">");
_f84.write("<div class=\"lotusCommentHeader\">&nbsp;</div><!--end comment header-->");
_f84.write("<div class=\"lotusCommentBody\">\t");
if(_f88!=""&&_f80.X_bizCardSTStatusMsg){
_f84.write("<p>Sametime: <span id=\""+_f88+"vcardStStatusElem\"></span></p>");
}
_f84.write("</div><!--end commentBody-->");
_f84.write("</div><!--end comment-->");
}else{
var _f87=dojo.i18n.getLocalization("lc_default")["label.personcard.noprofilemsg"];
_f84.write("<h3 id='noProfileMsg'>"+_f87+"</h3>");
}
},writeExpandoUIContent:function(_f89,_f8a){
_f89.write("<div class=\"lotusRight\">");
_f89.write("<a onclick=\"lconn.profiles.bizCard.bizCardUI.toggleSlimCard(this,'"+_f8a+"');"+"event.cancelBubble=true;\""+"href=\"javascript:void(0);\">");
_f89.write(" <img id=\"slimTwisty\" src=\""+_f8a+"/nav/common/styles/images/"+(this.isSlim?"iconShow.gif":"iconHide.gif")+"\" alt=\"\" title=\"\"/>");
_f89.write("</a>");
_f89.write("</div>");
},getInlineMarkup:function(_f8b,bidi,_f8d){
var _f8e=lconn.core.bizCard.bizCardUtils.getBaseURL("hcard");
var _f8f=_f8d;
if(_f8b!=null){
var _f90="";
if(this.isEmailEnabled){
_f90=_f8b.email.internet;
}
_f8f.write("<div class=\"lotusui\">");
_f8f.write("<div id=\""+_f8b.key+"\" class=\"vcard lotusVCard lotusInlineVCard\" style=\"position:static;margin:10px\">");
_f8f.write("  <div class=\"lotusContainer\">");
_f8f.write("    <div id=\""+_f8b.key+"_Pivot\" class=\"lotusPivotNav\">");
_f8f.write("      <div class=\"lotusPivotNavToggle\">");
_f8f.write("        <a href=\"javascript:void(0);\" title=\"\" onclick=\"lconn.core.bizCard.bizCardUtils.toggleInlineCard('"+_f8b.key+"')\">"+"&nbsp;"+"</a>");
_f8f.write("      </div>");
if(_f8b.X_bizCardShowPhoto){
_f8f.write("      <div class=\"lotusPhoto photo\">");
_f8f.write("        <img id=\"photo\" src=\""+_f8b.photo+"\" alt=\""+_f8b.fn+"\" title=\""+_f8b.fn+"\" height=\"35\" width=\"35\" />");
_f8f.write("      </div>");
}
_f8f.write("      <div class=\"lotusPersonInfo\">");
_f8f.write("        <h2 class=\"fn\" id=\""+_f90+"vcardNameElem\" class=\"fn\">"+_f8b.fn+"</h2>");
_f8f.write("      </div>");
_f8f.write("    </div>");
_f8f.write("    <div id=\""+_f8b.key+"_Details\" class=\"lotusInlineVCardDetails\">");
if(_f8b.X_bizCardActions.length>0){
_f8f.write("<div class=\"lotusEmail\">");
_f8f.write(this.getActionLink(_f8b,0,true));
_f8f.write("</div>");
}
this.writeLinks(_f8f,_f8b,true);
if(_f8b.X_bizCardActions.length>1){
_f8f.write("<div class=\"lotusPersonActions\">");
_f8f.write("  <ul class=\"lotusInlinelist\">");
_f8f.write("    <li class=\"lotusFirst\">");
_f8f.write("      <a href=\"javascript:;\"");
_f8f.write("        onclick=\"lconn.profiles.bizCard.bizCardUI.displayMore('"+_f8b.key+"InlineMoreActionMenu',this.parentNode.parentNode);event.cancelBubble=true\">");
_f8f.write(generalrs.personCardMoreActions);
_f8f.write("        <img src=\""+_f8e+"/nav/common/styles/images/btnDropDown.gif\" alt=\""+generalrs.personCardMoreActionsAltText+"\"");
_f8f.write("          title=\""+generalrs.personCardMoreActionsAltText+"\" />");
_f8f.write("      </a>");
_f8f.write("    </li>");
_f8f.write("  </ul>");
_f8f.write("</div>");
this.writeMoreActionsMenu(_f8f,_f8b,_f8e,true);
}
_f8f.write("    </div>");
_f8f.write("  </div>");
_f8f.write("</div>");
_f8f.write("</div>");
}else{
_f8f.write("<div class=\"lotusui\">");
_f8f.write("<div class=\"vcard lotusVCard lotusInlineVCard\" style=\"position:static;margin:10px\">");
_f8f.write("  <div class=\"lotusContainer\">");
_f8f.write("    </div>");
_f8f.write("    </div>");
_f8f.write("    </div>");
}
},writeLinks:function(_f91,_f92,_f93){
try{
var _f94=lconn.core.bizCard.bizCardUtils.getBaseURL("hcard");
if(!_f92.X_bizCardServiceLinks){
_f92.X_bizCardServiceLinks=[];
}
if(!_f92.X_concatSemPersonSvc&&SemTagPerson.services&&SemTagPerson.services.length>0){
_f92.X_bizCardServiceLinks=_f92.X_bizCardServiceLinks.concat(SemTagPerson.services);
_f92.X_concatSemPersonSvc=true;
}
if(_f92.X_bizCardServiceLinks&&_f92.X_bizCardServiceLinks.length>0){
_f91.write((_f93)?"<ul id=\"appLinks1\" class=\"lotusAppLinks\">":"<tr id=\"appLinks1\" class=\"lotusAppLinks\">");
var _f95=false;
var _f96=false;
for(var k=0;k<_f92.X_bizCardServiceLinks.length;k++){
var _f98=false;
var _f99=_f92.X_bizCardServiceLinks[k];
if(_f99==null||_f99.name==null||_f99.name==""){
continue;
}
var _f9a="";
var _f9b=false;
if(typeof (_f99.href)!="undefined"&&_f99.href!=null){
_f9a=_f99.href;
}else{
if(typeof (_f99.url_pattern)!="undefined"&&_f99.url_pattern!=null&&_f99.url_pattern!=""){
_f9a=_f99.url_pattern;
if(_f9a.indexOf("{email}")!=-1&&(_f92.email!=null&&_f92.email.internet!=null)){
_f9a=_f9a.replace(/{email}/g,_f92.email.internet);
}
if(_f9a.indexOf("{uid}")!=-1&&(_f92.uid!=null)){
_f9a=_f9a.replace(/{uid}/g,_f92.uid);
}
if(_f9a.indexOf("{key}")!=-1&&(_f92.key!=null)){
_f9a=_f9a.replace(/{key}/g,_f92.key);
}
if(_f9a.indexOf("{fn}")!=-1&&(_f92.fn!=null)){
_f9a=_f9a.replace(/{fn}/g,_f92.fn);
}
if(_f9a.indexOf("{displayName}")!=-1&&(_f92.fn!=null)){
_f9a=_f9a.replace(/{displayName}/g,_f92.fn);
}
if(_f9a.indexOf("{workPhoneNumber}")!=-1&&(_f92.adr!=null&&_f92.adr.work!=null)){
_f9a=_f9a.replace(/{workPhoneNumber}/g,_f92.adr.work);
}
if(_f9a.indexOf("{userid}")!=-1&&(_f92.X_lconn_userid!=null)){
_f9a=_f9a.replace(/{userid}/g,_f92.X_lconn_userid);
}
if(typeof (_f99.location)!="undefined"&&_f99.location!=null){
_f9a=_f99.location+_f9a;
}
}else{
continue;
}
}
if((_f93==false)&&k==4&&_f92.X_bizCardServiceLinks.length>=6&&!_f95){
_f91.write("<td>"+"<a onclick=\"lconn.profiles.bizCard.bizCardUI.toggleMoreApps('appLinks2',this); event.cancelBubble=true;\""+" href=\"javascript:void(0);\" "+" class=\"lotusMore lotusMoreExpanded\">&nbsp;"+"<span class=\"lotusAltText\">+</span>"+"</a>"+"</td>");
_f91.write("</tr>");
_f91.write("<tr id=\"appLinks2\" class=\"lotusAppLinks\">");
_f95=true;
_f96=true;
}
_f91.write((_f93)?"<li ":"<td ");
if(k==0||_f96==true){
_f91.write("class=\"lotusFirst\"");
}
_f96=false;
var _f9c="";
if(typeof (_f99.js_eval)!="undefined"&&_f99.js_eval!=null&&_f99.js_eval.indexOf("generalrs.")==0){
var key=_f99.js_eval.substr("generalrs.".length);
if(typeof (generalrs[key])=="undefined"){
key=key.replace(/\_/g,".");
}
_f9c=generalrs[key];
}else{
if(_f99.js_eval){
try{
if(_f92.X_allowEvalLabel){
_f9c=dojo.eval(_f99.js_eval);
}else{
_f9c=new String(_f99.js_eval);
}
}
catch(exception2){
_f9c="!error.eval!";
}
}else{
if(_f99.label){
_f9c=new String(_f99.label);
}else{
_f9c="???";
}
}
}
if(_f99.name=="blogs"&&_f92.X_blogUrl!=null&&_f92.X_blogUrl!=""){
_f91.write("><a class=\"url\" href=\""+_f92.X_blogUrl+"\">"+_f9c+"</a>");
}else{
_f91.write("><a class=\"url\" href=\""+_f9a+"\">"+_f9c+"</a>");
}
_f91.write((_f93)?"</li>":"</td>");
}
if(_f95){
_f91.write("<td colspan=\""+(11-_f92.X_bizCardServiceLinks.length)+"\">&nbsp;</td>");
}
_f91.write((_f93)?"</ul>":"</tr>");
}
}
catch(exception2){
alert(exception2.message);
}
},writeMoreActionsMenu:function(_f9e,_f9f,_fa0,_fa1){
try{
_f9e.write("<ul class=\"lotusActionMenu\" id=\""+_f9f.key);
if(_fa1){
_f9e.write("Inline");
}
_f9e.write("MoreActionMenu\">");
if(_f9f.X_bizCardActions.length>0&&!_fa1){
_f9e.write("<li class=\""+_f9f.X_bizCardActions[0].liClass+"\">"+this.getActionLink(_f9f,0,false)+"</li>");
}
if(this.isEmailEnabled&&_f9f.X_bizCardSTAwareness&&_f9f.email.internet!=""){
if(_f9f.X_STChatAction){
_f9e.write("<li id=\""+_f9f.email.internet+"ChatActionMore\" style=\"display:none;\"><a href=\"javascript:void(0);\" onclick=\"lconn.profiles.bizCard.bizCard.sametimeStart('chat', '"+_f9f.email.internet+"');\"> "+generalrs.personCardChat+" </a></li>");
}
if(_f9f.X_STCallAction){
_f9e.write("<li id=\""+_f9f.email.internet+"CallActionMore\" style=\"display:none;\"><a href=\"javascript:void(0);\" onclick=\"lconn.profiles.bizCard.bizCard.sametimeStart('call', '"+_f9f.email.internet+"');\"> "+generalrs.personCardCall+" </a></li>");
}
}
if(_f9f.X_bizCardActions.length>1){
for(var i=1;i<_f9f.X_bizCardActions.length;i++){
_f9e.write("<li class=\""+_f9f.X_bizCardActions[i].liClass+"\">"+this.getActionLink(_f9f,i,false)+"</li>");
}
}
_f9e.write("</ul>");
}
catch(exception2){
alert(exception2.message);
}
},displayMore:function(_fa3,_fa4){
_fa4.style.display="none";
document.getElementById(_fa3).style.display="block";
},convertQuickrEmail:function(_fa5){
_fa5=_fa5.replace(/@/g,"_at_");
_fa5=_fa5.replace(/\./g,"_");
return _fa5;
},toggleMoreApps:function(pDiv,_fa7){
var _fa8=document.getElementById(pDiv);
if(_fa7.className.indexOf("lotusMoreExpanded")!=-1){
_fa7.className="lotusMore";
_fa8.style.display="none";
}else{
_fa7.className+=" lotusMoreExpanded";
_fa8.style.display="";
}
},toggleSlimCard:function(_fa9,_faa){
var _fab=document.getElementById("slimTwisty");
if(_fab.src.indexOf("iconHide.gif")!=-1){
this.slimCard(_faa);
dojo.cookie("card.popup.slim",1);
}else{
this.expandCard(_faa);
dojo.cookie("card.popup.slim",0);
}
},slimCard:function(_fac){
var _fad=document.getElementById("slimTwisty");
var _fae=document.getElementById("cardHeader");
var _faf=document.getElementById("cardFooter");
if(_fad){
_fad.src=_fac+"/nav/common/styles/images/iconShow.gif";
}
_fae.style.display="none";
_faf.style.display="none";
},expandCard:function(_fb0){
var _fb1=document.getElementById("slimTwisty");
var _fb2=document.getElementById("cardHeader");
var _fb3=document.getElementById("cardFooter");
if(_fb1){
_fb1.src=_fb0+"/nav/common/styles/images/iconHide.gif";
}
_fb2.style.display="";
_fb3.style.display="";
},resizeObj:function(obj,_fb5,_fb6){
if(typeof (obj.style.height)=="undefined"||obj.style.height<=0){
obj.style.height=obj.height;
}
if(typeof (obj.style.width)=="undefined"||obj.style.width<=0){
obj.style.width=obj.width;
}
obj.style.height=(_fb5)?obj.style.height=_fb6+"%":obj.style.height;
obj.style.width=(_fb5)?obj.style.width=_fb6+"%":obj.style.width;
},openVCardDialog:function(key,_fb8){
this._createVCardDialog(key,_fb8);
},_createVCardDialog:function(key,_fba){
window.open(this._getVCardDownloadUrl(key,_fba),"vcarddl","status=0,toolbar=0,scrollbars=0,resizable=0,height=350,width=550");
},_getVCardDownloadUrl:function(key,_fbc){
var base=lconn.core.bizCard.bizCardUtils.getBaseURL("hcard");
var lang=lconn.core.bizCard.bizCardUtils.getLangParam();
return base+"/html/exportVCardDialog.do?key="+key+"&lastMod="+_fbc+"&lang="+lang;
},
setLinkSource:function(obj){
this.linkSource=obj;
}};
}
dojo.i18n._preloadLocalizations("dojo.nls.communities",["da","es","hu","de","pt-br","pl","pt","ca","sv","ar","pt-pt","fi","zh","ru","xx","fr","zh-tw","it","th","cs","he","nl","el","no","ko","tr","en","ROOT","ja"]);
/* Copyright IBM Corp. 2001, 2008  All Rights Reserved.               */

/*this file replaces Menu.js for use with the dojo menu*/
dojo.declare("lconn.MenuUtility", null, {
	// contains the dom node that was last clicked/keypressed to open the menu
	openedBy: null,
 
	openMenu: function (evt, menuId){	
		// summary: open a dijit pointed by menuId (typically a dijit.Menu) in a popup placed around the node in evt.target
		//	typically called on a onclick event in the page (onclick="menuUtility.openMenu(event, 'id of your menu')"
		//	you can also use dojo.connect to bind it programmatically in a dom node
		var menu = dijit.byId(menuId);		
		
		// standardize the event (fix cross-browser differences)
		evt = dojo.fixEvent(evt);
		
		// store the DOM of the action link that opened the menu
		this.openedBy = evt.target;

		// open the menu, place it relative to the target position of the node
		dijit.popup.open({
			popup: menu,
			around: evt.target,
			orient: {'BL':'TL', 'BR':'TR', 'TL':'BL', 'TR':'BR'},
			onExecute: function(){ 
			},
			onCancel: function(){ 				
				dijit.popup.close(menu); 
			}, 
			onClose: function(){
	    		try{
		        	evt.target.focus();
		        }
		        catch(exception)
		        {
					//Will try again to add focus. IE doesn't like it when an element is invisible and focus is set on the element.
					setTimeout(function () {
				        try{
				        	evt.target.focus();
				        }
				        catch(exception2)
				        {
							//do nothing at this point
				        }
			        }, 1000);
		        }    			
			}}); 

		menu.focus();

		// close the menu when the user click outside the menu 
		dojo.connect(menu, "_onBlur", function(){dijit.popup.close(menu)}); 			
		
		dojo.stopEvent(evt);
	},

	openMenuA11y: function (evt, menuId){
		// for keyboard a11y
		if (evt.keyCode == dojo.keys.ENTER){
			this.openMenu(evt, menuId);
		} 
	}});
 
 // one instance per page
 menuUtility = new lconn.MenuUtility();
